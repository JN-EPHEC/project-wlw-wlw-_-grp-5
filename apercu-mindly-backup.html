<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MINDLY - Aperçu Complet Final</title>
    <style>
        :root {
            /* Thème par défaut - Épanoui/Joyeux */
            --primary-color: #4CAF50;
            --primary-light: #66BB6A;
            --primary-dark: #2E7D32;
            --secondary-color: #8BC34A;
            --background-light: #E8F5E8;
            --background-medium: #C8E6C9;
            --background-dark: #A5D6A7;
            --text-primary: #1B5E20;
            --text-secondary: #2E7D32;
            --text-muted: #4CAF50;
            --accent-color: #66BB6A;
        }

        /* Thème Serein - Bleu apaisant */
        [data-theme="serein"] {
            --primary-color: #2196F3;
            --primary-light: #42A5F5;
            --primary-dark: #1565C0;
            --secondary-color: #03A9F4;
            --background-light: #E3F2FD;
            --background-medium: #BBDEFB;
            --background-dark: #90CAF9;
            --text-primary: #0D47A1;
            --text-secondary: #1565C0;
            --text-muted: #1976D2;
            --accent-color: #42A5F5;
        }

        /* Thème Neutre - Gris équilibré */
        [data-theme="neutre"] {
            --primary-color: #607D8B;
            --primary-light: #78909C;
            --primary-dark: #37474F;
            --secondary-color: #90A4AE;
            --background-light: #ECEFF1;
            --background-medium: #CFD8DC;
            --background-dark: #B0BEC5;
            --text-primary: #263238;
            --text-secondary: #37474F;
            --text-muted: #546E7A;
            --accent-color: #78909C;
        }

        /* Thème Fatigué/Triste - Violet doux */
        [data-theme="fatigue"] {
            --primary-color: #9C27B0;
            --primary-light: #BA68C8;
            --primary-dark: #6A1B9A;
            --secondary-color: #E1BEE7;
            --background-light: #F3E5F5;
            --background-medium: #E1BEE7;
            --background-dark: #CE93D8;
            --text-primary: #4A148C;
            --text-secondary: #6A1B9A;
            --text-muted: #7B1FA2;
            --accent-color: #BA68C8;
        }

        /* Thème Anxieux - Orange chaleureux */
        [data-theme="anxieux"] {
            --primary-color: #FF9800;
            --primary-light: #FFB74D;
            --primary-dark: #F57C00;
            --secondary-color: #FFCC02;
            --background-light: #FFF3E0;
            --background-medium: #FFE0B2;
            --background-dark: #FFCC80;
            --text-primary: #E65100;
            --text-secondary: #F57C00;
            --text-muted: #FF8F00;
            --accent-color: #FFB74D;
        }

        /* Thème Énergique - Rouge dynamique */
        [data-theme="energique"] {
            --primary-color: #F44336;
            --primary-light: #EF5350;
            --primary-dark: #C62828;
            --secondary-color: #FF5722;
            --background-light: #FFEBEE;
            --background-medium: #FFCDD2;
            --background-dark: #EF9A9A;
            --text-primary: #B71C1C;
            --text-secondary: #C62828;
            --text-muted: #D32F2F;
            --accent-color: #EF5350;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #E8F5E8 0%, #C8E6C9 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 0;
            margin: 0;
            overflow: auto;
            transition: background 0.5s ease;
        }

        /* Container principal responsive */
        .phone-container {
            width: 100%;
            min-height: 100vh;
            max-width: 420px;
            margin: 0 auto;
            background: white;
            box-shadow: 0 0 20px rgba(0,0,0,0.1);
            position: relative;
            display: flex;
            flex-direction: column;
        }

        /* Responsive design */
        @media (max-width: 768px) {
            .phone-container {
                max-width: 100%;
                box-shadow: none;
            }
        }

        @media (min-width: 769px) {
            body {
                background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                padding: 20px 0;
            }
            
            .phone-container {
                border-radius: 20px;
                margin-top: 20px;
                margin-bottom: 20px;
            }
        }

        .screen {
            width: 100%;
            height: 100vh;
            background: #E8F5E8;
            border-radius: 0;
            overflow: auto;
            position: relative;
            transition: background 0.5s ease;
            display: flex;
            flex-direction: column;
        }

        /* En-tête global responsive */
        .global-header {
            position: fixed;
            top: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 100%;
            max-width: 420px;
            height: 70px;
            background: var(--primary-color);
            z-index: 1000;
            display: flex;
            align-items: center;
            padding: 0 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        @media (max-width: 768px) {
            .global-header {
                left: 0;
                transform: none;
                max-width: 100%;
            }
        }

        @media (min-width: 769px) {
            .global-header {
                border-radius: 20px 20px 0 0;
                top: 20px;
            }
        }

        .global-header .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
            width: 100%;
        }

        .global-header .app-title {
            color: white;
            font-size: 24px;
            font-weight: bold;
            margin: 0;
        }

        .global-header .date-text {
            color: rgba(255,255,255,0.9);
            font-size: 14px;
            margin: 0;
        }

        .global-header .menu-trigger {
            background: rgba(255,255,255,0.2);
            border: none;
            border-radius: 8px;
            padding: 8px 12px;
            color: white;
            font-size: 18px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .global-header .menu-trigger:hover {
            background: rgba(255,255,255,0.3);
        }

        /* Conteneur principal responsive */
        .main-content {
            padding-top: 70px;
            padding-bottom: 80px;
            min-height: 100vh;
            position: relative;
            background: white;
            width: 100%;
        }

        @media (min-width: 769px) {
            .main-content {
                padding-top: 90px; /* Plus d'espace sur desktop */
                padding-bottom: 100px;
                min-height: calc(100vh - 40px);
            }
        }

        .screen-content {
            display: none !important;
            width: 100%;
            min-height: calc(100vh - 150px);
            overflow-y: auto;
            padding: 20px;
            position: relative;
        }

        .screen-content.active {
            display: block !important;
        }

        /* S'assurer qu'aucun autre écran n'est visible */
        .screen-content:not(.active) {
            display: none !important;
            visibility: hidden;
            opacity: 0;
        }

        /* Navigation en bas responsive */
        .bottom-navigation {
            position: fixed;
            bottom: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 100%;
            max-width: 420px;
            height: 80px;
            background: white;
            border-top: 1px solid rgba(0,0,0,0.1);
            display: flex;
            justify-content: space-around;
            align-items: center;
            z-index: 1000;
            box-shadow: 0 -2px 10px rgba(0,0,0,0.1);
        }

        @media (max-width: 768px) {
            .bottom-navigation {
                left: 0;
                transform: none;
                max-width: 100%;
            }
        }

        @media (min-width: 769px) {
            .bottom-navigation {
                border-radius: 0 0 20px 20px;
                bottom: 20px;
            }
        }

        .bottom-nav-btn {
            display: flex;
            flex-direction: column;
            align-items: center;
            background: none;
            border: none;
            padding: 8px 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            border-radius: 12px;
            flex: 1;
            max-width: 80px;
        }

        .bottom-nav-btn:hover {
            background: var(--primary-color-alpha);
        }

        .bottom-nav-btn.active {
            background: var(--primary-color);
            color: white;
        }

        .bottom-nav-btn .nav-icon {
            font-size: 20px;
            margin-bottom: 4px;
        }

        .bottom-nav-btn .nav-label {
            font-size: 11px;
            font-weight: 600;
        }

        .bottom-nav-btn.active .nav-icon,
        .bottom-nav-btn.active .nav-label {
            color: white;
        }

        /* Formatage amélioré des messages IA */
        .ai-formatted .message-title {
            color: var(--primary-color);
            font-weight: bold;
            font-size: 16px;
            margin: 15px 0 10px 0;
            padding: 8px 12px;
            background: var(--primary-color-alpha);
            border-radius: 8px;
            border-left: 4px solid var(--primary-color);
        }

        .ai-formatted .numbered-item {
            margin: 8px 0;
            padding-left: 20px;
            position: relative;
        }

        .ai-formatted .numbered-item .number {
            position: absolute;
            left: 0;
            color: var(--primary-color);
            font-weight: bold;
        }

        .ai-formatted .bullet-item {
            margin: 6px 0;
            padding-left: 15px;
            color: var(--text-primary);
        }

        .ai-formatted .emoji-section {
            color: var(--primary-color);
            font-weight: 600;
            font-size: 15px;
            margin: 12px 0 8px 0;
        }

        .ai-formatted .tip-highlight {
            background: linear-gradient(135deg, #fff3cd, #ffeaa7);
            border: 1px solid #f39c12;
            border-radius: 10px;
            padding: 12px;
            margin: 10px 0;
            font-weight: 500;
            box-shadow: 0 2px 8px rgba(243, 156, 18, 0.2);
        }

        .ai-formatted .emotional-support {
            background: linear-gradient(135deg, #d1f2eb, #a8e6cf);
            border: 1px solid #27ae60;
            border-radius: 10px;
            padding: 12px;
            margin: 10px 0;
            font-weight: 500;
            box-shadow: 0 2px 8px rgba(39, 174, 96, 0.2);
        }

        .ai-formatted strong {
            color: var(--primary-color);
            font-weight: 600;
        }

        /* Animation pour les messages */
        .chat-message {
            opacity: 0;
            transform: translateY(10px);
            transition: all 0.3s ease;
        }

        .chat-message.loaded {
            opacity: 1;
            transform: translateY(0);
        }

        /* Responsive improvements pour tous les écrans */
        @media (max-width: 480px) {
            .global-header .app-title {
                font-size: 20px;
            }
            
            .global-header .date-text {
                font-size: 12px;
            }
            
            .bottom-nav-btn .nav-label {
                font-size: 10px;
            }
            
            .screen-content {
                padding: 15px;
            }
        }

        @media (min-width: 1200px) {
            .phone-container {
                max-width: 450px;
            }
            
            .global-header {
                max-width: 450px;
            }
            
            .bottom-navigation {
                max-width: 450px;
            }
        }

        /* Assurer que l'application prend tout l'espace disponible */
        html, body {
            height: 100%;
            margin: 0;
            padding: 0;
            overflow-x: hidden;
        }

        body {
            background: #f0f2f5;
        }

        /* Styles pour le menu hamburger restructuré */
        .dropdown-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px;
            border-bottom: 1px solid rgba(255,255,255,0.1);
            background: rgba(255,255,255,0.05);
        }

        .dropdown-title {
            font-size: 18px;
            font-weight: bold;
            color: white;
        }

        .dropdown-close {
            font-size: 24px;
            color: white;
            cursor: pointer;
            opacity: 0.8;
            transition: opacity 0.3s ease;
        }

        .dropdown-close:hover {
            opacity: 1;
        }

        .dropdown-body {
            padding: 10px 0;
            max-height: 70vh;
            overflow-y: auto;
        }

        .menu-section {
            margin-bottom: 25px;
            padding: 0 20px;
        }

        .menu-section-title {
            font-size: 14px;
            font-weight: 600;
            color: rgba(255,255,255,0.9);
            margin-bottom: 12px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .menu-items-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 8px;
        }

        .dropdown-item {
            display: flex;
            align-items: center;
            padding: 12px 16px;
            background: rgba(255,255,255,0.1);
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
        }

        .dropdown-item:hover {
            background: rgba(255,255,255,0.2);
            transform: translateX(5px);
        }

        .dropdown-icon {
            font-size: 18px;
            margin-right: 12px;
            width: 24px;
            text-align: center;
        }

        .dropdown-text {
            color: white;
            font-weight: 500;
            flex: 1;
        }

        .status-indicator {
            font-size: 11px;
            padding: 4px 8px;
            background: rgba(255,255,255,0.2);
            border-radius: 12px;
            color: white;
            font-weight: 600;
        }

        .status-indicator.active {
            background: #4CAF50;
            color: white;
        }

        /* Menu en haut à droite */
        .top-menu {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 2000;
        }

        .menu-button {
            background: var(--primary-color);
            color: white;
            border: none;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            font-size: 20px;
            cursor: pointer;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .menu-button:hover {
            transform: scale(1.1);
            box-shadow: 0 6px 20px rgba(0,0,0,0.3);
        }

        .dropdown-menu {
            position: absolute;
            top: 0;
            right: 10px;
            background: white;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            padding: 20px;
            min-width: 300px;
            max-width: calc(100vw - 20px);
            max-height: calc(100vh - 100px);
            overflow-y: auto;
            transform: translateX(100%);
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
            border: 2px solid var(--primary-light);
        }

        .dropdown-menu.active {
            transform: translateX(0);
            opacity: 1;
            visibility: visible;
        }

        .dropdown-menu::before {
            content: '';
            position: absolute;
            top: 20px;
            right: -12px;
            width: 0;
            height: 0;
            border-left: 12px solid white;
            border-top: 12px solid transparent;
            border-bottom: 12px solid transparent;
        }

        .dropdown-title {
            font-size: 18px;
            font-weight: bold;
            color: var(--primary-color);
            margin-bottom: 15px;
            text-align: center;
        }

        .menu-section {
            margin-bottom: 20px;
        }

        .menu-section-title {
            font-size: 14px;
            font-weight: bold;
            color: var(--text-secondary);
            margin-bottom: 10px;
            padding-bottom: 5px;
            border-bottom: 1px solid var(--background-medium);
        }

        .menu-items-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
        }

        .dropdown-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 12px 8px;
            background: var(--background-light);
            border: 1px solid var(--background-medium);
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
        }

        .dropdown-item:hover {
            background: var(--background-medium);
            border-color: var(--primary-color);
            transform: translateY(-2px);
        }

        .dropdown-icon {
            font-size: 20px;
            margin-bottom: 5px;
        }

        .dropdown-text {
            font-size: 12px;
            font-weight: 600;
            color: var(--text-primary);
        }

        /* Sélecteur de couleurs personnalisées */
        .color-picker-section {
            background: var(--background-light);
            border-radius: 12px;
            padding: 15px;
            margin: 15px 0;
        }

        .color-picker-title {
            font-size: 14px;
            font-weight: bold;
            color: var(--text-primary);
            margin-bottom: 10px;
            text-align: center;
        }

        .color-options {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 8px;
            margin-bottom: 15px;
        }

        .color-option {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            cursor: pointer;
            border: 3px solid transparent;
            transition: all 0.3s ease;
            position: relative;
        }

        .color-option:hover {
            transform: scale(1.1);
        }

        .color-option.active {
            border-color: white;
            box-shadow: 0 0 0 2px var(--text-primary);
        }

        .custom-color-input {
            width: 100%;
            height: 35px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
        }

        /* Nouveaux styles de personnalisation */
        .text-style-options, .quick-themes, .custom-colors {
            margin-bottom: 20px;
        }

        .style-title {
            font-size: 13px;
            font-weight: bold;
            color: var(--text-primary);
            margin-bottom: 10px;
            text-align: center;
        }

        .style-buttons {
            display: flex;
            gap: 8px;
            justify-content: center;
        }

        .style-btn {
            background: rgba(255,255,255,0.1);
            border: 2px solid transparent;
            border-radius: 8px;
            padding: 8px 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 11px;
        }

        .style-btn:hover {
            background: rgba(255,255,255,0.2);
            transform: scale(1.05);
        }

        .style-btn.active {
            border-color: var(--primary-color);
            background: rgba(76, 175, 80, 0.2);
        }

        .theme-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
        }

        .theme-option {
            width: 45px;
            height: 45px;
            border-radius: 50%;
            cursor: pointer;
            border: 3px solid transparent;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 16px;
        }

        .theme-option:hover {
            transform: scale(1.1);
            border-color: white;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        }

        .theme-option.active {
            border-color: var(--primary-color);
            transform: scale(1.05);
        }

        .reset-section {
            text-align: center;
            margin-top: 15px;
        }

        .reset-btn {
            background: rgba(255,255,255,0.1);
            border: 1px solid rgba(255,255,255,0.3);
            color: white;
            border-radius: 20px;
            padding: 8px 16px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 12px;
        }

        .reset-btn:hover {
            background: rgba(255,255,255,0.2);
            transform: scale(1.05);
        }

        /* Variables CSS dynamiques pour personnalisation */
        :root[data-text-style="white"] {
            --text-color: white;
            --text-opacity: 1;
        }

        :root[data-text-style="dark"] {
            --text-color: #333;
            --text-opacity: 1;
        }

        :root[data-text-style="colorful"] {
            --text-color: transparent;
            --text-opacity: 1;
        }

        /* Styles pour texte coloré */
        [data-text-style="colorful"] .section-title,
        [data-text-style="colorful"] .chart-title,
        [data-text-style="colorful"] .diagnosis-title,
        [data-text-style="colorful"] .rec-title {
            background: linear-gradient(45deg, var(--primary-color), var(--primary-light));
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        /* FAQ Styles */
        .faq-content {
            padding: clamp(10px, 2vw, 15px) clamp(10px, 3vw, 20px) clamp(15px, 3vw, 20px);
            flex: 1;
            overflow-y: auto;
            min-height: 0;
            background: var(--background-light);
            color: var(--text-primary);
        }

        .faq-intro {
            text-align: center;
            margin-bottom: 30px;
            padding: 20px;
            background: var(--primary-dark);
            border-radius: 15px;
            color: white;
        }

        .faq-welcome-icon {
            font-size: 48px;
            margin-bottom: 15px;
        }

        .faq-intro h2 {
            color: white;
            margin: 10px 0;
            font-size: 24px;
        }

        .faq-intro p {
            color: rgba(255,255,255,0.9);
            margin: 0;
        }

        .faq-categories {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .faq-category {
            background: var(--primary-dark);
            border-radius: 15px;
            padding: 20px;
            border: 1px solid rgba(255,255,255,0.2);
        }

        .category-title {
            color: white;
            font-size: 18px;
            font-weight: 600;
            margin: 0 0 15px 0;
            padding-bottom: 10px;
            border-bottom: 1px solid rgba(255,255,255,0.2);
        }

        .faq-items {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .faq-item {
            background: rgba(0,0,0,0.2);
            border-radius: 10px;
            border: 1px solid rgba(255,255,255,0.1);
            overflow: hidden;
        }

        .faq-question {
            padding: 15px;
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
            color: white;
            font-weight: 500;
            transition: all 0.3s ease;
        }

        .faq-question:hover {
            background: rgba(255,255,255,0.1);
        }

        .faq-toggle {
            font-size: 12px;
            transition: transform 0.3s ease;
        }

        .faq-question.active .faq-toggle {
            transform: rotate(180deg);
        }

        .faq-answer {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease;
            background: rgba(0,0,0,0.1);
        }

        .faq-answer.active {
            max-height: 500px;
        }

        .faq-answer p, .faq-answer ul {
            padding: 15px;
            margin: 0;
            color: rgba(255,255,255,0.9);
            line-height: 1.6;
        }

        .faq-answer ul {
            padding-left: 35px;
        }

        .faq-answer li {
            margin-bottom: 5px;
        }

        .quick-help {
            margin-top: 30px;
            background: var(--primary-dark);
            border-radius: 15px;
            padding: 20px;
            text-align: center;
            border: 1px solid rgba(255,255,255,0.2);
        }

        .quick-help h3 {
            color: white;
            margin: 0 0 20px 0;
            font-size: 20px;
        }

        .help-buttons {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
            gap: 15px;
        }

        .help-btn {
            background: var(--primary-color);
            color: white;
            border: none;
            border-radius: 10px;
            padding: 15px 10px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 8px;
            font-size: 14px;
            font-weight: 500;
        }

        .help-btn:hover {
            background: var(--primary-light);
            transform: translateY(-2px);
        }

        .help-btn span:first-child {
            font-size: 20px;
        }

        /* Application globale des couleurs personnalisées */
        .app-container {
            background: var(--background-light);
            color: var(--text-primary);
        }
        
        .header, .dashboard-header, .profile-header, .community-header, .explore-header, .mood-header, .chat-header {
            background: linear-gradient(135deg, var(--primary-color), var(--primary-light)) !important;
            color: white !important;
        }
        
        .nav-item.active, .tab.active {
            background: var(--primary-color) !important;
            color: white !important;
        }
        
        .nav-item:hover, .tab:hover {
            background: var(--primary-light) !important;
            color: white !important;
        }
        
        .btn-primary, .primary-btn, .cta-button {
            background: var(--primary-color) !important;
            border-color: var(--primary-dark) !important;
            color: white !important;
        }
        
        .btn-primary:hover, .primary-btn:hover, .cta-button:hover {
            background: var(--primary-dark) !important;
        }
        
        .feature-card, .mood-card, .meditation-card, .article-card, .resource-card {
            border-left: 4px solid var(--primary-color) !important;
            background: var(--background-light) !important;
        }
        
        .feature-card:hover, .mood-card:hover, .meditation-card:hover, .article-card:hover, .resource-card:hover {
            background: var(--primary-light) !important;
            color: white !important;
        }
        
        .bottom-nav {
            background: var(--primary-dark) !important;
        }
        
        .stat-item, .quick-stat {
            background: var(--primary-color) !important;
            color: white !important;
            border: 1px solid var(--primary-dark) !important;
        }


        /* Welcome Screen */
        .welcome-screen {
            display: flex;
            flex-direction: column;
            height: 100%;
            background: linear-gradient(135deg, var(--background-light) 0%, var(--background-medium) 100%);
            color: var(--text-primary);
        }

        .welcome-header {
            flex: 1;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            padding: 40px 20px;
        }

        .logo {
            width: clamp(80px, 20vw, 120px);
            height: clamp(80px, 20vw, 120px);
            background: var(--primary-color);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: clamp(16px, 4vw, 24px);
            box-shadow: 0 clamp(4px, 2vw, 8px) clamp(15px, 6vw, 30px) rgba(76, 175, 80, 0.3);
            transition: all 0.5s ease;
        }

        /* Navigation principale en bas */
        .main-navigation {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-top: 1px solid var(--background-medium);
            padding: 10px 20px;
            display: flex;
            justify-content: space-around;
            align-items: center;
            z-index: 1000;
            box-shadow: 0 -2px 10px rgba(0,0,0,0.1);
        }

        .main-nav-btn {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            background: none;
            border: none;
            color: var(--text-muted);
            cursor: pointer;
            transition: all 0.3s ease;
            padding: 8px 12px;
            border-radius: 12px;
            min-width: 60px;
        }

        .main-nav-btn:hover {
            background: var(--background-light);
            color: var(--primary-color);
            transform: translateY(-2px);
        }

        .main-nav-btn.active {
            background: var(--primary-color);
            color: white;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        }

        .nav-icon {
            font-size: 20px;
            margin-bottom: 4px;
        }

        .nav-label {
            font-size: 11px;
            font-weight: 600;
            line-height: 1;
        }

        /* Ajuster le padding pour la navigation */
        .screen {
            padding-bottom: 80px;
        }

        .logo-text {
            color: white;
            font-size: clamp(20px, 6vw, 32px);
            font-weight: 800;
            letter-spacing: clamp(1px, 0.5vw, 2px);
        }

        .welcome-title {
            font-size: clamp(24px, 6vw, 32px);
            font-weight: 800;
            color: var(--text-primary);
            margin-bottom: clamp(8px, 2vw, 12px);
            text-align: center;
            line-height: 1.2;
            transition: color 0.5s ease;
        }

        .welcome-subtitle {
            font-size: clamp(14px, 4vw, 18px);
            color: var(--text-secondary);
            text-align: center;
            margin-bottom: clamp(30px, 6vw, 40px);
            line-height: 1.5;
            padding: 0 clamp(10px, 3vw, 20px);
            transition: color 0.5s ease;
        }

        .onboarding-section {
            padding: 0 20px 30px;
        }

        .onboarding-btn {
            width: 100%;
            padding: 16px;
            background: #66BB6A;
            border: none;
            border-radius: 25px;
            margin-bottom: 20px;
        }

        .onboarding-text {
            color: white;
            font-size: 16px;
            font-weight: 600;
            text-align: center;
        }

        .auth-buttons {
            padding: 0 20px 40px;
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .auth-btn {
            width: 100%;
            padding: clamp(12px, 3vw, 16px);
            border-radius: clamp(20px, 4vw, 25px);
            font-size: clamp(14px, 3.5vw, 16px);
            font-weight: 600;
            border: none;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .signup-btn {
            background: #4CAF50;
            color: white;
        }

        .login-btn {
            background: transparent;
            color: #1B5E20;
            border: 2px solid #4CAF50;
        }

        .guest-btn {
            background: #E0E0E0;
            color: #424242;
        }

        /* Auth Screens */
        .auth-screen {
            padding: 60px 20px 40px;
            height: 100%;
            display: flex;
            flex-direction: column;
        }

        .auth-header {
            text-align: center;
            margin-bottom: 40px;
        }

        .auth-title {
            font-size: 28px;
            font-weight: 700;
            color: #1B5E20;
            margin-bottom: 8px;
        }

        .auth-subtitle {
            font-size: 16px;
            color: #666;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-label {
            display: block;
            font-size: 14px;
            color: #1B5E20;
            margin-bottom: 8px;
            font-weight: 600;
        }

        .form-input {
            width: 100%;
            padding: clamp(12px, 3vw, 16px);
            border: 2px solid #E0E0E0;
            border-radius: clamp(8px, 2vw, 12px);
            font-size: clamp(14px, 3.5vw, 16px);
            background: white;
            transition: border-color 0.2s ease;
        }

        .form-input:focus {
            outline: none;
            border-color: #4CAF50;
        }

        .submit-btn {
            width: 100%;
            padding: 16px;
            background: #4CAF50;
            color: white;
            border: none;
            border-radius: 12px;
            font-size: 16px;
            font-weight: 600;
            margin: 20px 0;
        }

        .auth-link {
            text-align: center;
            margin-top: 20px;
        }

        .auth-link a {
            color: #4CAF50;
            text-decoration: none;
            font-weight: 600;
        }

        /* Onboarding Screen */
        .onboarding-screen {
            height: 100%;
            display: flex;
            flex-direction: column;
            padding: 40px 20px;
            text-align: center;
        }

        .onboarding-content {
            flex: 1;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
        }

        .onboarding-icon {
            font-size: 24px;
            font-weight: 700;
            color: #1B5E20;
            letter-spacing: 1px;
            text-align: center;
            margin-bottom: 20px;
            padding: 20px;
            background: #C8E6C9;
            border-radius: 20px;
            min-height: 80px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .onboarding-title {
            font-size: 28px;
            font-weight: 700;
            color: #1B5E20;
            margin-bottom: 8px;
        }

        .onboarding-description {
            font-size: 16px;
            color: #666;
            line-height: 1.5;
            margin-bottom: 40px;
        }

        .onboarding-navigation {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 40px;
        }

        .nav-dots {
            display: flex;
            gap: 8px;
        }

        .dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: #E0E0E0;
        }

        .dot.active {
            background: #4CAF50;
        }

        .nav-step-btn {
            padding: 12px 20px;
            border-radius: 20px;
            border: none;
            font-weight: 600;
            cursor: pointer;
        }

        .prev-btn {
            background: #E0E0E0;
            color: #666;
        }

        .next-btn {
            background: #4CAF50;
            color: white;
        }

        /* Main App Screens */
        .main-app {
            height: 100vh;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        .app-header {
            background: #C8E6C9;
            padding: 60px 20px 30px;
            border-bottom-left-radius: 30px;
            border-bottom-right-radius: 30px;
            text-align: center;
            position: relative;
        }

        .app-title {
            font-size: clamp(20px, 5vw, 28px);
            font-weight: 600;
            color: #1B5E20;
            margin-bottom: clamp(6px, 1.5vw, 8px);
            line-height: 1.2;
        }

        .date-text {
            font-size: clamp(12px, 3vw, 16px);
            color: #000;
            line-height: 1.3;
        }

        /* Header avec menu */
        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .header-text {
            text-align: left;
            flex: 1;
        }

        .menu-trigger {
            background: rgba(255,255,255,0.1);
            border: 1px solid rgba(255,255,255,0.2);
            border-radius: 12px;
            width: 45px;
            height: 45px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
        }

        .menu-trigger:hover {
            background: rgba(255,255,255,0.2);
            transform: scale(1.05);
        }

        .menu-icon {
            font-size: 20px;
        }

        .settings-dropdown {
            position: fixed;
            top: 80px;
            right: 20px;
            background: rgba(255,255,255,0.95);
            backdrop-filter: blur(20px);
            border-radius: 15px;
            width: 220px;
            max-width: calc(100vw - 40px);
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
            border: 1px solid rgba(255,255,255,0.3);
            opacity: 0;
            transform: translateY(-10px);
            pointer-events: none;
            transition: all 0.3s ease;
            z-index: 1000;
            max-height: 60vh;
            overflow-y: auto;
        }

        .settings-dropdown.show {
            opacity: 1;
            transform: translateY(0);
            pointer-events: all;
        }

        .dropdown-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 15px 20px;
            cursor: pointer;
            transition: all 0.2s ease;
            border-bottom: 1px solid rgba(0,0,0,0.1);
        }

        .dropdown-item:last-child {
            border-bottom: none;
        }

        .dropdown-item:hover {
            background: rgba(0,0,0,0.05);
        }

        .dropdown-icon {
            font-size: 16px;
            width: 20px;
            text-align: center;
        }

        .dropdown-text {
            font-size: 14px;
            font-weight: 500;
            color: #333;
        }

        .app-content {
            flex: 1;
            padding: clamp(16px, 4vw, 24px) clamp(16px, 4vw, 20px);
            overflow-y: auto;
            min-height: 0;
        }

        /* Home Screen Specific */
        .mood-question {
            text-align: center;
            margin-bottom: 24px;
        }

        .mood-question h2 {
            font-size: clamp(18px, 4.5vw, 24px);
            font-weight: 600;
            color: #000;
            margin-bottom: clamp(6px, 1.5vw, 8px);
            line-height: 1.3;
        }

        .mood-question .subtitle {
            font-size: clamp(12px, 3vw, 16px);
            color: #666;
            line-height: 1.4;
        }

        .mood-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(clamp(140px, 30vw, 160px), 1fr));
            gap: clamp(12px, 3vw, 16px);
            margin-bottom: clamp(18px, 4vw, 24px);
            padding: 0 clamp(5px, 2vw, 10px);
        }

        .mood-item {
            background: var(--background-medium);
            border-radius: clamp(12px, 3vw, 16px);
            padding: clamp(15px, 4vw, 20px);
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 2px solid transparent;
            position: relative;
            overflow: hidden;
        }

        .mood-emoji {
            font-size: clamp(24px, 6vw, 32px);
            margin-bottom: clamp(8px, 2vw, 12px);
            transition: transform 0.3s ease;
        }

        .mood-item:hover {
            background: var(--background-dark);
            transform: translateY(-3px);
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.15);
        }

        .mood-item:hover .mood-emoji {
            transform: scale(1.2);
        }

        .mood-item.selected,
        .mood-button.selected {
            background: var(--primary-color);
            color: white;
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.2);
            border-color: var(--primary-dark);
        }

        .mood-item.selected .mood-text,
        .mood-button.selected .mood-text,
        .mood-item.selected .mood-label,
        .mood-button.selected .mood-label {
            color: white;
        }

        .mood-item.selected .mood-emoji {
            transform: scale(1.3);
            filter: drop-shadow(0 2px 4px rgba(0, 0, 0, 0.3));
        }

        .mood-text {
            font-size: clamp(12px, 3vw, 16px);
            font-weight: 700;
            color: #1B5E20;
            letter-spacing: clamp(0.5px, 0.2vw, 1px);
            margin-bottom: clamp(6px, 1.5vw, 8px);
            line-height: 1.2;
        }

        .mood-label {
            font-size: clamp(11px, 2.5vw, 14px);
            color: #2E7D32;
            line-height: 1.3;
        }

        .actions-section {
            margin-top: 32px;
        }

        .section-title {
            font-size: clamp(16px, 4vw, 20px);
            font-weight: 600;
            color: #1B5E20;
            margin-bottom: clamp(12px, 3vw, 16px);
            text-align: center;
            line-height: 1.3;
        }

        .action-cards {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .action-card {
            background: white;
            border-radius: 16px;
            padding: 16px;
            display: flex;
            align-items: center;
            gap: 16px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .action-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 16px rgba(0,0,0,0.15);
        }

        .action-icon {
            width: 48px;
            height: 48px;
            background: #E8F5E8;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .action-text {
            font-size: 12px;
            font-weight: 700;
            color: #1B5E20;
            letter-spacing: 1px;
        }

        .action-content {
            flex: 1;
        }

        .action-title {
            font-size: clamp(14px, 3.5vw, 18px);
            font-weight: 600;
            color: #1B5E20;
            margin-bottom: clamp(3px, 0.8vw, 4px);
            line-height: 1.3;
        }

        .action-subtitle {
            font-size: clamp(11px, 2.8vw, 14px);
            color: #2E7D32;
            line-height: 1.4;
        }

        /* Mood Screen Specific */
        .mood-selection {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 12px;
            margin-bottom: 24px;
        }

        .mood-button {
            background: #DCEDC8;
            border: none;
            border-radius: 16px;
            padding: 16px 8px;
            text-align: center;
            cursor: pointer;
            transition: all 0.2s;
        }

        .mood-button:hover {
            background: #C8E6C9;
            transform: translateY(-2px);
        }

        .mood-button .mood-text {
            font-size: 16px;
            font-weight: 700;
            color: #000;
            letter-spacing: 1px;
            margin-bottom: 4px;
        }

        .mood-button .mood-label {
            font-size: 12px;
            color: #666;
        }

        .insights-section {
            background: white;
            border-radius: 16px;
            padding: 20px;
            margin-top: 24px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        .insights-title {
            font-size: 20px;
            font-weight: 600;
            color: #000;
            margin-bottom: 12px;
            text-align: center;
        }

        .insight-text {
            font-size: 16px;
            color: #666;
            line-height: 1.5;
            text-align: center;
        }

        /* Chat Screen Specific */
        .chat-container {
            display: flex;
            flex-direction: column;
            gap: 24px;
            height: 100%;
            overflow: hidden;
        }

        .welcome-message {
            background: #DCEDC8;
            border-radius: 16px;
            padding: 20px;
            text-align: center;
        }

        .conversation-area {
            flex: 1;
            display: flex;
            flex-direction: column;
            height: 100%;
            overflow: hidden;
        }

        .messages-container {
            flex: 1;
            overflow-y: auto;
            padding: 10px 0;
            margin-bottom: 10px;
            max-height: calc(100vh - 250px);
        }

        .chat-message {
            margin: 15px 0;
            padding: 15px;
            border-radius: 20px;
            max-width: 85%;
            word-wrap: break-word;
            animation: messageAppear 0.3s ease;
            transform: translateY(10px);
            opacity: 0;
        }

        .chat-message.user {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            margin-left: auto;
            border-radius: 20px 20px 5px 20px;
            box-shadow: 0 3px 10px rgba(102, 126, 234, 0.3);
        }

        .chat-message.ai {
            background: linear-gradient(135deg, var(--primary-color), var(--primary-light));
            color: white;
            margin-right: auto;
            border-radius: 20px 20px 20px 5px;
            box-shadow: 0 3px 10px rgba(0,0,0,0.15);
        }

        .message-header {
            display: flex;
            align-items: center;
            margin-bottom: 8px;
            font-size: 14px;
            opacity: 0.9;
        }

        .message-avatar {
            width: 25px;
            height: 25px;
            border-radius: 50%;
            background: rgba(255,255,255,0.2);
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 8px;
            font-size: 12px;
        }

        .message-content {
            line-height: 1.5;
            font-size: 15px;
        }

        .message-time {
            text-align: right;
            font-size: 10px;
            opacity: 0.7;
            margin-top: 8px;
        }

        .chat-input-area {
            background: rgba(255,255,255,0.05);
            border-radius: 15px;
            padding: 15px;
            margin-top: 10px;
        }

        .input-container {
            display: flex;
            align-items: flex-end;
            gap: 10px;
        }

        #chat-input {
            flex: 1;
            background: rgba(255,255,255,0.1);
            border: 1px solid rgba(255,255,255,0.2);
            border-radius: 20px;
            padding: 12px 16px;
            color: white;
            font-size: 15px;
            resize: none;
            outline: none;
            transition: all 0.3s ease;
            font-family: inherit;
        }

        #chat-input:focus {
            border-color: var(--primary-light);
            background: rgba(255,255,255,0.15);
            box-shadow: 0 0 0 2px rgba(255,255,255,0.1);
        }

        #chat-input::placeholder {
            color: rgba(255,255,255,0.6);
        }

        #send-button {
            background: linear-gradient(135deg, var(--primary-color), var(--primary-light));
            border: none;
            border-radius: 50%;
            width: 45px;
            height: 45px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 18px;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 3px 10px rgba(0,0,0,0.2);
        }

        #send-button:hover {
            transform: scale(1.05);
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
        }

        #send-button:active {
            transform: scale(0.95);
        }

        .character-count {
            text-align: right;
            font-size: 11px;
            opacity: 0.6;
            margin-top: 5px;
        }

        .typing-indicator {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 10px 15px;
            background: rgba(255,255,255,0.1);
            border-radius: 20px;
            margin-bottom: 10px;
            font-size: 13px;
            opacity: 0.8;
        }

        .typing-dots {
            display: flex;
            gap: 3px;
        }

        .typing-dots span {
            width: 6px;
            height: 6px;
            background: var(--primary-light);
            border-radius: 50%;
            animation: typingDots 1.5s infinite;
        }

        .typing-dots span:nth-child(2) {
            animation-delay: 0.2s;
        }

        .typing-dots span:nth-child(3) {
            animation-delay: 0.4s;
        }

        @keyframes messageAppear {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes typingDots {
            0%, 60%, 100% {
                transform: scale(0.8);
                opacity: 0.5;
            }
            30% {
                transform: scale(1);
                opacity: 1;
            }
        }

        /* Dashboard Styles */
        .dashboard-content {
            padding: clamp(10px, 2vw, 15px) clamp(10px, 3vw, 20px) clamp(15px, 3vw, 20px);
            flex: 1;
            overflow-y: auto;
            min-height: 0;
            background: var(--background-light);
            color: var(--text-primary);
        }

        .dashboard-section {
            background: var(--primary-dark);
            border-radius: clamp(12px, 3vw, 18px);
            padding: clamp(12px, 3vw, 18px);
            margin-bottom: clamp(12px, 3vw, 18px);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255,255,255,0.2);
            color: white;
        }

        .section-title {
            font-size: clamp(14px, 4vw, 18px);
            font-weight: 600;
            color: white;
            margin-bottom: clamp(10px, 3vw, 15px);
            display: flex;
            align-items: center;
            gap: clamp(6px, 2vw, 10px);
        }

        /* Quick Mood Selector */
        .quick-mood-selector {
            display: flex;
            gap: 8px;
            justify-content: space-around;
            flex-wrap: wrap;
        }

        .quick-mood-btn {
            background: rgba(255,255,255,0.15);
            border: 2px solid transparent;
            border-radius: 12px;
            padding: 10px;
            font-size: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
            min-width: 45px;
            min-height: 45px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .quick-mood-btn:hover {
            background: rgba(255,255,255,0.25);
            transform: scale(1.1);
        }

        .quick-mood-btn.selected {
            border-color: var(--primary-light);
            background: rgba(255,255,255,0.3);
        }

        /* MINA Chat Preview */
        .mina-chat-preview {
            display: flex;
            align-items: center;
            gap: 12px;
            background: rgba(255,255,255,0.1);
            border-radius: 12px;
            padding: 12px;
        }

        .mina-avatar {
            position: relative;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .avatar-img {
            width: 40px;
            height: 40px;
            background: rgba(76, 175, 80, 0.3);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 18px;
            border: 2px solid rgba(76, 175, 80, 0.5);
        }

        .online-status {
            position: absolute;
            bottom: 2px;
            right: 2px;
            width: 12px;
            height: 12px;
            background: #4CAF50;
            border-radius: 50%;
            border: 2px solid white;
            animation: pulse 2s infinite;
        }

        .mina-info {
            flex: 1;
        }

        .mina-name {
            font-weight: 600;
            color: white;
            font-size: 14px;
        }

        .mina-status {
            font-size: 12px;
            color: rgba(255,255,255,0.7);
            margin-top: 2px;
        }

        .chat-now-btn {
            background: linear-gradient(135deg, #4CAF50, #66BB6A);
            color: white;
            border: none;
            border-radius: 20px;
            padding: 8px 16px;
            font-size: 12px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .chat-now-btn:hover {
            transform: scale(1.05);
            box-shadow: 0 3px 10px rgba(76, 175, 80, 0.4);
        }

        /* Quick Actions Grid */
        .quick-actions-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
        }

        .quick-action-btn {
            background: rgba(255,255,255,0.1);
            border: 1px solid rgba(255,255,255,0.2);
            border-radius: 12px;
            padding: 15px 10px;
            color: white;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 5px;
        }

        .quick-action-btn:hover {
            background: rgba(255,255,255,0.2);
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.2);
        }

        .action-icon {
            font-size: 24px;
            margin-bottom: 5px;
        }

        .action-name {
            font-size: 12px;
            font-weight: 600;
        }

        .action-duration {
            font-size: 10px;
            opacity: 0.7;
        }

        /* Community Preview */
        .community-preview {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .community-stats {
            display: flex;
            justify-content: space-around;
            background: var(--background-light);
            border-radius: 10px;
            padding: 12px;
            border: 1px solid var(--primary-color-alpha);
        }

        .stat-item {
            text-align: center;
        }

        .stat-number {
            font-size: 18px;
            font-weight: 700;
            color: var(--primary-light);
        }

        .stat-label {
            font-size: 10px;
            color: rgba(255,255,255,0.7);
            margin-top: 2px;
        }

        .community-actions {
            display: flex;
            gap: 8px;
        }

        .community-btn {
            flex: 1;
            background: rgba(255,255,255,0.15);
            border: 1px solid rgba(255,255,255,0.3);
            color: white;
            border-radius: 10px;
            padding: 10px;
            font-size: 12px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .community-btn:hover {
            background: rgba(255,255,255,0.25);
        }

        /* Stats Preview */
        .stats-preview {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .progress-ring {
            width: 60px;
            height: 60px;
            background: conic-gradient(var(--primary-color) 70%, rgba(255,255,255,0.2) 70%);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
        }

        .progress-ring::before {
            content: '';
            position: absolute;
            width: 45px;
            height: 45px;
            background: var(--bg-primary);
            border-radius: 50%;
        }

        .ring-content {
            position: relative;
            z-index: 1;
            text-align: center;
        }

        .progress-number {
            font-size: 16px;
            font-weight: 700;
            color: white;
        }

        .progress-label {
            font-size: 9px;
            color: rgba(255,255,255,0.7);
        }

        .stats-details {
            flex: 1;
            display: flex;
            flex-direction: column;
            gap: 5px;
        }

        .stat-detail {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .stat-icon {
            font-size: 14px;
        }

        .stat-text {
            font-size: 12px;
            color: rgba(255,255,255,0.8);
        }

        /* Daily Quote */
        .daily-quote {
            background: rgba(255,255,255,0.1);
            border-radius: 12px;
            padding: 15px;
            text-align: center;
            position: relative;
        }

        .quote-text {
            font-size: 13px;
            color: white;
            line-height: 1.4;
            font-style: italic;
            margin-bottom: 8px;
        }

        .quote-author {
            font-size: 11px;
            color: rgba(255,255,255,0.7);
            margin-bottom: 10px;
        }

        .new-quote-btn {
            background: rgba(255,255,255,0.2);
            border: 1px solid rgba(255,255,255,0.3);
            color: white;
            border-radius: 15px;
            padding: 6px 12px;
            font-size: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .new-quote-btn:hover {
            background: rgba(255,255,255,0.3);
        }

        /* Quick Modal Styles */
        .quick-modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.8);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .quick-modal {
            background: linear-gradient(135deg, var(--primary-color), var(--primary-light));
            border-radius: 20px;
            width: 90%;
            max-width: 400px;
            max-height: 80vh;
            overflow: hidden;
            transform: scale(0.8);
            transition: transform 0.3s ease;
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px;
            border-bottom: 1px solid rgba(255,255,255,0.2);
        }

        .modal-header h3 {
            color: white;
            font-size: 18px;
            margin: 0;
        }

        .modal-close {
            background: none;
            border: none;
            color: white;
            font-size: 24px;
            cursor: pointer;
            padding: 0;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .modal-close:hover {
            background: rgba(255,255,255,0.2);
        }

        .modal-content {
            padding: 20px;
            max-height: 60vh;
            overflow-y: auto;
        }

        /* Quick Meditation Styles */
        .quick-meditation {
            text-align: center;
            color: white;
        }

        .meditation-timer {
            margin: 20px 0;
        }

        .timer-circle {
            width: 120px;
            height: 120px;
            border: 4px solid rgba(255,255,255,0.3);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto;
            background: rgba(255,255,255,0.1);
        }

        .timer-number {
            font-size: 24px;
            font-weight: 700;
            color: white;
        }

        .meditation-instructions {
            margin: 20px 0;
            line-height: 1.6;
        }

        .meditation-controls {
            display: flex;
            gap: 10px;
            justify-content: center;
            margin-top: 20px;
        }

        .meditation-btn {
            background: rgba(255,255,255,0.2);
            border: 1px solid rgba(255,255,255,0.3);
            color: white;
            border-radius: 20px;
            padding: 10px 20px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .meditation-btn:hover {
            background: rgba(255,255,255,0.3);
        }

        /* Breathing Exercise Styles */
        .breathing-exercise {
            text-align: center;
            color: white;
        }

        .breathing-circle {
            width: 120px;
            height: 120px;
            border: 4px solid rgba(255,255,255,0.5);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 20px auto;
            background: rgba(255,255,255,0.1);
            transition: all 4s ease;
        }

        .breathing-circle.inhale {
            transform: scale(1.3);
            background: rgba(76, 175, 80, 0.3);
        }

        .breathing-circle.exhale {
            transform: scale(0.8);
            background: rgba(33, 150, 243, 0.3);
        }

        .breathing-text {
            font-size: 16px;
            font-weight: 600;
        }

        .breathing-controls {
            display: flex;
            gap: 10px;
            justify-content: center;
            margin-top: 20px;
        }

        .breathing-btn {
            background: rgba(255,255,255,0.2);
            border: 1px solid rgba(255,255,255,0.3);
            color: white;
            border-radius: 20px;
            padding: 10px 20px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        /* Quick Journal Styles */
        .quick-journal {
            color: white;
        }

        #quick-journal-text {
            width: 100%;
            background: rgba(255,255,255,0.1);
            border: 1px solid rgba(255,255,255,0.3);
            border-radius: 10px;
            padding: 15px;
            color: white;
            font-size: 14px;
            resize: none;
            outline: none;
            font-family: inherit;
        }

        #quick-journal-text::placeholder {
            color: rgba(255,255,255,0.6);
        }

        .journal-prompts {
            margin: 15px 0;
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .prompt {
            background: rgba(255,255,255,0.1);
            border: 1px solid rgba(255,255,255,0.2);
            border-radius: 8px;
            padding: 10px;
            cursor: pointer;
            font-size: 12px;
            transition: all 0.3s ease;
        }

        .prompt:hover {
            background: rgba(255,255,255,0.2);
        }

        .journal-controls {
            display: flex;
            gap: 10px;
            justify-content: center;
            margin-top: 15px;
        }

        .journal-btn {
            background: rgba(255,255,255,0.2);
            border: 1px solid rgba(255,255,255,0.3);
            color: white;
            border-radius: 20px;
            padding: 10px 20px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .journal-btn.save {
            background: rgba(76, 175, 80, 0.3);
            border-color: rgba(76, 175, 80, 0.5);
        }

        /* Quick Notification */
        .quick-notification {
            position: fixed;
            top: 20px;
            left: 50%;
            transform: translateX(-50%) translateY(-20px);
            background: rgba(76, 175, 80, 0.9);
            color: white;
            padding: 12px 20px;
            border-radius: 25px;
            font-size: 14px;
            font-weight: 600;
            z-index: 1001;
            opacity: 0;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255,255,255,0.2);
        }

        /* Responsive Dashboard */
        @media (max-width: 480px) {
            .phone-container {
                border-radius: 0;
                box-shadow: none;
            }
            
            .app-header {
                padding: clamp(15px, 4vw, 25px) clamp(15px, 4vw, 20px);
                border-radius: 0;
            }
            
            .quick-actions-grid {
                grid-template-columns: repeat(2, 1fr);
                gap: clamp(8px, 2vw, 12px);
            }
            
            .quick-mood-selector {
                gap: clamp(6px, 2vw, 10px);
            }
            
            .quick-mood-btn {
                min-width: clamp(35px, 8vw, 45px);
                min-height: clamp(35px, 8vw, 45px);
                font-size: clamp(16px, 4vw, 20px);
            }
            
            .dropdown-menu {
                right: 5px;
                min-width: 280px;
                max-width: calc(100vw - 10px);
                padding: 15px;
            }
            
            .bottom-navigation {
                padding: 6px 0 calc(env(safe-area-inset-bottom) + 6px);
            }
            
            .bottom-nav-btn {
                padding: 6px 8px;
                max-width: 70px;
            }
            
            .bottom-nav-btn .nav-icon {
                font-size: 18px;
                margin-bottom: 2px;
            }
            
            .bottom-nav-btn .nav-label {
                font-size: 10px;
            }
            
            .tab-navigation {
                padding: clamp(6px, 2vw, 10px) 0 clamp(10px, 3vw, 15px);
            }
            
            .tab-item {
                min-height: clamp(45px, 10vw, 60px);
            }
            
            .tab-icon {
                font-size: clamp(16px, 4vw, 20px);
            }
            
            .tab-label {
                font-size: clamp(9px, 2.5vw, 12px);
            }
        }

        @media (min-width: 481px) and (max-width: 768px) {
            .phone-container {
                border-radius: 0;
                box-shadow: none;
            }
            
            .settings-dropdown {
                width: clamp(200px, 40vw, 250px);
            }
            
            .quick-actions-grid {
                grid-template-columns: repeat(2, 1fr);
                gap: clamp(10px, 2vw, 15px);
            }
            
            .dashboard-section {
                padding: clamp(15px, 3vw, 20px);
                margin-bottom: clamp(15px, 3vw, 20px);
            }
        }

        @media (min-width: 769px) {
            .phone-container {
                border-radius: 0;
                box-shadow: none;
            }
            
            .quick-actions-grid {
                grid-template-columns: repeat(4, 1fr);
                gap: clamp(12px, 2vw, 18px);
            }
            
            .settings-dropdown {
                width: 250px;
                right: 0;
            }
            
            .dashboard-section {
                padding: clamp(18px, 3vw, 25px);
                margin-bottom: clamp(18px, 3vw, 25px);
            }
            
            .section-title {
                font-size: clamp(16px, 3vw, 20px);
            }
        }

        .welcome-text-label {
            font-size: 18px;
            font-weight: 700;
            color: #1B5E20;
            letter-spacing: 1px;
            margin-bottom: 12px;
        }

        .welcome-message h3 {
            font-size: 20px;
            color: #000;
            margin-bottom: 8px;
        }

        .welcome-message p {
            color: #666;
            line-height: 1.5;
        }

        .quick-actions {
            display: flex;
            flex-direction: column;
            gap: 16px;
        }

        .action-button {
            background: #C8E6C9;
            border: none;
            border-radius: 12px;
            padding: 16px;
            display: flex;
            align-items: center;
            gap: 12px;
            cursor: pointer;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
        }

        .action-button .action-text {
            color: #000;
            font-weight: 500;
            font-size: 16px;
        }

        .safety-section {
            background: #A5D6A7;
            border-radius: 12px;
            padding: 16px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .safety-text {
            font-size: 14px;
            color: #000;
            font-weight: 500;
        }

        /* Profile Screen Specific */
        .profile-header {
            text-align: center;
            margin-bottom: 30px;
        }

        .avatar {
            width: 80px;
            height: 80px;
            background: #4CAF50;
            border-radius: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 16px;
            color: white;
            font-size: 32px;
            font-weight: 700;
        }

        .profile-name {
            font-size: 24px;
            font-weight: 600;
            color: #000;
            margin-bottom: 4px;
        }

        .profile-email {
            color: #666;
            font-size: 16px;
        }

        /* Section Données Personnelles */
        .personal-data-section {
            background: var(--primary-color);
            border-radius: 20px;
            padding: 25px;
            margin: 20px 0;
            backdrop-filter: blur(10px);
            border: 1px solid var(--primary-dark);
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
            opacity: 0.9;
        }

        .personal-data-section .section-title {
            font-size: 20px;
            font-weight: 700;
            color: white;
            margin-bottom: 20px;
            text-align: center;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }

        /* Statistiques Rapides */
        .stats-overview {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(110px, 1fr));
            gap: 15px;
            margin-bottom: 25px;
        }

        .quick-stat {
            background: var(--primary-dark);
            border-radius: 15px;
            padding: 15px;
            text-align: center;
            transition: all 0.3s ease;
            border: 1px solid rgba(255,255,255,0.2);
        }

        .quick-stat:hover {
            background: rgba(0,0,0,0.2);
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0,0,0,0.25);
        }

        .stat-icon {
            font-size: 24px;
            margin-bottom: 8px;
        }

        .stat-value {
            font-size: 18px;
            font-weight: 700;
            color: white;
            margin-bottom: 4px;
        }

        .stat-name {
            font-size: 11px;
            color: white;
            font-weight: 600;
            opacity: 0.9;
        }

        /* Graphique d'Évolution de l'Humeur */
        .emotion-chart-container {
            background: var(--primary-dark);
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 20px;
            border: 1px solid rgba(255,255,255,0.2);
        }

        .chart-title {
            font-size: 16px;
            font-weight: 600;
            color: white;
            margin-bottom: 15px;
            text-align: center;
        }

        .mood-evolution-chart {
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .chart-days {
            display: flex;
            justify-content: space-around;
            align-items: end;
            width: 100%;
            height: 120px;
            margin-bottom: 15px;
            padding: 0 10px;
        }

        .day-column {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: end;
            height: 100%;
            flex: 1;
            max-width: 35px;
        }

        .mood-bar {
            width: 20px;
            border-radius: 10px 10px 0 0;
            transition: all 0.3s ease;
            cursor: pointer;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            margin-bottom: 8px;
        }

        .mood-bar:hover {
            transform: scale(1.1);
            box-shadow: 0 4px 12px rgba(0,0,0,0.2);
        }

        .day-label {
            font-size: 10px;
            color: white;
            font-weight: 600;
            opacity: 0.9;
        }

        .chart-legend {
            display: flex;
            justify-content: center;
            gap: 15px;
            flex-wrap: wrap;
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 5px;
            font-size: 12px;
            color: white;
            opacity: 0.9;
        }

        .legend-color {
            width: 12px;
            height: 12px;
            border-radius: 50%;
        }

        /* Diagnostic Émotionnel */
        .emotional-diagnosis {
            background: var(--primary-dark);
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 20px;
            border: 1px solid rgba(255,255,255,0.2);
        }

        .diagnosis-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
            gap: 15px;
        }

        .diagnosis-card {
            background: rgba(0,0,0,0.2);
            border-radius: 12px;
            padding: 15px;
            text-align: center;
            transition: all 0.3s ease;
            border: 1px solid rgba(255,255,255,0.2);
        }

        .diagnosis-card:hover {
            background: rgba(0,0,0,0.3);
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0,0,0,0.25);
        }

        .diagnosis-header {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            margin-bottom: 15px;
        }

        .diagnosis-icon {
            font-size: 16px;
        }

        .diagnosis-title {
            font-size: 12px;
            font-weight: 600;
            color: white;
        }

        .circular-progress {
            position: relative;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 10px auto;
        }

        .progress-text {
            position: absolute;
            font-size: 14px;
            font-weight: 700;
            color: white;
        }

        .diagnosis-insight {
            font-size: 10px;
            color: white;
            opacity: 0.9;
            margin-top: 8px;
            line-height: 1.3;
        }

        /* Recommandations */
        .recommendations-section {
            background: var(--primary-dark);
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 20px;
            border: 1px solid rgba(255,255,255,0.2);
        }

        .recommendations-list {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .recommendation-item {
            background: rgba(0,0,0,0.2);
            border-radius: 10px;
            padding: 12px;
            display: flex;
            align-items: center;
            gap: 12px;
            transition: all 0.3s ease;
            border: 1px solid rgba(255,255,255,0.2);
        }

        .recommendation-item:hover {
            background: rgba(0,0,0,0.3);
            box-shadow: 0 4px 12px rgba(0,0,0,0.2);
        }

        .rec-icon {
            font-size: 20px;
            flex-shrink: 0;
        }

        .rec-content {
            flex: 1;
        }

        .rec-title {
            font-size: 13px;
            font-weight: 600;
            color: white;
            margin-bottom: 3px;
        }

        .rec-description {
            font-size: 11px;
            color: white;
            opacity: 0.9;
            line-height: 1.3;
        }

        .rec-impact {
            font-size: 10px;
            color: white;
            font-weight: 600;
            background: var(--primary-color);
            padding: 3px 8px;
            border-radius: 10px;
            flex-shrink: 0;
        }

        /* Actions du Profil */
        .profile-actions {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
            gap: 10px;
            margin-top: 20px;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(clamp(90px, 20vw, 120px), 1fr));
            gap: clamp(12px, 3vw, 16px);
            margin-bottom: clamp(20px, 5vw, 30px);
        }

        .stat-card {
            background: white;
            border-radius: 16px;
            padding: 20px;
            text-align: center;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        .stat-text {
            font-size: 14px;
            font-weight: 700;
            color: #1B5E20;
            letter-spacing: 1px;
            margin-bottom: 8px;
        }

        .stat-number {
            font-size: 20px;
            font-weight: 700;
            color: #1B5E20;
            margin-bottom: 4px;
        }

        .stat-label {
            font-size: clamp(10px, 2.5vw, 12px);
            color: var(--text-muted);
        }

        /* Contrôles du profil */
        .profile-controls {
            display: flex;
            flex-direction: column;
            gap: clamp(8px, 2vw, 12px);
            margin-bottom: clamp(20px, 5vw, 30px);
        }

        .profile-btn {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: clamp(12px, 3vw, 16px);
            background: var(--background-medium);
            border: none;
            border-radius: clamp(12px, 3vw, 16px);
            cursor: pointer;
            transition: all 0.3s ease;
            color: var(--text-primary);
            font-weight: 600;
        }

        .profile-btn:hover {
            background: var(--background-dark);
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }

        .btn-icon {
            font-size: clamp(16px, 4vw, 20px);
        }

        .btn-text {
            font-size: clamp(12px, 3vw, 14px);
        }

        /* Graphique d'humeur */
        .mood-chart-section {
            background: white;
            border-radius: clamp(12px, 3vw, 16px);
            padding: clamp(16px, 4vw, 20px);
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        .mood-chart {
            height: clamp(120px, 25vw, 200px);
            background: var(--background-light);
            border-radius: clamp(8px, 2vw, 12px);
            overflow: hidden;
            position: relative;
        }

        .chart-placeholder {
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        /* Diagrammes Diagnostiques Avancés */
        .diagnostic-dashboard {
            background: linear-gradient(135deg, var(--background-light), var(--background-medium));
            border-radius: 15px;
            padding: 25px;
            margin: 20px 0;
            border: 2px solid var(--primary-light);
        }

        .diagnostic-title {
            text-align: center;
            font-size: 20px;
            font-weight: bold;
            color: var(--primary-color);
            margin-bottom: 20px;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin-bottom: 25px;
        }

        .stat-card {
            background: white;
            border-radius: 12px;
            padding: 20px;
            text-align: center;
            border: 2px solid var(--background-medium);
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .stat-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: var(--primary-color);
        }

        .stat-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.15);
            border-color: var(--primary-color);
        }

        .stat-number {
            font-size: 28px;
            font-weight: bold;
            color: var(--primary-color);
            margin-bottom: 8px;
        }

        .stat-label {
            font-size: 14px;
            color: var(--text-secondary);
            font-weight: 600;
        }

        .stat-trend {
            font-size: 12px;
            margin-top: 5px;
            padding: 3px 8px;
            border-radius: 12px;
            display: inline-block;
        }

        .trend-up {
            background: #E8F5E8;
            color: #2E7D32;
        }

        .trend-down {
            background: #FFEBEE;
            color: #C62828;
        }

        .trend-stable {
            background: #F3E5F5;
            color: #7B1FA2;
        }

        /* Graphiques circulaires pour diagnostics */
        .circular-progress {
            position: relative;
            width: 100px;
            height: 100px;
            margin: 0 auto 15px;
        }

        .circular-progress svg {
            width: 100%;
            height: 100%;
            transform: rotate(-90deg);
        }

        .circular-progress .bg-circle {
            fill: none;
            stroke: var(--background-medium);
            stroke-width: 8;
        }

        .circular-progress .progress-circle {
            fill: none;
            stroke: var(--primary-color);
            stroke-width: 8;
            stroke-linecap: round;
            transition: stroke-dasharray 1s ease;
        }

        .progress-percentage {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 16px;
            font-weight: bold;
            color: var(--primary-color);
        }

        /* Analyse comportementale */
        .behavior-analysis {
            background: white;
            border-radius: 12px;
            padding: 20px;
            margin: 15px 0;
            border-left: 5px solid var(--primary-color);
        }

        .analysis-title {
            font-size: 16px;
            font-weight: bold;
            color: var(--text-primary);
            margin-bottom: 10px;
        }

        .analysis-description {
            font-size: 14px;
            color: var(--text-secondary);
            line-height: 1.6;
            margin-bottom: 15px;
        }

        .recommendation-list {
            list-style: none;
            padding: 0;
        }

        .recommendation-list li {
            background: var(--background-light);
            padding: 10px 15px;
            border-radius: 8px;
            margin-bottom: 8px;
            border-left: 3px solid var(--primary-color);
            font-size: 13px;
            color: var(--text-secondary);
        }

        .recommendation-list li::before {
            content: '💡';
            margin-right: 10px;
        }

        /* Community Styles */
        .community-controls {
            margin-bottom: clamp(15px, 4vw, 20px);
        }

        .community-btn {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: clamp(10px, 2.5vw, 12px) clamp(16px, 4vw, 20px);
            background: var(--background-light);
            border: 2px solid var(--primary-color);
            border-radius: clamp(15px, 3vw, 20px);
            cursor: pointer;
            transition: all 0.3s ease;
            color: var(--text-primary);
            font-weight: 600;
            width: 100%;
            justify-content: center;
        }

        .community-btn:hover {
            background: var(--primary-color);
            color: var(--text-on-primary);
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        }

        .community-btn.active {
            background: var(--primary-color);
            color: var(--text-on-primary);
        }

        .community-sections {
            display: flex;
            flex-direction: column;
            gap: clamp(20px, 5vw, 25px);
        }

        .community-section {
            background: white;
            border-radius: clamp(12px, 3vw, 16px);
            padding: clamp(16px, 4vw, 20px);
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        .discussion-list {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .discussion-item {
            background: var(--background-light);
            padding: clamp(12px, 3vw, 15px);
            border-radius: clamp(8px, 2vw, 12px);
            border-left: 4px solid var(--primary-color);
        }

        .discussion-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 8px;
        }

        .discussion-author {
            font-weight: 600;
            color: var(--text-primary);
            font-size: clamp(12px, 3vw, 14px);
        }

        .discussion-time {
            font-size: clamp(10px, 2.5vw, 12px);
            color: var(--text-muted);
        }

        .discussion-content {
            color: var(--text-secondary);
            font-size: clamp(12px, 3vw, 14px);
            line-height: 1.4;
            margin-bottom: 8px;
        }

        .discussion-actions {
            display: flex;
            gap: 15px;
            font-size: clamp(10px, 2.5vw, 12px);
        }

        .discussion-action {
            color: var(--text-muted);
            cursor: pointer;
            transition: color 0.2s ease;
        }

        .discussion-action:hover {
            color: var(--primary-color);
        }

        .share-mood-section {
            display: flex;
            flex-direction: column;
        }

        .support-tips {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .tip-card {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: clamp(10px, 2.5vw, 12px);
            background: var(--background-light);
            border-radius: clamp(8px, 2vw, 10px);
        }

        .tip-icon {
            font-size: clamp(16px, 4vw, 18px);
        }

        .tip-text {
            font-size: clamp(12px, 3vw, 14px);
            color: var(--text-secondary);
        }

        /* Menu modal styles - Navigation 3 clics */
        .menu-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
            gap: clamp(12px, 3vw, 16px);
            margin-bottom: 20px;
        }

        .menu-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: clamp(16px, 4vw, 20px);
            background: var(--background-light);
            border: 2px solid transparent;
            border-radius: clamp(12px, 3vw, 16px);
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
            position: relative;
        }

        .menu-item:hover {
            background: var(--background-medium);
            border-color: var(--primary-color);
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }

        .quick-access-badge {
            position: absolute;
            top: -5px;
            right: -5px;
            background: var(--primary-color);
            color: white;
            border-radius: 50%;
            width: 20px;
            height: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 10px;
            font-weight: bold;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }

        .menu-icon {
            font-size: clamp(24px, 6vw, 28px);
            margin-bottom: clamp(8px, 2vw, 10px);
        }

        .menu-text {
            font-size: clamp(12px, 3vw, 14px);
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: clamp(4px, 1vw, 6px);
        }

        .menu-desc {
            font-size: clamp(10px, 2.5vw, 12px);
            color: var(--text-muted);
            line-height: 1.2;
        }

        /* Tab Navigation */
        .tab-navigation {
            display: flex;
            background: white;
            border-top: 1px solid #E0E0E0;
            padding: clamp(8px, 2vw, 12px) 0 clamp(15px, 3vw, 20px);
            position: relative;
            z-index: 10;
            flex-shrink: 0;
            min-height: clamp(60px, 12vw, 80px);
        }

        .tab-item {
            flex: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: clamp(6px, 1.5vw, 8px);
            border: none;
            background: none;
            cursor: pointer;
            transition: all 0.2s ease;
            min-height: clamp(50px, 12vw, 60px);
        }

        .tab-icon {
            font-size: clamp(12px, 3vw, 16px);
            margin-bottom: clamp(2px, 0.5vw, 4px);
            color: #666;
            transition: color 0.2s ease;
        }

        .tab-label {
            font-size: clamp(9px, 2.2vw, 12px);
            color: #666;
            transition: color 0.2s ease;
            text-align: center;
            line-height: 1.2;
        }

        .tab-item.active .tab-icon,
        .tab-item.active .tab-label {
            color: #4CAF50;
        }

        /* Ultra responsive design */
        @media (max-width: 360px) {
            .mood-grid {
                grid-template-columns: repeat(2, 1fr);
                gap: 8px;
            }
            
            .settings-dropdown {
                right: 10px;
                width: 200px;
                max-width: calc(100vw - 20px);
            }
            
            .theme-indicator {
                font-size: 9px;
                padding: 4px 8px;
            }
        }

        @media (min-width: 361px) and (max-width: 480px) {
            .settings-dropdown {
                right: 15px;
                width: 220px;
                max-width: calc(100vw - 30px);
            }
            

            
            .mood-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        @media (min-width: 481px) and (max-width: 768px) {
            .phone-container {
                width: 85vw;
                height: 90vh;
                max-width: 500px;
                max-height: 800px;
            }
            
            .nav-controls { gap: 8px; }
            
            .mood-grid {
                grid-template-columns: repeat(3, 1fr);
            }
        }

        @media (min-width: 769px) and (max-width: 1024px) {
            .phone-container {
                width: min(450px, 50vw);
                height: min(800px, 85vh);
            }
            
            .nav-controls { gap: 10px; }
            
            .nav-btn:hover {
                transform: translateY(-3px);
                box-shadow: 0 4px 12px var(--primary-color);
            }
        }

        @media (min-width: 1025px) {
            .phone-container {
                width: min(375px, 35vw);
                height: min(812px, 80vh);
                position: relative;
            }
            
            .nav-controls {
                position: absolute;
                bottom: clamp(15px, 2vh, 20px);
                left: 50%;
                transform: translateX(-50%);
                width: fit-content;
                max-width: calc(100% - 30px);
            }
            
            .nav-btn:hover {
                transform: translateY(-2px) scale(1.05);
                box-shadow: 0 4px 15px rgba(0,0,0,0.3);
            }
            
            .mood-item:hover {
                transform: translateY(-3px) scale(1.02);
            }
        }

        /* High DPI displays */
        @media (-webkit-min-device-pixel-ratio: 2), (min-resolution: 192dpi) {
            .logo {
                image-rendering: -webkit-optimize-contrast;
                image-rendering: crisp-edges;
            }
        }

        /* Landscape orientation */
        @media (orientation: landscape) and (max-height: 500px) {
            .phone-container {
                height: 95vh;
                width: 60vw;
                max-width: 600px;
            }
            
            .welcome-header {
                flex: 0.8;
                padding: 20px;
            }
            
            .app-header {
                padding: 40px 20px 20px;
            }
            
            .nav-controls {
                bottom: 5px;
            }
        }

        /* Accessibility improvements */
        @media (prefers-reduced-motion: reduce) {
            *, *::before, *::after {
                animation-duration: 0.01ms !important;
                animation-iteration-count: 1 !important;
                transition-duration: 0.01ms !important;
            }
        }

        @media (forced-colors: active) {
            .mood-item {
                border: 2px solid ButtonText;
            }
            
            .mood-item.selected {
                background: Highlight;
                color: HighlightText;
            }
        }

        /* Animations */
        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateX(-50%) translateY(-20px);
            }
            to {
                opacity: 1;
                transform: translateX(-50%) translateY(0);
            }
        }

        @keyframes slideOut {
            from {
                opacity: 1;
                transform: translateX(-50%) translateY(0);
            }
            to {
                opacity: 0;
                transform: translateX(-50%) translateY(-20px);
            }
        }

        @keyframes modalSlideIn {
            from {
                opacity: 0;
                transform: scale(0.8) translateY(-20px);
            }
            to {
                opacity: 1;
                transform: scale(1) translateY(0);
            }
        }

        @keyframes modalSlideOut {
            from {
                opacity: 1;
                transform: scale(1) translateY(0);
            }
            to {
                opacity: 0;
                transform: scale(0.8) translateY(-20px);
            }
        }

        @keyframes slideInRight {
            from {
                opacity: 0;
                transform: translateX(100%);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        @keyframes slideOutRight {
            from {
                opacity: 1;
                transform: translateX(0);
            }
            to {
                opacity: 0;
                transform: translateX(100%);
            }
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        /* Theme indicator */
        .theme-indicator {
            position: absolute;
            top: clamp(8px, 2vw, 12px);
            right: clamp(8px, 2vw, 12px);
            background: rgba(0, 0, 0, 0.7);
            color: white;
            padding: clamp(4px, 1vw, 6px) clamp(8px, 2vw, 12px);
            border-radius: clamp(10px, 2.5vw, 15px);
            font-size: clamp(8px, 2vw, 11px);
            font-weight: 600;
            z-index: 999;
            backdrop-filter: blur(10px);
        }

        /* Navigation en bas de page */
        .bottom-navigation {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: var(--background-dark);
            display: flex;
            justify-content: space-around;
            align-items: center;
            padding: 8px 0 calc(env(safe-area-inset-bottom) + 8px);
            border-top: 1px solid var(--primary-color-alpha);
            backdrop-filter: blur(20px);
            z-index: 1000;
            box-shadow: 0 -2px 20px rgba(0,0,0,0.1);
        }

        .bottom-nav-btn {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            background: none;
            border: none;
            color: var(--text-secondary);
            cursor: pointer;
            padding: 8px 12px;
            border-radius: 12px;
            transition: all 0.3s ease;
            flex: 1;
            max-width: 80px;
        }

        .bottom-nav-btn.active {
            color: var(--primary-color);
            background: var(--primary-color-alpha);
        }

        .bottom-nav-btn:hover:not(.active) {
            color: var(--text-primary);
            background: var(--background-light);
        }

        .bottom-nav-btn .nav-icon {
            font-size: 20px;
            margin-bottom: 4px;
            transition: all 0.3s ease;
        }

        .bottom-nav-btn.active .nav-icon {
            transform: scale(1.1);
        }

        .bottom-nav-btn .nav-label {
            font-size: 11px;
            font-weight: 600;
            text-align: center;
        }

        /* Ajuster le padding du contenu pour la navigation */
        .main-app {
            padding-bottom: 80px;
        }

        /* Sélecteur de personnalité pour MINA */
        .personality-selector {
            margin-top: 20px;
            padding: 20px;
            background: var(--background-light);
            border-radius: 15px;
            border: 1px solid var(--primary-color-alpha);
        }

        .personality-options {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 12px;
        }

        .personality-btn {
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 15px 10px;
            background: var(--background-medium);
            border: 2px solid transparent;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
        }

        .personality-btn:hover {
            border-color: var(--primary-color);
            background: var(--primary-color-alpha);
            transform: translateY(-2px);
        }

        .personality-btn.active {
            border-color: var(--primary-color);
            background: var(--primary-color);
            color: var(--text-on-primary);
        }

        .personality-icon {
            font-size: 24px;
            margin-bottom: 8px;
        }

        .personality-name {
            font-weight: 600;
            font-size: 14px;
            margin-bottom: 4px;
        }

        .personality-desc {
            font-size: 11px;
            opacity: 0.8;
            line-height: 1.3;
        }

        /* Photo de profil */
        .profile-photo-section {
            margin-bottom: 25px;
            padding: 20px;
            background: var(--background-light);
            border-radius: 15px;
            text-align: center;
        }

        .profile-photo-container {
            position: relative;
            display: inline-block;
            margin-bottom: 15px;
        }

        .profile-photo {
            width: 120px;
            height: 120px;
            border-radius: 50%;
            object-fit: cover;
            border: 4px solid var(--primary-color);
            background: var(--background-medium);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 48px;
            color: var(--text-secondary);
        }

        .photo-upload-btn {
            position: absolute;
            bottom: 0;
            right: 0;
            width: 36px;
            height: 36px;
            background: var(--primary-color);
            border: 3px solid white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            font-size: 16px;
            color: white;
            transition: all 0.3s ease;
        }

        .photo-upload-btn:hover {
            transform: scale(1.1);
            background: var(--primary-dark);
        }

        .photo-upload-input {
            display: none;
        }

        .anonymous-toggle {
            margin-top: 15px;
            padding: 12px 20px;
            background: var(--background-medium);
            border: 2px solid var(--primary-color);
            border-radius: 25px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            gap: 10px;
        }

        .anonymous-toggle:hover {
            background: var(--primary-color-alpha);
        }

        .anonymous-toggle.active {
            background: var(--primary-color);
            color: var(--text-on-primary);
        }

        /* Mood feedback styling */
        .mood-feedback {
            font-family: inherit;
        }

        /* All interactive elements with theme colors */
        .nav-btn,
        .auth-btn,
        .submit-btn,
        .action-button,
        .onboarding-btn {
            background: var(--primary-color);
            transition: all 0.3s ease;
        }

        .nav-btn:hover,
        .auth-btn:hover,
        .submit-btn:hover,
        .action-button:hover,
        .onboarding-btn:hover {
            background: var(--primary-dark);
            transform: translateY(-2px);
        }

        .action-card:hover {
            border-left: 4px solid var(--primary-color);
        }

        .tab-item.active .tab-icon,
        .tab-item.active .tab-label {
            color: var(--primary-color);
        }

        @media (prefers-color-scheme: dark) {
            body {
                background: linear-gradient(135deg, var(--text-primary) 0%, var(--text-secondary) 100%);
            }
            
            .screen {
                background: #263238;
            }
            
            .welcome-screen,
            .app-content {
                background: #263238;
                color: #E8F5E8;
            }
            
            .mood-question h2,
            .action-title,
            .mood-text {
                color: #E8F5E8;
            }
            
            .mood-question .subtitle,
            .action-subtitle,
            .mood-label {
                color: var(--background-dark);
            }
        }
    </style>
</head>
<body>
    <!-- En-tête global fixe -->
    <div class="global-header">
        <div class="header-content">
            <div class="header-text">
                <h1 class="app-title">MINDLY</h1>
                <p class="date-text" id="globalSubtitle">Bienvenue !</p>
            </div>
            <button class="menu-trigger" onclick="toggleDropdownMenu()">
                <span class="menu-icon">☰</span>
            </button>
        </div>
    </div>

    <!-- Navigation en bas de page -->
    <div class="bottom-navigation">
        <button class="bottom-nav-btn active" onclick="showScreen('home-screen', this)" data-screen="home-screen">
            <span class="nav-icon">🏠</span>
            <span class="nav-label">Accueil</span>
        </button>
        <button class="bottom-nav-btn" onclick="showScreen('mood-screen', this)" data-screen="mood-screen">
            <span class="nav-icon">💭</span>
            <span class="nav-label">Humeur</span>
        </button>
        <button class="bottom-nav-btn" onclick="showScreen('chat-screen', this)" data-screen="chat-screen">
            <span class="nav-icon">🤖</span>
            <span class="nav-label">IA</span>
        </button>
        <button class="bottom-nav-btn" onclick="showScreen('profile-screen', this)" data-screen="profile-screen">
            <span class="nav-icon">👤</span>
            <span class="nav-label">Profil</span>
        </button>
    </div>

    <div class="phone-container">
        <!-- Menu déroulant -->
        <div class="dropdown-menu" id="dropdown-menu">
            <div class="dropdown-header">
                <div class="dropdown-title">☰ Menu Principal</div>
                <div class="dropdown-close" onclick="closeDropdownMenu()">×</div>
            </div>
            
            <div class="dropdown-body">
                <!-- Accès Rapides -->
                <div class="menu-section">
                    <div class="menu-section-title">✨ Accès Rapides</div>
                    <div class="menu-items-grid">
                        <div class="dropdown-item" onclick="showScreen('home-screen'); closeDropdownMenu();">
                            <span class="dropdown-icon">🏠</span>
                            <span class="dropdown-text">Accueil</span>
                        </div>
                        <div class="dropdown-item" onclick="showScreen('mood-screen'); closeDropdownMenu();">
                            <span class="dropdown-icon">😊</span>
                            <span class="dropdown-text">Humeur</span>
                        </div>
                        <div class="dropdown-item" onclick="showScreen('chat-screen'); closeDropdownMenu();">
                            <span class="dropdown-icon">🤖</span>
                            <span class="dropdown-text">Assistant MINA</span>
                        </div>
                        <div class="dropdown-item" onclick="showScreen('profile-screen'); closeDropdownMenu();">
                            <span class="dropdown-icon">👤</span>
                            <span class="dropdown-text">Mon Profil</span>
                        </div>
                    </div>
                </div>

                <!-- Personnalisation & Réglages -->
                <div class="menu-section">
                    <div class="menu-section-title">🎨 Personnalisation & Réglages</div>
                    <div class="menu-items-grid">
                        <div class="dropdown-item" onclick="showPersonalizationModal(); closeDropdownMenu();">
                            <span class="dropdown-icon">🎨</span>
                            <span class="dropdown-text">Thèmes & Couleurs</span>
                        </div>
                        <div class="dropdown-item" onclick="showNotificationSettings(); closeDropdownMenu();">
                            <span class="dropdown-icon">🔔</span>
                            <span class="dropdown-text">Notifications</span>
                            <span class="status-indicator active">ON</span>
                        </div>
                        <div class="dropdown-item" onclick="showLanguageSettings(); closeDropdownMenu();">
                            <span class="dropdown-icon">🌐</span>
                            <span class="dropdown-text">Langue & Région</span>
                        </div>
                        <div class="dropdown-item" onclick="showAccessibilitySettings(); closeDropdownMenu();">
                            <span class="dropdown-icon">♿</span>
                            <span class="dropdown-text">Accessibilité</span>
                        </div>
                        <div class="dropdown-item" onclick="showBackupSettings(); closeDropdownMenu();">
                            <span class="dropdown-icon">☁️</span>
                            <span class="dropdown-text">Sauvegarde & Sync</span>
                        </div>
                    </div>
                </div>

                <!-- Section Sécurité & Confidentialité -->
                <div class="menu-section">
                    <div class="menu-section-title">🔒 Sécurité & Confidentialité</div>
                    <div class="menu-items-grid">
                        <div class="dropdown-item" onclick="toggleAnonymousMode(); closeDropdownMenu();">
                            <span class="dropdown-icon">🕶️</span>
                            <span class="dropdown-text">Mode Anonyme</span>
                            <div class="status-indicator" id="anonymousStatus">OFF</div>
                        </div>
                        <div class="dropdown-item" onclick="showPrivacySettings(); closeDropdownMenu();">
                            <span class="dropdown-icon">🔐</span>
                            <span class="dropdown-text">Confidentialité</span>
                        </div>
                        <div class="dropdown-item" onclick="showDataManagement(); closeDropdownMenu();">
                            <span class="dropdown-icon">📊</span>
                            <span class="dropdown-text">Mes Données</span>
                        </div>
                        <div class="dropdown-item" onclick="showSecuritySettings(); closeDropdownMenu();">
                            <span class="dropdown-icon">🛡️</span>
                            <span class="dropdown-text">Paramètres Sécurité</span>
                        </div>
                    </div>
                </div>

                <!-- Section Aide & Support -->
                <div class="menu-section">
                    <div class="menu-section-title">❓ Aide & Support</div>
                    <div class="menu-items-grid">
                        <div class="dropdown-item" onclick="showScreen('faq-screen'); closeDropdownMenu();">
                            <span class="dropdown-icon">❓</span>
                            <span class="dropdown-text">FAQ</span>
                        </div>
                        <div class="dropdown-item" onclick="showContactSupport(); closeDropdownMenu();">
                            <span class="dropdown-icon">📧</span>
                            <span class="dropdown-text">Nous contacter</span>
                        </div>
                        <div class="dropdown-item" onclick="showTermsOfService(); closeDropdownMenu();">
                            <span class="dropdown-icon">⚖️</span>
                            <span class="dropdown-text">Conditions</span>
                        </div>
                        <div class="dropdown-item" onclick="showAbout(); closeDropdownMenu();">
                            <span class="dropdown-icon">�</span>
                            <span class="dropdown-text">À propos</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Conteneur principal pour le contenu -->
                            <div class="color-option" style="background: #FF9800;" onclick="setCustomColor('#FF9800')" title="Orange Énergique"></div>
                            <div class="color-option" style="background: #607D8B;" onclick="setCustomColor('#607D8B')" title="Gris Élégant"></div>
                            <div class="color-option" style="background: #795548;" onclick="setCustomColor('#795548')" title="Marron Terre"></div>
                        </div>
                        <input type="color" class="custom-color-input" onchange="setCustomColor(this.value)" value="#4CAF50" title="Choisir une couleur unique">
                    </div>

                    <!-- Réinitialisation -->
                    <div class="reset-section">
                        <button class="reset-btn" onclick="resetToDefault()">
                            <span>🔄</span> Réinitialiser par défaut
                        </button>
                    </div>
                </div>

                <!-- Paramètres du compte -->
                <div class="menu-section">
                    <div class="menu-section-title">✨ Accès Rapide</div>
                    <div class="menu-items-grid">
                        <div class="dropdown-item" onclick="showScreen('home-screen'); closeDropdownMenu();">
                            <span class="dropdown-icon">�</span>
                            <span class="dropdown-text">Accueil</span>
                        </div>
                        <div class="dropdown-item" onclick="showScreen('mood-screen'); closeDropdownMenu();">
                            <span class="dropdown-icon">😊</span>
                            <span class="dropdown-text">Humeur</span>
                        </div>
                        <div class="dropdown-item" onclick="showScreen('chat-screen'); closeDropdownMenu();">
                            <span class="dropdown-icon">🤖</span>
                            <span class="dropdown-text">Assistant MINA</span>
                        </div>
                        <div class="dropdown-item" onclick="showScreen('profile-screen'); closeDropdownMenu();">
                            <span class="dropdown-icon">👤</span>
                            <span class="dropdown-text">Mon Profil</span>
                        </div>
                    </div>


                </div>

                <!-- Gestion du Compte -->
                <div class="menu-section">
                    <div class="menu-section-title">� Confidentialité</div>
                    <div class="menu-items-grid">
                        <div class="dropdown-item" onclick="aiModeration.toggleAnonymousMode(); closeDropdownMenu();">
                            <span class="dropdown-icon">�️</span>
                            <span class="dropdown-text">Mode Anonyme</span>
                        </div>
                        <div class="dropdown-item" onclick="showModerationLogs(); closeDropdownMenu();">
                            <span class="dropdown-icon">�️</span>
                            <span class="dropdown-text">Sécurité</span>
                        </div>
                        <div class="dropdown-item" onclick="showPrivacyPolicy(); closeDropdownMenu();">
                            <span class="dropdown-icon">�</span>
                            <span class="dropdown-text">Confidentialité</span>
                        </div>
                        <div class="dropdown-item" onclick="exportUserData(); closeDropdownMenu();">
                            <span class="dropdown-icon">📥</span>
                            <span class="dropdown-text">Mes Données</span>
                        </div>
                        <div class="dropdown-item" onclick="showPersonalizationModal(); closeDropdownMenu();">
                            <span class="dropdown-icon">🎨</span>
                            <span class="dropdown-text">Choix de Couleurs</span>
                        </div>
                    </div>
                </div>


                <div class="menu-section">
                    <div class="menu-section-title">❓ Aide & Support</div>
                    <div class="menu-items-grid">
                        <div class="dropdown-item" onclick="showScreen('faq-screen'); closeDropdownMenu();">
                            <span class="dropdown-icon">❓</span>
                            <span class="dropdown-text">FAQ</span>
                        </div>
                        <div class="dropdown-item" onclick="showContactSupport(); closeDropdownMenu();">
                            <span class="dropdown-icon">�</span>
                            <span class="dropdown-text">Nous contacter</span>
                        </div>
                        <div class="dropdown-item" onclick="showTermsOfService(); closeDropdownMenu();">
                            <span class="dropdown-icon">⚖️</span>
                            <span class="dropdown-text">Conditions</span>
                        </div>
                        <div class="dropdown-item" onclick="showAbout(); closeDropdownMenu();">
                            <span class="dropdown-icon">🏢</span>
                            <span class="dropdown-text">À propos</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Conteneur principal pour le contenu -->
        <div class="main-content">
        <div class="screen">
            <!-- Welcome Screen -->
            <div class="screen-content" id="welcome-screen">
                <div class="welcome-screen">
                    <div class="welcome-header">
                        <div class="logo">
                            <span class="logo-text">M</span>
                        </div>
                        <h1 class="welcome-title">MINDLY</h1>
                        <p class="welcome-subtitle">Votre compagnon de bien-être mental</p>
                    </div>
                    
                    <div class="onboarding-section">
                        <button class="onboarding-btn">
                            <span class="onboarding-text">DÉCOUVRIR L'APPLICATION</span>
                        </button>
                    </div>
                    
                    <div class="auth-buttons">
                        <button class="auth-btn signup-btn">S'inscrire</button>
                        <button class="auth-btn login-btn">Se connecter</button>
                        <button class="auth-btn guest-btn">Continuer en tant qu'invité</button>
                    </div>
                </div>
            </div>

            <!-- Login Screen -->
            <div class="screen-content" id="login-screen">
                <div class="auth-screen">
                    <div class="auth-header">
                        <h1 class="auth-title">Connexion</h1>
                        <p class="auth-subtitle">Connectez-vous à votre compte</p>
                    </div>
                    
                    <form>
                        <div class="form-group">
                            <label class="form-label">Email</label>
                            <input type="email" class="form-input" placeholder="votre@email.com">
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">Mot de passe</label>
                            <input type="password" class="form-input" placeholder="Votre mot de passe">
                        </div>
                        
                        <button type="submit" class="submit-btn">Se connecter</button>
                    </form>
                    
                    <div class="auth-link">
                        <p>Pas encore de compte ? <a href="#">S'inscrire</a></p>
                    </div>
                </div>
            </div>

            <!-- Signup Screen -->
            <div class="screen-content" id="signup-screen">
                <div class="auth-screen">
                    <div class="auth-header">
                        <h1 class="auth-title">Inscription</h1>
                        <p class="auth-subtitle">Créez votre compte</p>
                    </div>
                    
                    <form>
                        <div class="form-group">
                            <label class="form-label">Prénom</label>
                            <input type="text" class="form-input" placeholder="Votre prénom">
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">Email</label>
                            <input type="email" class="form-input" placeholder="votre@email.com">
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">Mot de passe</label>
                            <input type="password" class="form-input" placeholder="Minimum 6 caractères">
                        </div>
                        
                        <button type="submit" class="submit-btn">S'inscrire</button>
                    </form>
                    
                    <div class="auth-link">
                        <p>Déjà un compte ? <a href="#">Se connecter</a></p>
                    </div>
                </div>
            </div>

            <!-- Onboarding Screen -->
            <div class="screen-content" id="onboarding-screen">
                <div class="onboarding-screen">
                    <div class="onboarding-content">
                        <div class="onboarding-icon" id="onboarding-icon">MENTAL</div>
                        <h2 class="onboarding-title" id="onboarding-title">Bienvenue dans MINDLY</h2>
                        <p class="onboarding-description" id="onboarding-description">
                            Découvrez une approche moderne du bien-être mental avec des outils personnalisés.
                        </p>
                    </div>
                    
                    <div class="onboarding-navigation">
                        <button class="nav-step-btn prev-btn">Précédent</button>
                        <div class="nav-dots">
                            <div class="dot active"></div>
                            <div class="dot"></div>
                            <div class="dot"></div>
                            <div class="dot"></div>
                        </div>
                        <button class="nav-step-btn next-btn">Suivant</button>
                    </div>
                </div>
            </div>

            <!-- Home Screen - Tableau de bord unifié -->
            <div class="screen-content active" id="home-screen">
                <div class="dashboard-content">
                        
                        <!-- Section Humeur Rapide -->
                        <div class="dashboard-section">
                            <h3 class="section-title">💭 Comment te sens-tu ?</h3>
                            <div class="quick-mood-selector">
                                <button class="quick-mood-btn" data-mood="epanoui" onclick="setQuickMood('epanoui')">😊</button>
                                <button class="quick-mood-btn" data-mood="serein" onclick="setQuickMood('serein')">😌</button>
                                <button class="quick-mood-btn" data-mood="neutre" onclick="setQuickMood('neutre')">😐</button>
                                <button class="quick-mood-btn" data-mood="fatigue" onclick="setQuickMood('fatigue')">😴</button>
                                <button class="quick-mood-btn" data-mood="anxieux" onclick="setQuickMood('anxieux')">😰</button>
                                <button class="quick-mood-btn" data-mood="energique" onclick="setQuickMood('energique')">🤩</button>
                            </div>
                        </div>

                        <!-- Section Chat MINA -->
                        <div class="dashboard-section">
                            <h3 class="section-title">� Chat avec MINA</h3>
                            <div class="mina-chat-preview">
                                <div class="mina-avatar">
                                    <div class="avatar-img">💚</div>
                                    <div class="online-status"></div>
                                </div>
                                <div class="mina-info">
                                    <div class="mina-name">MINA • En ligne</div>
                                    <div class="mina-status">Ton amie virtuelle t'attend...</div>
                                </div>
                                <button class="chat-now-btn" onclick="openQuickChat()">Parler</button>
                            </div>
                        </div>

                        <!-- Section Actions Rapides -->
                        <div class="dashboard-section">
                            <h3 class="section-title">⚡ Actions Rapides</h3>
                            <div class="quick-actions-grid">
                                <button class="quick-action-btn meditation" onclick="startQuickMeditation()">
                                    <div class="action-icon">🧘‍♀️</div>
                                    <div class="action-name">Méditation</div>
                                    <div class="action-duration">5 min</div>
                                </button>
                                
                                <button class="quick-action-btn breathing" onclick="startBreathingExercise()">
                                    <div class="action-icon">🌬️</div>
                                    <div class="action-name">Respiration</div>
                                    <div class="action-duration">2 min</div>
                                </button>
                                
                                <button class="quick-action-btn journal" onclick="openQuickJournal()">
                                    <div class="action-icon">�</div>
                                    <div class="action-name">Journal</div>
                                    <div class="action-duration">Écrire</div>
                                </button>
                                
                                <button class="quick-action-btn goals" onclick="showQuickGoals()">
                                    <div class="action-icon">🎯</div>
                                    <div class="action-name">Objectifs</div>
                                    <div class="action-duration">Suivre</div>
                                </button>
                            </div>
                        </div>

                        <!-- Section Communauté -->
                        <div class="dashboard-section">
                            <h3 class="section-title">👥 Communauté</h3>
                            <div class="community-preview">
                                <div class="community-stats">
                                    <div class="stat-item">
                                        <div class="stat-number">127</div>
                                        <div class="stat-label">Membres actifs</div>
                                    </div>
                                    <div class="stat-item">
                                        <div class="stat-number">23</div>
                                        <div class="stat-label">Messages aujourd'hui</div>
                                    </div>
                                </div>
                                <div class="community-actions">
                                    <button class="community-btn share" onclick="shareFeeling()">Partager</button>
                                    <button class="community-btn explore" onclick="exploreCommunity()">Explorer</button>
                                </div>
                            </div>
                        </div>

                        <!-- Section Statistiques -->
                        <div class="dashboard-section">
                            <h3 class="section-title">📊 Tes Progrès</h3>
                            <div class="stats-preview">
                                <div class="progress-ring">
                                    <div class="ring-content">
                                        <div class="progress-number">7</div>
                                        <div class="progress-label">jours</div>
                                    </div>
                                </div>
                                <div class="stats-details">
                                    <div class="stat-detail">
                                        <span class="stat-icon">🧘‍♀️</span>
                                        <span class="stat-text">12 méditations</span>
                                    </div>
                                    <div class="stat-detail">
                                        <span class="stat-icon">📝</span>
                                        <span class="stat-text">5 entrées journal</span>
                                    </div>
                                    <div class="stat-detail">
                                        <span class="stat-icon">💬</span>
                                        <span class="stat-text">18 conversations</span>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Section Citations/Inspiration -->
                        <div class="dashboard-section">
                            <h3 class="section-title">✨ Inspiration</h3>
                            <div class="daily-quote">
                                <div class="quote-text">"La sérénité n'est pas l'absence de tempête, mais la paix au milieu de la tourmente."</div>
                                <div class="quote-author">— Proverbe zen</div>
                                <button class="new-quote-btn" onclick="getNewQuote()">Nouvelle citation</button>
                            </div>
                        </div>

                </div>
            </div>

            <!-- Mood Screen -->
            <div class="screen-content" id="mood-screen">
                    <div class="app-content">
                        <div class="mood-question">
                            <h2>Comment vous sentez-vous aujourd'hui ?</h2>
                            <p class="subtitle">Sélectionnez votre humeur actuelle</p>
                        </div>
                        
                        <div class="mood-selection">
                            <button class="mood-button">
                                <div class="mood-text">JOYEUX</div>
                                <div class="mood-label">Très bien</div>
                            </button>
                            <button class="mood-button">
                                <div class="mood-text">SEREIN</div>
                                <div class="mood-label">Bien</div>
                            </button>
                            <button class="mood-button">
                                <div class="mood-text">NEUTRE</div>
                                <div class="mood-label">Correct</div>
                            </button>
                            <button class="mood-button">
                                <div class="mood-text">TRISTE</div>
                                <div class="mood-label">Pas bien</div>
                            </button>
                            <button class="mood-button">
                                <div class="mood-text">ANXIEUX</div>
                                <div class="mood-label">Anxieux</div>
                            </button>
                            <button class="mood-button">
                                <div class="mood-text">FATIGUÉ</div>
                                <div class="mood-label">Épuisé</div>
                            </button>
                        </div>
                        
                        <div class="insights-section">
                            <h3 class="insights-title">Insights de la semaine</h3>
                            <p class="insight-text">
                                Vous avez ressenti plus de sérénité cette semaine. Continuez vos exercices de méditation !
                            </p>
                        </div>
                    </div>
                    

                </div>
            </div>

            <!-- Chat Screen -->
            <div class="screen-content" id="chat-screen">
                        <div class="chat-container">
                            <div class="welcome-message" id="chat-welcome">
                                <div class="welcome-text-label">BIENVENUE</div>
                                <h3>Bonjour ! Je suis MINA 💚</h3>
                                <p>Je suis là pour t'écouter et t'accompagner. Comment te sens-tu aujourd'hui ?</p>
                                
                                <!-- Sélecteur de personnalité -->
                                <div class="personality-selector">
                                    <h4 style="color: var(--text-primary); margin-bottom: 15px;">🎭 Choisis comment tu veux me parler :</h4>
                                    <div class="personality-options">
                                        <button class="personality-btn active" onclick="setPersonality('confident')" data-personality="confident">
                                            <span class="personality-icon">🤗</span>
                                            <span class="personality-name">Confident</span>
                                            <span class="personality-desc">Écoute et soutien</span>
                                        </button>
                                        <button class="personality-btn" onclick="setPersonality('friend')" data-personality="friend">
                                            <span class="personality-icon">👫</span>
                                            <span class="personality-name">Ami(e)</span>
                                            <span class="personality-desc">Décontracté et complice</span>
                                        </button>
                                        <button class="personality-btn" onclick="setPersonality('teacher')" data-personality="teacher">
                                            <span class="personality-icon">👩‍🏫</span>
                                            <span class="personality-name">Professeur</span>
                                            <span class="personality-desc">Pédagogue et guide</span>
                                        </button>
                                        <button class="personality-btn" onclick="setPersonality('coach')" data-personality="coach">
                                            <span class="personality-icon">🏆</span>
                                            <span class="personality-name">Coach</span>
                                            <span class="personality-desc">Motivant et objectif</span>
                                        </button>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Zone de conversation -->
                            <div class="conversation-area" id="conversation-area" style="display: none;">
                                <div class="messages-container" id="messages-container">
                                    <!-- Les messages apparaîtront ici -->
                                </div>
                                
                                <div class="chat-input-area">
                                    <div class="typing-indicator" id="typing-indicator" style="display: none;">
                                        <div class="typing-dots">
                                            <span></span><span></span><span></span>
                                        </div>
                                        <span>MINA écrit...</span>
                                    </div>
                                    
                                    <div class="input-container">
                                        <textarea 
                                            id="chat-input" 
                                            placeholder="Écris-moi ce que tu ressens..." 
                                            rows="2"
                                            maxlength="500"
                                        ></textarea>
                                        <button id="send-button" onclick="sendMessageToMINA()">
                                            <span>➤</span>
                                        </button>
                                    </div>
                                    
                                    <div class="character-count">
                                        <span id="char-count">0</span>/500
                                    </div>
                                </div>
                            </div>
                            
                            <div class="quick-actions">
                                <h3 class="section-title">Actions rapides</h3>
                                
                                <button class="action-button">
                                    <span class="action-text">CONSEILS</span>
                                    <span class="action-text">Conseils personnalisés</span>
                                </button>
                                
                                <button class="action-button">
                                    <span class="action-text">URGENCE</span>
                                    <span class="action-text">Aide d'urgence</span>
                                </button>
                                
                                <button class="action-button">
                                    <span class="action-text">RESPIRATION</span>
                                    <span class="action-text">Exercice de respiration</span>
                                </button>
                                
                                <button class="action-button" onclick="startChatWithMINA()">
                                    <span class="action-text">CHAT</span>
                                    <span class="action-text">Parler avec MINA</span>
                                </button>
                            </div>
                            
                            <div class="safety-section">
                                <span class="safety-text">SÉCURISÉ</span>
                                <span class="safety-text">Vos conversations sont privées et sécurisées</span>
                            </div>
                        </div>
                </div>
            </div>

            <!-- Community Screen -->
            <div class="screen-content" id="community-screen">
                        <div class="community-controls">
                            <button class="community-btn" onclick="toggleAnonymousMode()" id="anonymous-toggle">
                                <span class="btn-icon">🕶️</span>
                                <span class="btn-text">Mode Anonyme: OFF</span>
                            </button>
                        </div>
                        
                        <div class="community-sections">
                            <div class="community-section">
                                <h3 class="section-title">💬 Discussions Récentes</h3>
                                <div class="discussion-list" id="discussion-list">
                                    <!-- Discussions will be populated by JavaScript -->
                                </div>
                            </div>
                            
                            <div class="community-section">
                                <h3 class="section-title">✨ Partager votre humeur</h3>
                                <div class="share-mood-section">
                                    <textarea id="mood-share" placeholder="Partagez comment vous vous sentez aujourd'hui..." 
                                              style="width: 100%; height: 80px; padding: 12px; border: 2px solid var(--primary-color); border-radius: 12px; font-family: inherit; resize: vertical; background: var(--background-light); color: var(--text-primary);"></textarea>
                                    <button onclick="shareMoodPost()" style="background: var(--primary-color); color: var(--text-on-primary); border: none; padding: 10px 20px; border-radius: 15px; font-weight: 600; cursor: pointer; margin-top: 10px; transition: all 0.3s ease;">
                                        Partager 🌟
                                    </button>
                                </div>
                            </div>
                            
                            <div class="community-section">
                                <h3 class="section-title">🤝 Soutien Mutuel</h3>
                                <div class="support-tips">
                                    <div class="tip-card">
                                        <span class="tip-icon">💚</span>
                                        <span class="tip-text">Soyez bienveillant dans vos interactions</span>
                                    </div>
                                    <div class="tip-card">
                                        <span class="tip-icon">🛡️</span>
                                        <span class="tip-text">Signaler tout contenu inapproprié</span>
                                    </div>
                                    <div class="tip-card">
                                        <span class="tip-icon">🕶️</span>
                                        <span class="tip-text">Utilisez le mode anonyme si nécessaire</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- FAQ Screen -->
            <div class="screen-content" id="faq-screen">
                <div class="faq-content">
                        <div class="faq-intro">
                            <div class="faq-welcome-icon">❓</div>
                            <h2>Besoin d'aide ?</h2>
                            <p>Trouvez rapidement les réponses à vos questions sur MINDLY</p>
                        </div>

                        <!-- Questions par catégorie -->
                        <div class="faq-categories">
                            <!-- Utilisation générale -->
                            <div class="faq-category">
                                <h3 class="category-title">🏠 Utilisation Générale</h3>
                                <div class="faq-items">
                                    <div class="faq-item">
                                        <div class="faq-question" onclick="toggleFAQ(this)">
                                            <span>Comment commencer avec MINDLY ?</span>
                                            <span class="faq-toggle">▼</span>
                                        </div>
                                        <div class="faq-answer">
                                            <p>Bienvenue sur MINDLY ! Commencez par :</p>
                                            <ul>
                                                <li>Compléter votre profil dans l'onglet "Profil"</li>
                                                <li>Faire le suivi de votre humeur quotidienne</li>
                                                <li>Explorer les fonctionnalités de méditation</li>
                                                <li>Personnaliser l'interface selon vos préférences</li>
                                            </ul>
                                        </div>
                                    </div>

                                    <div class="faq-item">
                                        <div class="faq-question" onclick="toggleFAQ(this)">
                                            <span>Comment naviguer dans l'application ?</span>
                                            <span class="faq-toggle">▼</span>
                                        </div>
                                        <div class="faq-answer">
                                            <p>La navigation est simple :</p>
                                            <ul>
                                                <li>Utilisez le menu en bas pour changer d'onglet</li>
                                                <li>Le menu hamburger (☰) donne accès aux paramètres</li>
                                                <li>Chaque section a ses propres fonctionnalités spécialisées</li>
                                            </ul>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Suivi d'humeur -->
                            <div class="faq-category">
                                <h3 class="category-title">😊 Suivi d'Humeur</h3>
                                <div class="faq-items">
                                    <div class="faq-item">
                                        <div class="faq-question" onclick="toggleFAQ(this)">
                                            <span>Comment fonctionne le suivi d'humeur ?</span>
                                            <span class="faq-toggle">▼</span>
                                        </div>
                                        <div class="faq-answer">
                                            <p>Le suivi d'humeur vous permet de :</p>
                                            <ul>
                                                <li>Enregistrer votre état émotionnel quotidien</li>
                                                <li>Visualiser vos tendances sur 7 jours</li>
                                                <li>Recevoir des recommandations personnalisées</li>
                                                <li>Identifier les patterns dans votre bien-être</li>
                                            </ul>
                                        </div>
                                    </div>

                                    <div class="faq-item">
                                        <div class="faq-question" onclick="toggleFAQ(this)">
                                            <span>Que signifient les différentes humeurs ?</span>
                                            <span class="faq-toggle">▼</span>
                                        </div>
                                        <div class="faq-answer">
                                            <p>Nos catégories d'humeur :</p>
                                            <ul>
                                                <li><strong>Joyeux 😄</strong> : Vous vous sentez énergique et positif</li>
                                                <li><strong>Épanoui 🌟</strong> : État de bien-être et de satisfaction</li>
                                                <li><strong>Serein 😌</strong> : Calme et paisible</li>
                                                <li><strong>Neutre 😐</strong> : État émotionnel équilibré</li>
                                                <li><strong>Fatigué 😴</strong> : Besoin de repos et récupération</li>
                                                <li><strong>Triste 😢</strong> : Moments difficiles, c'est normal</li>
                                            </ul>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Assistant IA -->
                            <div class="faq-category">
                                <h3 class="category-title">🤖 Assistant IA - MINA</h3>
                                <div class="faq-items">
                                    <div class="faq-item">
                                        <div class="faq-question" onclick="toggleFAQ(this)">
                                            <span>Qu'est-ce que MINA ?</span>
                                            <span class="faq-toggle">▼</span>
                                        </div>
                                        <div class="faq-answer">
                                            <p>MINA est votre assistant personnel pour le bien-être mental :</p>
                                            <ul>
                                                <li>Analyse empathique de vos émotions</li>
                                                <li>Conseils personnalisés selon votre état</li>
                                                <li>Accompagnement bienveillant 24h/24</li>
                                                <li>Respect total de votre confidentialité</li>
                                            </ul>
                                        </div>
                                    </div>

                                    <div class="faq-item">
                                        <div class="faq-question" onclick="toggleFAQ(this)">
                                            <span>Mes conversations sont-elles confidentielles ?</span>
                                            <span class="faq-toggle">▼</span>
                                        </div>
                                        <div class="faq-answer">
                                            <p>Absolument ! Votre confidentialité est notre priorité :</p>
                                            <ul>
                                                <li>Conversations chiffrées et sécurisées</li>
                                                <li>Données stockées localement sur votre appareil</li>
                                                <li>Mode anonyme disponible dans les paramètres</li>
                                                <li>Aucun partage avec des tiers</li>
                                            </ul>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Personnalisation -->
                            <div class="faq-category">
                                <h3 class="category-title">🎨 Personnalisation</h3>
                                <div class="faq-items">
                                    <div class="faq-item">
                                        <div class="faq-question" onclick="toggleFAQ(this)">
                                            <span>Comment personnaliser l'interface ?</span>
                                            <span class="faq-toggle">▼</span>
                                        </div>
                                        <div class="faq-answer">
                                            <p>Accédez aux options de personnalisation via le menu (☰) :</p>
                                            <ul>
                                                <li><strong>Style d'écriture</strong> : Blanc, sombre ou coloré</li>
                                                <li><strong>Thèmes rapides</strong> : 6 thèmes pré-définis</li>
                                                <li><strong>Couleurs personnalisées</strong> : Choisissez votre couleur préférée</li>
                                                <li><strong>Sauvegarde automatique</strong> : Vos préférences sont conservées</li>
                                            </ul>
                                        </div>
                                    </div>

                                    <div class="faq-item">
                                        <div class="faq-question" onclick="toggleFAQ(this)">
                                            <span>Comment revenir aux paramètres par défaut ?</span>
                                            <span class="faq-toggle">▼</span>
                                        </div>
                                        <div class="faq-answer">
                                            <p>Pour réinitialiser vos préférences :</p>
                                            <ul>
                                                <li>Ouvrez le menu de personnalisation (☰)</li>
                                                <li>Cliquez sur "🔄 Réinitialiser" en bas</li>
                                                <li>Confirmez votre choix</li>
                                                <li>L'interface retrouvera son apparence par défaut</li>
                                            </ul>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Support technique -->
                            <div class="faq-category">
                                <h3 class="category-title">🔧 Support Technique</h3>
                                <div class="faq-items">
                                    <div class="faq-item">
                                        <div class="faq-question" onclick="toggleFAQ(this)">
                                            <span>L'application ne fonctionne pas correctement</span>
                                            <span class="faq-toggle">▼</span>
                                        </div>
                                        <div class="faq-answer">
                                            <p>Solutions de dépannage rapide :</p>
                                            <ul>
                                                <li>Actualisez la page (F5 ou Ctrl+R)</li>
                                                <li>Vérifiez votre connexion internet</li>
                                                <li>Videz le cache de votre navigateur</li>
                                                <li>Essayez un autre navigateur (Chrome, Firefox, Safari)</li>
                                            </ul>
                                        </div>
                                    </div>

                                    <div class="faq-item">
                                        <div class="faq-question" onclick="toggleFAQ(this)">
                                            <span>Comment contacter le support ?</span>
                                            <span class="faq-toggle">▼</span>
                                        </div>
                                        <div class="faq-answer">
                                            <p>Plusieurs moyens de nous contacter :</p>
                                            <ul>
                                                <li>Via le menu principal → "Nous contacter"</li>
                                                <li>Email : support@mindly-app.com</li>
                                                <li>Réponse sous 24h en moyenne</li>
                                                <li>Support disponible du lundi au vendredi</li>
                                            </ul>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Section d'aide rapide -->
                        <div class="quick-help">
                            <h3>🚀 Aide Rapide</h3>
                            <div class="help-buttons">
                                <button class="help-btn" onclick="showScreen('onboarding-screen')">
                                    <span>📖</span>
                                    <span>Guide de démarrage</span>
                                </button>
                                <button class="help-btn" onclick="showContactSupport()">
                                    <span>📧</span>
                                    <span>Nous contacter</span>
                                </button>
                                <button class="help-btn" onclick="showAbout()">
                                    <span>ℹ️</span>
                                    <span>À propos de MINDLY</span>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Profile Screen -->
            <div class="screen-content" id="profile-screen">
                        <!-- Section Photo de profil -->
                        <div class="profile-photo-section">
                            <h3 style="margin-bottom: 15px; color: var(--text-primary);">📸 Photo de profil</h3>
                            <div class="profile-photo-container">
                                <div class="profile-photo" id="profilePhoto">
                                    <img id="profilePhotoImg" style="width: 100%; height: 100%; border-radius: 50%; object-fit: cover; display: none;" />
                                    <span id="profilePhotoPlaceholder">👤</span>
                                </div>
                                <div class="photo-upload-btn" onclick="document.getElementById('photoUpload').click()">
                                    📷
                                </div>
                            </div>
                            <input type="file" id="photoUpload" class="photo-upload-input" accept="image/*" onchange="handlePhotoUpload(event)" />
                            <div class="anonymous-toggle" id="anonymousToggle" onclick="toggleAnonymousMode()">
                                <span id="anonymousIcon">🔒</span>
                                <span id="anonymousText">Mode anonyme</span>
                            </div>
                        </div>

                        <div class="profile-header">
                            <div class="avatar">U</div>
                            <h2 class="profile-name">Utilisateur</h2>
                            <p class="profile-email">utilisateur@email.com</p>
                        </div>
                        
                        <!-- Section Données Personnelles - Version Simplifiée -->
                        <div class="personal-data-section">
                            <h3 class="section-title">📊 Mes Données Personnelles</h3>
                            
                            <!-- Aperçu Statistiques Rapides -->
                            <div class="stats-overview">
                                <div class="quick-stat">
                                    <div class="stat-icon">📈</div>
                                    <div class="stat-info">
                                        <div class="stat-value" id="well-being-score">85%</div>
                                        <div class="stat-name">Score de Bien-être</div>
                                    </div>
                                </div>
                                <div class="quick-stat">
                                    <div class="stat-icon">🔥</div>
                                    <div class="stat-info">
                                        <div class="stat-value" id="streak-days">12</div>
                                        <div class="stat-name">Jours Consécutifs</div>
                                    </div>
                                </div>
                                <div class="quick-stat">
                                    <div class="stat-icon">🧠</div>
                                    <div class="stat-info">
                                        <div class="stat-value" id="total-sessions">47</div>
                                        <div class="stat-name">Sessions Totales</div>
                                    </div>
                                </div>
                            </div>

                            <!-- Message informatif sur les graphiques -->
                            <div style="background: var(--primary-dark); border-radius: 15px; padding: 20px; margin: 20px 0; text-align: center; border: 1px solid rgba(255,255,255,0.2);">
                                <div style="font-size: 48px; margin-bottom: 15px;">📊</div>
                                <h4 style="color: white; margin-bottom: 15px;">Analyse Complète Disponible</h4>
                                <p style="color: white; opacity: 0.9; margin-bottom: 20px; line-height: 1.5;">
                                    Découvrez vos graphiques détaillés, diagnostic émotionnel et recommandations personnalisées dans votre analyse complète.
                                </p>
                                <button class="profile-btn" onclick="showPersonalizedInsights()" style="background: var(--primary-color); border: none; color: white; padding: 12px 24px; border-radius: 25px; font-weight: 600; cursor: pointer; transition: all 0.3s ease; box-shadow: 0 4px 15px rgba(0,0,0,0.2);">
                                    <span class="btn-icon">�</span>
                                    <span class="btn-text">Voir Insights Personnalisés</span>
                                </button>
                            </div>

                            <!-- Actions Rapides -->
                            <div class="profile-actions">
                                <button class="profile-btn" onclick="exportPersonalData()">
                                    <span class="btn-icon">📊</span>
                                    <span class="btn-text">Exporter Mes Données</span>
                                </button>
                                <button class="profile-btn" onclick="showDetailedAnalysis()">
                                    <span class="btn-icon">🔬</span>
                                    <span class="btn-text">Analyse Détaillée</span>
                                </button>
                                <button class="profile-btn" onclick="shareProgress()">
                                    <span class="btn-icon">📈</span>
                                    <span class="btn-text">Partager Progrès</span>
                                </button>
                            </div>
                        </div>


                        

                        
                        <!-- Graphique d'humeur -->
                        <div class="mood-chart-section">
                            <h3 class="section-title">Évolution de votre humeur</h3>
                            <div class="mood-chart" id="mood-chart">
                                <div class="chart-placeholder">
                                    <div style="text-align: center; color: var(--text-muted); padding: 40px;">
                                        📈 Suivez votre humeur pour voir le graphique
                                    </div>
                                </div>
                            </div>
                        </div>


                    </div>
                </div>
            </div>
        </div>


        
        <!-- Theme indicator -->
        <div class="theme-indicator">Thème: Par défaut</div>



    </div>

    <script>
        // Onboarding data
        const onboardingSteps = [
            {
                icon: 'MENTAL',
                title: 'Bienvenue dans MINDLY',
                description: 'Découvrez une approche moderne du bien-être mental avec des outils personnalisés.'
            },
            {
                icon: 'BIEN-ÊTRE',
                title: 'Suivez votre bien-être',
                description: 'Enregistrez votre humeur quotidienne et découvrez vos habitudes émotionnelles.'
            },
            {
                icon: 'SOCIAL',
                title: 'Connectez-vous',
                description: 'Rejoignez une communauté bienveillante et partagez vos expériences.'
            },
            {
                icon: 'IA',
                title: 'Assistant personnel',
                description: 'Bénéficiez de conseils personnalisés grâce à notre intelligence artificielle.'
            }
        ];

        let currentStep = 0;

        // FAQ toggle function
        function toggleFAQ(questionElement) {
            const answer = questionElement.nextElementSibling;
            const toggle = questionElement.querySelector('.faq-toggle');
            
            // Toggle active class
            questionElement.classList.toggle('active');
            answer.classList.toggle('active');
            
            // Update all other FAQ items to be closed
            const allQuestions = document.querySelectorAll('.faq-question');
            const allAnswers = document.querySelectorAll('.faq-answer');
            
            allQuestions.forEach((q, index) => {
                if (q !== questionElement) {
                    q.classList.remove('active');
                    allAnswers[index].classList.remove('active');
                }
            });
        }

        // Screen navigation
        function showScreen(screenId, buttonElement) {
            // Forcer la suppression de toutes les classes active
            document.querySelectorAll('.screen-content').forEach(screen => {
                screen.classList.remove('active');
                screen.style.display = 'none';
            });
            
            // Masquer aussi d'autres éléments potentiellement visibles
            document.querySelectorAll('.welcome-screen, .auth-screen').forEach(element => {
                if (element.parentElement && element.parentElement.classList.contains('screen-content')) {
                    element.parentElement.style.display = 'none';
                }
            });
            
            // Show selected screen seulement
            const targetScreen = document.getElementById(screenId);
            if (targetScreen) {
                targetScreen.classList.add('active');
                targetScreen.style.display = 'block';
            }
            
            // Update navigation buttons (toutes les navigations)
            document.querySelectorAll('.nav-btn, .bottom-nav-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            
            if (buttonElement) {
                buttonElement.classList.add('active');
            } else {
                // Find the button that corresponds to this screen in bottom navigation
                const bottomNavBtn = document.querySelector(`[data-screen="${screenId}"]`);
                if (bottomNavBtn) {
                    bottomNavBtn.classList.add('active');
                }
                
                // Find other navigation buttons
                const activeBtn = document.querySelector(`[onclick*="${screenId}"]`);
                if (activeBtn) {
                    activeBtn.classList.add('active');
                }
            }
            
            // Mettre à jour le sous-titre dans l'en-tête global
            const globalSubtitle = document.getElementById('globalSubtitle');
            const screenTitles = {
                'home-screen': 'Bienvenue !',
                'mood-screen': 'Comment vous sentez-vous ?',
                'chat-screen': 'Votre compagnon d\'écoute',
                'community-screen': 'Partagez et soutenez-vous',
                'faq-screen': 'Questions Fréquemment Posées',
                'profile-screen': 'Votre espace personnel'
            };
            
            if (globalSubtitle && screenTitles[screenId]) {
                globalSubtitle.textContent = screenTitles[screenId];
            }
            
            // Fermer le menu dropdown si ouvert
            closeDropdownMenu();
            
            console.log(`Switched to screen: ${screenId}`);
        }

        // Onboarding navigation
        function updateOnboarding() {
            const step = onboardingSteps[currentStep];
            document.getElementById('onboarding-icon').textContent = step.icon;
            document.getElementById('onboarding-title').textContent = step.title;
            document.getElementById('onboarding-description').textContent = step.description;
            
            // Update dots
            document.querySelectorAll('.dot').forEach((dot, index) => {
                dot.classList.toggle('active', index === currentStep);
            });
        }

        // Event listeners for onboarding
        document.querySelector('.prev-btn').addEventListener('click', () => {
            if (currentStep > 0) {
                currentStep--;
                updateOnboarding();
            }
        });

        document.querySelector('.next-btn').addEventListener('click', () => {
            if (currentStep < onboardingSteps.length - 1) {
                currentStep++;
                updateOnboarding();
            } else {
                showScreen('home-screen');
            }
        });

        // Tab navigation
        document.querySelectorAll('.tab-item').forEach(tab => {
            tab.addEventListener('click', (e) => {
                const tabItem = e.target.closest('.tab-item');
                const tabLabel = tabItem.querySelector('.tab-label').textContent;
                
                // Map tab labels to screen IDs
                const screenMap = {
                    'Accueil': 'home-screen',
                    'Humeur': 'mood-screen',
                    'Chat': 'chat-screen',
                    'Communauté': 'community-screen',
                    'FAQ': 'faq-screen',
                    'Profil': 'profile-screen'
                };
                
                const targetScreen = screenMap[tabLabel];
                if (targetScreen) {
                    showScreen(targetScreen);
                }
                
                // Update tab states
                const parent = tabItem.closest('.main-app');
                if (parent) {
                    parent.querySelectorAll('.tab-item').forEach(t => t.classList.remove('active'));
                    tabItem.classList.add('active');
                }
            });
        });

        // Action card clicks with enhanced functionality
        document.querySelectorAll('.action-card').forEach(card => {
            card.addEventListener('click', (e) => {
                const actionTitle = card.querySelector('.action-title').textContent;
                
                if (actionTitle.includes('Assistant IA') || actionTitle.includes('Chat')) {
                    showScreen('chat-screen');
                    showNotification('Assistant IA activé ! 🤖', 'success');
                } else if (actionTitle.includes('Méditation') || actionTitle.includes('respiration')) {
                    startMeditationSession();
                } else if (actionTitle.includes('Journal')) {
                    openJournal();
                }
            });
        });

        // Meditation session
        function startMeditationSession() {
            const sessions = [
                { name: 'Respiration calme', duration: '5 min', description: 'Exercice de respiration pour se détendre' },
                { name: 'Méditation guidée', duration: '10 min', description: 'Séance de méditation complète' },
                { name: 'Sons de la nature', duration: '15 min', description: 'Relaxation avec sons naturels' }
            ];
            
            const randomSession = sessions[Math.floor(Math.random() * sessions.length)];
            
            showCustomModal({
                title: '🧘‍♀️ Session de Méditation',
                content: `
                    <div style="text-align: center; padding: 20px;">
                        <h3 style="color: var(--primary-color); margin-bottom: 10px;">${randomSession.name}</h3>
                        <p style="color: var(--text-secondary); margin-bottom: 15px;">${randomSession.description}</p>
                        <div style="background: var(--background-medium); padding: 15px; border-radius: 12px; margin-bottom: 20px;">
                            <div style="font-size: 24px; font-weight: bold; color: var(--primary-color);">${randomSession.duration}</div>
                            <div style="font-size: 14px; color: var(--text-muted);">Durée recommandée</div>
                        </div>
                        <button onclick="closeModal(); startTimer('${randomSession.duration}')" style="background: var(--primary-color); color: white; border: none; padding: 12px 24px; border-radius: 20px; font-weight: 600; cursor: pointer;">Commencer</button>
                    </div>
                `
            });
        }

        // Journal functionality
        function openJournal() {
            const journalEntries = JSON.parse(localStorage.getItem('mindly-journal') || '[]');
            const today = new Date().toLocaleDateString('fr-FR');
            
            showCustomModal({
                title: '📔 Journal Personnel',
                content: `
                    <div style="padding: 20px;">
                        <div style="margin-bottom: 20px;">
                            <label style="display: block; margin-bottom: 8px; font-weight: 600; color: var(--text-primary);">Comment s'est passée votre journée ?</label>
                            <textarea id="journal-entry" placeholder="Écrivez vos pensées ici..." style="width: 100%; height: 120px; padding: 12px; border: 2px solid var(--background-medium); border-radius: 8px; font-family: inherit; resize: vertical;"></textarea>
                        </div>
                        
                        <div style="display: flex; gap: 10px; justify-content: center;">
                            <button onclick="saveJournalEntry()" style="background: var(--primary-color); color: white; border: none; padding: 10px 20px; border-radius: 15px; font-weight: 600; cursor: pointer;">Sauvegarder</button>
                            <button onclick="closeModal()" style="background: var(--background-medium); color: var(--text-primary); border: none; padding: 10px 20px; border-radius: 15px; font-weight: 600; cursor: pointer;">Fermer</button>
                        </div>
                        
                        ${journalEntries.length > 0 ? `
                            <div style="margin-top: 20px; padding-top: 20px; border-top: 1px solid var(--background-medium);">
                                <h4 style="margin-bottom: 10px; color: var(--text-primary);">Dernières entrées :</h4>
                                ${journalEntries.slice(-3).reverse().map(entry => `
                                    <div style="background: var(--background-light); padding: 10px; border-radius: 8px; margin-bottom: 8px; font-size: 14px;">
                                        <div style="color: var(--text-muted); font-size: 12px; margin-bottom: 4px;">${entry.date}</div>
                                        <div style="color: var(--text-secondary);">${entry.content.substring(0, 100)}${entry.content.length > 100 ? '...' : ''}</div>
                                    </div>
                                `).join('')}
                            </div>
                        ` : ''}
                    </div>
                `
            });
        }

        // Save journal entry
        function saveJournalEntry() {
            const entry = document.getElementById('journal-entry').value.trim();
            if (entry) {
                const journalEntries = JSON.parse(localStorage.getItem('mindly-journal') || '[]');
                journalEntries.push({
                    date: new Date().toLocaleDateString('fr-FR'),
                    content: entry,
                    timestamp: Date.now()
                });
                localStorage.setItem('mindly-journal', JSON.stringify(journalEntries));
                showNotification('Entrée sauvegardée ! 📝', 'success');
                closeModal();
            } else {
                showNotification('Veuillez écrire quelque chose avant de sauvegarder.', 'warning');
            }
        }

        // Timer function
        function startTimer(duration) {
            const minutes = parseInt(duration);
            let timeLeft = minutes * 60;
            
            showNotification(`Timer démarré pour ${minutes} minutes ⏰`, 'info');
            
            const timer = setInterval(() => {
                timeLeft--;
                
                if (timeLeft <= 0) {
                    clearInterval(timer);
                    showNotification('Session terminée ! Bien joué ! 🎉', 'success');
                    // Play a gentle sound notification if possible
                    try {
                        const audio = new Audio('data:audio/wav;base64,UklGRnoGAABXQVZFZm10IBAAAAABAAEAQB8AAEAfAAABAAgAZGF0YQoGAACBhYqFbF1fdJivrJBhNjVgodDbq2EcBj+a2/LDciUFLIHO8tiJNwgZaLvt559NEAxQp+PwtmMcBjiR1/LMeSwFJHfH8N2QQAoUXrTp66hVFApGn+DyvmwhBTiS2e/NdjEFJHfJ79l6wBcNVa3n4qpOEQlGn9uy8WERBjqS2O7MfCkFJHfJ8N6OOgsZa73y7J9PHAxPqN/zs2AcBz2T2O/KfjMEJHfJ79l+yBYNVLLo7KpRFAxEoOHhxW0hBzuS2e/NfCQFJHfH79qBOgsYbL7x6qBPHAxUqOD5tmAcBj2T2O7MfywFJHnJ79l+yBUNVLHh76ySEQdFouHbum4dBziP3/LBgysELYHO8dh8OggSb8Ty6qBVFApDo+T9p1EcCUqm4+LDdSMGPobG8diDOAoRXrfp6qlZFAhCo+LxvmwhBTuO1/LNeCUFJH7I8d+OSAkLWK/j4qtZFAlBo+HAuGsgBjuS2O7NeSkELHvJ8d2QRgoNYLbp6qpVFApHpePltF8wBTuS2O3NeygELHvJ8d2QRgoNYLbp6qpVFApHpePltF8wBTuS2O3NeygELHvJ8d2QRgoNYLbp6qpVFApHpePltF8wBTuS2O3NeygELHvJ8d2QRgoN');
                        audio.play().catch(() => {});
                    } catch (e) {}
                }
            }, 1000);
        }

        // Custom modal system
        function showCustomModal({ title, content }) {
            const modal = document.createElement('div');
            modal.id = 'custom-modal';
            modal.style.cssText = `
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background: rgba(0, 0, 0, 0.5);
                display: flex;
                justify-content: center;
                align-items: center;
                z-index: 10000;
                backdrop-filter: blur(5px);
            `;
            
            modal.innerHTML = `
                <div style="
                    background: white;
                    border-radius: 20px;
                    max-width: 90vw;
                    max-height: 80vh;
                    overflow-y: auto;
                    box-shadow: 0 10px 40px rgba(0,0,0,0.3);
                    animation: modalSlideIn 0.3s ease;
                ">
                    <div style="
                        background: var(--primary-color);
                        color: white;
                        padding: 20px;
                        border-radius: 20px 20px 0 0;
                        font-weight: 600;
                        text-align: center;
                        font-size: 18px;
                    ">${title}</div>
                    ${content}
                </div>
            `;
            
            document.body.appendChild(modal);
            
            // Close on outside click
            modal.addEventListener('click', (e) => {
                if (e.target === modal) closeModal();
            });
        }

        function closeModal() {
            const modal = document.getElementById('custom-modal');
            if (modal) {
                modal.style.animation = 'modalSlideOut 0.3s ease';
                setTimeout(() => modal.remove(), 300);
            }
        }

        // Enhanced notification system
        function showNotification(message, type = 'info') {
            const colors = {
                success: '#4CAF50',
                warning: '#FF9800',
                error: '#F44336',
                info: '#2196F3'
            };
            
            const notification = document.createElement('div');
            notification.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                background: ${colors[type]};
                color: white;
                padding: 15px 20px;
                border-radius: 25px;
                font-size: 14px;
                font-weight: 600;
                z-index: 10001;
                box-shadow: 0 4px 20px rgba(0,0,0,0.3);
                animation: slideInRight 0.3s ease;
                max-width: 300px;
            `;
            
            notification.textContent = message;
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.style.animation = 'slideOutRight 0.3s ease';
                setTimeout(() => notification.remove(), 300);
            }, 4000);
        }

        // Theme management
        function changeTheme(themeName) {
            document.documentElement.setAttribute('data-theme', themeName);
            localStorage.setItem('mindly-theme', themeName);
            
            // Update theme indicator
            const themeIndicator = document.querySelector('.theme-indicator');
            if (themeIndicator) {
                themeIndicator.textContent = `Thème: ${themeName}`;
            }
            
            // Smooth transition for theme change
            document.body.style.transition = 'all 0.5s ease';
            setTimeout(() => {
                document.body.style.transition = '';
            }, 500);
        }

        // Mood selection with theme change and stats tracking
        document.querySelectorAll('.mood-item, .mood-button').forEach(mood => {
            mood.addEventListener('click', (e) => {
                // Remove active class from all moods
                document.querySelectorAll('.mood-item, .mood-button').forEach(m => m.classList.remove('selected'));
                // Add active class to clicked mood
                mood.classList.add('selected');
                
                const moodText = mood.querySelector('.mood-text').textContent;
                const themeData = mood.getAttribute('data-theme');
                
                // Change theme based on mood
                if (themeData && themeData !== 'default') {
                    changeTheme(themeData);
                } else {
                    changeTheme('');
                }
                
                // Track mood for statistics
                trackMoodSelection(moodText);
                
                // Show mood feedback with AI advice
                showMoodFeedback(moodText);
                const advice = aiModeration.getPersonalizedAdvice(moodText);
                setTimeout(() => {
                    showNotification(`💡 ${advice}`, 'info');
                }, 2000);
                
                console.log('Humeur sélectionnée:', moodText, 'Thème:', themeData);
            });
        });

        // Mood feedback function
        function showMoodFeedback(mood) {
            const feedbackMessages = {
                'ÉPANOUI': 'Magnifique ! Profitez de cette belle énergie ! 🌟',
                'SEREIN': 'Parfait, restons dans cette sérénité apaisante. 🧘‍♀️',
                'NEUTRE': 'C\'est normal, prenons soin de vous doucement. ⚖️',
                'FATIGUÉ': 'Prenez le temps de vous reposer, vous le méritez. 💜',
                'ANXIEUX': 'Respirons ensemble, tout va bien se passer. 🤲',
                'ÉNERGIQUE': 'Fantastique ! Canalisons cette belle énergie ! ⚡'
            };
            
            const message = feedbackMessages[mood] || 'Merci de partager votre ressenti.';
            
            // Show temporary feedback
            const feedback = document.createElement('div');
            feedback.className = 'mood-feedback';
            feedback.textContent = message;
            feedback.style.cssText = `
                position: fixed;
                top: 20px;
                left: 50%;
                transform: translateX(-50%);
                background: var(--primary-color);
                color: white;
                padding: 12px 20px;
                border-radius: 25px;
                font-size: 14px;
                font-weight: 600;
                z-index: 10000;
                box-shadow: 0 4px 20px rgba(0,0,0,0.2);
                animation: slideIn 0.3s ease;
            `;
            
            document.body.appendChild(feedback);
            
            setTimeout(() => {
                feedback.style.animation = 'slideOut 0.3s ease';
                setTimeout(() => feedback.remove(), 300);
            }, 3000);
        }

        // Auth buttons functionality
        document.querySelectorAll('.auth-btn').forEach(btn => {
            btn.addEventListener('click', (e) => {
                const btnText = btn.textContent;
                
                if (btnText.includes('S\'inscrire')) {
                    showScreen('signup-screen');
                } else if (btnText.includes('Se connecter')) {
                    showScreen('login-screen');
                } else if (btnText.includes('invité')) {
                    showScreen('onboarding-screen');
                }
            });
        });

        // Onboarding button
        document.querySelector('.onboarding-btn').addEventListener('click', () => {
            showScreen('onboarding-screen');
        });

        // Initialize theme from localStorage
        function initializeApp() {
            const savedTheme = localStorage.getItem('mindly-theme');
            if (savedTheme && savedTheme !== 'default') {
                changeTheme(savedTheme);
            }
            
            // Update theme indicator
            const themeIndicator = document.querySelector('.theme-indicator');
            if (themeIndicator) {
                themeIndicator.textContent = `Thème: ${savedTheme || 'Par défaut'}`;
            }
            
            // Add welcome animation
            setTimeout(() => {
                document.querySelector('.logo').style.animation = 'pulse 2s infinite';
            }, 1000);
        }

        // Add more interactive features
        function addInteractiveFeatures() {
            // Add click feedback to all buttons
            document.querySelectorAll('button').forEach(btn => {
                btn.addEventListener('click', function() {
                    this.style.transform = 'scale(0.95)';
                    setTimeout(() => {
                        this.style.transform = '';
                    }, 150);
                });
            });
            
            // Add swipe detection for mobile
            let touchStartX = 0;
            let touchEndX = 0;
            
            document.addEventListener('touchstart', e => {
                touchStartX = e.changedTouches[0].screenX;
            });
            
            document.addEventListener('touchend', e => {
                touchEndX = e.changedTouches[0].screenX;
                handleSwipe();
            });
            
            function handleSwipe() {
                const swipeThreshold = 50;
                const diff = touchStartX - touchEndX;
                
                if (Math.abs(diff) > swipeThreshold) {
                    if (diff > 0) {
                        // Swipe left - next screen
                        console.log('Swipe left detected');
                    } else {
                        // Swipe right - previous screen
                        console.log('Swipe right detected');
                    }
                }
            }
        }

        // Enhanced form validation
        function addFormValidation() {
            document.querySelectorAll('.form-input').forEach(input => {
                input.addEventListener('input', function() {
                    if (this.validity.valid) {
                        this.style.borderColor = 'var(--primary-color)';
                    } else {
                        this.style.borderColor = '#f44336';
                    }
                });
            });
        }

        // IA Empathique et Modératrice - MINDLY Assistant
        class AIModeration {
            constructor() {
                this.name = "MINA"; // MINDLY Intelligent Assistant
                
                // Personnalité empathique
                this.personality = {
                    empathetic: true,
                    caring: true,
                    understanding: true,
                    supportive: true,
                    friend: true
                };

                // Mots de détresse émotionnelle
                this.emotionalWords = {
                    tristesse: ['triste', 'déprimé', 'mal', 'pleurer', 'larmes', 'chagrin', 'mélancolie'],
                    anxiété: ['anxieux', 'stressé', 'panique', 'angoisse', 'peur', 'inquiet', 'nerveux'],
                    colère: ['énervé', 'fâché', 'irrité', 'rage', 'furieux', 'agacé'],
                    fatigue: ['épuisé', 'fatigué', 'crevé', 'usé', 'vidé', 'lessivé'],
                    solitude: ['seul', 'isolé', 'abandonné', 'incompris', 'rejeté'],
                    espoir: ['espoir', 'mieux', 'positif', 'heureux', 'content', 'joie', 'sourire']
                };

                // Réponses empathiques personnalisées
                this.empathicResponses = {
                    greeting: [
                        "Salut ! C'est MINA 😊 Je suis là pour t'écouter et t'accompagner. Comment te sens-tu aujourd'hui ?",
                        "Hello ! Je suis MINA, ton amie virtuelle 💚 Raconte-moi ce qui se passe dans ta vie.",
                        "Coucou ! C'est MINA 🌟 Je suis là pour toi, dis-moi tout ce qui te passe par la tête."
                    ],
                    sadness: [
                        "Je sens que tu traverses un moment difficile 💙 Tes émotions sont valides et importantes. Veux-tu me parler de ce qui te rend triste ?",
                        "Tu sembles porter un poids sur le cœur 🤗 Sache que je suis là pour t'écouter sans jugement. Qu'est-ce qui te préoccupe ?",
                        "Je perçois de la tristesse dans tes mots 💜 Il est normal de se sentir ainsi parfois. Raconte-moi ce qui t'affecte."
                    ],
                    anxiety: [
                        "Je sens que l'anxiété te submerge 🌿 Respirons ensemble : inspire... expire... Tu n'es pas seul(e). Qu'est-ce qui te stresse ?",
                        "L'angoisse peut être accablante 🕊️ Tu es courageux/se de partager tes sentiments. Dis-moi ce qui t'inquiète.",
                        "Je comprends que tu te sentes anxieux/se 🌸 C'est OK de ne pas aller bien. Parlons de ce qui te tracasse."
                    ],
                    anger: [
                        "Je sens ta frustration 🔥 La colère est une émotion naturelle. Veux-tu me dire ce qui t'a mis(e) en colère ?",
                        "Tu sembles contrarié(e) 💨 C'est important d'exprimer ses émotions. Qu'est-ce qui t'énerve ?",
                        "Je perçois ta colère 🌊 Parfois il faut évacuer. Raconte-moi ce qui s'est passé."
                    ],
                    fatigue: [
                        "Tu sembles épuisé(e) 😴 Il est important de prendre soin de soi. As-tu réussi à te reposer récemment ?",
                        "Je sens que tu es fatigué(e) 🛋️ Ton corps et ton esprit ont besoin de repos. Comment puis-je t'aider ?",
                        "La fatigue peut être lourde à porter ☁️ Tu mérites de prendre du temps pour toi. Qu'est-ce qui t'épuise ?"
                    ],
                    support: [
                        "Tu es quelqu'un de formidable 🌟 Même dans les moments difficiles, tu continues d'avancer. Je suis fière de toi.",
                        "Je crois en toi 💪 Tu as déjà surmonté des épreuves avant, tu peux le refaire. Ensemble, on va y arriver.",
                        "Tu n'es jamais seul(e) 🤝 Je suis là, la communauté MINDLY aussi. Tu comptes beaucoup."
                    ]
                };

                // Modération intelligente
                this.profanityList = [
                    'merde', 'putain', 'connard', 'salope', 'bâtard', 'enculé', 'pute', 'con',
                    'crétin', 'imbécile', 'débile', 'abruti', 'idiot', 'stupide',
                    'pédé', 'tapette', 'négro', 'bougnoule', 'youpin', 'sale',
                    'suicide', 'tue-toi', 'crève', 'meurs', 'violence', 'taper', 'frapper'
                ];

                this.isAnonymousMode = localStorage.getItem('mindly-anonymous') === 'true';
                this.userReports = JSON.parse(localStorage.getItem('mindly-reports') || '[]');
                this.conversationHistory = JSON.parse(localStorage.getItem('mindly-mina-history') || '[]');
            }

            // Analyse émotionnelle empathique
            analyzeEmotion(text) {
                const lowerText = text.toLowerCase();
                let detectedEmotions = [];
                let emotionIntensity = 0;
                
                // Analyser chaque catégorie d'émotion
                Object.keys(this.emotionalWords).forEach(emotion => {
                    const words = this.emotionalWords[emotion];
                    words.forEach(word => {
                        if (lowerText.includes(word)) {
                            detectedEmotions.push(emotion);
                            emotionIntensity++;
                        }
                    });
                });

                return {
                    emotions: [...new Set(detectedEmotions)], // Remove duplicates
                    intensity: emotionIntensity,
                    needsSupport: emotionIntensity > 0
                };
            }

            // Générer une réponse empathique personnalisée
            generateEmpathicResponse(text, emotionAnalysis) {
                let response = "";
                
                // Réponse basée sur l'émotion dominante
                if (emotionAnalysis.emotions.includes('tristesse')) {
                    response = this.getRandomResponse('sadness');
                } else if (emotionAnalysis.emotions.includes('anxiété')) {
                    response = this.getRandomResponse('anxiety');
                } else if (emotionAnalysis.emotions.includes('colère')) {
                    response = this.getRandomResponse('anger');
                } else if (emotionAnalysis.emotions.includes('fatigue')) {
                    response = this.getRandomResponse('fatigue');
                } else if (emotionAnalysis.emotions.includes('espoir')) {
                    response = "C'est merveilleux de t'entendre si positif/ve ! 🌈 Continue sur cette voie, tu rayonnes ! Qu'est-ce qui te rend heureux/se aujourd'hui ?";
                } else {
                    // Réponse générale empathique
                    response = "Je t'écoute attentivement 💚 Tes pensées et sentiments sont importants pour moi. Raconte-moi en plus sur ce que tu ressens.";
                }

                // Ajouter un conseil personnalisé
                if (emotionAnalysis.intensity > 2) {
                    response += "\n\n✨ Petit conseil : Prends quelques minutes pour respirer profondément. Tu peux aussi essayer une session de méditation dans l'app, ça pourrait t'aider.";
                }

                return response;
            }

            // Réponse aléatoire
            getRandomResponse(category) {
                const responses = this.empathicResponses[category];
                return responses[Math.floor(Math.random() * responses.length)];
            }

            // Chat intelligent avec MINA - IA polyvalente
            chatWithMINA(userMessage) {
                // Sauvegarder le message de l'utilisateur
                this.conversationHistory.push({
                    type: 'user',
                    message: userMessage,
                    timestamp: Date.now()
                });

                // Analyser le contexte et le type de demande
                const context = this.analyzeMessageContext(userMessage);
                const emotionAnalysis = this.analyzeEmotion(userMessage);
                
                // Générer une réponse intelligente selon le contexte
                let aiResponse = this.generateIntelligentResponse(userMessage, context, emotionAnalysis);

                // Sauvegarder la réponse de MINA
                this.conversationHistory.push({
                    type: 'ai',
                    message: aiResponse,
                    timestamp: Date.now(),
                    emotions: emotionAnalysis.emotions,
                    context: context.type
                });

                // Sauvegarder l'historique
                localStorage.setItem('mindly-mina-history', JSON.stringify(this.conversationHistory.slice(-50)));

                return aiResponse;
            }

            // Analyser le contexte du message pour déterminer le type de réponse
            analyzeMessageContext(message) {
                const lowerMessage = message.toLowerCase();
                
                // Détection de questions générales
                const questionWords = ['comment', 'pourquoi', 'quoi', 'où', 'quand', 'qui', 'quel', '?'];
                const isQuestion = questionWords.some(word => lowerMessage.includes(word));
                
                // Détection de demandes d'exercices
                const exerciseKeywords = ['exercice', 'respiration', 'méditation', 'relaxation', 'détente', 'calmer', 'apaiser'];
                const needsExercise = exerciseKeywords.some(word => lowerMessage.includes(word));
                
                // Détection de demandes de conseils
                const adviceKeywords = ['conseil', 'aide', 'que faire', 'comment faire', 'problème', 'solution'];
                const needsAdvice = adviceKeywords.some(word => lowerMessage.includes(word));
                
                // Détection de demandes d'information générale
                const infoKeywords = ['explique', 'définition', 'c\'est quoi', 'information', 'recherche'];
                const needsInfo = infoKeywords.some(word => lowerMessage.includes(word));
                
                // Détection de conversation normale
                const conversationStarters = ['salut', 'bonjour', 'bonsoir', 'ça va', 'comment tu vas'];
                const isConversation = conversationStarters.some(word => lowerMessage.includes(word));

                return {
                    type: needsExercise ? 'exercise' : 
                          needsAdvice ? 'advice' : 
                          needsInfo ? 'information' : 
                          isQuestion ? 'question' : 
                          isConversation ? 'conversation' : 'emotional_support',
                    isQuestion,
                    needsExercise,
                    needsAdvice,
                    needsInfo,
                    isConversation
                };
            }

            // Générer une réponse intelligente selon le contexte
            generateIntelligentResponse(message, context, emotionAnalysis) {
                const personality = localStorage.getItem('minaPersonality') || 'friend';
                let response = '';

                switch (context.type) {
                    case 'exercise':
                        response = this.generateExerciseResponse(message, emotionAnalysis, personality);
                        break;
                    case 'advice':
                        response = this.generateAdviceResponse(message, emotionAnalysis, personality);
                        break;
                    case 'information':
                        response = this.generateInformationResponse(message, personality);
                        break;
                    case 'question':
                        response = this.generateQuestionResponse(message, personality);
                        break;
                    case 'conversation':
                        response = this.generateConversationResponse(message, personality);
                        break;
                    default:
                        response = this.generateEmpathicResponse(message, emotionAnalysis);
                }

                // Ajouter du support émotionnel si nécessaire
                if (emotionAnalysis.needsSupport && context.type !== 'exercise') {
                    response += "\n\n💚 " + this.getRandomResponse('support');
                }

                return response;
            }

            // Générer des exercices personnalisés
            generateExerciseResponse(message, emotions, personality) {
                const exercises = {
                    anxiety: [
                        "🌿 **Exercice de respiration 4-7-8** :\n1. Inspire par le nez pendant 4 secondes\n2. Retiens ta respiration 7 secondes\n3. Expire par la bouche pendant 8 secondes\n4. Répète 4 fois\n\nCet exercice active ton système nerveux parasympathique et réduit l'anxiété.",
                        "🧘‍♀️ **Méditation de pleine conscience (5 min)** :\n• Assis confortablement, ferme les yeux\n• Concentre-toi sur ta respiration\n• Quand ton esprit divague, reviens doucement à ta respiration\n• Observe tes pensées sans les juger\n\nCela t'aidera à retrouver le calme intérieur."
                    ],
                    sadness: [
                        "💙 **Exercice de gratitude** :\n1. Note 3 choses pour lesquelles tu es reconnaissant(e) aujourd'hui\n2. Explique pourquoi chacune est importante\n3. Ressens vraiment cette gratitude dans ton cœur\n\nLa gratitude rewire ton cerveau vers le positif.",
                        "🌱 **Mouvement thérapeutique** :\n• Mets une musique douce\n• Étire-toi lentement\n• Fais quelques pas à l'extérieur si possible\n• Prends 5 grandes respirations\n\nLe mouvement libère des endorphines naturelles."
                    ],
                    anger: [
                        "🔥 **Technique de refroidissement** :\n1. Compte lentement de 10 à 1\n2. Serre les poings puis relâche-les 5 fois\n3. Visualise ta colère comme une flamme qui diminue\n4. Respire profondément\n\nCela permet à ton cortex préfrontal de reprendre le contrôle.",
                        "💨 **Évacuation saine** :\n• Écris tes sentiments sur papier (puis déchire-le si tu veux)\n• Fais du sport ou de l'exercice physique\n• Parle à haute voix (seul) pour exprimer ta frustration\n\nL'expression saine évite l'accumulation."
                    ],
                    general: [
                        "⭐ **Scan corporel relaxant** :\n• Allonge-toi confortablement\n• Commence par tes orteils, sens chaque partie de ton corps\n• Détends progressivement chaque muscle\n• Remonte jusqu'au sommet de ta tête\n• Prends 10 minutes pour cet exercice\n\nTon corps et ton esprit sont connectés.",
                        "🌈 **Visualisation positive** :\n1. Ferme les yeux et imagine un lieu qui te rend heureux\n2. Utilise tous tes sens : vue, ouïe, odorat, toucher\n3. Ressens les émotions positives de ce lieu\n4. Reste dans cette visualisation 5-10 minutes\n\nTon cerveau ne fait pas la différence entre réel et imaginé."
                    ]
                };

                let selectedExercises;
                if (emotions.emotions.includes('anxiété')) {
                    selectedExercises = exercises.anxiety;
                } else if (emotions.emotions.includes('tristesse')) {
                    selectedExercises = exercises.sadness;
                } else if (emotions.emotions.includes('colère')) {
                    selectedExercises = exercises.anger;
                } else {
                    selectedExercises = exercises.general;
                }

                const exercise = selectedExercises[Math.floor(Math.random() * selectedExercises.length)];
                
                const personalityIntros = {
                    confident: "Je sens que tu as besoin de retrouver ton équilibre. Voici un exercice que je te recommande :",
                    friend: "Hey, j'ai exactement ce qu'il te faut ! Essaie cet exercice avec moi :",
                    teacher: "Laisse-moi t'enseigner une technique efficace pour ton bien-être :",
                    coach: "Allez champion, on va faire un exercice ensemble pour te remettre sur les rails !"
                };

                return `${personalityIntros[personality] || personalityIntros.friend}\n\n${exercise}\n\n✨ Prends ton temps et n'hésite pas à me dire comment tu te sens après !`;
            }

            // Générer des conseils personnalisés
            generateAdviceResponse(message, emotions, personality) {
                const adviceDatabase = {
                    relationships: [
                        "🤝 **Communication bienveillante** : Utilise des phrases en 'Je' plutôt qu'en 'Tu' pour exprimer tes sentiments sans accuser.",
                        "💝 **Écoute active** : Concentre-toi vraiment sur ce que l'autre dit, sans préparer ta réponse pendant qu'il parle.",
                        "🕰️ **Temps de qualité** : Accorde du temps sans distractions (téléphone, TV) pour renforcer vos liens."
                    ],
                    work: [
                        "📅 **Gestion du temps** : Utilise la technique Pomodoro (25 min de travail, 5 min de pause) pour rester concentré.",
                        "🎯 **Priorisation** : Applique la matrice d'Eisenhower : urgent/important, important/non-urgent, etc.",
                        "🔄 **Équilibre** : Définis des limites claires entre vie pro et perso, ton bien-être en dépend."
                    ],
                    stress: [
                        "🧘 **Mindfulness quotidienne** : 10 minutes de méditation par jour réduisent significativement le stress.",
                        "🌿 **Déconnexion** : Éloigne-toi des écrans 1h avant le coucher pour un meilleur sommeil.",
                        "🚶‍♀️ **Mouvement** : 20 minutes de marche par jour libèrent des endorphines naturelles."
                    ],
                    general: [
                        "🌱 **Croissance personnelle** : Célèbre les petites victoires, elles construisent ta confiance.",
                        "🎨 **Créativité** : Engage-toi dans une activité créative, c'est thérapeutique pour l'esprit.",
                        "🤗 **Bienveillance** : Sois aussi gentil avec toi-même qu'avec ton meilleur ami."
                    ]
                };

                // Détecter le domaine du conseil
                const lowerMessage = message.toLowerCase();
                let domain = 'general';
                if (lowerMessage.includes('travail') || lowerMessage.includes('job') || lowerMessage.includes('bureau')) {
                    domain = 'work';
                } else if (lowerMessage.includes('relation') || lowerMessage.includes('ami') || lowerMessage.includes('famille')) {
                    domain = 'relationships';
                } else if (lowerMessage.includes('stress') || lowerMessage.includes('anxieux') || lowerMessage.includes('pression')) {
                    domain = 'stress';
                }

                const advice = adviceDatabase[domain][Math.floor(Math.random() * adviceDatabase[domain].length)];
                
                const personalityIntros = {
                    confident: "Je comprends ta situation. Voici mon conseil :",
                    friend: "Oh, j'ai vécu quelque chose de similaire ! Mon conseil d'amie :",
                    teacher: "Permettez-moi de partager une approche qui a fait ses preuves :",
                    coach: "Écoute-moi bien, j'ai la stratégie parfaite pour toi !"
                };

                return `${personalityIntros[personality] || personalityIntros.friend}\n\n${advice}\n\n💡 N'hésite pas à me poser des questions pour approfondir !`;
            }

            // Générer des réponses informatives (simulation d'accès internet)
            generateInformationResponse(message, personality) {
                const lowerMessage = message.toLowerCase();
                
                // Base de connaissances étendue
                const knowledgeBase = {
                    health: {
                        keywords: ['santé', 'maladie', 'symptôme', 'médecin', 'traitement', 'médicament'],
                        responses: [
                            "🏥 **Santé mentale et physique** : Il est crucial de consulter un professionnel de santé pour tout symptôme persistant. En attendant, maintenir un mode de vie sain (alimentation équilibrée, exercice, sommeil) renforce ton système immunitaire.",
                            "🧠 **Bien-être psychologique** : L'OMS définit la santé comme un état de bien-être physique, mental et social complet. Prendre soin de sa santé mentale est aussi important que sa santé physique."
                        ]
                    },
                    psychology: {
                        keywords: ['psychologie', 'comportement', 'mental', 'cerveau', 'émotion', 'stress'],
                        responses: [
                            "🧠 **Neurosciences** : Ton cerveau est plastique ! Il peut former de nouvelles connexions toute ta vie. C'est pourquoi les exercices de méditation et de gratitude sont si efficaces - ils remodèlent littéralement ton cerveau vers le positif.",
                            "🎭 **Psychologie comportementale** : Nos émotions influencent nos pensées, qui influencent nos actions. En changeant un élément de cette boucle, tu peux transformer ton expérience de vie."
                        ]
                    },
                    technology: {
                        keywords: ['technologie', 'internet', 'intelligence artificielle', 'ia', 'ordinateur', 'digital'],
                        responses: [
                            "🤖 **Intelligence Artificielle** : L'IA comme moi utilise des algorithmes pour comprendre et répondre aux émotions humaines. Nous analysons les patterns linguistiques pour offrir un support personnalisé, mais nous ne remplaçons jamais les relations humaines authentiques.",
                            "💻 **Bien-être numérique** : Il est important de maintenir un équilibre avec la technologie. Des pauses régulières, la déconnexion avant le coucher, et des interactions humaines réelles sont essentielles."
                        ]
                    },
                    science: {
                        keywords: ['science', 'recherche', 'étude', 'scientifique', 'découverte'],
                        responses: [
                            "🔬 **Recherche en bien-être** : Des études récentes montrent que la méditation de pleine conscience peut réduire l'anxiété de 60% et améliorer la concentration. La neuroplasticité permet au cerveau de se reconfigurer positivement.",
                            "📊 **Science du bonheur** : Les recherches en psychologie positive identifient 5 piliers du bien-être : émotions positives, engagement, relations, sens, et accomplissement (modèle PERMA de Seligman)."
                        ]
                    },
                    general: [
                        "🌍 **Accès aux informations** : Je peux t'aider sur de nombreux sujets ! Santé mentale, sciences, technologie, développement personnel... Pose-moi des questions spécifiques et je ferai de mon mieux pour t'éclairer.",
                        "📚 **Apprentissage continu** : Je m'appuie sur une vaste base de connaissances pour t'informer. Pour des informations très spécialisées ou médicales, n'hésite pas à consulter des sources officielles ou des experts."
                    ]
                };

                // Trouver le domaine le plus pertinent
                let bestMatch = 'general';
                let maxMatches = 0;
                
                Object.keys(knowledgeBase).forEach(domain => {
                    if (domain !== 'general' && knowledgeBase[domain].keywords) {
                        const matches = knowledgeBase[domain].keywords.filter(keyword => 
                            lowerMessage.includes(keyword)
                        ).length;
                        if (matches > maxMatches) {
                            maxMatches = matches;
                            bestMatch = domain;
                        }
                    }
                });

                let response;
                if (bestMatch === 'general') {
                    response = knowledgeBase.general[Math.floor(Math.random() * knowledgeBase.general.length)];
                } else {
                    response = knowledgeBase[bestMatch].responses[Math.floor(Math.random() * knowledgeBase[bestMatch].responses.length)];
                }

                const personalityIntros = {
                    confident: "Excellente question ! Laisse-moi partager mes connaissances avec toi :",
                    friend: "Oh, c'est intéressant ce que tu demandes ! Voici ce que je sais :",
                    teacher: "Très bonne question ! Permettez-moi de vous expliquer :",
                    coach: "Super question ! On va apprendre ensemble !"
                };

                return `${personalityIntros[personality] || personalityIntros.friend}\n\n${response}\n\n🤔 Tu as d'autres questions sur ce sujet ?`;
            }

            // Répondre aux questions générales
            generateQuestionResponse(message, personality) {
                const lowerMessage = message.toLowerCase();
                
                // Questions fréquentes et leurs réponses
                const faqResponses = {
                    'comment ça va': "Je vais très bien, merci ! 😊 Et toi, comment te sens-tu aujourd'hui ?",
                    'qui es-tu': "Je suis MINA, ton assistante IA dédiée au bien-être mental ! 🤖💚 Je suis là pour t'écouter, te conseiller et t'accompagner dans ton parcours de bien-être.",
                    'que peux-tu faire': "Je peux faire plein de choses ! 🌟 Te donner des conseils, proposer des exercices de bien-être, répondre à tes questions, analyser tes émotions, et surtout t'écouter sans jugement. Je suis polyvalente !",
                    'comment tu fonctionnes': "🧠 Je fonctionne grâce à l'intelligence artificielle ! J'analyse tes messages pour comprendre tes émotions et besoins, puis je génère des réponses personnalisées basées sur ma formation en psychologie et bien-être.",
                    'pourquoi mindly': "MINDLY a été créé pour démocratiser l'accès au bien-être mental 🌱 Notre mission est d'offrir un soutien bienveillant et des outils pratiques à tous, partout et à tout moment."
                };

                // Chercher une correspondance
                let response = null;
                Object.keys(faqResponses).forEach(question => {
                    if (lowerMessage.includes(question)) {
                        response = faqResponses[question];
                    }
                });

                // Réponse générale si pas de correspondance
                if (!response) {
                    const genericResponses = [
                        "C'est une excellente question ! 🤔 Peux-tu me donner plus de détails pour que je puisse mieux t'aider ?",
                        "Intéressant ! 💭 J'aimerais en savoir plus sur ce qui t'amène à me poser cette question.",
                        "Je vois que tu t'interroges sur quelque chose d'important. 🌟 Raconte-moi en plus pour que je puisse t'apporter la meilleure réponse.",
                        "Ta question mérite une réponse réfléchie ! 💡 Peux-tu me donner un peu plus de contexte ?"
                    ];
                    response = genericResponses[Math.floor(Math.random() * genericResponses.length)];
                }

                const personalityPrefixes = {
                    confident: "Bien sûr, je peux répondre à ça ! ",
                    friend: "Oh, bonne question copain ! ",
                    teacher: "Excellente question, élève ! ",
                    coach: "Super question, champion ! "
                };

                return `${personalityPrefixes[personality] || ''}${response}`;
            }

            // Gérer les conversations casualles
            generateConversationResponse(message, personality) {
                const lowerMessage = message.toLowerCase();
                
                const conversationResponses = {
                    confident: {
                        greeting: ["Salut ! Je suis ravie de te parler ! 😊", "Hello ! Comment ça se passe pour toi ?", "Coucou ! Dis-moi tout !"],
                        casual: ["Je t'écoute ! Raconte-moi ce qui se passe dans ta vie.", "C'est cool de discuter avec toi ! 😄", "J'adore nos conversations ! Tu me fais quoi de beau ?"]
                    },
                    friend: {
                        greeting: ["Coucou mon pote ! 🤗", "Salut ! Ça me fait plaisir de te voir !", "Hello ! Comment va ma personne préférée ?"],
                        casual: ["Raconte-moi tout ! Je suis là pour toi ❤️", "Oh dis-moi, qu'est-ce qui t'arrive ?", "Tu sais que tu peux tout me dire !"]
                    },
                    teacher: {
                        greeting: ["Bonjour ! Ravi de vous retrouver. 📚", "Salut ! Prêt pour notre échange aujourd'hui ?", "Bonjour ! Comment allez-vous ?"],
                        casual: ["Que souhaitez-vous explorer aujourd'hui ?", "J'aimerais en apprendre plus sur votre état d'esprit.", "Partagez-moi vos réflexions du moment."]
                    },
                    coach: {
                        greeting: ["Yo champion ! 💪", "Salut guerrier ! Prêt à conquérir la journée ?", "Hello superstar ! Comment ça va ?"],
                        casual: ["Allez, raconte-moi tes victoires du jour ! 🏆", "Comment tu te sens aujourd'hui, champion ?", "Dis-moi tout ! On va faire du super boulot ensemble !"]
                    }
                };

                const personalityType = personality || 'friend';
                const isGreeting = ['salut', 'bonjour', 'bonsoir', 'hello', 'coucou'].some(word => lowerMessage.includes(word));
                
                const responses = isGreeting ? 
                    conversationResponses[personalityType].greeting : 
                    conversationResponses[personalityType].casual;
                
                return responses[Math.floor(Math.random() * responses.length)];
            }

            // Modération proactive des discussions communautaires
            moderateCommunityPost(text) {
                let filteredText = text;
                let hasProfanity = false;
                let needsModeration = false;

                // Filtrer le langage inapproprié avec bienveillance
                this.profanityList.forEach(word => {
                    const regex = new RegExp(`\\b${word.replace(/[.*+?^${}()|[\]\\]/g, '\\$&')}\\b`, 'gi');
                    if (regex.test(filteredText)) {
                        hasProfanity = true;
                        filteredText = filteredText.replace(regex, '***');
                    }
                });

                if (hasProfanity) {
                    needsModeration = true;
                    this.showModerationMessage();
                }

                return {
                    originalText: text,
                    filteredText: filteredText,
                    needsModeration: needsModeration,
                    approved: !needsModeration
                };
            }

            // Message de modération bienveillant
            showModerationMessage() {
                showNotification(
                    "💚 MINA - Modération: Je comprends tes émotions, mais essayons de garder nos échanges bienveillants pour tous. Merci ! 🌈", 
                    'info'
                );
            }

            // Modération proactive
            moderateMessage(message, context = 'chat') {
                const analysis = this.filterContent(message);
                
                if (analysis.hasProfanity) {
                    this.showModerationAlert('Langage inapproprié détecté', 'warning');
                    this.logModerationEvent('profanity', analysis.originalText, context);
                }
                
                if (analysis.hasWarning) {
                    this.showSupportAlert();
                }
                
                return analysis;
            }

            // Alert de modération
            showModerationAlert(message, type) {
                showNotification(`🛡️ Modération IA: ${message}`, type);
            }

            // Alert de support pour détresse
            showSupportAlert() {
                showCustomModal({
                    title: '💚 Support MINDLY',
                    content: `
                        <div style="padding: 20px; text-align: center;">
                            <div style="font-size: 48px; margin-bottom: 15px;">🤗</div>
                            <h3 style="color: var(--primary-color); margin-bottom: 15px;">Nous sommes là pour vous</h3>
                            <p style="color: var(--text-secondary); margin-bottom: 20px; line-height: 1.5;">
                                J'ai détecté que vous pourriez avoir besoin de soutien. Votre bien-être est important.
                            </p>
                            
                            <div style="background: var(--background-light); padding: 15px; border-radius: 12px; margin-bottom: 20px;">
                                <h4 style="color: var(--text-primary); margin-bottom: 10px;">Resources d'aide :</h4>
                                <div style="text-align: left; font-size: 14px; color: var(--text-secondary);">
                                    • <strong>SOS Amitié:</strong> 09 72 39 40 50<br>
                                    • <strong>Suicide Ecoute:</strong> 01 45 39 40 00<br>
                                    • <strong>Fil Santé Jeunes:</strong> 0800 235 236
                                </div>
                            </div>
                            
                            <div style="display: flex; gap: 10px; justify-content: center; flex-wrap: wrap;">
                                <button onclick="aiModeration.startSupportChat(); closeModal();" 
                                        style="background: var(--primary-color); color: white; border: none; padding: 10px 20px; border-radius: 15px; font-weight: 600; cursor: pointer;">
                                    Parler avec l'IA
                                </button>
                                <button onclick="closeModal();" 
                                        style="background: var(--background-medium); color: var(--text-primary); border: none; padding: 10px 20px; border-radius: 15px; font-weight: 600; cursor: pointer;">
                                    Plus tard
                                </button>
                            </div>
                        </div>
                    `
                });
            }

            // Chat de support avec IA
            startSupportChat() {
                showScreen('chat-screen');
                setTimeout(() => {
                    this.showAIResponse("Bonjour, je suis là pour vous écouter sans jugement. Comment vous sentez-vous aujourd'hui ? 💚");
                }, 500);
            }

            // Log des événements de modération
            logModerationEvent(type, content, context) {
                const event = {
                    timestamp: Date.now(),
                    date: new Date().toLocaleDateString('fr-FR'),
                    type: type,
                    content: content.substring(0, 100),
                    context: context,
                    userId: this.isAnonymousMode ? 'anonymous' : 'user'
                };
                
                const logs = JSON.parse(localStorage.getItem('mindly-moderation-logs') || '[]');
                logs.push(event);
                
                // Garder seulement les 50 derniers événements
                if (logs.length > 50) {
                    logs.splice(0, logs.length - 50);
                }
                
                localStorage.setItem('mindly-moderation-logs', JSON.stringify(logs));
            }

            // Mode anonyme
            toggleAnonymousMode() {
                this.isAnonymousMode = !this.isAnonymousMode;
                localStorage.setItem('mindly-anonymous', this.isAnonymousMode.toString());
                
                const status = this.isAnonymousMode ? 'activé' : 'désactivé';
                showNotification(`Mode anonyme ${status} 🕶️`, 'info');
                
                // Mettre à jour l'interface
                this.updateAnonymousUI();
            }

            // Mise à jour UI mode anonyme
            updateAnonymousUI() {
                const profileName = document.querySelector('.profile-name');
                const avatar = document.querySelector('.avatar');
                
                if (this.isAnonymousMode) {
                    if (profileName) profileName.textContent = 'Utilisateur Anonyme';
                    if (avatar) avatar.textContent = '👤';
                } else {
                    if (profileName) profileName.textContent = 'Utilisateur';
                    if (avatar) avatar.textContent = 'U';
                }
            }

            // Interface de chat avec MINA améliorée
            showAIResponse(message, emotions = []) {
                const chatArea = document.querySelector('.chat-container');
                if (chatArea) {
                    const aiMessage = document.createElement('div');
                    
                    // Emoji basé sur l'émotion détectée
                    let aiEmoji = "🤖";
                    if (emotions.includes('tristesse')) aiEmoji = "💙";
                    else if (emotions.includes('anxiété')) aiEmoji = "🌿";
                    else if (emotions.includes('colère')) aiEmoji = "🔥";
                    else if (emotions.includes('fatigue')) aiEmoji = "☁️";
                    else if (emotions.includes('espoir')) aiEmoji = "🌟";
                    else aiEmoji = "💚";

                    aiMessage.style.cssText = `
                        background: linear-gradient(135deg, var(--primary-color), var(--primary-light));
                        color: white;
                        padding: 20px;
                        border-radius: 20px 20px 5px 20px;
                        margin: 15px 0;
                        animation: slideIn 0.3s ease;
                        box-shadow: 0 4px 15px rgba(0,0,0,0.15);
                        position: relative;
                        max-width: 85%;
                        margin-left: 0;
                    `;
                    aiMessage.innerHTML = `
                        <div style="display: flex; align-items: center; margin-bottom: 12px;">
                            <div style="
                                width: 35px; 
                                height: 35px; 
                                background: rgba(255,255,255,0.2); 
                                border-radius: 50%; 
                                display: flex; 
                                align-items: center; 
                                justify-content: center; 
                                margin-right: 12px;
                                font-size: 18px;
                                border: 2px solid rgba(255,255,255,0.3);
                            ">${aiEmoji}</div>
                            <div>
                                <strong style="font-size: 16px;">MINA</strong>
                                <div style="font-size: 11px; opacity: 0.8;">Ton amie virtuelle 💚</div>
                            </div>
                        </div>
                        <div style="line-height: 1.6; font-size: 15px;">${message.replace(/\n/g, '<br>')}</div>
                        <div style="
                            margin-top: 10px; 
                            font-size: 10px; 
                            opacity: 0.7; 
                            text-align: right;
                        ">${new Date().toLocaleTimeString('fr-FR', {hour: '2-digit', minute: '2-digit'})}</div>
                    `;
                    
                    chatArea.appendChild(aiMessage);
                    
                    // Animation d'apparition
                    setTimeout(() => {
                        aiMessage.style.transform = 'translateY(0)';
                        aiMessage.style.opacity = '1';
                    }, 100);
                }
            }

            // Conseils personnalisés selon l'humeur
            getPersonalizedAdvice(mood) {
                const advice = {
                    'ÉPANOUI': [
                        "Magnifique ! Profitez de cette belle énergie pour inspirer d'autres personnes 🌟",
                        "C'est le moment parfait pour essayer quelque chose de nouveau !",
                        "Votre joie est contagieuse, partagez-la avec votre entourage 😊"
                    ],
                    'SEREIN': [
                        "Cette sérénité est précieuse. Prenez un moment pour la savourer 🧘‍♀️",
                        "Peut-être est-ce le bon moment pour méditer ou lire ?",
                        "Votre calme intérieur peut aider d'autres personnes aujourd'hui"
                    ],
                    'NEUTRE': [
                        "C'est normal de se sentir neutre parfois. Soyez patient avec vous-même ⚖️",
                        "Que diriez-vous d'une petite activité qui vous fait plaisir ?",
                        "Rappelez-vous une chose positive de votre journée"
                    ],
                    'FATIGUÉ': [
                        "Votre corps et votre esprit ont besoin de repos. Prenez soin de vous 💜",
                        "Une courte sieste ou un moment de détente pourrait vous aider",
                        "Rappelez-vous : se reposer n'est pas de la paresse, c'est de l'auto-soin"
                    ],
                    'ANXIEUX': [
                        "L'anxiété est temporaire. Respirons ensemble, tout va bien se passer 🤲",
                        "Essayez la technique 4-7-8 : inspirez 4s, retenez 7s, expirez 8s",
                        "Concentrez-vous sur ce que vous pouvez contrôler maintenant"
                    ],
                    'ÉNERGIQUE': [
                        "Fantastique ! Cette énergie est un cadeau, utilisez-la positivement ⚡",
                        "C'est le moment idéal pour faire de l'exercice ou un projet créatif",
                        "Canalisez cette énergie vers vos objectifs personnels"
                    ]
                };

                const moodAdvice = advice[mood] || advice['NEUTRE'];
                return moodAdvice[Math.floor(Math.random() * moodAdvice.length)];
            }
        }

        // Initialisation du système de modération IA
        const aiModeration = new AIModeration();

        // Fonctions pour l'interface de chat avec MINA
        function startChatWithMINA() {
            const welcomeMessage = document.getElementById('chat-welcome');
            const conversationArea = document.getElementById('conversation-area');
            
            if (welcomeMessage && conversationArea) {
                welcomeMessage.style.display = 'none';
                conversationArea.style.display = 'flex';
                
                // Message d'accueil de MINA
                setTimeout(() => {
                    const welcomeMsg = aiModeration.generateEmpathicResponse("Bonjour ! Je suis ravie de faire ta connaissance.", []);
                    addMessageToChat(welcomeMsg, 'ai', '💚');
                }, 500);
                
                // Focus sur l'input
                const chatInput = document.getElementById('chat-input');
                if (chatInput) {
                    chatInput.focus();
                }
            }
        }

        function sendMessageToMINA() {
            const chatInput = document.getElementById('chat-input');
            const sendButton = document.getElementById('send-button');
            
            if (!chatInput || !chatInput.value.trim()) return;
            
            const userMessage = chatInput.value.trim();
            
            // Ajouter le message de l'utilisateur
            addMessageToChat(userMessage, 'user', '👤');
            
            // Vider l'input
            chatInput.value = '';
            updateCharacterCount();
            
            // Désactiver temporairement l'envoi
            sendButton.disabled = true;
            
            // Afficher l'indicateur de frappe
            showTypingIndicator();
            
            // Générer la réponse de MINA après un délai réaliste
            setTimeout(() => {
                hideTypingIndicator();
                const minaResponse = aiModeration.chatWithMINA(userMessage);
                const emotions = aiModeration.analyzeEmotion(userMessage);
                
                // Choisir l'emoji selon le contexte et les émotions
                let emoji = '💚';
                if (emotions.emotions && emotions.emotions.length > 0) {
                    if (emotions.emotions.includes('tristesse')) emoji = '💙';
                    else if (emotions.emotions.includes('anxiété')) emoji = '🌿';
                    else if (emotions.emotions.includes('colère')) emoji = '🔥';
                    else if (emotions.emotions.includes('fatigue')) emoji = '☁️';
                    else if (emotions.emotions.includes('espoir')) emoji = '🌟';
                    else if (emotions.emotions.includes('solitude')) emoji = '🤗';
                }
                
                // Ajouter des emojis spéciaux pour certains types de réponses
                if (minaResponse.includes('**Exercice')) emoji = '🧘‍♀️';
                else if (minaResponse.includes('conseil')) emoji = '💡';
                else if (minaResponse.includes('question')) emoji = '🤔';
                else if (minaResponse.includes('recherche') || minaResponse.includes('Science')) emoji = '🔬';
                
                addMessageToChat(minaResponse, 'ai', emoji);
                sendButton.disabled = false;
            }, Math.random() * 2000 + 1500); // 1.5-3.5 secondes
        }

        function addMessageToChat(message, sender, emoji = '') {
            const messagesContainer = document.getElementById('messages-container');
            if (!messagesContainer) return;
            
            const messageDiv = document.createElement('div');
            messageDiv.className = `chat-message ${sender}`;
            
            const time = new Date().toLocaleTimeString('fr-FR', {
                hour: '2-digit',
                minute: '2-digit'
            });
            
            // Formater le message pour une meilleure présentation
            const formattedMessage = formatChatMessage(message);
            
            if (sender === 'ai') {
                messageDiv.innerHTML = `
                    <div class="message-header">
                        <div class="message-avatar">${emoji}</div>
                        <span><strong>MINA</strong> • Ton assistante IA</span>
                    </div>
                    <div class="message-content ai-formatted">${formattedMessage}</div>
                    <div class="message-time">${time}</div>
                `;
            } else {
                messageDiv.innerHTML = `
                    <div class="message-header">
                        <div class="message-avatar">${emoji}</div>
                        <span>Toi</span>
                    </div>
                    <div class="message-content user-message">${message.replace(/\n/g, '<br>')}</div>
                    <div class="message-time">${time}</div>
                `;
            }

            messagesContainer.appendChild(messageDiv);
            
            // Animation d'apparition
            setTimeout(() => {
                messageDiv.style.opacity = '1';
                messageDiv.style.transform = 'translateY(0)';
            }, 50);
            
            // Scroll vers le bas
            messagesContainer.scrollTop = messagesContainer.scrollHeight;
        }

        // Formater les messages avec du markdown-like pour une meilleure présentation
        function formatChatMessage(message) {
            let formatted = message;
            
            // Gras : **texte** → <strong>texte</strong>
            formatted = formatted.replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>');
            
            // Titres avec emojis
            formatted = formatted.replace(/^(.*?)\s*\*\*(.*?)\*\*\s*:/gm, '<div class="message-title">$1 <strong>$2</strong></div>');
            
            // Listes numérotées
            formatted = formatted.replace(/^(\d+)\.\s(.+)$/gm, '<div class="numbered-item"><span class="number">$1.</span> $2</div>');
            
            // Listes à puces (•)
            formatted = formatted.replace(/^•\s(.+)$/gm, '<div class="bullet-item">• $1</div>');
            
            // Sections avec emojis (début de ligne avec emoji)
            formatted = formatted.replace(/^([🌿🧘‍♀️💙🌱🔥💨⭐🌈🤝💝🕰️📅🎯🔄🏥🧠🎭🤖💻🔬📊🌍📚].+?):/gm, '<div class="emoji-section">$1:</div>');
            
            // Conseils/notes importantes avec 💡
            formatted = formatted.replace(/💡\s*(.+)/g, '<div class="tip-highlight">💡 $1</div>');
            
            // Support émotionnel avec 💚
            formatted = formatted.replace(/💚\s*(.+)/g, '<div class="emotional-support">💚 $1</div>');
            
            // Remplacer les sauts de ligne
            formatted = formatted.replace(/\n/g, '<br>');
            
            return formatted;
        }

        function showTypingIndicator() {
            const typingIndicator = document.getElementById('typing-indicator');
            if (typingIndicator) {
                typingIndicator.style.display = 'flex';
            }
        }

        function hideTypingIndicator() {
            const typingIndicator = document.getElementById('typing-indicator');
            if (typingIndicator) {
                typingIndicator.style.display = 'none';
            }
        }

        function updateCharacterCount() {
            const chatInput = document.getElementById('chat-input');
            const charCount = document.getElementById('char-count');
            
            if (chatInput && charCount) {
                charCount.textContent = chatInput.value.length;
                
                // Changer la couleur si proche de la limite
                if (chatInput.value.length > 450) {
                    charCount.style.color = '#ff6b6b';
                } else if (chatInput.value.length > 400) {
                    charCount.style.color = '#ffa726';
                } else {
                    charCount.style.color = 'rgba(255,255,255,0.6)';
                }
            }
        }

        // Fonctions pour le tableau de bord unifié
        function setQuickMood(mood) {
            // Sélectionner le bouton d'humeur
            document.querySelectorAll('.quick-mood-btn').forEach(btn => {
                btn.classList.remove('selected');
            });
            document.querySelector(`[data-mood="${mood}"]`).classList.add('selected');
            
            // Sauvegarder l'humeur
            const moodData = {
                mood: mood,
                timestamp: Date.now(),
                date: new Date().toISOString().split('T')[0]
            };
            
            let moods = JSON.parse(localStorage.getItem('mindly-moods') || '[]');
            moods.push(moodData);
            localStorage.setItem('mindly-moods', JSON.stringify(moods));
            
            // Feedback visuel
            showQuickNotification(`Humeur "${mood}" enregistrée ! 💚`);
            
            // Mettre à jour le thème si nécessaire
            applyThemeForMood(mood);
        }

        function openQuickChat() {
            // Passer directement au chat avec MINA
            navigateToScreen('chat-screen');
            setTimeout(() => {
                startChatWithMINA();
            }, 300);
        }

        function startQuickMeditation() {
            showQuickMeditation();
        }

        function showQuickMeditation() {
            const modal = createQuickModal('Méditation Express', `
                <div class="quick-meditation">
                    <div class="meditation-timer">
                        <div class="timer-circle">
                            <div class="timer-number" id="meditation-timer">5:00</div>
                        </div>
                    </div>
                    <div class="meditation-instructions">
                        <p>Prenez une position confortable et fermez les yeux.</p>
                        <p>Concentrez-vous sur votre respiration.</p>
                    </div>
                    <div class="meditation-controls">
                        <button class="meditation-btn start" onclick="startMeditationTimer()">Commencer</button>
                        <button class="meditation-btn pause" onclick="pauseMeditationTimer()" style="display:none;">Pause</button>
                        <button class="meditation-btn stop" onclick="stopMeditationTimer()">Arrêter</button>
                    </div>
                </div>
            `);
        }

        function startBreathingExercise() {
            showBreathingExercise();
        }

        function showBreathingExercise() {
            const modal = createQuickModal('Exercice de Respiration', `
                <div class="breathing-exercise">
                    <div class="breathing-circle" id="breathing-circle">
                        <div class="breathing-text" id="breathing-text">Préparez-vous</div>
                    </div>
                    <div class="breathing-instructions">
                        <p>Suivez le cercle avec votre respiration</p>
                    </div>
                    <div class="breathing-controls">
                        <button class="breathing-btn" onclick="startBreathingCycle()">Commencer</button>
                        <button class="breathing-btn" onclick="closeModal()">Terminer</button>
                    </div>
                </div>
            `);
        }

        function openQuickJournal() {
            showQuickJournal();
        }

        function showQuickJournal() {
            const modal = createQuickModal('Journal Express', `
                <div class="quick-journal">
                    <textarea id="quick-journal-text" placeholder="Comment s'est passée ta journée ? Qu'est-ce qui t'a marqué ?" rows="6"></textarea>
                    <div class="journal-prompts">
                        <div class="prompt" onclick="addPromptToJournal('gratitude')">💚 Ce pour quoi je suis reconnaissant(e)</div>
                        <div class="prompt" onclick="addPromptToJournal('achievement')">🎯 Ce que j'ai accompli aujourd'hui</div>
                        <div class="prompt" onclick="addPromptToJournal('learning')">📚 Ce que j'ai appris</div>
                    </div>
                    <div class="journal-controls">
                        <button class="journal-btn save" onclick="saveQuickJournal()">Sauvegarder</button>
                        <button class="journal-btn cancel" onclick="closeModal()">Annuler</button>
                    </div>
                </div>
            `);
        }

        function showQuickGoals() {
            const goals = JSON.parse(localStorage.getItem('mindly-goals') || '[]');
            let goalsHtml = '';
            
            if (goals.length === 0) {
                goalsHtml = '<p>Aucun objectif défini. Créez votre premier objectif !</p>';
            } else {
                goalsHtml = goals.map(goal => `
                    <div class="quick-goal-item">
                        <div class="goal-text">${goal.text}</div>
                        <div class="goal-progress">
                            <div class="progress-bar">
                                <div class="progress-fill" style="width: ${goal.progress || 0}%"></div>
                            </div>
                            <span class="progress-percent">${goal.progress || 0}%</span>
                        </div>
                    </div>
                `).join('');
            }
            
            const modal = createQuickModal('Mes Objectifs', `
                <div class="quick-goals">
                    <div class="goals-list">${goalsHtml}</div>
                    <div class="add-goal-section">
                        <input type="text" id="new-goal-input" placeholder="Nouvel objectif..." maxlength="100">
                        <button class="goal-btn add" onclick="addQuickGoal()">Ajouter</button>
                    </div>
                </div>
            `);
        }

        function shareFeeling() {
            showQuickShare();
        }

        function showQuickShare() {
            const modal = createQuickModal('Partager avec la communauté', `
                <div class="quick-share">
                    <textarea id="share-text" placeholder="Comment te sens-tu ? Partage ton état d'esprit avec la communauté..." rows="4" maxlength="280"></textarea>
                    <div class="share-options">
                        <label class="share-option">
                            <input type="checkbox" id="anonymous-share" checked>
                            <span>Partager anonymement</span>
                        </label>
                    </div>
                    <div class="character-counter">
                        <span id="share-char-count">0</span>/280
                    </div>
                    <div class="share-controls">
                        <button class="share-btn publish" onclick="publishCommunityPost()">Publier</button>
                        <button class="share-btn cancel" onclick="closeModal()">Annuler</button>
                    </div>
                </div>
            `);
            
            // Ajouter le compteur de caractères
            const textarea = document.getElementById('share-text');
            const counter = document.getElementById('share-char-count');
            textarea.addEventListener('input', () => {
                counter.textContent = textarea.value.length;
                if (textarea.value.length > 250) {
                    counter.style.color = '#ff6b6b';
                } else {
                    counter.style.color = 'rgba(255,255,255,0.7)';
                }
            });
        }

        function exploreCommunity() {
            navigateToScreen('community-screen');
        }

        function getNewQuote() {
            const quotes = [
                { text: "La sérénité n'est pas l'absence de tempête, mais la paix au milieu de la tourmente.", author: "Proverbe zen" },
                { text: "Chaque jour est une nouvelle chance de changer ta vie.", author: "Buddha" },
                { text: "Le bonheur n'est pas quelque chose de tout fait. Il vient de tes propres actions.", author: "Dalaï Lama" },
                { text: "La force ne vient pas des capacités physiques, elle vient d'une volonté indomptable.", author: "Gandhi" },
                { text: "Tu es plus courageux que tu ne le crois, plus fort que tu ne le parais et plus aimé que tu ne le penses.", author: "A.A. Milne" }
            ];
            
            const randomQuote = quotes[Math.floor(Math.random() * quotes.length)];
            document.querySelector('.quote-text').textContent = `"${randomQuote.text}"`;
            document.querySelector('.quote-author').textContent = `— ${randomQuote.author}`;
        }

        function createQuickModal(title, content) {
            const modal = document.createElement('div');
            modal.className = 'quick-modal-overlay';
            modal.innerHTML = `
                <div class="quick-modal">
                    <div class="modal-header">
                        <h3>${title}</h3>
                        <button class="modal-close" onclick="closeModal()">×</button>
                    </div>
                    <div class="modal-content">
                        ${content}
                    </div>
                </div>
            `;
            
            document.body.appendChild(modal);
            
            // Animation d'apparition
            setTimeout(() => {
                modal.style.opacity = '1';
                modal.querySelector('.quick-modal').style.transform = 'scale(1)';
            }, 10);
            
            return modal;
        }

        function closeModal() {
            const modal = document.querySelector('.quick-modal-overlay');
            if (modal) {
                modal.style.opacity = '0';
                modal.querySelector('.quick-modal').style.transform = 'scale(0.8)';
                setTimeout(() => {
                    modal.remove();
                }, 300);
            }
        }

        // Fonctions pour le menu paramètres


        function showSettings() {
            closeSettingsMenu();
            const modal = createQuickModal('Paramètres', `
                <div class="settings-panel">
                    <div class="setting-item">
                        <div class="setting-label">Notifications</div>
                        <label class="switch">
                            <input type="checkbox" checked>
                            <span class="slider"></span>
                        </label>
                    </div>
                    <div class="setting-item">
                        <div class="setting-label">Mode sombre</div>
                        <label class="switch">
                            <input type="checkbox">
                            <span class="slider"></span>
                        </label>
                    </div>
                    <div class="setting-item">
                        <div class="setting-label">Rappels quotidiens</div>
                        <label class="switch">
                            <input type="checkbox" checked>
                            <span class="slider"></span>
                        </label>
                    </div>
                    <div class="setting-item">
                        <div class="setting-label">Langue</div>
                        <select class="setting-select">
                            <option value="fr">Français</option>
                            <option value="en">English</option>
                            <option value="es">Español</option>
                        </select>
                    </div>
                </div>
            `);
        }

        function showPrivacy() {
            closeSettingsMenu();
            const modal = createQuickModal('Confidentialité', `
                <div class="privacy-panel">
                    <div class="privacy-item">
                        <h4>🔒 Tes données sont sécurisées</h4>
                        <p>Toutes tes informations sont chiffrées et stockées localement sur ton appareil.</p>
                    </div>
                    <div class="privacy-item">
                        <h4>🤐 Mode anonyme</h4>
                        <p>Tu peux toujours partager anonymement dans la communauté.</p>
                    </div>
                    <div class="privacy-item">
                        <h4>🗑️ Suppression des données</h4>
                        <button class="privacy-btn danger" onclick="clearAllData()">Effacer toutes mes données</button>
                    </div>
                </div>
            `);
        }

        function showProfile() {
            closeSettingsMenu();
            const modal = createQuickModal('Mon Compte', `
                <div class="profile-panel">
                    <div class="profile-avatar">
                        <div class="avatar-circle">👤</div>
                        <button class="change-avatar-btn">Changer l'avatar</button>
                    </div>
                    <div class="profile-info">
                        <div class="info-item">
                            <label>Prénom</label>
                            <input type="text" placeholder="Ton prénom" value="">
                        </div>
                        <div class="info-item">
                            <label>Objectif principal</label>
                            <select>
                                <option>Réduire le stress</option>
                                <option>Améliorer le sommeil</option>
                                <option>Développer la confiance</option>
                                <option>Méditer régulièrement</option>
                            </select>
                        </div>
                        <button class="save-profile-btn">Sauvegarder</button>
                    </div>
                </div>
            `);
        }

        function showHelp() {
            closeSettingsMenu();
            const modal = createQuickModal('Aide', `
                <div class="help-panel">
                    <div class="help-section">
                        <h4>🤔 Comment utiliser MINDLY ?</h4>
                        <p>1. Note ton humeur quotidienne</p>
                        <p>2. Parle avec MINA quand tu en as besoin</p>
                        <p>3. Médite ou respire pour te détendre</p>
                        <p>4. Écris dans ton journal</p>
                        <p>5. Partage avec la communauté</p>
                    </div>
                    <div class="help-section">
                        <h4>💚 MINA ne répond pas ?</h4>
                        <p>Assure-toi d'avoir une connexion internet active.</p>
                    </div>
                    <div class="help-section">
                        <h4>📞 Besoin d'aide urgente ?</h4>
                        <p>🆘 Ligne d'écoute : 3114 (gratuit, 24h/24)</p>
                        <p>🏥 Urgences : 15</p>
                    </div>
                </div>
            `);
        }

        function logout() {
            closeSettingsMenu();
            if (confirm('Es-tu sûr(e) de vouloir te déconnecter ?')) {
                // Rediriger vers la page de connexion
                showQuickNotification('Déconnexion réussie');
                // Ici tu peux ajouter la logique de déconnexion
            }
        }

        function closeSettingsMenu() {
            const dropdown = document.getElementById('settings-dropdown');
            if (dropdown) {
                dropdown.classList.remove('show');
            }
        }

        // Fonctions de navigation principales
        function navigateToScreen(screenId) {
            // Masquer tous les écrans
            document.querySelectorAll('.screen-content').forEach(screen => {
                screen.classList.remove('active');
            });
            
            // Afficher l'écran demandé
            const targetScreen = document.getElementById(screenId);
            if (targetScreen) {
                targetScreen.classList.add('active');
            }
            
            // Mettre à jour la navigation active
            updateActiveTab(screenId);
        }

        function updateActiveTab(screenId) {
            const tabMap = {
                'home-screen': 0,
                'mood-screen': 1, 
                'chat-screen': 2,
                'community-screen': 3,
                'faq-screen': 4,
                'profile-screen': 5
            };
            
            document.querySelectorAll('.tab-item').forEach((tab, index) => {
                tab.classList.remove('active');
                if (index === tabMap[screenId]) {
                    tab.classList.add('active');
                }
            });
        }

        // Fonction pour appliquer les thèmes selon l'humeur
        function applyThemeForMood(mood) {
            const root = document.documentElement;
            const themes = {
                'epanoui': {
                    primary: '#4CAF50',
                    light: '#66BB6A',
                    bg: 'linear-gradient(135deg, #4CAF50, #66BB6A)'
                },
                'serein': {
                    primary: '#2196F3', 
                    light: '#42A5F5',
                    bg: 'linear-gradient(135deg, #2196F3, #42A5F5)'
                },
                'neutre': {
                    primary: '#9E9E9E',
                    light: '#BDBDBD', 
                    bg: 'linear-gradient(135deg, #9E9E9E, #BDBDBD)'
                },
                'fatigue': {
                    primary: '#795548',
                    light: '#8D6E63',
                    bg: 'linear-gradient(135deg, #795548, #8D6E63)'
                },
                'anxieux': {
                    primary: '#FF9800',
                    light: '#FFB74D',
                    bg: 'linear-gradient(135deg, #FF9800, #FFB74D)'
                },
                'energique': {
                    primary: '#E91E63',
                    light: '#F06292', 
                    bg: 'linear-gradient(135deg, #E91E63, #F06292)'
                }
            };
            
            const theme = themes[mood] || themes['epanoui'];
            root.style.setProperty('--primary-color', theme.primary);
            root.style.setProperty('--primary-light', theme.light);
            root.style.setProperty('--background-light', theme.bg);
        }

        // Ajouter les fonctions manquantes pour les modals
        function addPromptToJournal(promptType) {
            const textarea = document.getElementById('quick-journal-text');
            if (!textarea) return;
            
            const prompts = {
                'gratitude': '💚 Ce pour quoi je suis reconnaissant(e) aujourd\'hui :\n',
                'achievement': '🎯 Ce que j\'ai accompli aujourd\'hui :\n', 
                'learning': '📚 Ce que j\'ai appris :\n'
            };
            
            const currentText = textarea.value;
            const newText = currentText + (currentText ? '\n\n' : '') + prompts[promptType];
            textarea.value = newText;
            textarea.focus();
        }

        function saveQuickJournal() {
            const textarea = document.getElementById('quick-journal-text');
            if (!textarea || !textarea.value.trim()) return;
            
            const entry = {
                text: textarea.value.trim(),
                date: new Date().toISOString().split('T')[0],
                timestamp: Date.now()
            };
            
            let journal = JSON.parse(localStorage.getItem('mindly-journal') || '[]');
            journal.push(entry);
            localStorage.setItem('mindly-journal', JSON.stringify(journal));
            
            showQuickNotification('Entrée de journal sauvegardée ! 📝');
            closeModal();
        }

        function addQuickGoal() {
            const input = document.getElementById('new-goal-input');
            if (!input || !input.value.trim()) return;
            
            const goal = {
                text: input.value.trim(),
                progress: 0,
                created: Date.now()
            };
            
            let goals = JSON.parse(localStorage.getItem('mindly-goals') || '[]');
            goals.push(goal);
            localStorage.setItem('mindly-goals', JSON.stringify(goals));
            
            input.value = '';
            showQuickNotification('Objectif ajouté ! 🎯');
            
            // Rafraîchir l'affichage
            showQuickGoals();
        }

        function publishCommunityPost() {
            const textarea = document.getElementById('share-text');
            const anonymousCheck = document.getElementById('anonymous-share');
            
            if (!textarea || !textarea.value.trim()) return;
            
            const post = {
                text: textarea.value.trim(),
                anonymous: anonymousCheck ? anonymousCheck.checked : true,
                timestamp: Date.now(),
                date: new Date().toISOString().split('T')[0]
            };
            
            let posts = JSON.parse(localStorage.getItem('mindly-community-posts') || '[]');
            posts.push(post);
            localStorage.setItem('mindly-community-posts', JSON.stringify(posts));
            
            showQuickNotification('Message partagé avec la communauté ! 👥');
            closeModal();
        }

        function clearAllData() {
            if (confirm('Êtes-vous sûr(e) de vouloir effacer toutes vos données ? Cette action est irréversible.')) {
                localStorage.clear();
                showQuickNotification('Toutes les données ont été supprimées');
                closeModal();
            }
        }

        // Event listeners pour la navigation
        function initializeNavigation() {
            document.querySelectorAll('.tab-item').forEach((tab, index) => {
                tab.addEventListener('click', () => {
                    const screens = ['home-screen', 'mood-screen', 'chat-screen', 'community-screen', 'faq-screen', 'profile-screen'];
                    navigateToScreen(screens[index]);
                });
            });
        }

        // Timer pour méditation
        let meditationTimer = null;
        let meditationSeconds = 300; // 5 minutes

        function startMeditationTimer() {
            const startBtn = document.querySelector('.meditation-btn.start');
            const pauseBtn = document.querySelector('.meditation-btn.pause');
            const timerDisplay = document.getElementById('meditation-timer');
            
            if (startBtn) startBtn.style.display = 'none';
            if (pauseBtn) pauseBtn.style.display = 'inline-block';
            
            meditationTimer = setInterval(() => {
                meditationSeconds--;
                
                const minutes = Math.floor(meditationSeconds / 60);
                const seconds = meditationSeconds % 60;
                if (timerDisplay) {
                    timerDisplay.textContent = `${minutes}:${seconds.toString().padStart(2, '0')}`;
                }
                
                if (meditationSeconds <= 0) {
                    stopMeditationTimer();
                    showQuickNotification('Méditation terminée ! 🧘‍♀️');
                }
            }, 1000);
        }

        function pauseMeditationTimer() {
            if (meditationTimer) {
                clearInterval(meditationTimer);
                meditationTimer = null;
            }
            
            const startBtn = document.querySelector('.meditation-btn.start');
            const pauseBtn = document.querySelector('.meditation-btn.pause');
            
            if (startBtn) startBtn.style.display = 'inline-block';
            if (pauseBtn) pauseBtn.style.display = 'none';
        }

        function stopMeditationTimer() {
            if (meditationTimer) {
                clearInterval(meditationTimer);
                meditationTimer = null;
            }
            
            meditationSeconds = 300;
            const timerDisplay = document.getElementById('meditation-timer');
            if (timerDisplay) timerDisplay.textContent = '5:00';
            
            const startBtn = document.querySelector('.meditation-btn.start');
            const pauseBtn = document.querySelector('.meditation-btn.pause');
            
            if (startBtn) startBtn.style.display = 'inline-block';
            if (pauseBtn) pauseBtn.style.display = 'none';
        }

        // Exercice de respiration
        let breathingInterval = null;
        let breathingPhase = 'prepare';

        function startBreathingCycle() {
            const circle = document.getElementById('breathing-circle');
            const text = document.getElementById('breathing-text');
            
            if (!circle || !text) return;
            
            breathingPhase = 'inhale';
            let cycles = 0;
            const totalCycles = 6; // 2 minutes environ
            
            function breathingStep() {
                if (breathingPhase === 'inhale') {
                    circle.classList.remove('exhale');
                    circle.classList.add('inhale');
                    text.textContent = 'Inspirez...';
                    
                    setTimeout(() => {
                        breathingPhase = 'hold';
                        text.textContent = 'Retenez...';
                        
                        setTimeout(() => {
                            breathingPhase = 'exhale';
                            circle.classList.remove('inhale');
                            circle.classList.add('exhale');
                            text.textContent = 'Expirez...';
                            
                            setTimeout(() => {
                                cycles++;
                                if (cycles < totalCycles) {
                                    breathingPhase = 'inhale';
                                    breathingStep();
                                } else {
                                    text.textContent = 'Terminé !';
                                    circle.classList.remove('exhale');
                                    showQuickNotification('Exercice de respiration terminé ! 🌬️');
                                }
                            }, 4000);
                        }, 2000);
                    }, 4000);
                }
            }
            
            breathingStep();
        }

        // Initialisation au chargement de la page
        document.addEventListener('DOMContentLoaded', function() {
            // Initialiser la navigation
            initializeNavigation();
            
            // Afficher l'écran d'accueil par défaut
            navigateToScreen('home-screen');
        });

        // Fermer le menu quand on clique ailleurs
        document.addEventListener('click', function(event) {
            const dropdown = document.getElementById('settings-dropdown');
            const menuTrigger = document.querySelector('.menu-trigger');
            
            if (dropdown && !dropdown.contains(event.target) && !menuTrigger.contains(event.target)) {
                dropdown.classList.remove('show');
            }
        });

        function showQuickNotification(message) {
            const notification = document.createElement('div');
            notification.className = 'quick-notification';
            notification.textContent = message;
            
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.style.opacity = '1';
                notification.style.transform = 'translateX(-50%) translateY(0)';
            }, 10);
            
            setTimeout(() => {
                notification.style.opacity = '0';
                notification.style.transform = 'translateX(-50%) translateY(-20px)';
                setTimeout(() => notification.remove(), 300);
            }, 3000);
        }

        // Event listeners pour le chat
        document.addEventListener('DOMContentLoaded', function() {
            const chatInput = document.getElementById('chat-input');
            const sendButton = document.getElementById('send-button');
            
            if (chatInput) {
                // Compteur de caractères
                chatInput.addEventListener('input', updateCharacterCount);
                
                // Envoi avec Entrée
                chatInput.addEventListener('keypress', function(e) {
                    if (e.key === 'Enter' && !e.shiftKey) {
                        e.preventDefault();
                        sendMessageToMINA();
                    }
                });
                
                // Auto-resize du textarea
                chatInput.addEventListener('input', function() {
                    this.style.height = 'auto';
                    this.style.height = Math.min(this.scrollHeight, 100) + 'px';
                });
            }
            
            if (sendButton) {
                sendButton.addEventListener('click', sendMessageToMINA);
            }
        });

        // Système de suivi des statistiques
        class UserStats {
            constructor() {
                this.stats = JSON.parse(localStorage.getItem('mindly-stats') || '{}');
                this.initializeStats();
            }

            initializeStats() {
                if (!this.stats.firstVisit) {
                    this.stats.firstVisit = Date.now();
                    this.stats.consecutiveDays = 0;
                    this.stats.moodEntries = [];
                    this.stats.meditationSessions = 0;
                    this.stats.goalsAchieved = 0;
                    this.stats.journalEntries = 0;
                    this.stats.appUsageTime = 0;
                    this.stats.lastVisit = Date.now();
                }
                this.updateDisplayStats();
            }

            trackMood(mood) {
                const today = new Date().toDateString();
                const moodValue = this.getMoodValue(mood);
                
                // Ajouter l'entrée d'humeur
                this.stats.moodEntries.push({
                    date: today,
                    mood: mood,
                    value: moodValue,
                    timestamp: Date.now()
                });

                // Garder seulement les 30 derniers jours
                if (this.stats.moodEntries.length > 30) {
                    this.stats.moodEntries = this.stats.moodEntries.slice(-30);
                }

                this.updateConsecutiveDays();
                this.saveStats();
                this.updateDisplayStats();
            }

            getMoodValue(mood) {
                const values = {
                    'ÉPANOUI': 10,
                    'ÉNERGIQUE': 9,
                    'SEREIN': 8,
                    'NEUTRE': 5,
                    'FATIGUÉ': 3,
                    'ANXIEUX': 2,
                    'TRISTE': 1
                };
                return values[mood] || 5;
            }

            updateConsecutiveDays() {
                const today = new Date().toDateString();
                const yesterday = new Date(Date.now() - 86400000).toDateString();
                
                const todayEntry = this.stats.moodEntries.find(entry => entry.date === today);
                const yesterdayEntry = this.stats.moodEntries.find(entry => entry.date === yesterday);
                
                if (todayEntry && !this.stats.lastMoodDate || this.stats.lastMoodDate !== today) {
                    if (yesterdayEntry || this.stats.consecutiveDays === 0) {
                        this.stats.consecutiveDays++;
                    } else {
                        this.stats.consecutiveDays = 1;
                    }
                    this.stats.lastMoodDate = today;
                }
            }

            incrementMeditation() {
                this.stats.meditationSessions++;
                this.saveStats();
                this.updateDisplayStats();
            }

            incrementGoals() {
                this.stats.goalsAchieved++;
                this.saveStats();
                this.updateDisplayStats();
            }

            incrementJournal() {
                this.stats.journalEntries++;
                this.saveStats();
                this.updateDisplayStats();
            }

            updateDisplayStats() {
                // Mettre à jour l'affichage des statistiques
                const consecutiveDays = document.getElementById('consecutive-days');
                const moodAverage = document.getElementById('mood-average');
                const meditationCount = document.getElementById('meditation-count');
                const goalsAchieved = document.getElementById('goals-achieved');
                const journalEntries = document.getElementById('journal-entries');
                const appTime = document.getElementById('app-time');

                if (consecutiveDays) consecutiveDays.textContent = this.stats.consecutiveDays;
                if (moodAverage) moodAverage.textContent = this.calculateMoodAverage().toFixed(1);
                if (meditationCount) meditationCount.textContent = this.stats.meditationSessions;
                if (goalsAchieved) goalsAchieved.textContent = this.stats.goalsAchieved;
                if (journalEntries) journalEntries.textContent = this.stats.journalEntries;
                if (appTime) appTime.textContent = this.formatAppTime();

                // Mettre à jour le graphique d'humeur
                this.updateMoodChart();
            }

            calculateMoodAverage() {
                if (this.stats.moodEntries.length === 0) return 0;
                const sum = this.stats.moodEntries.reduce((acc, entry) => acc + entry.value, 0);
                return sum / this.stats.moodEntries.length;
            }

            formatAppTime() {
                const hours = Math.floor(this.stats.appUsageTime / 3600);
                const minutes = Math.floor((this.stats.appUsageTime % 3600) / 60);
                return hours > 0 ? `${hours}h${minutes}min` : `${minutes}min`;
            }

            updateMoodChart() {
                const chartContainer = document.getElementById('mood-chart');
                if (!chartContainer || this.stats.moodEntries.length === 0) return;

                const recentEntries = this.stats.moodEntries.slice(-7); // 7 derniers jours
                const maxValue = 10;

                let chartHTML = '<div style="display: flex; align-items: end; height: 100%; padding: 20px; gap: 8px;">';
                
                recentEntries.forEach((entry, index) => {
                    const height = (entry.value / maxValue) * 80; // 80% de la hauteur
                    const color = this.getMoodColor(entry.mood);
                    
                    chartHTML += `
                        <div style="flex: 1; display: flex; flex-direction: column; align-items: center;">
                            <div style="
                                height: ${height}%;
                                background: ${color};
                                width: 100%;
                                border-radius: 4px 4px 0 0;
                                margin-bottom: 4px;
                                transition: all 0.3s ease;
                            " title="${entry.mood} - ${entry.value}/10"></div>
                            <div style="font-size: 10px; color: var(--text-muted); writing-mode: vertical-rl;">
                                ${new Date(entry.timestamp).toLocaleDateString('fr-FR', { weekday: 'short' })}
                            </div>
                        </div>
                    `;
                });
                
                chartHTML += '</div>';
                chartContainer.innerHTML = chartHTML;
            }

            getMoodColor(mood) {
                const colors = {
                    'ÉPANOUI': '#4CAF50',
                    'ÉNERGIQUE': '#F44336',
                    'SEREIN': '#2196F3',
                    'NEUTRE': '#607D8B',
                    'FATIGUÉ': '#9C27B0',
                    'ANXIEUX': '#FF9800',
                    'TRISTE': '#795548'
                };
                return colors[mood] || '#607D8B';
            }

            saveStats() {
                localStorage.setItem('mindly-stats', JSON.stringify(this.stats));
            }

            exportData() {
                const exportData = {
                    stats: this.stats,
                    moodEntries: this.stats.moodEntries,
                    journalEntries: JSON.parse(localStorage.getItem('mindly-journal') || '[]'),
                    moderationLogs: JSON.parse(localStorage.getItem('mindly-moderation-logs') || '[]'),
                    theme: localStorage.getItem('mindly-theme'),
                    anonymous: localStorage.getItem('mindly-anonymous'),
                    exportDate: new Date().toISOString()
                };

                const blob = new Blob([JSON.stringify(exportData, null, 2)], { type: 'application/json' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = `mindly-data-${new Date().toISOString().split('T')[0]}.json`;
                a.click();
                URL.revokeObjectURL(url);

                showNotification('Données exportées avec succès ! 📥', 'success');
            }
        }

        // Initialiser le système de statistiques
        const userStats = new UserStats();

        // Fonctions globales pour l'interface
        function trackMoodSelection(mood) {
            userStats.trackMood(mood);
        }

        // Tableau de bord diagnostique avancé avec diagrammes
        function showDiagnosticDashboard() {
            const stats = userStats.stats;
            
            showCustomModal({
                title: '🔍 Diagnostic Complet - Analyse Comportementale',
                content: `
                    <div class="diagnostic-dashboard">
                        <div class="diagnostic-title">📈 Votre Profil Psychologique</div>
                        
                        <div class="stats-grid">
                            <div class="stat-card">
                                <div class="circular-progress">
                                    <svg>
                                        <circle class="bg-circle" cx="50" cy="50" r="35"></circle>
                                        <circle class="progress-circle" cx="50" cy="50" r="35" 
                                               stroke-dasharray="${calculateMoodScore() * 2.2} 220"></circle>
                                    </svg>
                                    <div class="progress-percentage">${calculateMoodScore()}%</div>
                                </div>
                                <div class="stat-label">Score Bien-être</div>
                                <div class="stat-trend trend-up">↗ +${Math.floor(Math.random() * 15 + 5)}%</div>
                            </div>
                            
                            <div class="stat-card">
                                <div class="stat-number">${stats.consecutiveDays || 0}</div>
                                <div class="stat-label">Jours Consécutifs</div>
                                <div class="stat-trend ${stats.consecutiveDays > 7 ? 'trend-up' : 'trend-stable'}">
                                    ${stats.consecutiveDays > 7 ? '🔥 Excellente régularité' : '💪 Continuez ainsi'}
                                </div>
                            </div>
                            
                            <div class="stat-card">
                                <div class="circular-progress">
                                    <svg>
                                        <circle class="bg-circle" cx="50" cy="50" r="35"></circle>
                                        <circle class="progress-circle" cx="50" cy="50" r="35" 
                                               stroke-dasharray="${Math.min((stats.meditationSessions || 0) * 10, 220)} 220"></circle>
                                    </svg>
                                    <div class="progress-percentage">${stats.meditationSessions || 0}</div>
                                </div>
                                <div class="stat-label">Sessions Méditation</div>
                                <div class="stat-trend trend-up">🧘‍♀️ Zen maître</div>
                            </div>
                            
                            <div class="stat-card">
                                <div class="stat-number">${((stats.appUsageTime || 0) / 3600000).toFixed(1)}h</div>
                                <div class="stat-label">Temps d'Utilisation</div>
                                <div class="stat-trend trend-stable">⏱️ Équilibré</div>
                            </div>
                        </div>
                        
                        ${generateBehaviorAnalysis()}
                        
                        <div style="text-align: center; margin-top: 20px;">
                            <button onclick="showAdvancedCharts()" style="
                                background: var(--primary-color);
                                color: white;
                                border: none;
                                padding: 12px 25px;
                                border-radius: 25px;
                                font-weight: bold;
                                margin: 0 10px;
                            ">📊 Graphiques Détaillés</button>
                            
                            <button onclick="exportDiagnostic()" style="
                                background: var(--secondary-color);
                                color: white;
                                border: none;
                                padding: 12px 25px;
                                border-radius: 25px;
                                font-weight: bold;
                                margin: 0 10px;
                            ">📄 Export PDF</button>
                        </div>
                    </div>
                `,
                width: 'max-content'
            });
        }

        // Calcul du score de bien-être basé sur les données
        function calculateMoodScore() {
            const stats = userStats.stats;
            if (!stats.moodEntries || stats.moodEntries.length === 0) return 50;
            
            const recentEntries = stats.moodEntries.slice(-7); // 7 derniers jours
            const averageValue = recentEntries.reduce((sum, entry) => sum + entry.value, 0) / recentEntries.length;
            
            return Math.round((averageValue / 10) * 100);
        }

        // Génération de l'analyse comportementale
        function generateBehaviorAnalysis() {
            const stats = userStats.stats;
            const moodScore = calculateMoodScore();
            
            let analysis = '';
            let recommendations = [];
            
            if (moodScore >= 80) {
                analysis = 'Excellent ! Votre état psychologique est remarquablement stable. Vous maintenez un équilibre émotionnel optimal et vos habitudes de bien-être sont bien ancrées.';
                recommendations = [
                    'Continuez vos pratiques actuelles, elles sont très efficaces',
                    'Partagez vos techniques dans la communauté pour aider les autres',
                    'Explorez de nouvelles techniques de méditation avancées'
                ];
            } else if (moodScore >= 60) {
                analysis = 'Très bien ! Vous montrez une bonne stabilité émotionnelle avec quelques fluctuations normales. Vos efforts portent leurs fruits.';
                recommendations = [
                    'Augmentez légèrement la fréquence de méditation',
                    'Identifiez les déclencheurs de stress pour mieux les gérer',
                    'Maintenez une routine régulière de suivi d\'humeur'
                ];
            } else if (moodScore >= 40) {
                analysis = 'Attention. Vos données indiquent des variations d\'humeur significatives. Il est important de renforcer vos pratiques de bien-être.';
                recommendations = [
                    'Pratiquez la méditation quotidiennement (10-15 min)',
                    'Consultez un professionnel si les symptômes persistent',
                    'Utilisez le journal pour identifier les patterns négatifs',
                    'Rejoignez des discussions communautaires pour du soutien'
                ];
            } else {
                analysis = 'Votre bien-être nécessite une attention particulière. Les données suggèrent un état émotionnel difficile qui mérite un soutien professionnel.';
                recommendations = [
                    'Contactez immédiatement un professionnel de santé mentale',
                    'Utilisez les ressources d\'urgence disponibles dans l\'app',
                    'Ne restez pas isolé, partagez avec des proches de confiance',
                    'Pratiquez des exercices de respiration plusieurs fois par jour'
                ];
            }
            
            return `
                <div class="behavior-analysis">
                    <div class="analysis-title">🧠 Analyse Comportementale Personnalisée</div>
                    <div class="analysis-description">${analysis}</div>
                    <ul class="recommendation-list">
                        ${recommendations.map(rec => `<li>${rec}</li>`).join('')}
                    </ul>
                </div>
            `;
        }

        function showPersonalizedInsights() {
            const insights = generatePersonalizedInsightsWithCharts();
            showCustomModal({
                title: '📊 Insights Personnalisés avec Graphiques',
                content: insights
            });
        }

        function generatePersonalizedInsightsWithCharts() {
            const stats = userStats.stats;
            const moodAvg = userStats.calculateMoodAverage();
            
            let insights = `
                <div style="padding: 20px; color: white; max-height: 80vh; overflow-y: auto;">
                    <h3 style="color: #4CAF50; margin-bottom: 20px; text-align: center;">📊 Analyse Personnalisée Complète</h3>
                    
                    <!-- Graphique d'Évolution de l'Humeur -->
                    <div style="background: var(--primary-dark); border-radius: 15px; padding: 20px; margin-bottom: 20px; border: 1px solid rgba(255,255,255,0.2);">
                        <h4 style="color: white; margin-bottom: 15px; text-align: center;">📈 Évolution de votre Humeur (7 derniers jours)</h4>
                        <div style="display: flex; flex-direction: column; align-items: center;">
                            <div style="display: flex; justify-content: space-around; align-items: end; width: 100%; height: 120px; margin-bottom: 15px; padding: 0 10px;">
                                <div style="display: flex; flex-direction: column; align-items: center; justify-content: end; height: 100%; flex: 1; max-width: 35px;">
                                    <div style="width: 20px; height: 70%; background: linear-gradient(to top, #4CAF50, #66BB6A); border-radius: 10px 10px 0 0; margin-bottom: 8px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);"></div>
                                    <span style="font-size: 10px; color: white; font-weight: 600; opacity: 0.9;">Lun</span>
                                </div>
                                <div style="display: flex; flex-direction: column; align-items: center; justify-content: end; height: 100%; flex: 1; max-width: 35px;">
                                    <div style="width: 20px; height: 85%; background: linear-gradient(to top, #4CAF50, #66BB6A); border-radius: 10px 10px 0 0; margin-bottom: 8px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);"></div>
                                    <span style="font-size: 10px; color: white; font-weight: 600; opacity: 0.9;">Mar</span>
                                </div>
                                <div style="display: flex; flex-direction: column; align-items: center; justify-content: end; height: 100%; flex: 1; max-width: 35px;">
                                    <div style="width: 20px; height: 60%; background: linear-gradient(to top, #607D8B, #78909C); border-radius: 10px 10px 0 0; margin-bottom: 8px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);"></div>
                                    <span style="font-size: 10px; color: white; font-weight: 600; opacity: 0.9;">Mer</span>
                                </div>
                                <div style="display: flex; flex-direction: column; align-items: center; justify-content: end; height: 100%; flex: 1; max-width: 35px;">
                                    <div style="width: 20px; height: 45%; background: linear-gradient(to top, #9C27B0, #BA68C8); border-radius: 10px 10px 0 0; margin-bottom: 8px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);"></div>
                                    <span style="font-size: 10px; color: white; font-weight: 600; opacity: 0.9;">Jeu</span>
                                </div>
                                <div style="display: flex; flex-direction: column; align-items: center; justify-content: end; height: 100%; flex: 1; max-width: 35px;">
                                    <div style="width: 20px; height: 80%; background: linear-gradient(to top, #4CAF50, #66BB6A); border-radius: 10px 10px 0 0; margin-bottom: 8px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);"></div>
                                    <span style="font-size: 10px; color: white; font-weight: 600; opacity: 0.9;">Ven</span>
                                </div>
                                <div style="display: flex; flex-direction: column; align-items: center; justify-content: end; height: 100%; flex: 1; max-width: 35px;">
                                    <div style="width: 20px; height: 90%; background: linear-gradient(to top, #4CAF50, #66BB6A); border-radius: 10px 10px 0 0; margin-bottom: 8px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);"></div>
                                    <span style="font-size: 10px; color: white; font-weight: 600; opacity: 0.9;">Sam</span>
                                </div>
                                <div style="display: flex; flex-direction: column; align-items: center; justify-content: end; height: 100%; flex: 1; max-width: 35px;">
                                    <div style="width: 20px; height: 75%; background: linear-gradient(to top, #4CAF50, #66BB6A); border-radius: 10px 10px 0 0; margin-bottom: 8px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);"></div>
                                    <span style="font-size: 10px; color: white; font-weight: 600; opacity: 0.9;">Dim</span>
                                </div>
                            </div>
                            <div style="display: flex; justify-content: center; gap: 15px; flex-wrap: wrap;">
                                <div style="display: flex; align-items: center; gap: 5px; font-size: 12px; color: white; opacity: 0.9;">
                                    <div style="width: 12px; height: 12px; border-radius: 50%; background: #4CAF50;"></div> Positif
                                </div>
                                <div style="display: flex; align-items: center; gap: 5px; font-size: 12px; color: white; opacity: 0.9;">
                                    <div style="width: 12px; height: 12px; border-radius: 50%; background: #607D8B;"></div> Neutre
                                </div>
                                <div style="display: flex; align-items: center; gap: 5px; font-size: 12px; color: white; opacity: 0.9;">
                                    <div style="width: 12px; height: 12px; border-radius: 50%; background: #9C27B0;"></div> Négatif
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Diagnostic Émotionnel avec Graphiques Circulaires -->
                    <div style="background: var(--primary-dark); border-radius: 15px; padding: 20px; margin-bottom: 20px; border: 1px solid rgba(255,255,255,0.2);">
                        <h4 style="color: white; margin-bottom: 15px; text-align: center;">🧠 Diagnostic Émotionnel Détaillé</h4>
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(160px, 1fr)); gap: 15px;">
                            <!-- Stabilité Émotionnelle -->
                            <div style="background: rgba(0,0,0,0.2); border-radius: 12px; padding: 15px; text-align: center; border: 1px solid rgba(255,255,255,0.2);">
                                <div style="display: flex; align-items: center; justify-content: center; gap: 8px; margin-bottom: 15px;">
                                    <span style="font-size: 16px;">⚖️</span>
                                    <span style="font-size: 12px; font-weight: 600; color: white;">Stabilité Émotionnelle</span>
                                </div>
                                <div style="position: relative; display: flex; align-items: center; justify-content: center; margin: 10px auto;">
                                    <svg width="80" height="80" viewBox="0 0 80 80">
                                        <circle cx="40" cy="40" r="30" stroke="#E0E0E0" stroke-width="8" fill="none"/>
                                        <circle cx="40" cy="40" r="30" stroke="#4CAF50" stroke-width="8" fill="none" 
                                                stroke-dasharray="188.4" stroke-dashoffset="41.2" stroke-linecap="round"/>
                                    </svg>
                                    <div style="position: absolute; font-size: 14px; font-weight: 700; color: white;">78%</div>
                                </div>
                                <div style="font-size: 10px; color: white; opacity: 0.9; margin-top: 8px; line-height: 1.3;">Excellente régularité</div>
                            </div>
                            
                            <!-- Gestion du Stress -->
                            <div style="background: rgba(0,0,0,0.2); border-radius: 12px; padding: 15px; text-align: center; border: 1px solid rgba(255,255,255,0.2);">
                                <div style="display: flex; align-items: center; justify-content: center; gap: 8px; margin-bottom: 15px;">
                                    <span style="font-size: 16px;">💭</span>
                                    <span style="font-size: 12px; font-weight: 600; color: white;">Gestion du Stress</span>
                                </div>
                                <div style="position: relative; display: flex; align-items: center; justify-content: center; margin: 10px auto;">
                                    <svg width="80" height="80" viewBox="0 0 80 80">
                                        <circle cx="40" cy="40" r="30" stroke="#E0E0E0" stroke-width="8" fill="none"/>
                                        <circle cx="40" cy="40" r="30" stroke="#FF9800" stroke-width="8" fill="none" 
                                                stroke-dasharray="188.4" stroke-dashoffset="65.9" stroke-linecap="round"/>
                                    </svg>
                                    <div style="position: absolute; font-size: 14px; font-weight: 700; color: white;">65%</div>
                                </div>
                                <div style="font-size: 10px; color: white; opacity: 0.9; margin-top: 8px; line-height: 1.3;">Bonne maîtrise</div>
                            </div>
                            
                            <!-- Connexion Sociale -->
                            <div style="background: rgba(0,0,0,0.2); border-radius: 12px; padding: 15px; text-align: center; border: 1px solid rgba(255,255,255,0.2);">
                                <div style="display: flex; align-items: center; justify-content: center; gap: 8px; margin-bottom: 15px;">
                                    <span style="font-size: 16px;">👥</span>
                                    <span style="font-size: 12px; font-weight: 600; color: white;">Connexion Sociale</span>
                                </div>
                                <div style="position: relative; display: flex; align-items: center; justify-content: center; margin: 10px auto;">
                                    <svg width="80" height="80" viewBox="0 0 80 80">
                                        <circle cx="40" cy="40" r="30" stroke="#E0E0E0" stroke-width="8" fill="none"/>
                                        <circle cx="40" cy="40" r="30" stroke="#2196F3" stroke-width="8" fill="none" 
                                                stroke-dasharray="188.4" stroke-dashoffset="33.9" stroke-linecap="round"/>
                                    </svg>
                                    <div style="position: absolute; font-size: 14px; font-weight: 700; color: white;">82%</div>
                                </div>
                                <div style="font-size: 10px; color: white; opacity: 0.9; margin-top: 8px; line-height: 1.3;">Excellent équilibre</div>
                            </div>
                            
                            <!-- Motivation -->
                            <div style="background: rgba(0,0,0,0.2); border-radius: 12px; padding: 15px; text-align: center; border: 1px solid rgba(255,255,255,0.2);">
                                <div style="display: flex; align-items: center; justify-content: center; gap: 8px; margin-bottom: 15px;">
                                    <span style="font-size: 16px;">🎯</span>
                                    <span style="font-size: 12px; font-weight: 600; color: white;">Motivation</span>
                                </div>
                                <div style="position: relative; display: flex; align-items: center; justify-content: center; margin: 10px auto;">
                                    <svg width="80" height="80" viewBox="0 0 80 80">
                                        <circle cx="40" cy="40" r="30" stroke="#E0E0E0" stroke-width="8" fill="none"/>
                                        <circle cx="40" cy="40" r="30" stroke="#E91E63" stroke-width="8" fill="none" 
                                                stroke-dasharray="188.4" stroke-dashoffset="17.0" stroke-linecap="round"/>
                                    </svg>
                                    <div style="position: absolute; font-size: 14px; font-weight: 700; color: white;">91%</div>
                                </div>
                                <div style="font-size: 10px; color: white; opacity: 0.9; margin-top: 8px; line-height: 1.3;">Motivation exceptionnelle !</div>
                            </div>
                        </div>
                    </div>

                    <!-- Analyse et Recommandations -->
                    <div style="background: var(--primary-dark); border-radius: 15px; padding: 20px; margin-bottom: 20px; border: 1px solid rgba(255,255,255,0.2);">
                        <h4 style="color: white; margin-bottom: 15px; text-align: center;">📋 Analyse Comportementale</h4>
                        <div style="background: rgba(0,0,0,0.2); padding: 15px; border-radius: 10px; margin-bottom: 15px; border: 1px solid rgba(255,255,255,0.2);">
                            <h5 style="color: white; margin-bottom: 10px;">🎯 Votre Profil Émotionnel</h5>
                            <p style="color: white; opacity: 0.9; margin: 5px 0;">Score moyen d'humeur : <strong>${moodAvg}%</strong></p>
                            <p style="color: white; opacity: 0.9; margin: 5px 0;">Sessions totales : <strong>${stats.totalSessions}</strong></p>
                            <p style="color: white; opacity: 0.9; margin: 5px 0;">Streak actuel : <strong>${stats.consecutiveDays}</strong> jours</p>
                        </div>

                        <div style="background: rgba(0,0,0,0.2); padding: 15px; border-radius: 10px; margin-bottom: 15px; border: 1px solid rgba(255,255,255,0.2);">
                            <h5 style="color: white; margin-bottom: 10px;">💡 Recommandations Personnalisées</h5>
                            <div style="display: flex; flex-direction: column; gap: 8px;">
                                <div style="display: flex; align-items: center; gap: 12px;">
                                    <span style="font-size: 16px;">🧘‍♀️</span>
                                    <div style="flex: 1;">
                                        <div style="color: white; font-size: 13px; font-weight: 600;">Méditation Matinale</div>
                                        <div style="color: white; opacity: 0.9; font-size: 11px;">Tes pics positifs arrivent après tes sessions. Continue 10min le matin.</div>
                                    </div>
                                    <div style="background: var(--primary-color); color: white; padding: 3px 8px; border-radius: 10px; font-size: 10px; font-weight: 600;">+12%</div>
                                </div>
                                <div style="display: flex; align-items: center; gap: 12px;">
                                    <span style="font-size: 16px;">📝</span>
                                    <div style="flex: 1;">
                                        <div style="color: white; font-size: 13px; font-weight: 600;">Journal du Soir</div>
                                        <div style="color: white; opacity: 0.9; font-size: 11px;">Tes jeudis sont plus difficiles. Un journal de gratitude pourrait aider.</div>
                                    </div>
                                    <div style="background: var(--primary-color); color: white; padding: 3px 8px; border-radius: 10px; font-size: 10px; font-weight: 600;">+8%</div>
                                </div>
                                <div style="display: flex; align-items: center; gap: 12px;">
                                    <span style="font-size: 16px;">🌱</span>
                                    <div style="flex: 1;">
                                        <div style="color: white; font-size: 13px; font-weight: 600;">Objectifs Hebdomadaires</div>
                                        <div style="color: white; opacity: 0.9; font-size: 11px;">Ta motivation est excellente ! Fixe-toi 2-3 micro-objectifs par semaine.</div>
                                    </div>
                                    <div style="background: var(--primary-color); color: white; padding: 3px 8px; border-radius: 10px; font-size: 10px; font-weight: 600;">+15%</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            `;
            
            return insights;
        }

        function generatePersonalizedInsights() {
            const stats = userStats.stats;
            const moodAvg = userStats.calculateMoodAverage();
            
            let insights = `
                <div style="padding: 20px;">
                    <div style="text-align: center; margin-bottom: 20px;">
                        <div style="font-size: 48px; margin-bottom: 10px;">📈</div>
                        <h3 style="color: var(--primary-color);">Votre parcours MINDLY</h3>
                    </div>
            `;

            if (stats.consecutiveDays > 7) {
                insights += `
                    <div style="background: var(--background-light); padding: 15px; border-radius: 12px; margin-bottom: 15px;">
                        <h4 style="color: var(--primary-color); margin-bottom: 8px;">🎉 Félicitations !</h4>
                        <p>Vous utilisez MINDLY depuis ${stats.consecutiveDays} jours consécutifs. C'est formidable !</p>
                    </div>
                `;
            }

            if (moodAvg > 7) {
                insights += `
                    <div style="background: var(--background-light); padding: 15px; border-radius: 12px; margin-bottom: 15px;">
                        <h4 style="color: var(--primary-color); margin-bottom: 8px;">😊 Excellent bien-être</h4>
                        <p>Votre moyenne d'humeur (${moodAvg.toFixed(1)}/10) indique un excellent état de bien-être.</p>
                    </div>
                `;
            } else if (moodAvg < 5) {
                insights += `
                    <div style="background: #FFF3E0; padding: 15px; border-radius: 12px; margin-bottom: 15px;">
                        <h4 style="color: #F57C00; margin-bottom: 8px;">💚 Prenez soin de vous</h4>
                        <p>Votre bien-être pourrait être amélioré. N'hésitez pas à utiliser nos outils de méditation.</p>
                    </div>
                `;
            }

            if (stats.meditationSessions > 10) {
                insights += `
                    <div style="background: var(--background-light); padding: 15px; border-radius: 12px; margin-bottom: 15px;">
                        <h4 style="color: var(--primary-color); margin-bottom: 8px;">🧘‍♀️ Méditant assidu</h4>
                        <p>Vous avez effectué ${stats.meditationSessions} sessions de méditation. Continuez !</p>
                    </div>
                `;
            }

            insights += `</div>`;
            return insights;
        }

        function showModerationLogs() {
            const logs = JSON.parse(localStorage.getItem('mindly-moderation-logs') || '[]');
            
            let logsHTML = `
                <div style="padding: 20px;">
                    <h3 style="text-align: center; color: var(--primary-color); margin-bottom: 20px;">🛡️ Historique de Modération</h3>
            `;

            if (logs.length === 0) {
                logsHTML += `
                    <div style="text-align: center; color: var(--text-muted); padding: 40px;">
                        Aucun événement de modération enregistré.<br>
                        Continuez à utiliser l'application de manière respectueuse ! 👍
                    </div>
                `;
            } else {
                logsHTML += '<div style="max-height: 300px; overflow-y: auto;">';
                logs.reverse().forEach(log => {
                    const typeEmoji = log.type === 'profanity' ? '🚫' : '⚠️';
                    logsHTML += `
                        <div style="background: var(--background-light); padding: 12px; border-radius: 8px; margin-bottom: 8px;">
                            <div style="display: flex; justify-content: between; align-items: center; margin-bottom: 4px;">
                                <span>${typeEmoji} ${log.type}</span>
                                <small style="color: var(--text-muted);">${log.date}</small>
                            </div>
                            <div style="font-size: 12px; color: var(--text-secondary);">
                                Contexte: ${log.context} | Contenu: "${log.content}..."
                            </div>
                        </div>
                    `;
                });
                logsHTML += '</div>';
            }

            logsHTML += '</div>';
            
            showCustomModal({
                title: '🛡️ Modération IA',
                content: logsHTML
            });
        }

        // Nouvelles fonctions pour les données personnelles du profil
        function exportPersonalData() {
            const userData = {
                wellBeingScore: 85,
                streakDays: 12,
                totalSessions: 47,
                emotionalStability: 78,
                stressManagement: 65,
                socialConnection: 82,
                motivation: 91,
                moodHistory: [
                    {day: 'Lun', mood: 'Épanoui', score: 70},
                    {day: 'Mar', mood: 'Joyeux', score: 85},
                    {day: 'Mer', mood: 'Neutre', score: 60},
                    {day: 'Jeu', mood: 'Fatigué', score: 45},
                    {day: 'Ven', mood: 'Épanoui', score: 80},
                    {day: 'Sam', mood: 'Joyeux', score: 90},
                    {day: 'Dim', mood: 'Épanoui', score: 75}
                ]
            };

            const date = new Date().toLocaleDateString('fr-FR');
            const exportData = `
=== MINDLY - DONNÉES PERSONNELLES ===
Date du rapport: ${date}
Utilisateur: ${userData.wellBeingScore >= 80 ? 'Profil Épanoui' : 'Profil en Progression'}

📊 SCORES PERSONNELS:
- Score de Bien-être Global: ${userData.wellBeingScore}%
- Stabilité Émotionnelle: ${userData.emotionalStability}%
- Gestion du Stress: ${userData.stressManagement}%
- Connexion Sociale: ${userData.socialConnection}%
- Niveau de Motivation: ${userData.motivation}%

📈 PROGRESSION:
- Jours consécutifs: ${userData.streakDays} jours
- Sessions totales: ${userData.totalSessions} sessions
- Moyenne hebdomadaire d'humeur: ${Math.round(userData.moodHistory.reduce((a,b) => a + b.score, 0) / userData.moodHistory.length)}%

🧠 ANALYSE COMPORTEMENTALE:
${userData.wellBeingScore >= 80 ? 
'Excellent équilibre émotionnel. Vous maintenez une grande stabilité.' : 
'Progression positive. Continue sur cette voie pour améliorer ton bien-être.'}

💡 RECOMMANDATIONS:
- Méditation matinale: +12% bien-être
- Journal du soir: +8% stabilité
- Objectifs hebdomadaires: +15% progression

=== FIN DU RAPPORT PERSONNEL ===
            `.trim();

            const blob = new Blob([exportData], { type: 'text/plain;charset=utf-8' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `MINDLY_Donnees-Personnelles_${date.replace(/\//g, '-')}.txt`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
            
            showNotification('📊 Données personnelles exportées avec succès !', 'success');
        }

        function showDetailedAnalysis() {
            showCustomModal({
                title: '🔬 Analyse Détaillée de vos Données',
                content: `
                    <div style="padding: 20px; color: white;">
                        <h3 style="color: #4CAF50; margin-bottom: 15px;">📈 Analyse Approfondie</h3>
                        
                        <div style="background: rgba(255,255,255,0.1); padding: 15px; border-radius: 10px; margin-bottom: 15px;">
                            <h4>🎯 Patterns Identifiés</h4>
                            <ul style="margin: 10px 0; padding-left: 20px;">
                                <li>Tes meilleures humeurs arrivent en fin de semaine</li>
                                <li>Les jeudis sont généralement plus difficiles</li>
                                <li>Tes sessions de méditation améliorent ton humeur de 23% en moyenne</li>
                                <li>Tu es plus productif/ve entre 9h et 11h</li>
                            </ul>
                        </div>

                        <div style="background: rgba(255,255,255,0.1); padding: 15px; border-radius: 10px; margin-bottom: 15px;">
                            <h4>💡 Insights Personnalisés</h4>
                            <p style="margin: 10px 0;">Ton profil correspond à un "Épanouisseur Progressif" - tu maintiens un niveau élevé de bien-être tout en cherchant continuellement à t'améliorer.</p>
                            <p style="margin: 10px 0;">Ton plus grand atout : ta régularité (12 jours consécutifs !)</p>
                            <p style="margin: 10px 0;">Zone d'amélioration : gestion du stress en milieu de semaine</p>
                        </div>

                        <div style="background: rgba(255,255,255,0.1); padding: 15px; border-radius: 10px;">
                            <h4>🎯 Objectifs Suggérés</h4>
                            <ul style="margin: 10px 0; padding-left: 20px;">
                                <li>Atteindre 90% de bien-être global</li>
                                <li>Maintenir 20 jours consécutifs</li>
                                <li>Améliorer la gestion du stress à 75%</li>
                                <li>Créer une routine anti-stress pour les jeudis</li>
                            </ul>
                        </div>
                    </div>
                `
            });
        }

        function shareProgress() {
            const progressData = {
                wellBeing: 85,
                streak: 12,
                improvement: '+23% ce mois'
            };

            if (navigator.share) {
                navigator.share({
                    title: 'Mon Progrès MINDLY',
                    text: `🌟 Mon bien-être : ${progressData.wellBeing}% | 🔥 ${progressData.streak} jours consécutifs | 📈 ${progressData.improvement}`,
                    url: window.location.href
                });
            } else {
                const shareText = `🌟 Mon progrès MINDLY :\n- Bien-être : ${progressData.wellBeing}%\n- Streak : ${progressData.streak} jours\n- Amélioration : ${progressData.improvement}\n\n#MINDLY #BienEtre #Progression`;
                
                if (navigator.clipboard) {
                    navigator.clipboard.writeText(shareText).then(() => {
                        showNotification('📋 Progrès copié dans le presse-papiers !', 'success');
                    });
                } else {
                    showCustomModal({
                        title: '📈 Partager mes Progrès',
                        content: `
                            <div style="padding: 20px; color: white;">
                                <p style="margin-bottom: 15px;">Copie ce texte pour partager tes progrès :</p>
                                <div style="background: rgba(0,0,0,0.3); padding: 15px; border-radius: 10px; font-family: monospace; white-space: pre-line;">
${shareText}
                                </div>
                            </div>
                        `
                    });
                }
            }
        }

        function exportUserData() {
            userStats.exportData();
        }

        // Système de communauté et mode anonyme
        class CommunityManager {
            constructor() {
                this.isAnonymous = localStorage.getItem('mindly-anonymous') === 'true';
                this.communityPosts = JSON.parse(localStorage.getItem('mindly-community-posts') || '[]');
                this.anonymousNames = [
                    'Lotus Serein', 'Papillon Libre', 'Étoile Douce', 'Vent Paisible', 'Lune Bienveillante',
                    'Soleil Chaleureux', 'Nuage Tendre', 'Océan Calme', 'Forêt Apaisante', 'Montagne Sage',
                    'Fleur Courageuse', 'Rivière Fluide', 'Oiseau Joyeux', 'Cristal Lumineux', 'Arc-en-ciel Espoir'
                ];
                this.currentAnonymousName = localStorage.getItem('mindly-anonymous-name') || this.generateAnonymousName();
                this.initializeCommunity();
            }

            generateAnonymousName() {
                const name = this.anonymousNames[Math.floor(Math.random() * this.anonymousNames.length)];
                localStorage.setItem('mindly-anonymous-name', name);
                return name;
            }

            toggleAnonymousMode() {
                this.isAnonymous = !this.isAnonymous;
                localStorage.setItem('mindly-anonymous', this.isAnonymous.toString());
                
                const toggleBtn = document.getElementById('anonymous-toggle');
                const status = this.isAnonymous ? 'ON' : 'OFF';
                
                if (toggleBtn) {
                    toggleBtn.classList.toggle('active', this.isAnonymous);
                    toggleBtn.querySelector('.btn-text').textContent = `Mode Anonyme: ${status}`;
                }

                // Mettre à jour le profil
                aiModeration.updateAnonymousUI();
                
                showNotification(`Mode anonyme ${this.isAnonymous ? 'activé' : 'désactivé'} 🕶️`, 'info');
                
                if (this.isAnonymous) {
                    showNotification(`Votre pseudonyme: ${this.currentAnonymousName} ✨`, 'info');
                }
            }

            shareMoodPost() {
                const moodShareTextarea = document.getElementById('mood-share');
                const content = moodShareTextarea?.value.trim();
                
                if (!content) {
                    showNotification('Veuillez écrire quelque chose avant de partager.', 'warning');
                    return;
                }

                // Modération du contenu
                const moderation = aiModeration.moderateMessage(content, 'community');
                
                if (moderation.hasProfanity) {
                    showNotification('Votre message contient un langage inapproprié et a été modéré.', 'warning');
                }

                const author = this.isAnonymous ? this.currentAnonymousName : 'Vous';
                const post = {
                    id: Date.now(),
                    author: author,
                    content: moderation.filteredText,
                    timestamp: Date.now(),
                    date: new Date().toLocaleDateString('fr-FR'),
                    likes: 0,
                    isAnonymous: this.isAnonymous,
                    reports: 0
                };

                this.communityPosts.unshift(post);
                
                // Garder seulement les 50 derniers posts
                if (this.communityPosts.length > 50) {
                    this.communityPosts = this.communityPosts.slice(0, 50);
                }

                this.savePosts();
                this.displayDiscussions();
                
                moodShareTextarea.value = '';
                showNotification('Votre message a été partagé ! 🌟', 'success');
            }

            initializeCommunity() {
                // Ajouter quelques posts d'exemple si c'est la première visite
                if (this.communityPosts.length === 0) {
                    this.addSamplePosts();
                }
                this.displayDiscussions();
            }

            addSamplePosts() {
                const samplePosts = [
                    {
                        id: 1,
                        author: 'Lotus Serein',
                        content: 'Aujourd\'hui j\'ai pris le temps de méditer 10 minutes et je me sens beaucoup mieux. La régularité fait vraiment la différence ! 🧘‍♀️',
                        timestamp: Date.now() - 3600000,
                        date: new Date(Date.now() - 3600000).toLocaleDateString('fr-FR'),
                        likes: 5,
                        isAnonymous: true,
                        reports: 0
                    },
                    {
                        id: 2,
                        author: 'Papillon Libre',
                        content: 'Petite baisse de moral aujourd\'hui, mais je me rappelle que c\'est temporaire. Merci à cette communauté pour le soutien 💚',
                        timestamp: Date.now() - 7200000,
                        date: new Date(Date.now() - 7200000).toLocaleDateString('fr-FR'),
                        likes: 8,
                        isAnonymous: true,
                        reports: 0
                    },
                    {
                        id: 3,
                        author: 'Étoile Douce',
                        content: 'Je voulais partager une petite victoire : j\'ai réussi à parler de mes émotions avec un proche. C\'était difficile mais libérateur !',
                        timestamp: Date.now() - 10800000,
                        date: new Date(Date.now() - 10800000).toLocaleDateString('fr-FR'),
                        likes: 12,
                        isAnonymous: true,
                        reports: 0
                    }
                ];

                this.communityPosts = samplePosts;
                this.savePosts();
            }

            displayDiscussions() {
                const discussionList = document.getElementById('discussion-list');
                if (!discussionList) return;

                if (this.communityPosts.length === 0) {
                    discussionList.innerHTML = `
                        <div style="text-align: center; color: var(--text-muted); padding: 40px;">
                            Aucune discussion pour le moment.<br>
                            Soyez le premier à partager ! 🌟
                        </div>
                    `;
                    return;
                }

                let discussionsHTML = '';
                
                this.communityPosts.forEach(post => {
                    const timeAgo = this.getTimeAgo(post.timestamp);
                    discussionsHTML += `
                        <div class="discussion-item">
                            <div class="discussion-header">
                                <div class="discussion-author">
                                    ${post.isAnonymous ? '🕶️ ' : ''}${post.author}
                                </div>
                                <div class="discussion-time">${timeAgo}</div>
                            </div>
                            <div class="discussion-content">${post.content}</div>
                            <div class="discussion-actions">
                                <span class="discussion-action" onclick="likePost(${post.id})">
                                    👍 ${post.likes}
                                </span>
                                <span class="discussion-action" onclick="reportPost(${post.id})">
                                    🚩 Signaler
                                </span>
                                <span class="discussion-action" onclick="replyToPost(${post.id})">
                                    💬 Répondre
                                </span>
                            </div>
                        </div>
                    `;
                });

                discussionList.innerHTML = discussionsHTML;
            }

            getTimeAgo(timestamp) {
                const now = Date.now();
                const diff = now - timestamp;
                const minutes = Math.floor(diff / 60000);
                const hours = Math.floor(diff / 3600000);
                const days = Math.floor(diff / 86400000);

                if (days > 0) return `il y a ${days} jour${days > 1 ? 's' : ''}`;
                if (hours > 0) return `il y a ${hours} heure${hours > 1 ? 's' : ''}`;
                if (minutes > 0) return `il y a ${minutes} minute${minutes > 1 ? 's' : ''}`;
                return 'À l\'instant';
            }

            likePost(postId) {
                const post = this.communityPosts.find(p => p.id === postId);
                if (post) {
                    post.likes++;
                    this.savePosts();
                    this.displayDiscussions();
                    showNotification('👍 Merci pour votre soutien !', 'success');
                }
            }

            reportPost(postId) {
                const post = this.communityPosts.find(p => p.id === postId);
                if (post) {
                    post.reports++;
                    
                    // Auto-modération si trop de signalements
                    if (post.reports >= 3) {
                        this.moderatePost(post);
                    }
                    
                    this.savePosts();
                    showNotification('🚩 Signalement envoyé. Merci de maintenir une communauté saine.', 'info');
                }
            }

            moderatePost(post) {
                // Masquer le post s'il a trop de signalements
                post.content = '[Message masqué par la modération automatique]';
                post.author = 'Modération IA';
                aiModeration.logModerationEvent('community-report', post.content, 'community');
            }

            replyToPost(postId) {
                showNotification('Fonctionnalité de réponse en cours de développement 💬', 'info');
            }

            savePosts() {
                localStorage.setItem('mindly-community-posts', JSON.stringify(this.communityPosts));
            }
        }

        // Initialiser le gestionnaire de communauté
        const communityManager = new CommunityManager();

        // Fonctions globales pour l'interface communauté
        function toggleAnonymousMode() {
            communityManager.toggleAnonymousMode();
        }

        function shareMoodPost() {
            communityManager.shareMoodPost();
        }

        function likePost(postId) {
            communityManager.likePost(postId);
        }

        function reportPost(postId) {
            communityManager.reportPost(postId);
        }

        function replyToPost(postId) {
            communityManager.replyToPost(postId);
        }

        // Menu modal avec Navigation 3 Clics Maximum
        function showMenuModal() {
            showCustomModal({
                title: '� Navigation Rapide - 3 Clics Max',
                content: `
                    <div style="padding: 20px;">
                        <div style="text-align: center; margin-bottom: 15px; color: var(--primary-color); font-weight: bold;">
                            🎯 Accès Ultra-Rapide à toutes les fonctions
                        </div>
                        <div class="menu-grid">
                            <button class="menu-item" onclick="showScreen('mood-screen'); closeModal();">
                                <span class="quick-access-badge">1</span>
                                <span class="menu-icon">😊</span>
                                <span class="menu-text">Suivi d'Humeur</span>
                                <span class="menu-desc">1 clic → Diagnostic</span>
                            </button>
                            
                            <button class="menu-item" onclick="startMeditationSession(); closeModal();">
                                <span class="quick-access-badge">2</span>
                                <span class="menu-icon">🧘‍♀️</span>
                                <span class="menu-text">Méditation</span>
                                <span class="menu-desc">2 clics → Relaxation</span>
                            </button>
                            
                            <button class="menu-item" onclick="openJournal(); closeModal();">
                                <span class="quick-access-badge">2</span>
                                <span class="menu-icon">📔</span>
                                <span class="menu-text">Journal</span>
                                <span class="menu-desc">2 clics → Écriture</span>
                            </button>
                            
                            <button class="menu-item" onclick="showDiagnosticDashboard(); closeModal();">
                                <span class="quick-access-badge">1</span>
                                <span class="menu-icon">📊</span>
                                <span class="menu-text">Diagnostics</span>
                                <span class="menu-desc">1 clic → Analyses visuelles</span>
                            </button>
                            
                            <button class="menu-item" onclick="showScreen('onboarding-screen'); closeModal();">
                                <span class="menu-icon">ℹ️</span>
                                <span class="menu-text">Introduction</span>
                                <span class="menu-desc">Découvrir l'app</span>
                            </button>
                            
                            <button class="menu-item" onclick="showModerationLogs(); closeModal();">
                                <span class="menu-icon">🛡️</span>
                                <span class="menu-text">Modération</span>
                                <span class="menu-desc">Historique sécurité</span>
                            </button>
                            
                            <button class="menu-item" onclick="aiModeration.toggleAnonymousMode(); closeModal();">
                                <span class="menu-icon">🕶️</span>
                                <span class="menu-text">Mode Anonyme</span>
                                <span class="menu-desc">Protection identité</span>
                            </button>
                            
                            <button class="menu-item" onclick="exportUserData(); closeModal();">
                                <span class="menu-icon">📥</span>
                                <span class="menu-text">Export Données</span>
                                <span class="menu-desc">Sauvegarde complète</span>
                            </button>
                            
                            <button class="menu-item" onclick="showScreen('login-screen'); closeModal();">
                                <span class="menu-icon">🔑</span>
                                <span class="menu-text">Connexion</span>
                                <span class="menu-desc">Se connecter</span>
                            </button>
                            
                            <button class="menu-item" onclick="showScreen('signup-screen'); closeModal();">
                                <span class="menu-icon">✍️</span>
                                <span class="menu-text">Inscription</span>
                                <span class="menu-desc">Créer un compte</span>
                            </button>
                        </div>
                        
                        <div style="text-align: center; margin-top: 20px;">
                            <button onclick="closeModal()" style="
                                background: var(--text-muted); 
                                color: white; 
                                border: none; 
                                padding: 12px 24px; 
                                border-radius: 20px; 
                                font-weight: 600; 
                                cursor: pointer;
                            ">Fermer</button>
                        </div>
                    </div>
                `
            });
        }

        // Initialize everything
        // Graphiques avancés avec analyses détaillées  
        function showAdvancedCharts() {
            const stats = userStats.stats;
            showCustomModal({
                title: '📊 Analyses Graphiques Avancées',
                content: `
                    <div class="diagnostic-dashboard">
                        <div class="diagnostic-title">📈 Évolution Temporelle Détaillée</div>
                        
                        <div style="background: white; border-radius: 12px; padding: 20px; margin: 15px 0;">
                            <h4>Graphique d'Humeur - 30 Derniers Jours</h4>
                            <div id="advanced-mood-chart" style="height: 200px; position: relative;">
                                ${generateAdvancedMoodChart()}
                            </div>
                        </div>
                        
                        <div style="background: white; border-radius: 12px; padding: 20px; margin: 15px 0;">
                            <h4>Analyse des Patterns Comportementaux</h4>
                            ${generatePatternAnalysis()}
                        </div>
                        
                        <div style="background: white; border-radius: 12px; padding: 20px; margin: 15px 0;">
                            <h4>Corrélations et Insights IA</h4>
                            ${generateCorrelationAnalysis()}
                        </div>
                    </div>
                `,
                width: '90%'
            });
        }

        function generateAdvancedMoodChart() {
            const stats = userStats.stats;
            if (!stats.moodEntries || stats.moodEntries.length === 0) {
                return '<div style="display: flex; align-items: center; justify-content: center; height: 100%; color: var(--text-muted);">Aucune donnée d\'humeur disponible</div>';
            }
            
            const last30 = stats.moodEntries.slice(-30);
            let chartHTML = '<div style="display: flex; align-items: end; height: 100%; padding: 20px; gap: 3px; background: linear-gradient(to top, #f8f9fa, transparent);">';
            
            last30.forEach((entry, index) => {
                const height = (entry.value / 10) * 160;
                const color = getMoodColor(entry.mood);
                chartHTML += `
                    <div style="
                        height: ${height}px;
                        background: ${color};
                        flex: 1;
                        border-radius: 3px 3px 0 0;
                        position: relative;
                        cursor: pointer;
                        transition: all 0.3s ease;
                        margin: 0 1px;
                    " onmouseover="this.style.opacity='0.8'" onmouseout="this.style.opacity='1'" 
                       title="${entry.mood} - ${new Date(entry.timestamp).toLocaleDateString()}">
                        <div style="
                            position: absolute;
                            bottom: -25px;
                            left: 50%;
                            transform: translateX(-50%);
                            font-size: 10px;
                            color: var(--text-muted);
                        ">${index % 5 === 0 ? new Date(entry.timestamp).getDate() : ''}</div>
                    </div>
                `;
            });
            
            chartHTML += '</div>';
            return chartHTML;
        }

        function getMoodColor(mood) {
            const colors = {
                'ÉPANOUI': '#4CAF50',
                'SEREIN': '#2196F3', 
                'ÉNERGIQUE': '#FF5722',
                'NEUTRE': '#607D8B',
                'FATIGUÉ': '#9C27B0',
                'ANXIEUX': '#FF9800',
                'TRISTE': '#F44336'
            };
            return colors[mood] || '#607D8B';
        }

        function generatePatternAnalysis() {
            const stats = userStats.stats;
            const patterns = analyzeUserPatterns(stats);
            
            return `
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px;">
                    <div style="background: var(--background-light); padding: 15px; border-radius: 8px;">
                        <div style="font-weight: bold; color: var(--primary-color);">🕐 Meilleure Période</div>
                        <div>${patterns.bestTimeOfDay}</div>
                    </div>
                    <div style="background: var(--background-light); padding: 15px; border-radius: 8px;">
                        <div style="font-weight: bold; color: var(--primary-color);">📅 Jour Optimal</div>
                        <div>${patterns.bestDayOfWeek}</div>
                    </div>
                    <div style="background: var(--background-light); padding: 15px; border-radius: 8px;">
                        <div style="font-weight: bold; color: var(--primary-color);">🎯 Tendance Globale</div>
                        <div>${patterns.overallTrend}</div>
                    </div>
                    <div style="background: var(--background-light); padding: 15px; border-radius: 8px;">
                        <div style="font-weight: bold; color: var(--primary-color);">⚠️ Zones d'Attention</div>
                        <div>${patterns.riskFactors}</div>
                    </div>
                </div>
            `;
        }

        function generateCorrelationAnalysis() {
            return `
                <div style="color: var(--text-secondary); line-height: 1.6;">
                    <p><strong>🧠 Analyse IA :</strong> Basé sur vos données comportementales, voici les corrélations détectées :</p>
                    <ul style="list-style: none; padding-left: 0;">
                        <li>🔍 <strong>Méditation ↔ Humeur :</strong> +${Math.floor(Math.random() * 30 + 60)}% de corrélation positive</li>
                        <li>🔍 <strong>Régularité ↔ Stabilité :</strong> +${Math.floor(Math.random() * 25 + 70)}% d'amélioration des scores</li>
                        <li>🔍 <strong>Journaling ↔ Clarté mentale :</strong> +${Math.floor(Math.random() * 20 + 45)}% de réduction du stress</li>
                        <li>🔍 <strong>Communauté ↔ Motivation :</strong> +${Math.floor(Math.random() * 35 + 50)}% d'engagement social</li>
                    </ul>
                    <div style="background: #E3F2FD; padding: 15px; border-radius: 8px; margin-top: 15px;">
                        <strong>💡 Recommandation IA :</strong> Continuez la méditation régulière et augmentez vos interactions communautaires pour optimiser votre bien-être global.
                    </div>
                </div>
            `;
        }

        function analyzeUserPatterns(stats) {
            // Simulation d'analyse avancée (en production, analyser les vraies données)
            const bestTimes = ['Matin (7h-9h)', 'Après-midi (14h-16h)', 'Soirée (19h-21h)'];
            const bestDays = ['Lundi', 'Mercredi', 'Vendredi', 'Dimanche'];
            const trends = ['Amélioration constante', 'Stabilité positive', 'Croissance progressive'];
            const risks = ['Pic de stress en fin de semaine', 'Baisse matinale occasionnelle', 'Aucun facteur de risque détecté'];
            
            return {
                bestTimeOfDay: bestTimes[Math.floor(Math.random() * bestTimes.length)],
                bestDayOfWeek: bestDays[Math.floor(Math.random() * bestDays.length)],
                overallTrend: trends[Math.floor(Math.random() * trends.length)],
                riskFactors: risks[Math.floor(Math.random() * risks.length)]
            };
        }

        // Gestion du menu déroulant en haut à droite
        function toggleDropdownMenu() {
            const menu = document.getElementById('dropdown-menu');
            menu.classList.toggle('active');
        }

        function closeDropdownMenu() {
            const menu = document.getElementById('dropdown-menu');
            menu.classList.remove('active');
        }

        // Fermer le menu si on clique ailleurs
        document.addEventListener('click', function(event) {
            const menu = document.getElementById('dropdown-menu');
            const button = document.querySelector('.menu-button');
            
            if (menu && button && !menu.contains(event.target) && !button.contains(event.target)) {
                menu.classList.remove('active');
            }
        });

        // Système de couleurs personnalisées amélioré
        function setCustomColor(color) {
            // Calculer les variations de couleur avec contraste optimal
            const primaryColor = color;
            const primaryLight = lightenColor(color, 15);
            const primaryDark = darkenColor(color, 25);
            const primaryVeryDark = darkenColor(color, 40);
            const secondaryColor = lightenColor(color, 8);
            
            // Arrière-plans avec nuances légères pour contraste avec texte blanc
            const backgroundLight = lightenColor(color, 80);
            const backgroundMedium = lightenColor(color, 65);
            const backgroundDark = lightenColor(color, 45);
            
            // Texte en blanc avec couleurs foncées pour contraste
            const textPrimary = '#FFFFFF';
            const textSecondary = '#FFFFFF';
            const textMuted = '#FFFFFF';
            const accentColor = lightenColor(color, 12);

            // Appliquer les nouvelles couleurs aux variables CSS
            const root = document.documentElement;
            root.style.setProperty('--primary-color', primaryColor);
            root.style.setProperty('--primary-light', primaryLight);
            root.style.setProperty('--primary-dark', primaryDark);
            root.style.setProperty('--primary-very-dark', primaryVeryDark);
            root.style.setProperty('--secondary-color', secondaryColor);
            root.style.setProperty('--background-light', backgroundLight);
            root.style.setProperty('--background-medium', backgroundMedium);
            root.style.setProperty('--background-dark', backgroundDark);
            root.style.setProperty('--text-primary', textPrimary);
            root.style.setProperty('--text-secondary', textSecondary);
            root.style.setProperty('--text-muted', textMuted);
            root.style.setProperty('--accent-color', accentColor);

            // Forcer le style de texte blanc pour cohérence
            root.setAttribute('data-text-style', 'white');

            // Appliquer la couleur à tous les éléments de l'interface
            applyColorToAllElements(color);

            // Marquer la couleur comme active
            document.querySelectorAll('.color-option').forEach(option => {
                option.classList.remove('active');
                if (option.style.backgroundColor === color || rgbToHex(option.style.backgroundColor) === color) {
                    option.classList.add('active');
                }
            });

            // Sauvegarder la couleur choisie
            localStorage.setItem('mindly-custom-color', color);
            localStorage.setItem('mindly-theme-type', 'custom');
            localStorage.setItem('mindly-text-style', 'white');
            
            showNotification(`🎨 Couleur personnalisée appliquée à toute l'application : ${color}`, 'success');
        }

        // Nouvelle fonction pour appliquer la couleur à tous les éléments
        function applyColorToAllElements(color) {
            const primaryColor = color;
            const primaryLight = lightenColor(color, 15);
            const primaryDark = darkenColor(color, 25);
            const backgroundLight = lightenColor(color, 80);
            
            // Styles dynamiques pour une application complète de la couleur
            const dynamicStyles = `
                <style id="dynamic-color-styles">
                    /* Application globale de la couleur */
                    .nav-item.active, .nav-item:hover {
                        background: ${primaryDark} !important;
                        color: white !important;
                    }
                    
                    .tab.active {
                        background: ${primaryColor} !important;
                        color: white !important;
                        border-color: ${primaryDark} !important;
                    }
                    
                    .tab:hover {
                        background: ${primaryLight} !important;
                        color: white !important;
                    }
                    
                    /* Boutons et éléments interactifs */
                    .btn-primary, .primary-btn, .cta-button {
                        background: ${primaryColor} !important;
                        border-color: ${primaryDark} !important;
                        color: white !important;
                    }
                    
                    .btn-primary:hover, .primary-btn:hover, .cta-button:hover {
                        background: ${primaryDark} !important;
                        color: white !important;
                    }
                    
                    /* Headers et titres */
                    .dashboard-header, .profile-header, .community-header {
                        background: linear-gradient(135deg, ${primaryColor}, ${primaryLight}) !important;
                        color: white !important;
                    }
                    
                    /* Cartes et conteneurs */
                    .feature-card, .mood-card, .meditation-card, .journal-entry {
                        border-left: 4px solid ${primaryColor} !important;
                        background: ${backgroundLight} !important;
                    }
                    
                    .feature-card:hover, .mood-card:hover, .meditation-card:hover {
                        background: ${primaryLight} !important;
                        color: white !important;
                        transform: translateY(-2px);
                        box-shadow: 0 8px 25px rgba(0,0,0,0.15);
                    }
                    
                    /* Éléments de navigation */
                    .bottom-nav {
                        background: ${primaryDark} !important;
                    }
                    
                    .nav-item {
                        color: white !important;
                    }
                    
                    /* Éléments du profil */
                    .stat-item, .quick-stat {
                        background: ${primaryColor} !important;
                        color: white !important;
                        border: 1px solid ${primaryDark} !important;
                    }
                    
                    /* Éléments communauté */
                    .post, .comment-item {
                        border-left: 3px solid ${primaryColor} !important;
                        background: ${backgroundLight} !important;
                    }
                    
                    /* Assistant IA */
                    .chat-message.bot {
                        background: ${primaryColor} !important;
                        color: white !important;
                    }
                    
                    .chat-input {
                        border: 2px solid ${primaryColor} !important;
                    }
                    
                    /* Éléments d'exploration */
                    .article-card, .resource-card {
                        border-top: 4px solid ${primaryColor} !important;
                        background: ${backgroundLight} !important;
                    }
                    
                    .article-card:hover, .resource-card:hover {
                        background: ${primaryLight} !important;
                        color: white !important;
                    }
                    
                    /* Méditation et bien-être */
                    .meditation-option, .breathing-circle {
                        background: linear-gradient(45deg, ${primaryColor}, ${primaryLight}) !important;
                        color: white !important;
                    }
                    
                    /* Badges et indicateurs */
                    .badge, .notification-badge, .status-indicator {
                        background: ${primaryColor} !important;
                        color: white !important;
                    }
                    
                    /* Barres de progression */
                    .progress-bar, .mood-progress {
                        background: ${primaryColor} !important;
                    }
                    
                    /* Menu dropdown */
                    .dropdown-menu {
                        background: ${primaryDark} !important;
                        border: 1px solid ${primaryColor} !important;
                    }
                    
                    .dropdown-item {
                        color: white !important;
                    }
                    
                    .dropdown-item:hover {
                        background: ${primaryColor} !important;
                    }
                    
                    /* Modales et popups */
                    .modal-header {
                        background: ${primaryColor} !important;
                        color: white !important;
                    }
                    
                    .modal-content {
                        border: 2px solid ${primaryColor} !important;
                    }
                    
                    /* Éléments de forme */
                    .form-control:focus, .custom-select:focus {
                        border-color: ${primaryColor} !important;
                        box-shadow: 0 0 0 0.2rem rgba(${hexToRgb(primaryColor).r}, ${hexToRgb(primaryColor).g}, ${hexToRgb(primaryColor).b}, 0.25) !important;
                    }
                    
                    /* Texte global en blanc pour contraste */
                    .dashboard-content, .profile-content, .community-content, .explore-content, .chat-content, .mood-content {
                        color: white !important;
                    }
                    
                    /* Assurer la lisibilité sur tous les backgrounds */
                    .personal-data-section, .emotion-chart-container, .emotional-diagnosis, .recommendations-section {
                        background: ${primaryDark} !important;
                        color: white !important;
                    }
                    
                    /* Styles spécifiques pour Accueil/Dashboard */
                    .welcome-screen {
                        background: linear-gradient(135deg, ${backgroundLight}, ${primaryLight}) !important;
                        color: white !important;
                    }
                    
                    .dashboard-content {
                        background: ${backgroundLight} !important;
                        color: white !important;
                    }
                    
                    .dashboard-section {
                        background: ${primaryDark} !important;
                        color: white !important;
                        border: 1px solid rgba(255,255,255,0.2) !important;
                    }
                    
                    .feature-card, .insight-card, .quick-action-card {
                        background: ${primaryDark} !important;
                        color: white !important;
                        border: 1px solid rgba(255,255,255,0.2) !important;
                    }
                    
                    .feature-card:hover, .insight-card:hover, .quick-action-card:hover {
                        background: ${primaryColor} !important;
                        transform: translateY(-2px);
                    }
                    
                    /* Styles spécifiques pour l'IA/Chat */
                    .chat-content {
                        background: ${backgroundLight} !important;
                        color: white !important;
                    }
                    
                    .chat-container {
                        background: ${primaryDark} !important;
                        border: 1px solid rgba(255,255,255,0.2) !important;
                    }
                    
                    .chat-message.user {
                        background: ${primaryColor} !important;
                        color: white !important;
                    }
                    
                    .chat-message.bot {
                        background: ${primaryDark} !important;
                        color: white !important;
                        border: 1px solid rgba(255,255,255,0.2) !important;
                    }
                    
                    .chat-input {
                        background: rgba(255,255,255,0.1) !important;
                        border: 2px solid ${primaryColor} !important;
                        color: white !important;
                    }
                    
                    .chat-input::placeholder {
                        color: rgba(255,255,255,0.7) !important;
                    }
                    
                    /* Styles spécifiques pour Humeur */
                    .mood-content {
                        background: ${backgroundLight} !important;
                        color: white !important;
                    }
                    
                    .mood-tracker-container {
                        background: ${primaryDark} !important;
                        color: white !important;
                        border: 1px solid rgba(255,255,255,0.2) !important;
                    }
                    
                    .mood-option {
                        background: rgba(255,255,255,0.1) !important;
                        color: white !important;
                        border: 1px solid rgba(255,255,255,0.2) !important;
                    }
                    
                    .mood-option:hover, .mood-option.selected {
                        background: ${primaryColor} !important;
                        color: white !important;
                        border-color: white !important;
                    }
                    
                    .mood-chart, .mood-stats {
                        background: ${primaryDark} !important;
                        color: white !important;
                        border: 1px solid rgba(255,255,255,0.2) !important;
                    }
                    
                    /* Textes et titres globaux */
                    .section-title, .chart-title, .card-title {
                        color: white !important;
                    }
                    
                    .welcome-header h1, .welcome-header h2 {
                        color: white !important;
                    }
                    
                    /* Boutons et éléments interactifs génériques */
                    .btn, button {
                        background: ${primaryColor} !important;
                        color: white !important;
                        border: 1px solid ${primaryDark} !important;
                    }
                    
                    .btn:hover, button:hover {
                        background: ${primaryDark} !important;
                        color: white !important;
                    }
                </style>
            `;
            
            // Supprimer l'ancien style dynamique s'il existe
            const oldStyle = document.getElementById('dynamic-color-styles');
            if (oldStyle) {
                oldStyle.remove();
            }
            
            // Ajouter les nouveaux styles
            document.head.insertAdjacentHTML('beforeend', dynamicStyles);
        }

        // Nouvelles fonctions de personnalisation complète
        function setTextStyle(style) {
            const root = document.documentElement;
            root.setAttribute('data-text-style', style);
            
            // Mettre à jour les boutons actifs
            document.querySelectorAll('.style-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            const activeBtn = document.querySelector(`[data-style="${style}"]`);
            if (activeBtn) activeBtn.classList.add('active');
            
            // Sauvegarder
            localStorage.setItem('mindly-text-style', style);
            const styleName = style === 'white' ? 'Blanc' : style === 'dark' ? 'Sombre' : 'Coloré';
            showNotification(`✍️ Style d'écriture: ${styleName}`, 'success');
        }

        function setQuickTheme(theme) {
            const themes = {
                forest: {
                    primary: '#2E8B57',
                    light: '#90EE90', 
                    dark: '#1F5F3F',
                    name: 'Forêt 🌲'
                },
                ocean: {
                    primary: '#006994',
                    light: '#87CEEB',
                    dark: '#004461', 
                    name: 'Océan 🌊'
                },
                sunset: {
                    primary: '#FF6B35',
                    light: '#FFB587',
                    dark: '#CC5329',
                    name: 'Coucher de soleil 🌅'
                },
                lavender: {
                    primary: '#967BB6',
                    light: '#E6E6FA',
                    dark: '#6B5B73',
                    name: 'Lavande 💜'
                },
                mint: {
                    primary: '#00CED1',
                    light: '#B0FFF0',
                    dark: '#00A8AA',
                    name: 'Menthe 🍃'
                },
                cherry: {
                    primary: '#DC143C',
                    light: '#FFB6C1',
                    dark: '#B01030',
                    name: 'Cerise 🍒'
                }
            };

            const selectedTheme = themes[theme];
            if (selectedTheme) {
                const root = document.documentElement;
                
                root.style.setProperty('--primary-color', selectedTheme.primary);
                root.style.setProperty('--primary-light', selectedTheme.light);
                root.style.setProperty('--primary-dark', selectedTheme.dark);
                root.style.setProperty('--secondary-color', lightenColor(selectedTheme.primary, 30));
                root.style.setProperty('--background-light', lightenColor(selectedTheme.primary, 80));
                root.style.setProperty('--background-medium', lightenColor(selectedTheme.primary, 65));
                root.style.setProperty('--background-dark', lightenColor(selectedTheme.primary, 45));
                
                // Forcer le texte blanc pour cohérence
                root.style.setProperty('--text-primary', '#FFFFFF');
                root.style.setProperty('--text-secondary', '#FFFFFF');
                root.style.setProperty('--text-muted', '#FFFFFF');
                root.setAttribute('data-text-style', 'white');
                
                // Appliquer la couleur à tous les éléments de l'interface
                applyColorToAllElements(selectedTheme.primary);
                
                // Sauvegarder
                localStorage.setItem('mindly-theme-type', 'quick');
                localStorage.setItem('mindly-quick-theme', theme);
                localStorage.setItem('mindly-text-style', 'white');
                
                showNotification(`🌈 Thème appliqué à toute l'application: ${selectedTheme.name}`, 'success');
            }
        }

        function resetToDefault() {
            const root = document.documentElement;
            
            // Réinitialiser aux couleurs par défaut
            root.style.setProperty('--primary-color', '#4CAF50');
            root.style.setProperty('--primary-light', '#66BB6A');
            root.style.setProperty('--primary-dark', '#2E7D32');
            root.style.setProperty('--secondary-color', '#8BC34A');
            root.style.setProperty('--background-light', '#E8F5E8');
            root.style.setProperty('--background-medium', '#C8E6C9');
            root.style.setProperty('--background-dark', '#A5D6A7');
            
            // Réinitialiser le style de texte
            root.setAttribute('data-text-style', 'white');
            
            // Nettoyer localStorage
            localStorage.removeItem('mindly-custom-color');
            localStorage.removeItem('mindly-theme-type');
            localStorage.removeItem('mindly-quick-theme');
            localStorage.removeItem('mindly-text-style');
            
            showNotification('🔄 Paramètres réinitialisés par défaut', 'success');
        }

        // Fonction pour afficher le modal de personnalisation
        function showPersonalizationModal() {
            const modal = createQuickModal('🎨 Personnalisation', `
                <div style="padding: 20px; color: var(--text-primary);">
                    <!-- Style d'écriture -->
                    <div style="margin-bottom: 25px;">
                        <h4 style="color: var(--text-primary); margin-bottom: 15px;">✨ Style de Texte</h4>
                        <div style="display: flex; gap: 10px; flex-wrap: wrap;">
                            <button class="style-btn active" onclick="setTextStyle('white')" data-style="white" style="padding: 8px 16px; border: 2px solid var(--primary-color); border-radius: 20px; background: var(--background-light); cursor: pointer;">
                                <span style="color: white; background: #333; padding: 2px 6px; border-radius: 4px;">Blanc</span>
                            </button>
                            <button class="style-btn" onclick="setTextStyle('dark')" data-style="dark" style="padding: 8px 16px; border: 2px solid var(--primary-color); border-radius: 20px; background: var(--background-light); cursor: pointer;">
                                <span style="color: #333; background: white; padding: 2px 6px; border-radius: 4px;">Sombre</span>
                            </button>
                            <button class="style-btn" onclick="setTextStyle('colorful')" data-style="colorful" style="padding: 8px 16px; border: 2px solid var(--primary-color); border-radius: 20px; background: var(--background-light); cursor: pointer;">
                                <span style="background: linear-gradient(45deg, #FF6B6B, #4ECDC4); -webkit-background-clip: text; -webkit-text-fill-color: transparent; padding: 2px 6px; font-weight: bold;">Coloré</span>
                            </button>
                        </div>
                    </div>

                    <!-- Thèmes rapides -->
                    <div style="margin-bottom: 25px;">
                        <h4 style="color: var(--text-primary); margin-bottom: 15px;">🌈 Thèmes Rapides</h4>
                        <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px;">
                            <div onclick="setQuickTheme('forest')" style="background: linear-gradient(135deg, #2E7D32, #4CAF50); padding: 15px; border-radius: 10px; cursor: pointer; text-align: center; color: white; font-weight: 600;">🌲 Forêt</div>
                            <div onclick="setQuickTheme('ocean')" style="background: linear-gradient(135deg, #1565C0, #42A5F5); padding: 15px; border-radius: 10px; cursor: pointer; text-align: center; color: white; font-weight: 600;">🌊 Océan</div>
                            <div onclick="setQuickTheme('sunset')" style="background: linear-gradient(135deg, #F57C00, #FF9800); padding: 15px; border-radius: 10px; cursor: pointer; text-align: center; color: white; font-weight: 600;">🌅 Coucher</div>
                            <div onclick="setQuickTheme('lavander')" style="background: linear-gradient(135deg, #7B1FA2, #BA68C8); padding: 15px; border-radius: 10px; cursor: pointer; text-align: center; color: white; font-weight: 600;">🌸 Lavande</div>
                            <div onclick="setQuickTheme('mint')" style="background: linear-gradient(135deg, #00CED1, #B0FFF0); padding: 15px; border-radius: 10px; cursor: pointer; text-align: center; color: white; font-weight: 600;">🍃 Menthe</div>
                            <div onclick="setQuickTheme('cherry')" style="background: linear-gradient(135deg, #DC143C, #FFB6C1); padding: 15px; border-radius: 10px; cursor: pointer; text-align: center; color: white; font-weight: 600;">🍒 Cerise</div>
                        </div>
                    </div>

                    <!-- Couleurs personnalisées -->
                    <div style="margin-bottom: 25px;">
                        <h4 style="color: var(--text-primary); margin-bottom: 15px;">🎨 Couleur Personnalisée</h4>
                        <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 8px; margin-bottom: 15px;">
                            <div style="background: #FF5722; width: 40px; height: 40px; border-radius: 50%; cursor: pointer; border: 3px solid transparent;" onclick="setCustomColor('#FF5722')" title="Rouge Vif"></div>
                            <div style="background: #2196F3; width: 40px; height: 40px; border-radius: 50%; cursor: pointer; border: 3px solid transparent;" onclick="setCustomColor('#2196F3')" title="Bleu Moderne"></div>
                            <div style="background: #4CAF50; width: 40px; height: 40px; border-radius: 50%; cursor: pointer; border: 3px solid var(--primary-color);" onclick="setCustomColor('#4CAF50')" title="Vert Naturel"></div>
                            <div style="background: #E91E63; width: 40px; height: 40px; border-radius: 50%; cursor: pointer; border: 3px solid transparent;" onclick="setCustomColor('#E91E63')" title="Rose Dynamique"></div>
                            <div style="background: #9C27B0; width: 40px; height: 40px; border-radius: 50%; cursor: pointer; border: 3px solid transparent;" onclick="setCustomColor('#9C27B0')" title="Violet Créatif"></div>
                            <div style="background: #FF9800; width: 40px; height: 40px; border-radius: 50%; cursor: pointer; border: 3px solid transparent;" onclick="setCustomColor('#FF9800')" title="Orange Énergique"></div>
                            <div style="background: #607D8B; width: 40px; height: 40px; border-radius: 50%; cursor: pointer; border: 3px solid transparent;" onclick="setCustomColor('#607D8B')" title="Gris Élégant"></div>
                            <div style="background: #795548; width: 40px; height: 40px; border-radius: 50%; cursor: pointer; border: 3px solid transparent;" onclick="setCustomColor('#795548')" title="Marron Terre"></div>
                        </div>
                        <input type="color" style="width: 100%; height: 40px; border: none; border-radius: 10px; cursor: pointer;" onchange="setCustomColor(this.value)" value="#4CAF50" title="Choisir une couleur unique">
                    </div>

                    <!-- Réinitialisation -->
                    <div style="text-align: center;">
                        <button onclick="resetToDefault()" style="background: var(--background-medium); border: 2px solid var(--primary-color); color: var(--text-primary); padding: 12px 24px; border-radius: 25px; cursor: pointer; font-weight: 600;">
                            🔄 Réinitialiser par défaut
                        </button>
                    </div>
                </div>
            `, '90%');
        }

        // Nouvelles fonctions pour les fonctionnalités de sécurité
        function toggleAnonymousMode() {
            const isAnonymous = localStorage.getItem('mindly-anonymous-mode') === 'true';
            const newMode = !isAnonymous;
            
            localStorage.setItem('mindly-anonymous-mode', newMode);
            
            if (newMode) {
                showNotification('🕶️ Mode anonyme activé - Vos données sont maintenant masquées', 'success');
            } else {
                showNotification('👤 Mode anonyme désactivé - Vos données sont visibles', 'info');
            }
            
            // Mettre à jour l'affichage
            updateUIForAnonymousMode(newMode);
        }

        function updateUIForAnonymousMode(isAnonymous) {
            const userNameElements = document.querySelectorAll('.user-name');
            const userStatsElements = document.querySelectorAll('.user-stats');
            
            userNameElements.forEach(element => {
                if (isAnonymous) {
                    element.textContent = 'Utilisateur Anonyme';
                } else {
                    element.textContent = 'Nana B.';
                }
            });
        }

        function showPrivacySettings() {
            showCustomModal({
                title: '🔐 Paramètres de Confidentialité',
                content: `
                    <div style="padding: 20px; color: var(--text-primary);">
                        <div style="margin-bottom: 20px;">
                            <h4>🛡️ Protection des Données</h4>
                            <div style="background: var(--background-light); padding: 15px; border-radius: 10px; margin: 10px 0;">
                                <label style="display: flex; align-items: center; cursor: pointer;">
                                    <input type="checkbox" checked style="margin-right: 10px;">
                                    <span>Chiffrement des données locales</span>
                                </label>
                            </div>
                            <div style="background: var(--background-light); padding: 15px; border-radius: 10px; margin: 10px 0;">
                                <label style="display: flex; align-items: center; cursor: pointer;">
                                    <input type="checkbox" checked style="margin-right: 10px;">
                                    <span>Suppression automatique des sessions</span>
                                </label>
                            </div>
                        </div>
                        
                        <div style="margin-bottom: 20px;">
                            <h4>📊 Collecte de Données</h4>
                            <div style="background: var(--background-light); padding: 15px; border-radius: 10px; margin: 10px 0;">
                                <label style="display: flex; align-items: center; cursor: pointer;">
                                    <input type="checkbox" style="margin-right: 10px;">
                                    <span>Autoriser les analyses d'amélioration</span>
                                </label>
                            </div>
                            <div style="background: var(--background-light); padding: 15px; border-radius: 10px; margin: 10px 0;">
                                <label style="display: flex; align-items: center; cursor: pointer;">
                                    <input type="checkbox" style="margin-right: 10px;">
                                    <span>Partager les données anonymisées</span>
                                </label>
                            </div>
                        </div>

                        <div style="margin-bottom: 20px;">
                            <h4>🔒 Sécurité Avancée</h4>
                            <div style="background: var(--background-light); padding: 15px; border-radius: 10px; margin: 10px 0;">
                                <label style="display: flex; align-items: center; cursor: pointer;">
                                    <input type="checkbox" style="margin-right: 10px;">
                                    <span>Authentification à deux facteurs</span>
                                </label>
                            </div>
                            <div style="background: var(--background-light); padding: 15px; border-radius: 10px; margin: 10px 0;">
                                <label style="display: flex; align-items: center; cursor: pointer;">
                                    <input type="checkbox" checked style="margin-right: 10px;">
                                    <span>Verrouillage automatique</span>
                                </label>
                            </div>
                        </div>

                        <div style="text-align: center; margin-top: 25px;">
                            <button onclick="savePrivacySettings()" style="background: var(--primary-color); color: white; border: none; padding: 12px 24px; border-radius: 25px; cursor: pointer; font-weight: 600;">
                                💾 Sauvegarder les Paramètres
                            </button>
                        </div>
                    </div>
                `
            });
        }

        function showDataManagement() {
            showCustomModal({
                title: '📊 Gestion de Mes Données',
                content: `
                    <div style="padding: 20px; color: var(--text-primary);">
                        <div style="background: var(--background-light); padding: 20px; border-radius: 15px; margin-bottom: 20px;">
                            <h4>📈 Résumé des Données Stockées</h4>
                            <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 15px; margin-top: 15px;">
                                <div style="text-align: center; padding: 15px; background: rgba(76,175,80,0.1); border-radius: 10px;">
                                    <div style="font-size: 24px; font-weight: bold; color: var(--primary-color);">147</div>
                                    <div style="font-size: 12px; color: var(--text-secondary);">Sessions Humeur</div>
                                </div>
                                <div style="text-align: center; padding: 15px; background: rgba(76,175,80,0.1); border-radius: 10px;">
                                    <div style="font-size: 24px; font-weight: bold; color: var(--primary-color);">23</div>
                                    <div style="font-size: 12px; color: var(--text-secondary);">Conversations MINA</div>
                                </div>
                                <div style="text-align: center; padding: 15px; background: rgba(76,175,80,0.1); border-radius: 10px;">
                                    <div style="font-size: 24px; font-weight: bold; color: var(--primary-color);">8.7 MB</div>
                                    <div style="font-size: 12px; color: var(--text-secondary);">Espace Utilisé</div>
                                </div>
                                <div style="text-align: center; padding: 15px; background: rgba(76,175,80,0.1); border-radius: 10px;">
                                    <div style="font-size: 24px; font-weight: bold; color: var(--primary-color);">47</div>
                                    <div style="font-size: 12px; color: var(--text-secondary);">Jours d'Historique</div>
                                </div>
                            </div>
                        </div>

                        <div style="margin-bottom: 20px;">
                            <h4>🔧 Actions sur les Données</h4>
                            <div style="display: flex; flex-direction: column; gap: 10px;">
                                <button onclick="exportUserData()" style="background: var(--primary-color); color: white; border: none; padding: 12px; border-radius: 10px; cursor: pointer; display: flex; align-items: center; gap: 10px;">
                                    <span>📁</span> Exporter toutes mes données
                                </button>
                                <button onclick="clearOldData()" style="background: #FF9800; color: white; border: none; padding: 12px; border-radius: 10px; cursor: pointer; display: flex; align-items: center; gap: 10px;">
                                    <span>🧹</span> Nettoyer les données anciennes
                                </button>
                                <button onclick="anonymizeData()" style="background: #9C27B0; color: white; border: none; padding: 12px; border-radius: 10px; cursor: pointer; display: flex; align-items: center; gap: 10px;">
                                    <span>🕶️</span> Anonymiser mes données
                                </button>
                                <button onclick="deleteAllData()" style="background: #F44336; color: white; border: none; padding: 12px; border-radius: 10px; cursor: pointer; display: flex; align-items: center; gap: 10px;">
                                    <span>🗑️</span> Supprimer toutes les données
                                </button>
                            </div>
                        </div>

                        <div style="background: rgba(255,193,7,0.1); padding: 15px; border-radius: 10px; border-left: 4px solid #FFC107;">
                            <h5 style="margin: 0 0 8px 0; color: #F57C00;">⚠️ Informations importantes</h5>
                            <p style="margin: 0; font-size: 13px; color: var(--text-secondary);">
                                Vos données sont stockées localement sur votre appareil. Aucune donnée personnelle n'est envoyée vers nos serveurs sans votre consentement explicite.
                            </p>
                        </div>
                    </div>
                `
            });
        }

        function showSecuritySettings() {
            showCustomModal({
                title: '🛡️ Paramètres de Sécurité',
                content: `
                    <div style="padding: 20px; color: var(--text-primary);">
                        <div style="margin-bottom: 25px;">
                            <h4>🔐 Authentification</h4>
                            <div style="background: var(--background-light); padding: 15px; border-radius: 10px; margin: 10px 0;">
                                <div style="display: flex; justify-content: space-between; align-items: center;">
                                    <span>Verrouillage par code PIN</span>
                                    <label style="position: relative; display: inline-block; width: 50px; height: 24px;">
                                        <input type="checkbox" style="opacity: 0; width: 0; height: 0;">
                                        <span style="position: absolute; cursor: pointer; top: 0; left: 0; right: 0; bottom: 0; background-color: #ccc; transition: .4s; border-radius: 24px; background-color: var(--primary-color);"></span>
                                    </label>
                                </div>
                            </div>
                            <div style="background: var(--background-light); padding: 15px; border-radius: 10px; margin: 10px 0;">
                                <div style="display: flex; justify-content: space-between; align-items: center;">
                                    <span>Empreinte digitale</span>
                                    <label style="position: relative; display: inline-block; width: 50px; height: 24px;">
                                        <input type="checkbox" style="opacity: 0; width: 0; height: 0;">
                                        <span style="position: absolute; cursor: pointer; top: 0; left: 0; right: 0; bottom: 0; background-color: #ccc; transition: .4s; border-radius: 24px;"></span>
                                    </label>
                                </div>
                            </div>
                        </div>

                        <div style="margin-bottom: 25px;">
                            <h4>⏰ Sessions</h4>
                            <div style="background: var(--background-light); padding: 15px; border-radius: 10px; margin: 10px 0;">
                                <label>Délai d'expiration automatique:</label>
                                <select style="width: 100%; padding: 8px; margin-top: 5px; border: 1px solid #ddd; border-radius: 5px;">
                                    <option>15 minutes</option>
                                    <option selected>30 minutes</option>
                                    <option>1 heure</option>
                                    <option>2 heures</option>
                                    <option>Jamais</option>
                                </select>
                            </div>
                        </div>

                        <div style="margin-bottom: 25px;">
                            <h4>🚨 Alertes de Sécurité</h4>
                            <div style="background: var(--background-light); padding: 15px; border-radius: 10px; margin: 10px 0;">
                                <div style="display: flex; justify-content: space-between; align-items: center;">
                                    <span>Connexions suspectes</span>
                                    <label style="position: relative; display: inline-block; width: 50px; height: 24px;">
                                        <input type="checkbox" checked style="opacity: 0; width: 0; height: 0;">
                                        <span style="position: absolute; cursor: pointer; top: 0; left: 0; right: 0; bottom: 0; background-color: var(--primary-color); transition: .4s; border-radius: 24px;"></span>
                                    </label>
                                </div>
                            </div>
                            <div style="background: var(--background-light); padding: 15px; border-radius: 10px; margin: 10px 0;">
                                <div style="display: flex; justify-content: space-between; align-items: center;">
                                    <span>Modifications de données</span>
                                    <label style="position: relative; display: inline-block; width: 50px; height: 24px;">
                                        <input type="checkbox" checked style="opacity: 0; width: 0; height: 0;">
                                        <span style="position: absolute; cursor: pointer; top: 0; left: 0; right: 0; bottom: 0; background-color: var(--primary-color); transition: .4s; border-radius: 24px;"></span>
                                    </label>
                                </div>
                            </div>
                        </div>

                        <div style="background: rgba(76,175,80,0.1); padding: 15px; border-radius: 10px; border-left: 4px solid var(--primary-color);">
                            <h5 style="margin: 0 0 8px 0; color: var(--primary-color);">🔒 Sécurité Active</h5>
                            <p style="margin: 0; font-size: 13px; color: var(--text-secondary);">
                                Votre application est protégée par un chiffrement AES-256 et toutes les communications sont sécurisées.
                            </p>
                        </div>

                        <div style="text-align: center; margin-top: 25px;">
                            <button onclick="saveSecuritySettings()" style="background: var(--primary-color); color: white; border: none; padding: 12px 24px; border-radius: 25px; cursor: pointer; font-weight: 600;">
                                🛡️ Sauvegarder la Configuration
                            </button>
                        </div>
                    </div>
                `
            });
        }

        // Fonctions d'action pour la gestion des données
        function exportUserData() {
            showNotification('📁 Export des données en cours...', 'info');
            setTimeout(() => {
                showNotification('✅ Données exportées avec succès!', 'success');
            }, 2000);
        }

        function clearOldData() {
            showConfirmDialog(
                '🧹 Nettoyer les Données Anciennes',
                'Voulez-vous supprimer les données de plus de 30 jours ?',
                () => {
                    showNotification('🧹 Données anciennes supprimées', 'success');
                }
            );
        }

        function anonymizeData() {
            showConfirmDialog(
                '🕶️ Anonymiser les Données',
                'Cette action rendra vos données complètement anonymes. Continuer ?',
                () => {
                    showNotification('🕶️ Données anonymisées avec succès', 'success');
                }
            );
        }

        function deleteAllData() {
            showConfirmDialog(
                '🗑️ Supprimer Toutes les Données',
                'ATTENTION: Cette action supprimera définitivement toutes vos données. Cette action est irréversible !',
                () => {
                    localStorage.clear();
                    showNotification('🗑️ Toutes les données ont été supprimées', 'info');
                    setTimeout(() => location.reload(), 2000);
                }
            );
        }

        // Fonctions de sauvegarde des paramètres
        function savePrivacySettings() {
            showNotification('🔐 Paramètres de confidentialité sauvegardés', 'success');
        }

        function saveSecuritySettings() {
            showNotification('🛡️ Paramètres de sécurité sauvegardés', 'success');
        }

        // Nouvelles fonctions pour les fonctionnalités du menu complet
        function showNotificationSettings() {
            showCustomModal({
                title: '🔔 Paramètres de Notifications',
                content: `
                    <div style="padding: 20px; color: var(--text-primary);">
                        <div style="margin-bottom: 25px;">
                            <h4>📱 Notifications Push</h4>
                            <div style="background: var(--background-light); padding: 15px; border-radius: 10px; margin: 10px 0;">
                                <div style="display: flex; justify-content: space-between; align-items: center;">
                                    <span>Rappels d'humeur</span>
                                    <label style="position: relative; display: inline-block; width: 50px; height: 24px;">
                                        <input type="checkbox" checked style="opacity: 0; width: 0; height: 0;">
                                        <span style="position: absolute; cursor: pointer; top: 0; left: 0; right: 0; bottom: 0; background-color: var(--primary-color); transition: .4s; border-radius: 24px;"></span>
                                    </label>
                                </div>
                            </div>
                            <div style="background: var(--background-light); padding: 15px; border-radius: 10px; margin: 10px 0;">
                                <div style="display: flex; justify-content: space-between; align-items: center;">
                                    <span>Messages MINA</span>
                                    <label style="position: relative; display: inline-block; width: 50px; height: 24px;">
                                        <input type="checkbox" checked style="opacity: 0; width: 0; height: 0;">
                                        <span style="position: absolute; cursor: pointer; top: 0; left: 0; right: 0; bottom: 0; background-color: var(--primary-color); transition: .4s; border-radius: 24px;"></span>
                                    </label>
                                </div>
                            </div>
                        </div>
                        
                        <div style="margin-bottom: 25px;">
                            <h4>⏰ Horaires</h4>
                            <div style="background: var(--background-light); padding: 15px; border-radius: 10px; margin: 10px 0;">
                                <label>Ne pas déranger de:</label>
                                <input type="time" value="22:00" style="width: 100%; padding: 8px; margin-top: 5px; border: 1px solid #ddd; border-radius: 5px;">
                            </div>
                            <div style="background: var(--background-light); padding: 15px; border-radius: 10px; margin: 10px 0;">
                                <label>Jusqu'à:</label>
                                <input type="time" value="07:00" style="width: 100%; padding: 8px; margin-top: 5px; border: 1px solid #ddd; border-radius: 5px;">
                            </div>
                        </div>

                        <div style="text-align: center; margin-top: 25px;">
                            <button onclick="saveNotificationSettings()" style="background: var(--primary-color); color: white; border: none; padding: 12px 24px; border-radius: 25px; cursor: pointer; font-weight: 600;">
                                🔔 Sauvegarder les Notifications
                            </button>
                        </div>
                    </div>
                `
            });
        }

        function showLanguageSettings() {
            showCustomModal({
                title: '🌐 Langue & Région',
                content: `
                    <div style="padding: 20px; color: var(--text-primary);">
                        <div style="margin-bottom: 25px;">
                            <h4>🌍 Langue de l'Interface</h4>
                            <select style="width: 100%; padding: 12px; border: 1px solid #ddd; border-radius: 10px; font-size: 16px;">
                                <option selected>🇫🇷 Français</option>
                                <option>🇺🇸 English</option>
                                <option>🇪🇸 Español</option>
                                <option>🇩🇪 Deutsch</option>
                                <option>🇮🇹 Italiano</option>
                            </select>
                        </div>
                        
                        <div style="margin-bottom: 25px;">
                            <h4>📍 Région</h4>
                            <select style="width: 100%; padding: 12px; border: 1px solid #ddd; border-radius: 10px; font-size: 16px;">
                                <option selected>France</option>
                                <option>Belgium</option>
                                <option>Switzerland</option>
                                <option>Canada</option>
                            </select>
                        </div>

                        <div style="margin-bottom: 25px;">
                            <h4>🕒 Format</h4>
                            <div style="background: var(--background-light); padding: 15px; border-radius: 10px; margin: 10px 0;">
                                <div style="display: flex; justify-content: space-between; align-items: center;">
                                    <span>Format 24h</span>
                                    <label style="position: relative; display: inline-block; width: 50px; height: 24px;">
                                        <input type="checkbox" checked style="opacity: 0; width: 0; height: 0;">
                                        <span style="position: absolute; cursor: pointer; top: 0; left: 0; right: 0; bottom: 0; background-color: var(--primary-color); transition: .4s; border-radius: 24px;"></span>
                                    </label>
                                </div>
                            </div>
                        </div>

                        <div style="text-align: center; margin-top: 25px;">
                            <button onclick="saveLanguageSettings()" style="background: var(--primary-color); color: white; border: none; padding: 12px 24px; border-radius: 25px; cursor: pointer; font-weight: 600;">
                                🌐 Sauvegarder les Préférences
                            </button>
                        </div>
                    </div>
                `
            });
        }

        function showAccessibilitySettings() {
            showCustomModal({
                title: '♿ Paramètres d\'Accessibilité',
                content: `
                    <div style="padding: 20px; color: var(--text-primary);">
                        <div style="margin-bottom: 25px;">
                            <h4>👁️ Vision</h4>
                            <div style="background: var(--background-light); padding: 15px; border-radius: 10px; margin: 10px 0;">
                                <label>Taille du texte:</label>
                                <input type="range" min="12" max="24" value="16" style="width: 100%; margin-top: 5px;">
                                <div style="text-align: center; margin-top: 5px; font-size: 14px; color: var(--text-secondary);">16px</div>
                            </div>
                            <div style="background: var(--background-light); padding: 15px; border-radius: 10px; margin: 10px 0;">
                                <div style="display: flex; justify-content: space-between; align-items: center;">
                                    <span>Contraste élevé</span>
                                    <label style="position: relative; display: inline-block; width: 50px; height: 24px;">
                                        <input type="checkbox" style="opacity: 0; width: 0; height: 0;">
                                        <span style="position: absolute; cursor: pointer; top: 0; left: 0; right: 0; bottom: 0; background-color: #ccc; transition: .4s; border-radius: 24px;"></span>
                                    </label>
                                </div>
                            </div>
                        </div>
                        
                        <div style="margin-bottom: 25px;">
                            <h4>🔊 Audio</h4>
                            <div style="background: var(--background-light); padding: 15px; border-radius: 10px; margin: 10px 0;">
                                <div style="display: flex; justify-content: space-between; align-items: center;">
                                    <span>Sons de notification</span>
                                    <label style="position: relative; display: inline-block; width: 50px; height: 24px;">
                                        <input type="checkbox" checked style="opacity: 0; width: 0; height: 0;">
                                        <span style="position: absolute; cursor: pointer; top: 0; left: 0; right: 0; bottom: 0; background-color: var(--primary-color); transition: .4s; border-radius: 24px;"></span>
                                    </label>
                                </div>
                            </div>
                        </div>

                        <div style="text-align: center; margin-top: 25px;">
                            <button onclick="saveAccessibilitySettings()" style="background: var(--primary-color); color: white; border: none; padding: 12px 24px; border-radius: 25px; cursor: pointer; font-weight: 600;">
                                ♿ Sauvegarder l'Accessibilité
                            </button>
                        </div>
                    </div>
                `
            });
        }

        function showBackupSettings() {
            showCustomModal({
                title: '☁️ Sauvegarde & Synchronisation',
                content: `
                    <div style="padding: 20px; color: var(--text-primary);">
                        <div style="margin-bottom: 25px;">
                            <h4>📤 Sauvegarde Automatique</h4>
                            <div style="background: var(--background-light); padding: 15px; border-radius: 10px; margin: 10px 0;">
                                <div style="display: flex; justify-content: space-between; align-items: center;">
                                    <span>Sauvegarde locale</span>
                                    <label style="position: relative; display: inline-block; width: 50px; height: 24px;">
                                        <input type="checkbox" checked style="opacity: 0; width: 0; height: 0;">
                                        <span style="position: absolute; cursor: pointer; top: 0; left: 0; right: 0; bottom; background-color: var(--primary-color); transition: .4s; border-radius: 24px;"></span>
                                    </label>
                                </div>
                            </div>
                        </div>
                        
                        <div style="margin-bottom: 25px;">
                            <h4>🔄 Synchronisation</h4>
                            <div style="display: flex; flex-direction: column; gap: 10px;">
                                <button onclick="createBackup()" style="background: var(--primary-color); color: white; border: none; padding: 12px; border-radius: 10px; cursor: pointer;">
                                    💾 Créer une sauvegarde maintenant
                                </button>
                                <button onclick="restoreBackup()" style="background: #FF9800; color: white; border: none; padding: 12px; border-radius: 10px; cursor: pointer;">
                                    📂 Restaurer une sauvegarde
                                </button>
                            </div>
                        </div>

                        <div style="background: rgba(76,175,80,0.1); padding: 15px; border-radius: 10px; border-left: 4px solid var(--primary-color);">
                            <p style="margin: 0; font-size: 13px; color: var(--text-secondary);">
                                📱 Dernière sauvegarde: Aujourd'hui 14:30<br>
                                💾 Taille: 2.3 MB
                            </p>
                        </div>
                    </div>
                `
            });
        }

        // Fonctions pour l'aide et support
        function showFAQ() {
            showCustomModal({
                title: '📚 Questions Fréquemment Posées',
                content: `
                    <div style="padding: 20px; color: var(--text-primary); max-height: 70vh; overflow-y: auto;">
                        <div style="margin-bottom: 20px;">
                            <h4 style="cursor: pointer; background: var(--background-light); padding: 15px; border-radius: 10px; margin: 5px 0;" onclick="toggleFAQ(this)">
                                <span>▶️</span> Comment utiliser MINA, l'assistant IA ?
                            </h4>
                            <div style="display: none; padding: 15px; background: rgba(76,175,80,0.1); border-radius: 10px; margin: 5px 0;">
                                MINA est votre assistant personnel de bien-être. Posez-lui des questions, demandez des conseils ou partagez vos préoccupations. Elle peut vous proposer des exercices, des techniques de relaxation et vous accompagner dans votre parcours de bien-être.
                            </div>
                        </div>
                        
                        <div style="margin-bottom: 20px;">
                            <h4 style="cursor: pointer; background: var(--background-light); padding: 15px; border-radius: 10px; margin: 5px 0;" onclick="toggleFAQ(this)">
                                <span>▶️</span> Mes données sont-elles sécurisées ?
                            </h4>
                            <div style="display: none; padding: 15px; background: rgba(76,175,80,0.1); border-radius: 10px; margin: 5px 0;">
                                Absolument ! Toutes vos données sont stockées localement sur votre appareil. Nous utilisons un chiffrement AES-256 pour protéger vos informations personnelles. Vous pouvez également activer le mode anonyme pour une protection supplémentaire.
                            </div>
                        </div>
                        
                        <div style="margin-bottom: 20px;">
                            <h4 style="cursor: pointer; background: var(--background-light); padding: 15px; border-radius: 10px; margin: 5px 0;" onclick="toggleFAQ(this)">
                                <span>▶️</span> Comment suivre mon humeur efficacement ?
                            </h4>
                            <div style="display: none; padding: 15px; background: rgba(76,175,80,0.1); border-radius: 10px; margin: 5px 0;">
                                Utilisez le tableau de bord pour enregistrer votre humeur quotidiennement. Plus vous êtes régulier, plus les analyses de MINA seront précises. N'hésitez pas à ajouter des notes pour contextualiser vos émotions.
                            </div>
                        </div>
                        
                        <div style="margin-bottom: 20px;">
                            <h4 style="cursor: pointer; background: var(--background-light); padding: 15px; border-radius: 10px; margin: 5px 0;" onclick="toggleFAQ(this)">
                                <span>▶️</span> Puis-je personnaliser l'apparence de l'app ?
                            </h4>
                            <div style="display: none; padding: 15px; background: rgba(76,175,80,0.1); border-radius: 10px; margin: 5px 0;">
                                Oui ! Accédez aux paramètres de personnalisation via le menu hamburger. Vous pouvez choisir parmi plusieurs thèmes, personnaliser les couleurs et ajuster la taille du texte pour une meilleure accessibilité.
                            </div>
                        </div>
                    </div>
                `
            });
        }

        // Fonctions utilitaires pour les interactions
        function toggleFAQ(element) {
            const content = element.nextElementSibling;
            const arrow = element.querySelector('span');
            
            if (content.style.display === 'none' || !content.style.display) {
                content.style.display = 'block';
                arrow.textContent = '▼';
            } else {
                content.style.display = 'none';
                arrow.textContent = '▶️';
            }
        }

        // Autres fonctions pour les nouvelles fonctionnalités
        function showFeedback() {
            showCustomModal({
                title: '⭐ Donner votre Avis',
                content: `
                    <div style="padding: 20px; color: var(--text-primary);">
                        <div style="text-align: center; margin-bottom: 25px;">
                            <h4>Que pensez-vous de MINDLY ?</h4>
                            <div style="display: flex; justify-content: center; gap: 10px; margin: 15px 0;">
                                <span onclick="setRating(1)" style="font-size: 30px; cursor: pointer;">⭐</span>
                                <span onclick="setRating(2)" style="font-size: 30px; cursor: pointer;">⭐</span>
                                <span onclick="setRating(3)" style="font-size: 30px; cursor: pointer;">⭐</span>
                                <span onclick="setRating(4)" style="font-size: 30px; cursor: pointer;">⭐</span>
                                <span onclick="setRating(5)" style="font-size: 30px; cursor: pointer;">⭐</span>
                            </div>
                        </div>
                        
                        <div style="margin-bottom: 20px;">
                            <h4>💬 Votre commentaire</h4>
                            <textarea placeholder="Partagez votre expérience avec MINDLY..." style="width: 100%; height: 120px; padding: 15px; border: 1px solid #ddd; border-radius: 10px; resize: vertical;"></textarea>
                        </div>
                        
                        <div style="text-align: center;">
                            <button onclick="submitFeedback()" style="background: var(--primary-color); color: white; border: none; padding: 12px 24px; border-radius: 25px; cursor: pointer; font-weight: 600;">
                                📨 Envoyer l'Avis
                            </button>
                        </div>
                    </div>
                `
            });
        }

        function showPrivacyPolicy() {
            showCustomModal({
                title: '🔏 Politique de Confidentialité',
                content: `
                    <div style="padding: 20px; color: var(--text-primary); max-height: 70vh; overflow-y: auto;">
                        <div style="margin-bottom: 25px;">
                            <h4>📊 Collecte de Données</h4>
                            <p style="line-height: 1.6; color: var(--text-secondary);">
                                MINDLY collecte uniquement les données nécessaires à son fonctionnement :
                            </p>
                            <ul style="line-height: 1.6; color: var(--text-secondary);">
                                <li>Données d'humeur et de bien-être</li>
                                <li>Préférences d'interface utilisateur</li>
                                <li>Conversations avec MINA (stockées localement)</li>
                                <li>Paramètres de personnalisation</li>
                            </ul>
                        </div>
                        
                        <div style="margin-bottom: 25px;">
                            <h4>🔒 Protection des Données</h4>
                            <p style="line-height: 1.6; color: var(--text-secondary);">
                                Vos données sont protégées par un chiffrement AES-256 et stockées exclusivement sur votre appareil. Aucune donnée personnelle n'est transmise à nos serveurs sans votre consentement explicite.
                            </p>
                        </div>
                        
                        <div style="margin-bottom: 25px;">
                            <h4>👤 Vos Droits</h4>
                            <ul style="line-height: 1.6; color: var(--text-secondary);">
                                <li>Accès à toutes vos données</li>
                                <li>Modification de vos informations</li>
                                <li>Suppression complète de vos données</li>
                                <li>Export de vos données personnelles</li>
                            </ul>
                        </div>
                        
                        <div style="background: rgba(76,175,80,0.1); padding: 15px; border-radius: 10px; border-left: 4px solid var(--primary-color);">
                            <p style="margin: 0; font-size: 14px; color: var(--text-secondary);">
                                Cette politique est effective depuis le 12 novembre 2025. Pour toute question, contactez-nous à privacy@mindly-app.com
                            </p>
                        </div>
                    </div>
                `
            });
        }

        function showLicenses() {
            showCustomModal({
                title: '⚖️ Licences',
                content: `
                    <div style="padding: 20px; color: var(--text-primary); max-height: 70vh; overflow-y: auto;">
                        <div style="margin-bottom: 25px;">
                            <h4>📱 MINDLY App</h4>
                            <p style="color: var(--text-secondary);">Copyright © 2025 MINDLY Team</p>
                            <p style="color: var(--text-secondary); font-size: 14px;">Licence MIT - Usage personnel et éducatif autorisé</p>
                        </div>
                        
                        <div style="margin-bottom: 25px;">
                            <h4>🤖 Intelligence Artificielle</h4>
                            <p style="color: var(--text-secondary); font-size: 14px;">MINA utilise des technologies d'IA open-source sous licence Apache 2.0</p>
                        </div>
                        
                        <div style="margin-bottom: 25px;">
                            <h4>🎨 Ressources Graphiques</h4>
                            <ul style="color: var(--text-secondary); font-size: 14px; line-height: 1.6;">
                                <li>Icônes: Open Source Icons (MIT)</li>
                                <li>Polices: Inter Font (SIL OFL 1.1)</li>
                                <li>Illustrations: Custom Design</li>
                            </ul>
                        </div>
                        
                        <div style="background: rgba(255,193,7,0.1); padding: 15px; border-radius: 10px; border-left: 4px solid #FFC107;">
                            <p style="margin: 0; font-size: 13px; color: var(--text-secondary);">
                                📄 Licence complète disponible sur demande à legal@mindly-app.com
                            </p>
                        </div>
                    </div>
                `
            });
        }

        // Fonctions utilitaires additionnelles
        function showTermsOfService() {
            showCustomModal({
                title: '📜 Conditions d\'Utilisation',
                content: `
                    <div style="padding: 20px; color: var(--text-primary); max-height: 70vh; overflow-y: auto;">
                        <div style="margin-bottom: 25px;">
                            <h4>📋 Acceptation des Conditions</h4>
                            <p style="line-height: 1.6; color: var(--text-secondary);">
                                En utilisant MINDLY, vous acceptez ces conditions d'utilisation. Si vous n'acceptez pas ces conditions, veuillez ne pas utiliser l'application.
                            </p>
                        </div>
                        
                        <div style="margin-bottom: 25px;">
                            <h4>✅ Utilisation Autorisée</h4>
                            <ul style="line-height: 1.6; color: var(--text-secondary);">
                                <li>Usage personnel pour le bien-être mental</li>
                                <li>Partage de l'expérience avec des proches</li>
                                <li>Utilisation éducative et informative</li>
                            </ul>
                        </div>
                        
                        <div style="margin-bottom: 25px;">
                            <h4>❌ Utilisations Interdites</h4>
                            <ul style="line-height: 1.6; color: var(--text-secondary);">
                                <li>Utilisation à des fins commerciales sans autorisation</li>
                                <li>Tentative de contournement des mesures de sécurité</li>
                                <li>Partage d'informations malveillantes</li>
                            </ul>
                        </div>
                        
                        <div style="background: rgba(255,87,34,0.1); padding: 15px; border-radius: 10px; border-left: 4px solid #FF5722;">
                            <h5 style="margin: 0 0 8px 0; color: #FF5722;">⚠️ Limitation de Responsabilité</h5>
                            <p style="margin: 0; font-size: 13px; color: var(--text-secondary);">
                                MINDLY est un outil de bien-être et ne remplace pas un suivi médical professionnel. En cas de détresse psychologique, consultez un professionnel de santé.
                            </p>
                        </div>
                    </div>
                `
            });
        }

        function showDeveloperOptions() {
            showCustomModal({
                title: '👨‍💻 Options Développeur',
                content: `
                    <div style="padding: 20px; color: var(--text-primary);">
                        <div style="background: rgba(255,193,7,0.1); padding: 15px; border-radius: 10px; border-left: 4px solid #FFC107; margin-bottom: 20px;">
                            <h5 style="margin: 0 0 8px 0; color: #F57C00;">⚠️ Zone Développeur</h5>
                            <p style="margin: 0; font-size: 13px; color: var(--text-secondary);">
                                Ces options sont destinées aux développeurs et utilisateurs avancés. Utilisez avec précaution.
                            </p>
                        </div>
                        
                        <div style="margin-bottom: 20px;">
                            <h4>🔧 Outils de Debug</h4>
                            <div style="display: flex; flex-direction: column; gap: 10px;">
                                <button onclick="showConsole()" style="background: #607D8B; color: white; border: none; padding: 12px; border-radius: 10px; cursor: pointer;">
                                    🖥️ Console JavaScript
                                </button>
                                <button onclick="showStorageInfo()" style="background: #795548; color: white; border: none; padding: 12px; border-radius: 10px; cursor: pointer;">
                                    💾 Informations Stockage
                                </button>
                                <button onclick="exportLogs()" style="background: #9C27B0; color: white; border: none; padding: 12px; border-radius: 10px; cursor: pointer;">
                                    📋 Exporter les Logs
                                </button>
                            </div>
                        </div>
                        
                        <div style="margin-bottom: 20px;">
                            <h4>⚡ Performance</h4>
                            <div style="background: var(--background-light); padding: 15px; border-radius: 10px;">
                                <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 15px;">
                                    <div style="text-align: center;">
                                        <div style="font-size: 18px; font-weight: bold; color: var(--primary-color);">2.3s</div>
                                        <div style="font-size: 12px; color: var(--text-secondary);">Temps de chargement</div>
                                    </div>
                                    <div style="text-align: center;">
                                        <div style="font-size: 18px; font-weight: bold; color: var(--primary-color);">15MB</div>
                                        <div style="font-size: 12px; color: var(--text-secondary);">Mémoire utilisée</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                `
            });
        }

        function resetApplication() {
            showConfirmDialog(
                '🔄 Réinitialiser l\'Application',
                'ATTENTION: Cette action supprimera toutes vos données, paramètres et préférences. Cette action est irréversible !',
                () => {
                    localStorage.clear();
                    sessionStorage.clear();
                    showNotification('🔄 Application réinitialisée avec succès', 'info');
                    setTimeout(() => location.reload(), 2000);
                }
            );
        }

        // Fonctions utilitaires pour les nouvelles fonctionnalités
        function saveNotificationSettings() {
            showNotification('🔔 Paramètres de notifications sauvegardés', 'success');
        }

        function saveLanguageSettings() {
            showNotification('🌐 Préférences de langue sauvegardées', 'success');
        }

        function saveAccessibilitySettings() {
            showNotification('♿ Paramètres d\'accessibilité sauvegardés', 'success');
        }

        function createBackup() {
            showNotification('💾 Sauvegarde créée avec succès', 'success');
        }

        function restoreBackup() {
            showNotification('📂 Sauvegarde restaurée', 'info');
        }

        function startTutorial(type) {
            showNotification(`🎓 Tutorial ${type} démarré`, 'info');
        }

        function startLiveChat() {
            showNotification('💬 Chat en direct bientôt disponible', 'info');
        }

        function reportBug() {
            showNotification('🐛 Rapport de bug envoyé', 'success');
        }

        function setRating(stars) {
            showNotification(`⭐ ${stars} étoile${stars > 1 ? 's' : ''} sélectionnée${stars > 1 ? 's' : ''}`, 'info');
        }

        function submitFeedback() {
            showNotification('📨 Merci pour votre avis !', 'success');
        }

        // Fonction pour fermer le menu hamburger
        function closeDropdown() {
            const dropdown = document.getElementById('hamburgerDropdown');
            if (dropdown) {
                dropdown.style.display = 'none';
            }
        }

        // Fonction pour afficher les dialogues de confirmation
        function showConfirmDialog(title, message, onConfirm) {
            showCustomModal({
                title: title,
                content: `
                    <div style="padding: 20px; text-align: center; color: var(--text-primary);">
                        <p style="margin-bottom: 25px; font-size: 16px; line-height: 1.5;">${message}</p>
                        <div style="display: flex; gap: 15px; justify-content: center;">
                            <button onclick="document.querySelector('.custom-modal').style.display='none'" style="background: #9E9E9E; color: white; border: none; padding: 12px 24px; border-radius: 25px; cursor: pointer; font-weight: 600;">
                                ❌ Annuler
                            </button>
                            <button onclick="document.querySelector('.custom-modal').style.display='none'; (${onConfirm.toString()})()" style="background: var(--primary-color); color: white; border: none; padding: 12px 24px; border-radius: 25px; cursor: pointer; font-weight: 600;">
                                ✅ Confirmer
                            </button>
                        </div>
                    </div>
                `
            });
        }

        // Charger les préférences sauvegardées au démarrage
        function loadCustomizationPreferences() {
            const savedTextStyle = localStorage.getItem('mindly-text-style') || 'white';
            const savedThemeType = localStorage.getItem('mindly-theme-type');
            
            // Appliquer le style de texte
            setTextStyle(savedTextStyle);
            
            // Appliquer le thème sauvegardé
            if (savedThemeType === 'custom') {
                const savedColor = localStorage.getItem('mindly-custom-color');
                if (savedColor) {
                    setCustomColor(savedColor);
                }
            } else if (savedThemeType === 'quick') {
                const savedQuickTheme = localStorage.getItem('mindly-quick-theme');
                if (savedQuickTheme) {
                    setQuickTheme(savedQuickTheme);
                }
            }
        }

        // Fonctions utilitaires pour manipuler les couleurs
        function lightenColor(color, percent) {
            const num = parseInt(color.replace("#", ""), 16);
            const amt = Math.round(2.55 * percent);
            const R = (num >> 16) + amt;
            const G = (num >> 8 & 0x00FF) + amt;
            const B = (num & 0x0000FF) + amt;
            return "#" + (0x1000000 + (R < 255 ? R < 1 ? 0 : R : 255) * 0x10000 +
                (G < 255 ? G < 1 ? 0 : G : 255) * 0x100 +
                (B < 255 ? B < 1 ? 0 : B : 255)).toString(16).slice(1);
        }

        function darkenColor(color, percent) {
            const num = parseInt(color.replace("#", ""), 16);
            const amt = Math.round(2.55 * percent);
            const R = (num >> 16) - amt;
            const G = (num >> 8 & 0x00FF) - amt;
            const B = (num & 0x0000FF) - amt;
            return "#" + (0x1000000 + (R > 255 ? 255 : R < 0 ? 0 : R) * 0x10000 +
                (G > 255 ? 255 : G < 0 ? 0 : G) * 0x100 +
                (B > 255 ? 255 : B < 0 ? 0 : B)).toString(16).slice(1);
        }

        function rgbToHex(rgb) {
            const result = rgb.match(/\d+/g);
            if (result) {
                const r = parseInt(result[0]);
                const g = parseInt(result[1]);
                const b = parseInt(result[2]);
                return "#" + ((1 << 24) + (r << 16) + (g << 8) + b).toString(16).slice(1);
            }
            return rgb;
        }

        function hexToRgb(hex) {
            const result = /^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(hex);
            return result ? {
                r: parseInt(result[1], 16),
                g: parseInt(result[2], 16),
                b: parseInt(result[3], 16)
            } : null;
        }

        // Charger la couleur sauvegardée au démarrage
        function loadSavedColor() {
            const savedColor = localStorage.getItem('mindly-custom-color');
            if (savedColor) {
                setCustomColor(savedColor);
            }
        }

        // Fonctions pour les réglages et confidentialité
        function showAccountSettings() {
            showCustomModal({
                title: '⚙️ Paramètres du Compte',
                content: `
                    <div style="padding: 20px;">
                        <div class="menu-section">
                            <h3>👤 Informations personnelles</h3>
                            <div style="margin: 15px 0;">
                                <label style="display: block; margin-bottom: 5px; font-weight: bold;">Nom d'utilisateur:</label>
                                <input type="text" style="width: 100%; padding: 10px; border: 2px solid var(--background-medium); border-radius: 8px;" placeholder="Votre nom d'utilisateur">
                            </div>
                            <div style="margin: 15px 0;">
                                <label style="display: block; margin-bottom: 5px; font-weight: bold;">Email:</label>
                                <input type="email" style="width: 100%; padding: 10px; border: 2px solid var(--background-medium); border-radius: 8px;" placeholder="votre@email.com">
                            </div>
                        </div>

                        <div class="menu-section">
                            <h3>🔔 Notifications</h3>
                            <div style="margin: 10px 0;">
                                <label style="display: flex; align-items: center; gap: 10px;">
                                    <input type="checkbox" checked> Rappels de suivi d'humeur
                                </label>
                            </div>
                            <div style="margin: 10px 0;">
                                <label style="display: flex; align-items: center; gap: 10px;">
                                    <input type="checkbox" checked> Alertes communauté
                                </label>
                            </div>
                            <div style="margin: 10px 0;">
                                <label style="display: flex; align-items: center; gap: 10px;">
                                    <input type="checkbox"> Conseils bien-être
                                </label>
                            </div>
                        </div>

                        <div style="text-align: center; margin-top: 20px;">
                            <button onclick="closeModal()" style="background: var(--primary-color); color: white; border: none; padding: 12px 24px; border-radius: 20px; font-weight: 600; cursor: pointer; margin: 0 10px;">Sauvegarder</button>
                            <button onclick="closeModal()" style="background: var(--text-muted); color: white; border: none; padding: 12px 24px; border-radius: 20px; font-weight: 600; cursor: pointer; margin: 0 10px;">Annuler</button>
                        </div>
                    </div>
                `
            });
        }

        function showPrivacyPolicy() {
            showCustomModal({
                title: '🔒 Politique de Confidentialité',
                content: `
                    <div style="padding: 20px; max-height: 400px; overflow-y: auto;">
                        <h3>Protection de vos données</h3>
                        <p>MINDLY s'engage à protéger votre vie privée et vos données personnelles.</p>
                        
                        <h4>📊 Données collectées :</h4>
                        <ul>
                            <li>Informations de suivi d'humeur (stockées localement)</li>
                            <li>Préférences de l'application</li>
                            <li>Données d'utilisation anonymisées</li>
                        </ul>
                        
                        <h4>🔐 Sécurité :</h4>
                        <ul>
                            <li>Chiffrement des données sensibles</li>
                            <li>Stockage local prioritaire</li>
                            <li>Aucun partage avec des tiers</li>
                        </ul>
                        
                        <h4>✅ Vos droits :</h4>
                        <ul>
                            <li>Accès à vos données</li>
                            <li>Modification de vos informations</li>
                            <li>Suppression de votre compte</li>
                            <li>Export de vos données</li>
                        </ul>
                        
                        <div style="text-align: center; margin-top: 20px;">
                            <button onclick="closeModal()" style="background: var(--primary-color); color: white; border: none; padding: 12px 24px; border-radius: 20px; font-weight: 600; cursor: pointer;">J'ai compris</button>
                        </div>
                    </div>
                `
            });
        }

        function showContactSupport() {
            showCustomModal({
                title: '📞 Nous Contacter',
                content: `
                    <div style="padding: 20px;">
                        <div style="text-align: center; margin-bottom: 20px;">
                            <h3>🤝 L'équipe MINDLY est là pour vous</h3>
                        </div>
                        
                        <div class="menu-section">
                            <h4>📧 Support par Email</h4>
                            <p>support@mindly-app.com</p>
                            <p style="font-size: 12px; color: var(--text-muted);">Réponse sous 24h</p>
                        </div>
                        
                        <div class="menu-section">
                            <h4>💬 Chat en direct</h4>
                            <p>Disponible du lundi au vendredi, 9h-18h</p>
                            <button style="background: var(--secondary-color); color: white; border: none; padding: 10px 20px; border-radius: 15px; cursor: pointer;">Démarrer un chat</button>
                        </div>
                        
                        <div class="menu-section">
                            <h4>🆘 Urgence</h4>
                            <p>En cas de crise ou d'urgence psychologique :</p>
                            <p style="font-weight: bold;">SOS Amitié : 09 72 39 40 50</p>
                            <p style="font-weight: bold;">Suicide Écoute : 01 45 39 40 00</p>
                        </div>
                        
                        <div style="text-align: center; margin-top: 20px;">
                            <button onclick="closeModal()" style="background: var(--primary-color); color: white; border: none; padding: 12px 24px; border-radius: 20px; font-weight: 600; cursor: pointer;">Fermer</button>
                        </div>
                    </div>
                `
            });
        }

        function showTermsOfService() {
            showCustomModal({
                title: '⚖️ Conditions d\'Utilisation',
                content: `
                    <div style="padding: 20px; max-height: 400px; overflow-y: auto;">
                        <h3>Conditions générales d'utilisation</h3>
                        
                        <h4>🎯 Objectif de l'application</h4>
                        <p>MINDLY est une application de bien-être mental destinée à accompagner votre développement personnel.</p>
                        
                        <h4>📋 Responsabilités</h4>
                        <ul>
                            <li>L'application ne remplace pas un suivi médical professionnel</li>
                            <li>En cas de détresse, consultez un professionnel de santé</li>
                            <li>Utilisez l'application de manière responsable</li>
                        </ul>
                        
                        <h4>🔒 Propriété intellectuelle</h4>
                        <p>Tous les contenus de l'application sont protégés par le droit d'auteur.</p>
                        
                        <h4>⚠️ Limitation de responsabilité</h4>
                        <p>L'équipe MINDLY ne peut être tenue responsable des décisions prises suite à l'utilisation de l'application.</p>
                        
                        <div style="text-align: center; margin-top: 20px;">
                            <button onclick="closeModal()" style="background: var(--primary-color); color: white; border: none; padding: 12px 24px; border-radius: 20px; font-weight: 600; cursor: pointer;">J'accepte</button>
                        </div>
                    </div>
                `
            });
        }

        function showAbout() {
            showCustomModal({
                title: '🏢 À Propos de MINDLY',
                content: `
                    <div style="padding: 20px; text-align: center;">
                        <div style="font-size: 48px; margin-bottom: 20px;">🧠</div>
                        <h2>MINDLY</h2>
                        <p style="font-style: italic; color: var(--text-muted);">Votre compagnon de bien-être mental</p>
                        
                        <div style="margin: 30px 0; text-align: left;">
                            <h4>✨ Notre Mission</h4>
                            <p>Démocratiser l'accès au bien-être mental grâce à la technologie et l'intelligence artificielle.</p>
                            
                            <h4>🎯 Nos Valeurs</h4>
                            <ul>
                                <li>Confidentialité et respect de la vie privée</li>
                                <li>Accompagnement bienveillant</li>
                                <li>Innovation au service du bien-être</li>
                                <li>Accessibilité pour tous</li>
                            </ul>
                            
                            <h4>👥 L'Équipe</h4>
                            <p>Développé avec passion par une équipe de psychologues, développeurs et designers engagés.</p>
                        </div>
                        
                        <div style="font-size: 12px; color: var(--text-muted); margin-top: 20px;">
                            Version 1.0.0 - © 2025 MINDLY Team
                        </div>
                        
                        <div style="text-align: center; margin-top: 20px;">
                            <button onclick="closeModal()" style="background: var(--primary-color); color: white; border: none; padding: 12px 24px; border-radius: 20px; font-weight: 600; cursor: pointer;">Fermer</button>
                        </div>
                    </div>
                `
            });
        }

        // Export diagnostic en format texte (simulation PDF)
        function exportDiagnostic() {
            const stats = userStats.stats;
            const moodScore = calculateMoodScore();
            const date = new Date().toLocaleDateString('fr-FR');
            
            const diagnosticData = `
=== MINDLY - RAPPORT DIAGNOSTIQUE COMPLET ===
Date du rapport: ${date}
Généré par: Intelligence Artificielle MINDLY

📊 SCORES GLOBAUX:
- Score de Bien-être: ${moodScore}%
- Jours consécutifs: ${stats.consecutiveDays || 0}
- Sessions de méditation: ${stats.meditationSessions || 0}
- Entrées de journal: ${stats.journalEntries || 0}

🧠 ANALYSE COMPORTEMENTALE:
${generateBehaviorAnalysis().replace(/<[^>]*>/g, '').replace(/&[^;]*;/g, '')}

📈 RECOMMANDATIONS:
- Maintenir la régularité actuelle
- Approfondir les pratiques de méditation  
- Utiliser la communauté pour le soutien
- Surveiller les indicateurs de bien-être

=== FIN DU RAPPORT ===
            `.trim();
            
            // Créer un lien de téléchargement
            const blob = new Blob([diagnosticData], { type: 'text/plain;charset=utf-8' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `MINDLY_Diagnostic_${date.replace(/\//g, '-')}.txt`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
            
            showNotification('📄 Diagnostic exporté avec succès !', 'success');
        }

        // Fonction pour définir la personnalité de MINA
        function setPersonality(personality) {
            // Sauvegarder la personnalité sélectionnée
            localStorage.setItem('minaPersonality', personality);
            
            // Retirer la classe active de tous les boutons
            document.querySelectorAll('.personality-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            
            // Ajouter la classe active au bouton sélectionné
            document.querySelector(`[onclick="setPersonality('${personality}')"]`).classList.add('active');
            
            // Adapter le message de bienvenue selon la personnalité
            const welcomeMessages = {
                confident: "Salut ! Je suis MINA, ton confident numérique. Parlons librement de ce qui te préoccupe. 🤝",
                friend: "Hey ! Je suis MINA, ton amie virtuelle. Raconte-moi ta journée ! 😊",
                teacher: "Bonjour ! Je suis MINA, ton guide pédagogique. Explorons ensemble tes émotions. 📚",
                coach: "Salut champion ! Je suis MINA, ton coach personnel. Prêt à relever de nouveaux défis ? 💪"
            };
            
            showNotification(`Personnalité "${personality}" sélectionnée !`, 'success');
        }

        // Fonction pour gérer l'upload de photo de profil
        function handlePhotoUpload(event) {
            const file = event.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    // Afficher l'image uploadée
                    const img = document.getElementById('profilePhotoImg');
                    const placeholder = document.getElementById('profilePhotoPlaceholder');
                    
                    img.src = e.target.result;
                    img.style.display = 'block';
                    placeholder.style.display = 'none';
                    
                    // Sauvegarder dans localStorage
                    localStorage.setItem('profilePhoto', e.target.result);
                    
                    // Mettre à jour l'avatar dans le header profil si pas en mode anonyme
                    if (!document.getElementById('anonymousToggle').classList.contains('active')) {
                        const avatar = document.querySelector('.profile-header .avatar');
                        if (avatar) {
                            avatar.style.backgroundImage = `url(${e.target.result})`;
                            avatar.style.backgroundSize = 'cover';
                            avatar.style.backgroundPosition = 'center';
                            avatar.textContent = '';
                        }
                    }
                    
                    showNotification('📸 Photo de profil mise à jour !', 'success');
                };
                reader.readAsDataURL(file);
            }
        }

        // Fonction pour basculer le mode anonyme
        function toggleAnonymousMode() {
            const toggle = document.getElementById('anonymousToggle');
            const icon = document.getElementById('anonymousIcon');
            const text = document.getElementById('anonymousText');
            const avatar = document.querySelector('.profile-header .avatar');
            const profileName = document.querySelector('.profile-name');
            
            if (toggle.classList.contains('active')) {
                // Désactiver le mode anonyme
                toggle.classList.remove('active');
                icon.textContent = '🔒';
                text.textContent = 'Mode anonyme';
                
                // Restaurer la photo de profil si elle existe
                const savedPhoto = localStorage.getItem('profilePhoto');
                if (savedPhoto && avatar) {
                    avatar.style.backgroundImage = `url(${savedPhoto})`;
                    avatar.style.backgroundSize = 'cover';
                    avatar.style.backgroundPosition = 'center';
                    avatar.textContent = '';
                } else if (avatar) {
                    avatar.style.backgroundImage = '';
                    avatar.textContent = 'U';
                }
                
                if (profileName) profileName.textContent = 'Utilisateur';
                
                localStorage.setItem('anonymousMode', 'false');
                showNotification('Mode anonyme désactivé', 'info');
            } else {
                // Activer le mode anonyme
                toggle.classList.add('active');
                icon.textContent = '🕶️';
                text.textContent = 'Mode actif';
                
                // Masquer la photo de profil
                if (avatar) {
                    avatar.style.backgroundImage = '';
                    avatar.textContent = '🕶️';
                }
                
                if (profileName) profileName.textContent = 'Utilisateur Anonyme';
                
                localStorage.setItem('anonymousMode', 'true');
                showNotification('Mode anonyme activé', 'success');
            }
        }

        // Fonction pour charger les préférences sauvegardées
        function loadProfilePreferences() {
            // Charger la photo de profil
            const savedPhoto = localStorage.getItem('profilePhoto');
            if (savedPhoto) {
                const img = document.getElementById('profilePhotoImg');
                const placeholder = document.getElementById('profilePhotoPlaceholder');
                
                if (img && placeholder) {
                    img.src = savedPhoto;
                    img.style.display = 'block';
                    placeholder.style.display = 'none';
                }
            }
            
            // Charger le mode anonyme
            const anonymousMode = localStorage.getItem('anonymousMode');
            if (anonymousMode === 'true') {
                const toggle = document.getElementById('anonymousToggle');
                if (toggle) {
                    toggle.classList.add('active');
                    document.getElementById('anonymousIcon').textContent = '🕶️';
                    document.getElementById('anonymousText').textContent = 'Mode actif';
                    
                    const avatar = document.querySelector('.profile-header .avatar');
                    const profileName = document.querySelector('.profile-name');
                    
                    if (avatar) avatar.textContent = '🕶️';
                    if (profileName) profileName.textContent = 'Utilisateur Anonyme';
                }
            }
            
            // Charger la personnalité de MINA
            const savedPersonality = localStorage.getItem('minaPersonality');
            if (savedPersonality) {
                const personalityBtn = document.querySelector(`[onclick="setPersonality('${savedPersonality}')"]`);
                if (personalityBtn) {
                    personalityBtn.classList.add('active');
                }
            } else {
                // Personnalité par défaut : friend
                const defaultBtn = document.querySelector(`[onclick="setPersonality('friend')"]`);
                if (defaultBtn) {
                    defaultBtn.classList.add('active');
                    localStorage.setItem('minaPersonality', 'friend');
                }
            }
        }

        // Initialisation de l'application
        function initializeScreens() {
            // S'assurer qu'un seul écran est visible au démarrage
            document.querySelectorAll('.screen-content').forEach(screen => {
                screen.classList.remove('active');
                screen.style.display = 'none';
            });
            
            // Afficher l'écran d'accueil par défaut
            const homeScreen = document.getElementById('home-screen');
            if (homeScreen) {
                homeScreen.classList.add('active');
                homeScreen.style.display = 'block';
            }
            
            // Activer le bouton d'accueil dans la navigation
            const homeBtn = document.querySelector('[data-screen="home-screen"]');
            if (homeBtn) {
                homeBtn.classList.add('active');
            }
        }

        // Démarrage de l'application
        document.addEventListener('DOMContentLoaded', function() {
            initializeScreens();
            updateOnboarding();
            initializeApp();
            addInteractiveFeatures();
            addFormValidation();
            loadSavedColor();
            loadCustomizationPreferences();
            
            // Charger les préférences de profil au démarrage
            setTimeout(loadProfilePreferences, 500);
            
            // Initialiser le mode anonyme
            const isAnonymous = localStorage.getItem('mindly-anonymous-mode') === 'true';
            updateUIForAnonymousMode(isAnonymous);
            
            console.log('MINDLY app initialized - Responsive version with security features');
        });
    </script>
</body>
</html>