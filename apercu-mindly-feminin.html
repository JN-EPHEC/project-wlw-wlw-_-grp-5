<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MINDLY - Bien-√™tre F√©minin</title>
    
    <!-- PWA Meta Tags -->
    <meta name="description" content="Application de bien-√™tre f√©minin avec IA empathique et suivi personnalis√©">
    <meta name="theme-color" content="#4CAF50">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="MINDLY">
    <meta name="mobile-web-app-capable" content="yes">
    
    <!-- PWA Icons -->
    <link rel="apple-touch-icon" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='180' height='180' viewBox='0 0 180 180'%3E%3Crect width='180' height='180' fill='%234CAF50' rx='20'/%3E%3Ctext x='90' y='105' font-family='Arial, sans-serif' font-size='70' text-anchor='middle' fill='white'%3Eüå∏%3C/text%3E%3Ctext x='90' y='140' font-family='Arial, sans-serif' font-size='20' text-anchor='middle' fill='white' font-weight='bold'%3EMINDLY%3C/text%3E%3C/svg%3E">
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='32' height='32' viewBox='0 0 32 32'%3E%3Crect width='32' height='32' fill='%234CAF50' rx='4'/%3E%3Ctext x='16' y='22' font-family='Arial, sans-serif' font-size='16' text-anchor='middle' fill='white'%3Eüå∏%3C/text%3E%3C/svg%3E">
    
    <!-- PWA Manifest -->
    <link rel="manifest" href="/manifest.json">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: #000000;
            margin: 0;
            padding: 0;
            overflow: hidden;
            width: 100vw;
            height: 100vh;
        }

        .app-container {
            width: 100vw;
            height: 100vh;
            background: #ffffff;
            position: fixed;
            top: 0;
            left: 0;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        /* Mobile App Layout - Tout dans l'√©cran */

        /* Desktop Sidebar - Cach√©e sur mobile */
        .desktop-sidebar {
            display: none;
        }

        /* Main Content Area - Plein √©cran mobile */
        .main-content {
            display: flex;
            flex-direction: column;
            width: 100%;
            height: 100vh;
            overflow: hidden;
        }

        @media (min-width: 430px) {
            .phone-container {
                border-radius: 25px;
                margin: 10px;
                width: calc(100vw - 20px);
                height: calc(100vh - 20px);
                box-shadow: 0 5px 20px rgba(0, 0, 0, 0.1);
            }
        }

        /* Mobile-specific optimizations */
        * {
            -webkit-tap-highlight-color: transparent;
        }

        button, input, select, textarea {
            font-size: 16px; /* Prevents zoom on iOS */
        }

        /* Smooth scrolling for better UX */
        * {
            -webkit-overflow-scrolling: touch;
        }

        /* Top Menu - Fixe en haut */
        .top-menu {
            width: 100%;
            height: 60px;
            background: #4CAF50;
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 20px;
            position: relative;
            z-index: 1000;
            flex-shrink: 0;
            box-sizing: border-box;
        }

        /* Mobile Portrait - Small screens */
        @media (max-width: 375px) {
            .top-menu {
                height: 56px;
                padding: 0 16px;
                min-height: calc(56px + env(safe-area-inset-top, 0));
            }
        }

        /* Mobile Landscape & Small Tablets */
        @media (min-width: 429px) and (max-width: 768px) {
            .top-menu {
                height: 64px;
                border-radius: 24px 24px 0 0;
                padding: 0 24px;
                min-height: 64px;
                padding-top: 0;
            }
        }

        /* Tablets */
        @media (min-width: 769px) and (max-width: 1024px) {
            .top-menu {
                height: 70px;
                border-radius: 32px 32px 0 0;
                padding: 0 32px;
                min-height: 70px;
                padding-top: 0;
            }
        }

        /* Desktop */
        @media (min-width: 1025px) {
            .top-menu {
                height: 60px;
                border-radius: 40px 40px 0 0;
                padding: 0 24px;
                min-height: 60px;
                padding-top: 0;
            }
        }

        .menu-button {
            background: rgba(255, 255, 255, 0.2);
            border: none;
            color: white;
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            min-height: 44px;
            -webkit-tap-highlight-color: transparent;
            touch-action: manipulation;
        }

        .menu-button:active {
            background: rgba(255, 255, 255, 0.3);
            transform: scale(0.95);
        }

        /* Responsive menu button */
        @media (max-width: 375px) {
            .menu-button {
                padding: 6px 12px;
                font-size: 13px;
                min-height: 40px;
            }
        }

        @media (min-width: 769px) and (max-width: 1024px) {
            .menu-button {
                padding: 10px 20px;
                font-size: 16px;
                min-height: 48px;
            }
        }

        @media (min-width: 1025px) {
            .menu-button:hover {
                background: rgba(255, 255, 255, 0.3);
                transform: scale(1.05);
            }
        }

        .menu-dropdown {
            position: absolute;
            top: 100%;
            right: 20px;
            background: white;
            border-radius: 15px;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
            padding: 10px 0;
            min-width: 180px;
            z-index: 1000;
            display: none;
        }

        .menu-dropdown.active {
            display: block;
            animation: dropdownFade 0.3s ease;
        }

        @keyframes dropdownFade {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .menu-item {
            padding: 16px 24px;
            color: #333333;
            text-decoration: none;
            display: flex;
            align-items: center;
            font-size: 16px;
            font-weight: 500;
            transition: all 0.2s ease;
            min-height: 56px;
            -webkit-tap-highlight-color: transparent;
            touch-action: manipulation;
        }

        .menu-item:active {
            background: #e8f5e8;
            color: #4CAF50;
            transform: scale(0.98);
        }

        .menu-item-icon {
            margin-right: 16px;
            font-size: 20px;
        }

        .app-title {
            color: white;
            font-size: 18px;
            font-weight: 700;
            letter-spacing: 1px;
        }

        .screen {
            width: 100%;
            height: calc(100% - 140px);
            background: #ffffff;
            border-radius: 0;
            overflow-y: auto;
            overflow-x: hidden;
            position: relative;
            flex: 1;
            -webkit-overflow-scrolling: touch;
        }

        @media (min-width: 430px) {
            .screen {
                border-radius: 20px 20px 0 0;
            }
        }

        .screen-content {
            display: none;
            width: 100%;
            height: 100%;
            overflow-y: auto;
            overflow-x: hidden;
            -webkit-overflow-scrolling: touch;
            overscroll-behavior: contain;
            box-sizing: border-box;
            padding: 0;
        }

        .screen-content.active {
            display: block;
        }

        /* Bottom Navigation - Fixe en bas */
        .bottom-nav {
            width: 100%;
            height: 80px;
            background: #4CAF50;
            display: flex;
            justify-content: space-around;
            align-items: center;
            padding: 0 10px;
            box-shadow: 0 -2px 10px rgba(0, 0, 0, 0.1);
            z-index: 1000;
            flex-shrink: 0;
            box-sizing: border-box;
        }

        /* Mobile Portrait - Small screens */
        @media (max-width: 375px) {
            .bottom-nav {
                height: 70px;
                padding: 0 8px;
                min-height: calc(70px + env(safe-area-inset-bottom, 0));
            }
        }

        /* Mobile Landscape & Small Tablets */
        @media (min-width: 429px) and (max-width: 768px) {
            .bottom-nav {
                height: 85px;
                border-radius: 0 0 24px 24px;
                padding: 0 20px;
                min-height: 85px;
                padding-bottom: 0;
            }
        }

        /* Tablets */
        @media (min-width: 769px) and (max-width: 1024px) {
            .bottom-nav {
                height: 90px;
                border-radius: 0 0 32px 32px;
                padding: 0 40px;
                min-height: 90px;
                padding-bottom: 0;
            }
        }

        /* Desktop */
        @media (min-width: 1025px) {
            .bottom-nav {
                height: 80px;
                border-radius: 0 0 40px 40px;
                padding: 0 20px;
                min-height: 80px;
                padding-bottom: 0;
            }
        }

        .bottom-nav-btn {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            background: none;
            border: none;
            cursor: pointer;
            transition: all 0.3s ease;
            padding: 12px;
            border-radius: 15px;
            min-width: 70px;
            height: 65px;
            flex: 1;
            touch-action: manipulation;
            -webkit-tap-highlight-color: transparent;
        }

        .bottom-nav-btn:active {
            background: rgba(255, 255, 255, 0.2);
            transform: scale(0.95);
        }

        .bottom-nav-btn.active {
            background: rgba(255, 255, 255, 0.3);
            transform: scale(1.02);
        }

        /* Responsive navigation buttons */
        @media (max-width: 375px) {
            .bottom-nav-btn {
                padding: 8px;
                min-width: 60px;
                height: 55px;
                border-radius: 12px;
            }
        }

        @media (min-width: 769px) and (max-width: 1024px) {
            .bottom-nav-btn {
                padding: 16px;
                min-width: 85px;
                height: 75px;
                border-radius: 18px;
            }
        }

        @media (min-width: 1025px) {
            .bottom-nav-btn:hover {
                background: rgba(255, 255, 255, 0.2);
                transform: translateY(-2px);
            }
        }

        .nav-icon {
            font-size: 24px;
            margin-bottom: 4px;
        }

        .nav-label {
            font-size: 12px;
            font-weight: 500;
            color: white;
            text-transform: capitalize;
        }

        /* Global Responsive Typography */
        @media (max-width: 375px) {
            .screen-content {
                padding: 16px;
            }
            
            h1 { font-size: 24px; }
            h2 { font-size: 20px; }
            h3 { font-size: 18px; }
            p { font-size: 14px; }
        }

        @media (min-width: 769px) and (max-width: 1024px) {
            .screen-content {
                padding: 32px;
            }
            
            h1 { font-size: 32px; }
            h2 { font-size: 26px; }
            h3 { font-size: 22px; }
            p { font-size: 17px; }
        }

        @media (min-width: 1025px) {
            .screen-content {
                padding: 24px;
            }
            
            h1 { font-size: 28px; }
            h2 { font-size: 24px; }
            h3 { font-size: 20px; }
            p { font-size: 16px; }
        }

        /* ========== DESKTOP SIDEBAR STYLES ========== */
        .sidebar-header {
            padding: 30px 25px 20px;
            border-bottom: 1px solid #f0f0f0;
        }

        .sidebar-logo {
            font-size: 24px;
            font-weight: 700;
            color: #4CAF50;
            margin-bottom: 5px;
        }

        .sidebar-subtitle {
            font-size: 14px;
            color: #666;
        }

        .sidebar-nav {
            padding: 20px 0;
            flex: 1;
        }

        .sidebar-nav-item {
            display: flex;
            align-items: center;
            padding: 15px 25px;
            color: #333;
            text-decoration: none;
            transition: all 0.2s ease;
            border-left: 3px solid transparent;
        }

        .sidebar-nav-item:hover {
            background: #f8f9fa;
            border-left-color: #4CAF50;
        }

        .sidebar-nav-item.active {
            background: #e8f5e8;
            border-left-color: #4CAF50;
            color: #2E7D32;
        }

        .sidebar-nav-icon {
            font-size: 20px;
            margin-right: 15px;
            width: 20px;
            text-align: center;
        }

        .sidebar-nav-text {
            font-weight: 500;
        }

        .sidebar-footer {
            padding: 20px 25px;
            border-top: 1px solid #f0f0f0;
        }

        /* Content Wrapper - Scrollable entre menu et nav */
        .content-wrapper {
            flex: 1;
            width: 100%;
            overflow-y: auto;
            overflow-x: hidden;
            background: #ffffff;
            position: relative;
            box-sizing: border-box;
        }

        /* Community Screen Styles */
        .community-posts {
            display: flex;
            flex-direction: column;
            gap: 16px;
            margin-bottom: 20px;
        }

        .post-card {
            background: white;
            border-radius: 15px;
            padding: 16px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            border: 1px solid #f0f0f0;
        }

        .post-header {
            display: flex;
            align-items: center;
            margin-bottom: 12px;
        }

        .post-avatar {
            width: 40px;
            height: 40px;
            background: #4CAF50;
            color: white;
            border-radius: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            margin-right: 12px;
        }

        .post-info {
            flex: 1;
        }

        .post-author {
            font-size: 16px;
            font-weight: 600;
            color: #333333;
            margin: 0 0 4px 0;
        }

        .post-time {
            font-size: 12px;
            color: #999999;
            margin: 0;
        }

        .post-content {
            margin-bottom: 12px;
        }

        .post-content p {
            color: #333333;
            line-height: 1.5;
            margin: 0;
        }

        .post-actions {
            display: flex;
            gap: 16px;
        }

        .action-btn {
            background: none;
            border: none;
            color: #666666;
            font-size: 16px;
            padding: 12px 16px;
            border-radius: 12px;
            transition: all 0.2s ease;
            min-height: 48px;
            min-width: 48px;
            display: flex;
            align-items: center;
            justify-content: center;
            -webkit-tap-highlight-color: transparent;
            touch-action: manipulation;
        }

        .action-btn:active {
            background: #f5f5f5;
            color: #4CAF50;
            transform: scale(0.95);
        }

        .action-btn.liked {
            color: #FF6B9D;
            background: rgba(255, 107, 157, 0.1);
        }

        /* Section des commentaires */
        .comment-section {
            margin-top: 16px;
            padding-top: 16px;
            border-top: 1px solid #E8E8E8;
        }

        .comments-list {
            margin-bottom: 16px;
        }

        .comment {
            display: flex;
            align-items: flex-start;
            margin-bottom: 12px;
            animation: fadeInUp 0.3s ease;
        }

        .comment-avatar {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            background: linear-gradient(135deg, #FF6B9D, #4ECDC4);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 600;
            font-size: 12px;
            margin-right: 12px;
            flex-shrink: 0;
        }

        .comment-content {
            background: #F8F9FA;
            padding: 8px 12px;
            border-radius: 16px;
            font-size: 14px;
            line-height: 1.4;
            flex: 1;
        }

        .comment-content strong {
            color: #FF6B9D;
        }

        .comment-input-container {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .comment-input {
            flex: 1;
            padding: 12px 16px;
            border: 2px solid #E8E8E8;
            border-radius: 24px;
            font-size: 14px;
            outline: none;
            transition: all 0.3s ease;
        }

        .comment-input:focus {
            border-color: #FF6B9D;
            box-shadow: 0 0 0 3px rgba(255, 107, 157, 0.1);
        }

        .comment-send-btn {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: linear-gradient(135deg, #FF6B9D, #4ECDC4);
            border: none;
            color: white;
            font-size: 16px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .comment-send-btn:hover {
            transform: scale(1.1);
            box-shadow: 0 4px 12px rgba(255, 107, 157, 0.3);
        }

        .create-post-btn {
            background: linear-gradient(135deg, #FF6B9D, #4ECDC4);
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 24px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 2px 8px rgba(255, 107, 157, 0.3);
            margin-top: 12px;
            width: 100%;
        }

        .create-post-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 16px rgba(255, 107, 157, 0.4);
        }

        /* ========== STYLES PROFIL AVANC√â ========== */
        
        .profile-actions {
            display: flex;
            gap: 8px;
            margin-top: 12px;
        }

        .create-profile-btn, .settings-btn {
            padding: 8px 16px;
            border: none;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .create-profile-btn {
            background: linear-gradient(135deg, #FF6B9D, #4ECDC4);
            color: white;
        }

        .settings-btn {
            background: rgba(255, 107, 157, 0.1);
            color: #FF6B9D;
        }

        .profile-card {
            background: white;
            border-radius: 20px;
            padding: 24px;
            margin-bottom: 20px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
            text-align: center;
        }

        .profile-status {
            margin-top: 12px;
        }

        .anonymity-status {
            display: inline-block;
            padding: 6px 12px;
            background: rgba(76, 175, 80, 0.1);
            color: #4CAF50;
            border-radius: 16px;
            font-size: 12px;
            font-weight: 600;
        }

        .profile-menu {
            margin-bottom: 20px;
        }

        .profile-menu-item {
            width: 100%;
            background: white;
            border: none;
            border-radius: 16px;
            padding: 16px;
            margin-bottom: 12px;
            display: flex;
            align-items: center;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
        }

        .profile-menu-item:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
        }

        .menu-icon {
            font-size: 24px;
            margin-right: 16px;
        }

        .menu-content {
            flex: 1;
            text-align: left;
        }

        .menu-content h3 {
            margin: 0 0 4px 0;
            font-size: 16px;
            font-weight: 600;
            color: #333;
        }

        .menu-content p {
            margin: 0;
            font-size: 12px;
            color: #666;
        }

        .menu-arrow {
            font-size: 18px;
            color: #FF6B9D;
        }

        .profile-section {
            display: none;
        }

        .section-header {
            display: flex;
            align-items: center;
            margin-bottom: 24px;
        }

        .back-btn {
            background: none;
            border: none;
            color: #FF6B9D;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            padding: 8px 0;
            margin-right: 16px;
        }

        .section-header h2 {
            margin: 0;
            flex: 1;
            font-size: 20px;
            color: #333;
        }

        /* Cr√©ation de profil */
        .create-profile-container {
            max-width: 500px;
            margin: 0 auto;
        }

        .id-card-upload {
            background: white;
            border-radius: 16px;
            padding: 24px;
            margin-bottom: 24px;
            text-align: center;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
        }

        .upload-area {
            border: 2px dashed #E8E8E8;
            border-radius: 12px;
            padding: 40px 20px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .upload-area:hover {
            border-color: #FF6B9D;
            background: rgba(255, 107, 157, 0.02);
        }

        .upload-icon {
            font-size: 48px;
            margin-bottom: 16px;
        }

        .upload-area h3 {
            margin: 0 0 8px 0;
            color: #333;
        }

        .upload-area p {
            margin: 0 0 16px 0;
            color: #666;
            font-size: 14px;
        }

        .upload-btn {
            background: linear-gradient(135deg, #FF6B9D, #4ECDC4);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 24px;
            font-weight: 600;
            cursor: pointer;
        }

        .upload-status {
            padding: 16px;
            background: rgba(76, 175, 80, 0.1);
            border-radius: 12px;
            color: #4CAF50;
            margin-top: 16px;
        }

        .profile-form {
            background: white;
            border-radius: 16px;
            padding: 24px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #333;
        }

        .form-group input, .form-group select {
            width: 100%;
            padding: 12px 16px;
            border: 2px solid #E8E8E8;
            border-radius: 12px;
            font-size: 16px;
            transition: all 0.3s ease;
            box-sizing: border-box;
        }

        .form-group input:focus, .form-group select:focus {
            outline: none;
            border-color: #FF6B9D;
            box-shadow: 0 0 0 3px rgba(255, 107, 157, 0.1);
        }

        .checkbox-label {
            display: flex !important;
            align-items: center;
            cursor: pointer;
            font-weight: normal !important;
        }

        .checkbox-label input[type="checkbox"] {
            width: auto !important;
            margin-right: 12px;
        }

        .create-profile-submit {
            width: 100%;
            background: linear-gradient(135deg, #FF6B9D, #4ECDC4);
            color: white;
            border: none;
            padding: 16px;
            border-radius: 12px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .create-profile-submit:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 20px rgba(255, 107, 157, 0.3);
        }

        /* Feedback d'humeur */
        .feedback-container {
            max-width: 600px;
            margin: 0 auto;
        }

        .mood-stats {
            background: white;
            border-radius: 16px;
            padding: 24px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
        }

        .mood-chart h3 {
            margin: 0 0 20px 0;
            color: #333;
        }

        .chart-container {
            height: 200px;
            display: flex;
            align-items: end;
            justify-content: center;
            margin-bottom: 32px;
        }

        .mood-bars {
            display: flex;
            align-items: end;
            gap: 20px;
            height: 100%;
        }

        .mood-bar {
            width: 60px;
            border-radius: 8px 8px 0 0;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: space-between;
            padding: 8px;
            color: white;
            font-weight: 600;
            min-height: 50px;
        }

        .mood-bar.happy {
            background: linear-gradient(135deg, #4CAF50, #81C784);
        }

        .mood-bar.neutral {
            background: linear-gradient(135deg, #FFC107, #FFD54F);
        }

        .mood-bar.sad {
            background: linear-gradient(135deg, #FF5722, #FF8A65);
        }

        .mood-insights h3 {
            margin: 0 0 16px 0;
            color: #333;
        }

        .insight-card {
            display: flex;
            align-items: center;
            padding: 16px;
            background: rgba(255, 107, 157, 0.05);
            border-radius: 12px;
            margin-bottom: 12px;
        }

        .insight-icon {
            font-size: 24px;
            margin-right: 16px;
        }

        .insight-content h4 {
            margin: 0 0 4px 0;
            color: #333;
            font-size: 14px;
        }

        .insight-content p {
            margin: 0;
            color: #666;
            font-size: 12px;
        }

        /* Param√®tres de langue */
        .language-options {
            background: white;
            border-radius: 16px;
            padding: 8px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
        }

        .language-option {
            width: 100%;
            display: flex;
            align-items: center;
            padding: 16px;
            border: none;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-bottom: 8px;
            background: transparent;
        }

        .language-option:hover {
            background: rgba(255, 107, 157, 0.05);
        }

        .language-option.active {
            background: rgba(255, 107, 157, 0.1);
        }

        .flag {
            font-size: 32px;
            margin-right: 16px;
        }

        .language-info {
            flex: 1;
            text-align: left;
        }

        .language-info h3 {
            margin: 0 0 4px 0;
            color: #333;
            font-size: 16px;
        }

        .language-info p {
            margin: 0;
            color: #666;
            font-size: 12px;
        }

        .check-icon {
            color: #4CAF50;
            font-size: 20px;
            font-weight: bold;
        }

        /* Param√®tres d'anonymat */
        .anonymity-options {
            margin-bottom: 32px;
        }

        .anonymity-card {
            background: white;
            border-radius: 16px;
            padding: 20px;
            margin-bottom: 16px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
        }

        .card-header {
            display: flex;
            align-items: center;
            margin-bottom: 12px;
        }

        .card-icon {
            font-size: 24px;
            margin-right: 12px;
        }

        .card-header h3 {
            margin: 0;
            color: #333;
            font-size: 16px;
        }

        .anonymity-card p {
            margin: 0 0 16px 0;
            color: #666;
            font-size: 14px;
        }

        .anonymity-btn {
            padding: 10px 20px;
            border: none;
            border-radius: 20px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .anonymity-btn:not(.secondary) {
            background: linear-gradient(135deg, #FF6B9D, #4ECDC4);
            color: white;
        }

        .anonymity-btn.secondary {
            background: rgba(255, 107, 157, 0.1);
            color: #FF6B9D;
        }

        .anonymity-preview {
            background: white;
            border-radius: 16px;
            padding: 20px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
        }

        .anonymity-preview h3 {
            margin: 0 0 16px 0;
            color: #333;
        }

        .preview-post {
            border: 1px solid #E8E8E8;
            border-radius: 12px;
            padding: 16px;
        }

        /* ========== STYLES MOD√âRATION IA ========== */
        
        .moderation-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 10000;
            opacity: 0;
            transition: all 0.3s ease;
        }

        .moderation-modal.show {
            opacity: 1;
        }

        .moderation-content {
            background: white;
            border-radius: 20px;
            max-width: 90%;
            width: 500px;
            max-height: 80vh;
            overflow-y: auto;
            transform: translateY(50px);
            transition: all 0.3s ease;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
        }

        .moderation-modal.show .moderation-content {
            transform: translateY(0);
        }

        .moderation-header {
            background: linear-gradient(135deg, #FF6B9D, #4ECDC4);
            color: white;
            padding: 20px;
            border-radius: 20px 20px 0 0;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .moderation-header h3 {
            margin: 0;
            font-size: 18px;
        }

        .close-btn {
            background: none;
            border: none;
            color: white;
            font-size: 24px;
            cursor: pointer;
            width: 32px;
            height: 32px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
        }

        .close-btn:hover {
            background: rgba(255, 255, 255, 0.2);
        }

        .moderation-body {
            padding: 24px;
        }

        .support-message {
            background: rgba(255, 107, 157, 0.1);
            border-radius: 12px;
            padding: 16px;
            margin-bottom: 20px;
            border-left: 4px solid #FF6B9D;
        }

        .support-message p {
            margin: 0;
            font-size: 16px;
            line-height: 1.5;
            color: #333;
        }

        .emergency-info {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            border-radius: 12px;
            padding: 16px;
            margin-bottom: 20px;
        }

        .emergency-info h4 {
            margin: 0 0 12px 0;
            color: #856404;
            font-size: 16px;
        }

        .emergency-info p {
            margin: 8px 0;
            color: #856404;
            font-size: 14px;
        }

        .alternatives {
            background: #d1ecf1;
            border: 1px solid #bee5eb;
            border-radius: 12px;
            padding: 16px;
            margin-bottom: 20px;
        }

        .alternatives h4 {
            margin: 0 0 12px 0;
            color: #0c5460;
            font-size: 16px;
        }

        .alternatives p {
            margin: 4px 0;
            color: #0c5460;
            font-size: 14px;
            font-family: monospace;
            background: rgba(255, 255, 255, 0.5);
            padding: 4px 8px;
            border-radius: 6px;
            display: inline-block;
        }

        .moderation-actions {
            display: flex;
            gap: 12px;
            flex-wrap: wrap;
        }

        .btn-primary, .btn-secondary {
            flex: 1;
            padding: 14px 20px;
            border: none;
            border-radius: 12px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            min-width: 140px;
        }

        .btn-primary {
            background: linear-gradient(135deg, #FF6B9D, #4ECDC4);
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 20px rgba(255, 107, 157, 0.4);
        }

        .btn-secondary {
            background: rgba(255, 107, 157, 0.1);
            color: #FF6B9D;
            border: 2px solid rgba(255, 107, 157, 0.3);
        }

        .btn-secondary:hover {
            background: rgba(255, 107, 157, 0.2);
            transform: translateY(-1px);
        }

        /* Animations pour les notifications */
        @keyframes slideInDown {
            from {
                transform: translate(-50%, -100%);
                opacity: 0;
            }
            to {
                transform: translate(-50%, 0);
                opacity: 1;
            }
        }

        @keyframes slideOutUp {
            from {
                transform: translate(-50%, 0);
                opacity: 1;
            }
            to {
                transform: translate(-50%, -100%);
                opacity: 0;
            }
        }

        /* Styles pour les messages mod√©r√©s */
        .moderated-message {
            background: rgba(255, 193, 7, 0.1);
            border: 1px solid rgba(255, 193, 7, 0.3);
            border-radius: 12px;
            padding: 12px;
            margin: 8px 0;
            position: relative;
        }

        .moderated-message::before {
            content: "ü§ñ";
            position: absolute;
            top: -8px;
            right: -8px;
            background: #FFC107;
            border-radius: 50%;
            width: 24px;
            height: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
        }

        .message-blocked {
            background: rgba(244, 67, 54, 0.1);
            border: 1px solid rgba(244, 67, 54, 0.3);
            color: #d32f2f;
            text-align: center;
            padding: 16px;
            border-radius: 12px;
            margin: 8px 0;
        }

        .ai-suggestion {
            background: rgba(76, 175, 80, 0.1);
            border: 1px solid rgba(76, 175, 80, 0.3);
            border-radius: 12px;
            padding: 12px;
            margin: 8px 0;
            color: #2e7d32;
            font-style: italic;
        }

        .ai-suggestion::before {
            content: "üí° Conseil IA: ";
            font-weight: bold;
            font-style: normal;
        }

        /* Styles pour les commentaires bloqu√©s */
        .blocked-comment .comment-avatar {
            background: linear-gradient(135deg, #ff5722, #f44336);
        }

        .ai-comment .comment-avatar {
            background: linear-gradient(135deg, #4CAF50, #81C784);
        }

        .blocked-comment .comment-content {
            background: rgba(244, 67, 54, 0.1);
            border: 1px solid rgba(244, 67, 54, 0.3);
            color: #d32f2f;
        }

        /* Animation pour les messages d'IA */
        @keyframes gentlePulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.02); }
        }

        .ai-comment {
            animation: gentlePulse 2s ease-in-out;
        }

        /* Indicateur de mod√©ration active */
        .moderation-indicator {
            position: fixed;
            top: 10px;
            right: 10px;
            background: linear-gradient(135deg, #4CAF50, #81C784);
            color: white;
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
            z-index: 1000;
            animation: fadeInRight 0.5s ease;
        }

        @keyframes fadeInRight {
            from {
                opacity: 0;
                transform: translateX(100%);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        /* ========== STYLES GESTION D'HUMEUR AVANC√âE ========== */
        
        .mood-nav-buttons {
            display: flex;
            gap: 8px;
            margin-top: 16px;
            overflow-x: auto;
            padding: 4px;
        }

        .mood-nav-btn {
            background: rgba(255, 107, 157, 0.1);
            color: #FF6B9D;
            border: 2px solid rgba(255, 107, 157, 0.2);
            border-radius: 20px;
            padding: 8px 16px;
            font-size: 12px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            white-space: nowrap;
            flex-shrink: 0;
        }

        .mood-nav-btn.active {
            background: linear-gradient(135deg, #FF6B9D, #4ECDC4);
            color: white;
            border-color: transparent;
        }

        .mood-nav-btn:hover {
            transform: translateY(-1px);
            box-shadow: 0 2px 8px rgba(255, 107, 157, 0.3);
        }

        .mood-section {
            display: none;
        }

        .mood-section.active {
            display: block;
        }

        /* Section √âvaluation */
        .evaluation-container {
            max-width: 600px;
            margin: 0 auto;
        }

        .evaluation-intro {
            background: white;
            border-radius: 16px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
            text-align: center;
        }

        .evaluation-intro h3 {
            margin: 0 0 12px 0;
            color: #333;
            font-size: 18px;
        }

        .evaluation-intro p {
            margin: 0;
            color: #666;
            font-size: 14px;
        }

        .mood-dimensions {
            background: white;
            border-radius: 16px;
            padding: 24px;
            margin-bottom: 20px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
        }

        .dimension-item {
            margin-bottom: 32px;
            padding-bottom: 20px;
            border-bottom: 1px solid #E8E8E8;
        }

        .dimension-item:last-child {
            margin-bottom: 0;
            border-bottom: none;
        }

        .dimension-header {
            display: flex;
            align-items: center;
            margin-bottom: 16px;
        }

        .dimension-icon {
            font-size: 24px;
            margin-right: 12px;
        }

        .dimension-title {
            flex: 1;
            margin: 0;
            font-size: 16px;
            font-weight: 600;
            color: #333;
        }

        .dimension-value {
            background: linear-gradient(135deg, #FF6B9D, #4ECDC4);
            color: white;
            padding: 4px 12px;
            border-radius: 12px;
            font-weight: bold;
            font-size: 14px;
            min-width: 24px;
            text-align: center;
        }

        .dimension-slider {
            position: relative;
        }

        .advanced-slider {
            width: 100%;
            height: 8px;
            border-radius: 4px;
            background: #E8E8E8;
            outline: none;
            appearance: none;
            -webkit-appearance: none;
            margin-bottom: 12px;
            cursor: pointer;
        }

        .advanced-slider::-webkit-slider-thumb {
            appearance: none;
            -webkit-appearance: none;
            width: 24px;
            height: 24px;
            border-radius: 50%;
            background: linear-gradient(135deg, #FF6B9D, #4ECDC4);
            cursor: pointer;
            box-shadow: 0 2px 8px rgba(255, 107, 157, 0.4);
            transition: all 0.3s ease;
        }

        .advanced-slider::-webkit-slider-thumb:hover {
            transform: scale(1.2);
            box-shadow: 0 4px 16px rgba(255, 107, 157, 0.6);
        }

        .advanced-slider::-moz-range-thumb {
            width: 24px;
            height: 24px;
            border-radius: 50%;
            background: linear-gradient(135deg, #FF6B9D, #4ECDC4);
            cursor: pointer;
            border: none;
            box-shadow: 0 2px 8px rgba(255, 107, 157, 0.4);
        }

        .slider-labels {
            display: flex;
            justify-content: space-between;
            font-size: 12px;
            color: #666;
        }

        .context-input {
            background: white;
            border-radius: 16px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
        }

        .context-input h4 {
            margin: 0 0 12px 0;
            color: #333;
            font-size: 16px;
        }

        .context-input textarea {
            width: 100%;
            min-height: 80px;
            padding: 12px;
            border: 2px solid #E8E8E8;
            border-radius: 12px;
            font-size: 14px;
            resize: vertical;
            outline: none;
            transition: all 0.3s ease;
            box-sizing: border-box;
        }

        .context-input textarea:focus {
            border-color: #FF6B9D;
            box-shadow: 0 0 0 3px rgba(255, 107, 157, 0.1);
        }

        .analyze-btn {
            width: 100%;
            background: linear-gradient(135deg, #FF6B9D, #4ECDC4);
            color: white;
            border: none;
            padding: 16px;
            border-radius: 16px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 16px rgba(255, 107, 157, 0.3);
        }

        .analyze-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 24px rgba(255, 107, 157, 0.4);
        }

        /* Section Diagnostic */
        .diagnostic-container {
            max-width: 700px;
            margin: 0 auto;
        }

        .diagnostic-header {
            background: white;
            border-radius: 16px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
        }

        .diagnostic-header h3 {
            margin: 0 0 12px 0;
            color: #333;
        }

        .ai-status {
            background: rgba(255, 193, 7, 0.1);
            color: #856404;
            padding: 8px 16px;
            border-radius: 12px;
            font-size: 14px;
            font-weight: 600;
        }

        .ai-status.analyzing {
            background: rgba(33, 150, 243, 0.1);
            color: #1976d2;
        }

        .ai-status.completed {
            background: rgba(76, 175, 80, 0.1);
            color: #388e3c;
        }

        .diagnostic-results {
            background: white;
            border-radius: 16px;
            padding: 24px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
        }

        .waiting-analysis, .waiting-exercises, .chart-placeholder, .no-insights {
            text-align: center;
            padding: 40px 20px;
            color: #666;
        }

        .placeholder-icon, .chart-icon {
            font-size: 48px;
            margin-bottom: 16px;
            display: block;
        }

        .waiting-analysis h4, .waiting-exercises h4, .chart-placeholder h4 {
            margin: 0 0 8px 0;
            color: #333;
        }

        .waiting-analysis p, .waiting-exercises p, .chart-placeholder p {
            margin: 0;
            font-size: 14px;
        }

        /* Styles pour les r√©sultats du diagnostic */
        .diagnostic-card {
            background: rgba(255, 107, 157, 0.05);
            border: 1px solid rgba(255, 107, 157, 0.2);
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 16px;
        }

        .diagnostic-title {
            color: #FF6B9D;
            font-weight: 600;
            margin: 0 0 8px 0;
            font-size: 16px;
        }

        .diagnostic-content {
            color: #333;
            line-height: 1.5;
            font-size: 14px;
        }

        .risk-indicator {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: 600;
            margin-bottom: 12px;
        }

        .risk-low {
            background: rgba(76, 175, 80, 0.1);
            color: #388e3c;
        }

        .risk-medium {
            background: rgba(255, 193, 7, 0.1);
            color: #f57c00;
        }

        .risk-high {
            background: rgba(244, 67, 54, 0.1);
            color: #d32f2f;
        }

        /* Section Exercices */
        .exercises-container {
            max-width: 600px;
            margin: 0 auto;
        }

        .exercises-header {
            background: white;
            border-radius: 16px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
            text-align: center;
        }

        .exercise-card {
            background: white;
            border-radius: 16px;
            padding: 20px;
            margin-bottom: 16px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
            border-left: 4px solid #4ECDC4;
        }

        .exercise-header {
            display: flex;
            align-items: center;
            margin-bottom: 12px;
        }

        .exercise-icon {
            font-size: 24px;
            margin-right: 12px;
        }

        .exercise-title {
            flex: 1;
            margin: 0;
            color: #333;
            font-size: 16px;
            font-weight: 600;
        }

        .exercise-duration {
            background: rgba(76, 220, 196, 0.1);
            color: #4ECDC4;
            padding: 4px 8px;
            border-radius: 8px;
            font-size: 12px;
            font-weight: 600;
        }

        .exercise-description {
            color: #666;
            font-size: 14px;
            line-height: 1.5;
            margin-bottom: 16px;
        }

        .exercise-btn {
            background: linear-gradient(135deg, #4ECDC4, #44A08D);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 12px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .exercise-btn:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 16px rgba(76, 220, 196, 0.4);
        }

        /* Section Suivi */
        .tracking-container {
            max-width: 700px;
            margin: 0 auto;
        }

        .tracking-header {
            background: white;
            border-radius: 16px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 16px;
        }

        .tracking-period {
            display: flex;
            gap: 8px;
        }

        .period-btn {
            background: rgba(255, 107, 157, 0.1);
            color: #FF6B9D;
            border: 2px solid rgba(255, 107, 157, 0.2);
            border-radius: 12px;
            padding: 8px 16px;
            font-size: 12px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .period-btn.active {
            background: #FF6B9D;
            color: white;
            border-color: #FF6B9D;
        }

        .mood-charts {
            background: white;
            border-radius: 16px;
            padding: 24px;
            margin-bottom: 20px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
            min-height: 300px;
        }

        .insights-summary {
            background: white;
            border-radius: 16px;
            padding: 20px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
        }

        .insights-summary h4 {
            margin: 0 0 16px 0;
            color: #333;
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .new-post-btn {
            width: 100%;
            padding: 18px 24px;
            background: #4CAF50;
            color: white;
            border: none;
            border-radius: 16px;
            font-size: 17px;
            font-weight: 600;
            transition: all 0.2s ease;
            margin-top: 20px;
            min-height: 56px;
            display: flex;
            align-items: center;
            justify-content: center;
            -webkit-tap-highlight-color: transparent;
            touch-action: manipulation;
        }

        .new-post-btn:active {
            background: #45a049;
            transform: scale(0.97);
        }

        /* Chat Styles */
        .chat-messages {
            max-height: 300px;
            overflow-y: auto;
            padding: 16px 0;
            margin-bottom: 16px;
        }

        .ai-message, .user-message {
            display: flex;
            margin-bottom: 16px;
            animation: messageSlide 0.3s ease;
        }

        @keyframes messageSlide {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .user-message {
            flex-direction: row-reverse;
        }

        .message-avatar {
            width: 36px;
            height: 36px;
            border-radius: 18px;
            background: #4CAF50;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 18px;
            margin: 0 12px;
            flex-shrink: 0;
        }

        .user-message .message-avatar {
            background: #2196F3;
        }

        .message-content {
            background: #f5f5f5;
            padding: 12px 16px;
            border-radius: 16px;
            max-width: 70%;
        }

        .user-message .message-content {
            background: #4CAF50;
            color: white;
        }

        .message-content p {
            margin: 0;
            line-height: 1.4;
        }

        .quick-suggestions {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-bottom: 16px;
        }

        .suggestion-btn {
            background: #e8f5e8;
            color: #333333;
            border: none;
            padding: 8px 12px;
            border-radius: 20px;
            font-size: 12px;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .suggestion-btn:hover {
            background: #4CAF50;
            color: white;
            transform: scale(1.05);
        }

        .chat-input-container {
            display: flex;
            gap: 12px;
            align-items: center;
            padding: 0 4px;
        }

        .chat-input {
            flex: 1;
            padding: 16px 20px;
            border: 2px solid #e0e0e0;
            border-radius: 24px;
            font-size: 16px;
            outline: none;
            min-height: 48px;
            -webkit-appearance: none;
            -webkit-tap-highlight-color: transparent;
            touch-action: manipulation;
        }

        .chat-input:focus {
            border-color: #4CAF50;
            box-shadow: 0 0 0 4px rgba(76, 175, 80, 0.1);
        }

        .send-btn {
            width: 48px;
            height: 48px;
            background: #4CAF50;
            color: white;
            border: none;
            border-radius: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s ease;
            -webkit-tap-highlight-color: transparent;
            touch-action: manipulation;
            font-size: 18px;
        }

        .send-btn:hover {
            background: #45a049;
            transform: scale(1.1);
        }

        /* Profile Photo Styles */
        .profile-photo-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            margin-bottom: 16px;
        }

        .profile-photo {
            width: 100px;
            height: 100px;
            border-radius: 50px;
            overflow: hidden;
            cursor: pointer;
            border: 4px solid #4CAF50;
            transition: all 0.3s ease;
            margin-bottom: 12px;
        }

        .profile-photo:hover {
            transform: scale(1.05);
            box-shadow: 0 4px 15px rgba(76, 175, 80, 0.3);
        }

        .profile-photo img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .change-photo-btn {
            background: #4CAF50;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 12px;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .change-photo-btn:hover {
            background: #45a049;
            transform: scale(1.05);
        }

        .profile-badges {
            display: flex;
            flex-direction: column;
            gap: 8px;
            margin-top: 12px;
        }

        .badge {
            background: #e8f5e8;
            color: #2e7d32;
            padding: 6px 12px;
            border-radius: 15px;
            font-size: 12px;
            font-weight: 500;
            text-align: center;
        }

        /* Signup Form Styles */
        .signup-form {
            display: flex;
            flex-direction: column;
            gap: 16px;
        }

        .form-row {
            display: flex;
            gap: 12px;
        }

        .form-group.half {
            flex: 1;
        }

        .photo-upload {
            display: flex;
            justify-content: center;
        }

        .upload-btn {
            background: #f5f5f5;
            color: #333333;
            border: 2px dashed #4CAF50;
            padding: 12px 20px;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .upload-btn:hover {
            background: #e8f5e8;
            border-color: #45a049;
        }

        .checkbox-group {
            display: flex;
            flex-direction: column;
            gap: 12px;
            margin: 16px 0;
        }

        .checkbox-label {
            display: flex;
            align-items: flex-start;
            font-size: 14px;
            line-height: 1.4;
            cursor: pointer;
        }

        .checkbox-label input[type="checkbox"] {
            margin-right: 8px;
            margin-top: 2px;
        }

        .checkbox-label a {
            color: #4CAF50;
            text-decoration: none;
        }

        .checkbox-label a:hover {
            text-decoration: underline;
        }

        /* Login Screen Styles */
        .login-method-selector {
            margin-bottom: 16px;
        }

        .method-select {
            width: 100%;
            padding: 12px 16px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 14px;
            background: white;
        }

        .method-select:focus {
            outline: none;
            border-color: #4CAF50;
        }

        .forgot-password {
            text-align: right;
            margin: 8px 0;
        }

        .forgot-password a {
            color: #4CAF50;
            text-decoration: none;
            font-size: 14px;
        }

        .forgot-password a:hover {
            text-decoration: underline;
        }

        .auth-separator {
            text-align: center;
            margin: 20px 0;
            position: relative;
        }

        .auth-separator::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 0;
            right: 0;
            height: 1px;
            background: #e0e0e0;
        }

        .auth-separator span {
            background: white;
            padding: 0 16px;
            color: #666666;
            font-size: 14px;
        }

        .apple-login-btn {
            width: 100%;
            padding: 16px;
            background: #000000;
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            margin-bottom: 16px;
        }

        .apple-login-btn:hover {
            background: #333333;
        }

        .apple-icon {
            font-size: 18px;
        }

        /* Dashboard Styles */
        .greeting {
            font-size: 28px;
            font-weight: 700;
            color: #333333;
            margin-bottom: 8px;
        }

        .mood-question {
            font-size: 18px;
            color: #666666;
            margin-bottom: 24px;
        }

        .shortcuts-section, .charts-section {
            margin-bottom: 24px;
        }

        .section-title {
            font-size: 20px;
            font-weight: 600;
            color: #333333;
            margin-bottom: 16px;
        }

        .shortcuts-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 12px;
        }

        .shortcut-btn {
            background: white;
            border: 2px solid #4CAF50;
            border-radius: 12px;
            padding: 16px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            flex-direction: column;
            align-items: center;
            text-align: center;
        }

        .shortcut-btn:hover {
            background: #4CAF50;
            color: white;
        }

        .shortcut-icon {
            font-size: 24px;
            margin-bottom: 8px;
        }

        .shortcut-label {
            font-size: 14px;
            font-weight: 600;
        }

        .chart-card {
            background: white;
            border: 1px solid #e0e0e0;
            border-radius: 12px;
            padding: 16px;
            margin-bottom: 12px;
        }

        .chart-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 12px;
        }

        .chart-header h4 {
            font-size: 16px;
            font-weight: 600;
            color: #333333;
            margin: 0;
        }

        .view-trends {
            color: #4CAF50;
            text-decoration: none;
            font-size: 12px;
        }

        .view-trends:hover {
            text-decoration: underline;
        }

        .chart-placeholder {
            background: #f8f9fa;
            border-radius: 8px;
            padding: 20px;
            text-align: center;
        }

        .chart-line {
            color: #666666;
            font-size: 14px;
        }

        /* Mood Journal Styles (Page 7) */
        .mood-scales {
            display: flex;
            flex-direction: column;
            gap: 24px;
        }

        .scale-group {
            background: white;
            border: 1px solid #e0e0e0;
            border-radius: 12px;
            padding: 20px;
        }

        .scale-title {
            font-size: 16px;
            font-weight: 600;
            color: #333333;
            margin-bottom: 16px;
            text-align: center;
        }

        .scale-slider {
            position: relative;
        }

        .slider {
            width: 100%;
            height: 8px;
            border-radius: 4px;
            background: #e0e0e0;
            outline: none;
            -webkit-appearance: none;
            appearance: none;
            -webkit-tap-highlight-color: transparent;
            touch-action: pan-x;
        }

        .slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 32px;
            height: 32px;
            border-radius: 50%;
            background: #4CAF50;
            box-shadow: 0 2px 8px rgba(0,0,0,0.2);
            transition: all 0.2s ease;
        }

        .slider::-webkit-slider-thumb:active {
            transform: scale(1.2);
        }

        .slider::-moz-range-thumb {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            background: #4CAF50;
            border: none;
            box-shadow: 0 2px 8px rgba(0,0,0,0.2);
        }

        .mood-slider::-webkit-slider-thumb {
            background: #FF6B9D;
        }

        .mood-slider::-webkit-slider-thumb:active {
            background: #FF4081;
            transform: scale(1.2);
        }

        .mood-slider::-moz-range-thumb {
            background: #FF6B9D;
        }

        .energy-slider::-webkit-slider-thumb {
            background: #FFA726;
        }

        .energy-slider::-moz-range-thumb {
            background: #FFA726;
        }

        .stress-slider::-webkit-slider-thumb {
            background: #EF5350;
        }

        .stress-slider::-moz-range-thumb {
            background: #EF5350;
        }

        /* Responsive sliders */
        @media (max-width: 375px) {
            .slider {
                height: 6px;
            }
            
            .slider::-webkit-slider-thumb {
                width: 28px;
                height: 28px;
            }
            
            .slider::-moz-range-thumb {
                width: 28px;
                height: 28px;
            }
        }

        @media (min-width: 769px) and (max-width: 1024px) {
            .slider {
                height: 10px;
                border-radius: 5px;
            }
            
            .slider::-webkit-slider-thumb {
                width: 36px;
                height: 36px;
            }
            
            .slider::-moz-range-thumb {
                width: 36px;
                height: 36px;
            }
        }

        @media (min-width: 1025px) {
            .slider {
                height: 9px;
            }
            
            .slider::-webkit-slider-thumb {
                width: 34px;
                height: 34px;
            }
            
            .slider::-moz-range-thumb {
                width: 34px;
                height: 34px;
            }
        }

        .scale-labels {
            display: flex;
            justify-content: space-between;
            margin-top: 8px;
            font-size: 20px;
        }

        .feelings-input {
            background: white;
            border: 1px solid #e0e0e0;
            border-radius: 12px;
            padding: 20px;
        }

        .feelings-textarea {
            width: 100%;
            min-height: 100px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            padding: 12px;
            font-size: 14px;
            font-family: inherit;
            resize: vertical;
            outline: none;
        }

        .feelings-textarea:focus {
            border-color: #4CAF50;
        }

        .validate-btn {
            width: 100%;
            padding: 16px;
            background: #4CAF50;
            color: white;
            border: none;
            border-radius: 25px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .validate-btn:hover {
            background: #45a049;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(76, 175, 80, 0.3);
        }

        /* Welcome Screen */
        .welcome-screen {
            display: flex;
            flex-direction: column;
            height: 100%;
            background: linear-gradient(135deg, #E8F5E8 0%, #F1F8E9 100%);
        }

        .welcome-header {
            flex: 1;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            padding: 40px 20px;
        }

        .logo {
            width: 120px;
            height: 120px;
            background: linear-gradient(135deg, #FF6B9D, #4ECDC4);
            border-radius: 60px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 24px;
            box-shadow: 0 10px 40px rgba(255, 107, 157, 0.5);
            animation: logoFloat 4s ease-in-out infinite;
        }

        @keyframes logoFloat {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-10px); }
        }

        .logo-text {
            color: white;
            font-size: 32px;
            font-weight: 800;
            letter-spacing: 2px;
        }

        .welcome-title {
            font-size: 32px;
            font-weight: 800;
            color: #333333;
            margin-bottom: 12px;
            text-align: center;
        }

        .welcome-subtitle {
            font-size: 20px;
            color: #4CAF50;
            text-align: center;
            margin-bottom: 20px;
            line-height: 1.5;
            font-weight: 600;
        }

        .welcome-description {
            font-size: 16px;
            color: #666666;
            text-align: center;
            margin-bottom: 40px;
            line-height: 1.6;
            padding: 0 20px;
        }

        .quick-actions {
            padding: 0 20px 30px;
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .quick-action-btn {
            width: 100%;
            padding: 16px 20px;
            background: white;
            border: 2px solid #4CAF50;
            border-radius: 15px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            text-align: left;
        }

        .quick-action-btn:hover {
            background: #4CAF50;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(76, 175, 80, 0.3);
        }

        .quick-action-btn:hover .action-text {
            color: white;
        }

        .action-icon {
            font-size: 24px;
            margin-right: 16px;
        }

        .action-text {
            color: #333333;
            font-size: 16px;
            font-weight: 600;
            transition: color 0.3s ease;
        }

        .auth-buttons {
            padding: 0 20px 40px;
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .auth-btn {
            width: 100%;
            padding: 18px;
            border-radius: 12px;
            font-size: 16px;
            font-weight: 600;
            border: none;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
            touch-action: manipulation;
            -webkit-tap-highlight-color: transparent;
            min-height: 56px;
        }

        .auth-btn::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            background: radial-gradient(circle, rgba(255,255,255,0.3) 0%, transparent 70%);
            transition: all 0.6s ease;
            transform: translate(-50%, -50%);
        }

        .auth-btn:hover::before {
            width: 300px;
            height: 300px;
        }

        .signup-btn {
            background: #4CAF50;
            color: white;
            box-shadow: 0 2px 8px rgba(76, 175, 80, 0.3);
        }

        .signup-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(76, 175, 80, 0.4);
            background: #45a049;
        }

        .login-btn {
            background: transparent;
            color: #4CAF50;
            border: 2px solid #4CAF50;
        }

        .login-btn:hover {
            background: #4CAF50;
            color: white;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(76, 175, 80, 0.3);
        }

        .guest-btn {
            background: #f5f5f5;
            color: #333333;
            border: 1px solid #ddd;
        }

        .guest-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            background: #eeeeee;
        }

        /* Main App Screens */
        .main-app {
            height: 100%;
            display: flex;
            flex-direction: column;
        }

        .app-header {
            background: linear-gradient(135deg, #81C784, #4CAF50);
            padding: 60px 20px 30px;
            border-bottom-left-radius: 30px;
            border-bottom-right-radius: 30px;
            text-align: center;
        }

        .app-title {
            font-size: 28px;
            font-weight: 600;
            color: white;
            margin-bottom: 8px;
            text-shadow: 0 2px 4px rgba(0,0,0,0.2);
        }

        .date-text {
            font-size: 16px;
            color: rgba(255,255,255,0.9);
        }

        .app-content {
            flex: 1;
            padding: 24px 20px;
            overflow-y: auto;
        }

        /* Home Screen Specific */
        .mood-question {
            text-align: center;
            margin-bottom: 24px;
        }

        .mood-question h2 {
            font-size: 24px;
            font-weight: 600;
            background: linear-gradient(135deg, #4CAF50, #1B5E20);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 8px;
        }

        .mood-question .subtitle {
            font-size: 16px;
            color: #666;
        }

        .mood-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 16px;
            margin-bottom: 24px;
        }

        .mood-item {
            background: linear-gradient(135deg, #FFEAA7, #FF6B9D, #4ECDC4);
            border-radius: 20px;
            padding: 20px;
            text-align: center;
            cursor: pointer;
            transition: all 0.4s ease;
            box-shadow: 0 6px 20px rgba(255, 234, 167, 0.3);
            border: 2px solid transparent;
            position: relative;
            overflow: hidden;
        }

        .mood-item::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.4), transparent);
            transition: left 0.6s;
        }

        .mood-item:hover::before {
            left: 100%;
        }

        .mood-item:hover {
            transform: translateY(-8px) scale(1.05);
            box-shadow: 0 12px 35px rgba(78, 205, 196, 0.4);
            border-color: rgba(255, 107, 157, 0.5);
        }

        .mood-item:active {
            transform: translateY(-5px) scale(0.98);
        }

        .mood-icon {
            font-size: 32px;
            margin-bottom: 8px;
            display: block;
        }

        .mood-label {
            font-size: 14px;
            color: #2E7D32;
            font-weight: 600;
        }

        .actions-section {
            margin-top: 32px;
        }

        .section-title {
            font-size: 20px;
            font-weight: 600;
            background: linear-gradient(135deg, #4CAF50, #1B5E20);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 16px;
            text-align: center;
        }

        .action-cards {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .action-card {
            background: linear-gradient(135deg, #96CEB4, #FFEAA7, #FF6B9D);
            border-radius: 20px;
            padding: 20px;
            display: flex;
            align-items: center;
            gap: 16px;
            box-shadow: 0 6px 20px rgba(150, 206, 180, 0.3);
            transition: all 0.4s ease;
            cursor: pointer;
            border: 2px solid transparent;
            position: relative;
            overflow: hidden;
        }

        .action-card::after {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            background: radial-gradient(circle, rgba(255,255,255,0.3) 0%, transparent 70%);
            transition: all 0.6s ease;
            transform: translate(-50%, -50%);
        }

        .action-card:hover::after {
            width: 300px;
            height: 300px;
        }

        .action-card:hover {
            transform: translateY(-5px) scale(1.02);
            box-shadow: 0 12px 35px rgba(69, 183, 209, 0.4);
            border-color: rgba(255, 107, 157, 0.6);
        }

        .action-card:active {
            transform: translateY(-2px) scale(0.98);
        }

        .action-icon {
            width: 50px;
            height: 50px;
            background: linear-gradient(135deg, #E8F5E8, #C8E6C9);
            border-radius: 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
        }

        .action-content {
            flex: 1;
        }

        .action-title {
            font-size: 18px;
            font-weight: 600;
            color: #333;
            margin-bottom: 4px;
        }

        .action-subtitle {
            font-size: 14px;
            color: #666;
        }

        /* Mood Screen Specific */
        .mood-selection {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 12px;
            margin-bottom: 24px;
        }

        .mood-button {
            background: linear-gradient(135deg, #E8F5E8, #DCEDC8);
            border: none;
            border-radius: 20px;
            padding: 16px 8px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
            box-shadow: 0 4px 15px rgba(76, 175, 80, 0.1);
        }

        .mood-button:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(76, 175, 80, 0.2);
        }

        .mood-button .mood-icon {
            font-size: 28px;
            margin-bottom: 8px;
            display: block;
        }

        .mood-button .mood-label {
            font-size: 12px;
            color: #2E7D32;
            font-weight: 600;
        }

        /* Chat Screen Specific */
        .chat-container {
            display: flex;
            flex-direction: column;
            gap: 24px;
        }

        .welcome-message {
            background: linear-gradient(135deg, #E8F5E8, #DCEDC8);
            border-radius: 20px;
            padding: 20px;
            text-align: center;
            box-shadow: 0 4px 15px rgba(76, 175, 80, 0.1);
        }

        .welcome-emoji {
            font-size: 32px;
            margin-bottom: 12px;
            display: block;
        }

        .welcome-message h3 {
            font-size: 20px;
            color: #333;
            margin-bottom: 8px;
        }

        .welcome-message p {
            color: #666;
            line-height: 1.5;
        }

        .quick-actions {
            display: flex;
            flex-direction: column;
            gap: 16px;
        }

        .action-button {
            background: linear-gradient(135deg, #4ECDC4, #45B7D1, #96CEB4);
            border: none;
            border-radius: 20px;
            padding: 18px 24px;
            display: flex;
            align-items: center;
            gap: 15px;
            cursor: pointer;
            box-shadow: 0 6px 20px rgba(78, 205, 196, 0.3);
            transition: all 0.4s ease;
            position: relative;
            overflow: hidden;
            min-width: 200px;
            justify-content: flex-start;
        }

        .action-button::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
            transition: left 0.6s;
        }

        .action-button:hover::before {
            left: 100%;
        }

        .action-button:hover {
            transform: translateY(-4px) scale(1.03);
            box-shadow: 0 12px 30px rgba(69, 183, 209, 0.4);
        }

        .action-button:active {
            transform: translateY(-2px) scale(0.98);
        }

        .action-emoji {
            font-size: 24px;
        }

        .action-text {
            color: #333;
            font-weight: 500;
            font-size: 16px;
        }

        /* Profile Screen Specific */
        .profile-header {
            text-align: center;
            margin-bottom: 30px;
        }

        .avatar {
            width: 80px;
            height: 80px;
            background: linear-gradient(135deg, #4CAF50, #2E7D32);
            border-radius: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 16px;
            color: white;
            font-size: 32px;
            font-weight: 700;
            box-shadow: 0 4px 15px rgba(76, 175, 80, 0.3);
        }

        .profile-name {
            font-size: 24px;
            font-weight: 600;
            background: linear-gradient(135deg, #4CAF50, #1B5E20);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 4px;
        }

        .profile-email {
            color: #666;
            font-size: 16px;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 16px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: linear-gradient(135deg, #FFF, #F1F8E9);
            border-radius: 20px;
            padding: 20px;
            text-align: center;
            box-shadow: 0 4px 15px rgba(76, 175, 80, 0.1);
            transition: all 0.3s;
        }

        .stat-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(76, 175, 80, 0.2);
        }

        .stat-icon {
            font-size: 24px;
            margin-bottom: 8px;
            display: block;
        }

        .stat-number {
            font-size: 20px;
            font-weight: 700;
            background: linear-gradient(135deg, #4CAF50, #1B5E20);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 4px;
        }

        .stat-label {
            font-size: 12px;
            color: #666;
        }

        /* Onboarding Screen */
        .onboarding-screen {
            height: 100%;
            display: flex;
            flex-direction: column;
            padding: 40px 20px;
            text-align: center;
        }

        .onboarding-content {
            flex: 1;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
        }

        .onboarding-icon {
            font-size: 80px;
            margin-bottom: 20px;
            padding: 20px;
            background: linear-gradient(135deg, #E8F5E8, #C8E6C9);
            border-radius: 30px;
            box-shadow: 0 4px 15px rgba(76, 175, 80, 0.1);
        }

        .onboarding-title {
            font-size: 28px;
            font-weight: 700;
            background: linear-gradient(135deg, #4CAF50, #1B5E20);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 8px;
        }

        .onboarding-description {
            font-size: 16px;
            color: #666;
            line-height: 1.5;
            margin-bottom: 40px;
        }

        .onboarding-navigation {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 40px;
        }

        .nav-dots {
            display: flex;
            gap: 8px;
        }

        .dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: #E0E0E0;
        }

        .dot.active {
            background: linear-gradient(135deg, #4CAF50, #2E7D32);
        }

        .nav-step-btn {
            padding: 12px 20px;
            border-radius: 20px;
            border: none;
            font-weight: 600;
            cursor: pointer;
        }

        .prev-btn {
            background: #E8F5E8;
            color: #1B5E20;
        }

        .next-btn {
            background: linear-gradient(135deg, #4CAF50, #2E7D32);
            color: white;
            box-shadow: 0 4px 15px rgba(76, 175, 80, 0.3);
        }

        /* Tab Navigation */
        .tab-navigation {
            display: flex;
            background: linear-gradient(135deg, #FFF, #F1F8E9);
            border-top: 1px solid rgba(76, 175, 80, 0.2);
            padding: 10px 0 20px;
        }

        .tab-item {
            flex: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 8px;
            border: none;
            background: none;
            cursor: pointer;
        }

        .tab-icon {
            font-size: 16px;
            margin-bottom: 4px;
            color: #999;
        }

        .tab-label {
            font-size: 12px;
            color: #999;
        }

        .tab-item.active .tab-icon,
        .tab-item.active .tab-label {
            color: #4CAF50;
        }

        /* Auth Screens */
        .auth-screen {
            padding: 60px 20px 40px;
            height: 100%;
            display: flex;
            flex-direction: column;
        }

        .auth-header {
            text-align: center;
            margin-bottom: 40px;
        }

        .auth-title {
            font-size: 32px;
            font-weight: 800;
            background: linear-gradient(135deg, #FF6B9D, #4ECDC4, #45B7D1, #96CEB4);
            -webkit-background-clip: text;
            background-clip: text;

        /* === NOUVEAU SYST√àME D'AUTHENTIFICATION === */
        
        /* Mode Navigation Anonyme (F01.4) */
        .anonymous-access {
            margin-bottom: 20px;
        }

        .anonymous-btn {
            width: 100%;
            padding: 15px 20px;
            background: rgba(255, 255, 255, 0.15);
            border: 2px solid rgba(255, 255, 255, 0.3);
            border-radius: 12px;
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
            transition: all 0.3s ease;
            cursor: pointer;
            font-size: 16px;
        }

        .anonymous-btn:hover {
            background: rgba(255, 255, 255, 0.25);
            border-color: rgba(255, 255, 255, 0.5);
            transform: translateY(-1px);
        }

        .anonymous-icon {
            font-size: 24px;
            opacity: 0.8;
        }

        .anonymous-text {
            display: flex;
            flex-direction: column;
            text-align: left;
        }

        .anonymous-main {
            font-weight: 600;
            font-size: 16px;
        }

        .anonymous-sub {
            font-size: 13px;
            opacity: 0.8;
            margin-top: 2px;
        }

        /* Messages d'√©tat */
        .auth-messages {
            margin-bottom: 20px;
        }

        .message {
            padding: 12px 16px;
            border-radius: 8px;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 14px;
        }

        .error-message {
            background: rgba(244, 67, 54, 0.1);
            border: 1px solid rgba(244, 67, 54, 0.3);
            color: #f44336;
        }

        .success-message {
            background: rgba(76, 175, 80, 0.1);
            border: 1px solid rgba(76, 175, 80, 0.3);
            color: #4caf50;
        }

        .loading-message {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.3);
            color: white;
        }

        .spinner {
            width: 16px;
            height: 16px;
            border: 2px solid rgba(255, 255, 255, 0.3);
            border-top: 2px solid white;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Authentification OAuth (F01.1, F01.2) */
        .oauth-section {
            margin-bottom: 20px;
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .oauth-btn {
            width: 100%;
            padding: 15px 20px;
            border: 2px solid rgba(255, 255, 255, 0.3);
            border-radius: 12px;
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
            transition: all 0.3s ease;
            cursor: pointer;
            font-size: 16px;
            font-weight: 500;
        }

        .google-btn {
            background: #db4437;
        }

        .google-btn:hover {
            background: #c23321;
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(219, 68, 55, 0.3);
        }

        .apple-btn {
            background: #000000;
        }

        .apple-btn:hover {
            background: #1a1a1a;
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
        }

        .oauth-icon {
            font-size: 20px;
        }

        .oauth-text {
            font-weight: 500;
        }

        /* Consentements RGPD (F01.5) */
        .consent-section {
            margin: 25px 0;
            padding: 20px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .consent-item {
            margin-bottom: 15px;
            display: flex;
            align-items: flex-start;
            gap: 10px;
        }

        .consent-item:last-child {
            margin-bottom: 0;
        }

        .consent-checkbox {
            margin-top: 2px;
            accent-color: #667eea;
        }

        .consent-label {
            flex: 1;
            color: white;
            font-size: 14px;
            line-height: 1.4;
            cursor: pointer;
        }

        .consent-label a {
            color: #81c784;
            text-decoration: underline;
        }

        .consent-label a:hover {
            color: #a5d6a7;
        }

        /* Validation mot de passe (F01.3) */
        .password-strength {
            margin-top: 8px;
            height: 4px;
            border-radius: 2px;
            background: rgba(255, 255, 255, 0.2);
            overflow: hidden;
        }

        .password-strength-bar {
            height: 100%;
            transition: all 0.3s ease;
            border-radius: 2px;
        }

        .password-strength.weak .password-strength-bar {
            width: 25%;
            background: #f44336;
        }

        .password-strength.fair .password-strength-bar {
            width: 50%;
            background: #ff9800;
        }

        .password-strength.good .password-strength-bar {
            width: 75%;
            background: #2196f3;
        }

        .password-strength.strong .password-strength-bar {
            width: 100%;
            background: #4caf50;
        }

        .password-requirements {
            margin-top: 5px;
        }

        .password-requirements small {
            color: rgba(255, 255, 255, 0.7);
            font-size: 12px;
        }

        /* Modal de v√©rification email */
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            padding: 20px;
        }

        .modal-content {
            background: white;
            border-radius: 12px;
            max-width: 400px;
            width: 100%;
            overflow: hidden;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
        }

        .modal-header {
            padding: 20px 20px 10px;
            text-align: center;
        }

        .modal-header h3 {
            margin: 0;
            color: #333;
            font-size: 18px;
        }

        .modal-body {
            padding: 0 20px 20px;
            text-align: center;
            color: #666;
            line-height: 1.5;
        }

        .verification-email {
            margin: 15px 0;
        }

        .verification-email strong {
            color: #667eea;
            font-weight: 600;
        }

        .expiry-note {
            font-size: 14px;
            color: #999;
            margin-top: 15px;
        }

        .modal-actions {
            padding: 20px;
            display: flex;
            gap: 10px;
            justify-content: flex-end;
            background: #f8f9fa;
        }

        .btn-primary, .btn-secondary {
            padding: 10px 20px;
            border-radius: 6px;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .btn-primary {
            background: #667eea;
            color: white;
            border: none;
        }

        .btn-primary:hover {
            background: #5a67d8;
        }

        .btn-secondary {
            background: transparent;
            color: #667eea;
            border: 1px solid #667eea;
        }

        .btn-secondary:hover {
            background: #667eea;
            color: white;
        }
            -webkit-text-fill-color: transparent;
            margin-bottom: 10px;
            animation: titleShine 3s ease-in-out infinite alternate;
        }

        .auth-subtitle {
            font-size: 16px;
            color: #666;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-label {
            display: block;
            font-size: 14px;
            color: #2E7D32;
            margin-bottom: 8px;
            font-weight: 600;
        }

        .form-input {
            width: 100%;
            padding: 18px 20px;
            border: 2px solid #e0e0e0;
            background: white;
            border-radius: 12px;
            font-size: 16px;
            transition: all 0.3s ease;
            position: relative;
            box-sizing: border-box;
            -webkit-appearance: none;
            appearance: none;
            min-height: 56px;
            -webkit-tap-highlight-color: transparent;
            touch-action: manipulation;
        }

        .form-input:focus {
            outline: none;
            border-color: #4CAF50;
            box-shadow: 0 0 0 4px rgba(76, 175, 80, 0.15);
        }

        /* ========== RESPONSIVE FORM ELEMENTS ========== */

        /* üì± MOBILE - Formulaires optimis√©s tactile */
        @media (max-width: 767px) {
            .form-input {
                padding: 16px 18px;
                font-size: 16px;
                min-height: 52px;
                border-radius: 12px;
            }
            
            .submit-btn {
                padding: 16px 20px;
                font-size: 16px;
                min-height: 52px;
            }
        }

        /* üì± TABLET - Formulaires espac√©s */
        @media (min-width: 768px) and (max-width: 1023px) {
            .form-input {
                padding: 20px 24px;
                font-size: 17px;
                min-height: 60px;
                border-radius: 16px;
            }
            
            .submit-btn {
                padding: 22px 32px;
                font-size: 18px;
                min-height: 64px;
                border-radius: 18px;
            }
        }

        /* üíª DESKTOP - Formulaires √©l√©gants */
        @media (min-width: 1024px) {
            .form-input {
                padding: 18px 22px;
                font-size: 16px;
                min-height: 56px;
                border-radius: 14px;
                max-width: 400px;
            }
            
            .submit-btn {
                padding: 18px 32px;
                font-size: 17px;
                min-height: 56px;
                border-radius: 16px;
                max-width: 300px;
                margin: 0 auto;
            }
        }

        .submit-btn {
            width: 100%;
            padding: 18px 24px;
            background: #4CAF50;
            color: white;
            border: none;
            border-radius: 16px;
            font-size: 17px;
            font-weight: 600;
            margin: 25px 0;
            box-shadow: 0 2px 8px rgba(76, 175, 80, 0.3);
            transition: all 0.2s ease;
            min-height: 56px;
            display: flex;
            align-items: center;
            justify-content: center;
            -webkit-tap-highlight-color: transparent;
            touch-action: manipulation;
        }

        .submit-btn:active {
            transform: scale(0.97);
            box-shadow: 0 1px 4px rgba(76, 175, 80, 0.3);
            background: #45a049;
        }

        /* Responsive submit buttons */
        @media (max-width: 375px) {
            .submit-btn {
                padding: 16px 20px;
                font-size: 16px;
                min-height: 52px;
                margin: 20px 0;
            }
        }

        @media (min-width: 769px) and (max-width: 1024px) {
            .submit-btn {
                padding: 22px 32px;
                font-size: 18px;
                min-height: 64px;
                border-radius: 18px;
                margin: 30px 0;
            }
        }

        @media (min-width: 1025px) {
            .submit-btn {
                padding: 20px 28px;
                font-size: 17px;
                min-height: 58px;
                margin: 28px 0;
            }
        }

        .auth-link {
            text-align: center;
            margin-top: 20px;
        }

        .auth-link a {
            background: linear-gradient(135deg, #FF6B9D, #45B7D1);
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
            text-decoration: none;
            font-weight: 700;
            transition: all 0.3s ease;
            position: relative;
        }

        .auth-link a:hover {
            transform: scale(1.05);
        }

        .auth-link a::after {
            content: '';
            position: absolute;
            bottom: -2px;
            left: 0;
            width: 0;
            height: 2px;
            background: linear-gradient(135deg, #FF6B9D, #45B7D1);
            transition: width 0.3s ease;
        }

        .auth-link a:hover::after {
            width: 100%;
        }

        /* Responsive */
        @media (max-width: 480px) {
            .phone-container {
                width: 95vw;
                height: 95vh;
                max-width: 375px;
                max-height: 812px;
            }
            
            .nav-controls {
                max-width: 350px;
            }
            
            .nav-btn {
                font-size: 10px;
                padding: 6px 10px;
            }
        }

        /* Navigation en bas */
        .bottom-navigation {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: white;
            border-top: 1px solid #e1e8ed;
            display: flex;
            justify-content: space-around;
            padding: 8px 0 max(8px, env(safe-area-inset-bottom));
            z-index: 1000;
            box-shadow: 0 -2px 10px rgba(0,0,0,0.1);
        }

        .nav-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 6px 12px;
            background: none;
            border: none;
            color: #666;
            text-decoration: none;
            transition: all 0.3s ease;
            border-radius: 12px;
            min-width: 60px;
        }

        .nav-item.active {
            color: #8A2BE2;
            background: rgba(138, 43, 226, 0.1);
        }

        .nav-icon {
            font-size: 22px;
            margin-bottom: 2px;
        }

        .nav-label {
            font-size: 11px;
            font-weight: 500;
        }

        .nav-item:active {
            transform: scale(0.95);
        }

        /* √âcrans d'onboarding */
        .onboarding-screen {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }

        .onboarding-container {
            background: white;
            border-radius: 20px;
            padding: 30px;
            max-width: 500px;
            width: 100%;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
        }

        .onboarding-header {
            text-align: center;
            margin-bottom: 30px;
        }

        .onboarding-header h1 {
            font-size: 28px;
            margin-bottom: 10px;
            color: #333;
        }

        .onboarding-header p {
            color: #666;
            font-size: 16px;
        }

        /* Conditions d'utilisation */
        .terms-content {
            margin-bottom: 25px;
        }

        .terms-section {
            margin-bottom: 25px;
        }

        .terms-section h3 {
            color: #8A2BE2;
            font-size: 18px;
            margin-bottom: 10px;
        }

        .terms-text {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 10px;
            border-left: 4px solid #8A2BE2;
        }

        .terms-text ul {
            margin: 10px 0 0 0;
            padding-left: 0;
        }

        .terms-text li {
            list-style: none;
            padding: 5px 0;
            font-size: 14px;
        }

        .terms-acceptance {
            margin-bottom: 25px;
        }

        .checkbox-container {
            display: block;
            position: relative;
            padding-left: 35px;
            margin-bottom: 15px;
            cursor: pointer;
            font-size: 14px;
            color: #333;
        }

        .checkbox-container input {
            position: absolute;
            opacity: 0;
            cursor: pointer;
        }

        .checkmark {
            position: absolute;
            top: 0;
            left: 0;
            height: 20px;
            width: 20px;
            background-color: #eee;
            border-radius: 4px;
            border: 2px solid #ddd;
        }

        .checkbox-container:hover input ~ .checkmark {
            background-color: #ccc;
        }

        .checkbox-container input:checked ~ .checkmark {
            background-color: #8A2BE2;
            border-color: #8A2BE2;
        }

        .checkmark:after {
            content: "";
            position: absolute;
            display: none;
        }

        .checkbox-container input:checked ~ .checkmark:after {
            display: block;
        }

        .checkbox-container .checkmark:after {
            left: 6px;
            top: 2px;
            width: 5px;
            height: 10px;
            border: solid white;
            border-width: 0 3px 3px 0;
            transform: rotate(45deg);
        }

        .continue-btn {
            width: 100%;
            background: #8A2BE2;
            color: white;
            border: none;
            padding: 15px;
            border-radius: 12px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .continue-btn:disabled {
            background: #ccc;
            cursor: not-allowed;
        }

        .continue-btn:not(:disabled):hover {
            background: #7B1FA2;
            transform: translateY(-2px);
        }

        /* Plans d'abonnement */
        .subscription-plans {
            display: flex;
            flex-direction: column;
            gap: 20px;
            margin-bottom: 25px;
        }

        .plan-card {
            border: 2px solid #e1e8ed;
            border-radius: 16px;
            padding: 25px;
            position: relative;
            transition: all 0.3s ease;
            background: white;
        }

        .plan-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.1);
        }

        .plan-card.recommended {
            border-color: #8A2BE2;
            box-shadow: 0 4px 20px rgba(138, 43, 226, 0.15);
        }

        .plan-badge {
            position: absolute;
            top: -10px;
            right: 20px;
            background: #8A2BE2;
            color: white;
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
        }

        .plan-header {
            text-align: center;
            margin-bottom: 20px;
        }

        .plan-header h3 {
            font-size: 22px;
            margin-bottom: 10px;
            color: #333;
        }

        .plan-price {
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 8px;
        }

        .plan-price .price {
            font-size: 32px;
            font-weight: 700;
            color: #8A2BE2;
        }

        .plan-price .period {
            font-size: 16px;
            color: #666;
            margin-left: 5px;
        }

        .plan-savings {
            background: #4CAF50;
            color: white;
            padding: 4px 12px;
            border-radius: 15px;
            font-size: 12px;
            font-weight: 600;
            display: inline-block;
        }

        .plan-features ul {
            list-style: none;
            padding: 0;
            margin: 0;
        }

        .plan-features li {
            padding: 8px 0;
            font-size: 14px;
            border-bottom: 1px solid #f0f0f0;
        }

        .plan-features li:last-child {
            border-bottom: none;
        }

        .select-plan-btn {
            width: 100%;
            background: #8A2BE2;
            color: white;
            border: none;
            padding: 15px;
            border-radius: 12px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-top: 20px;
        }

        .select-plan-btn:hover {
            background: #7B1FA2;
            transform: translateY(-2px);
        }

        .select-plan-btn.secondary {
            background: #333;
        }

        .select-plan-btn.secondary:hover {
            background: #555;
        }

        .select-plan-btn.basic-btn {
            background: transparent;
            color: #8A2BE2;
            border: 2px solid #8A2BE2;
        }

        .select-plan-btn.basic-btn:hover {
            background: #8A2BE2;
            color: white;
        }

        .subscription-info {
            text-align: center;
            color: #666;
        }

        /* √âcran de paiement */
        .trial-reminder {
            background: linear-gradient(135deg, #4CAF50, #45a049);
            color: white;
            padding: 15px;
            border-radius: 12px;
            margin-top: 15px;
            text-align: center;
        }

        .trial-badge {
            background: rgba(255,255,255,0.2);
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 14px;
            font-weight: 600;
            display: inline-block;
            margin-bottom: 10px;
        }

        .selected-plan-summary {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 12px;
            margin-bottom: 25px;
            border-left: 4px solid #8A2BE2;
        }

        .payment-form {
            max-width: 400px;
            margin: 0 auto;
        }

        .form-group {
            margin-bottom: 20px;
            position: relative;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #333;
        }

        .form-group input {
            width: 100%;
            padding: 12px;
            border: 2px solid #e1e8ed;
            border-radius: 8px;
            font-size: 16px;
            transition: border-color 0.3s ease;
            box-sizing: border-box;
        }

        .form-group input:focus {
            outline: none;
            border-color: #8A2BE2;
        }

        .form-row {
            display: flex;
            gap: 15px;
        }

        .card-icons {
            position: absolute;
            right: 12px;
            top: 50%;
            transform: translateY(-50%);
            font-size: 18px;
        }

        .security-info {
            margin: 25px 0;
        }

        .security-badge {
            display: flex;
            align-items: center;
            background: #e8f5e8;
            padding: 15px;
            border-radius: 10px;
            border: 1px solid #4CAF50;
        }

        .security-icon {
            font-size: 24px;
            margin-right: 15px;
        }

        .security-text strong {
            color: #4CAF50;
            display: block;
            margin-bottom: 2px;
        }

        .security-text p {
            margin: 0;
            font-size: 12px;
            color: #666;
        }

        .payment-btn {
            width: 100%;
            background: linear-gradient(135deg, #4CAF50, #45a049);
            color: white;
            border: none;
            padding: 18px;
            border-radius: 12px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-top: 10px;
        }

        .payment-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(76, 175, 80, 0.3);
        }

        .payment-terms {
            text-align: center;
            margin-top: 20px;
        }

        /* √âcran de bienvenue */
        .welcome-content {
            text-align: center;
        }

        .welcome-animation {
            margin-bottom: 30px;
        }

        .success-icon {
            font-size: 80px;
            margin-bottom: 20px;
            animation: bounce 1s ease-in-out;
        }

        @keyframes bounce {
            0%, 20%, 60%, 100% { transform: translateY(0); }
            40% { transform: translateY(-30px); }
            80% { transform: translateY(-15px); }
        }

        .welcome-content h1 {
            font-size: 32px;
            color: #333;
            margin-bottom: 10px;
        }

        .trial-status {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            padding: 25px;
            border-radius: 16px;
            margin-bottom: 30px;
        }

        .trial-info h3 {
            margin-bottom: 15px;
            font-size: 18px;
        }

        .trial-countdown {
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 10px;
        }

        .days-left {
            font-size: 48px;
            font-weight: 700;
            margin-right: 10px;
        }

        .days-text {
            font-size: 16px;
        }

        .welcome-features {
            margin-bottom: 30px;
        }

        .welcome-features h3 {
            color: #333;
            margin-bottom: 20px;
            font-size: 20px;
        }

        .feature-list {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .feature-item {
            display: flex;
            align-items: center;
            background: #f8f9fa;
            padding: 15px;
            border-radius: 10px;
            text-align: left;
        }

        .feature-icon {
            font-size: 24px;
            margin-right: 15px;
        }

        .feature-text {
            font-weight: 500;
            color: #333;
        }

        .start-app-btn {
            width: 100%;
            background: linear-gradient(135deg, #8A2BE2, #9C27B0);
            color: white;
            border: none;
            padding: 18px;
            border-radius: 16px;
            font-size: 18px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .start-app-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 25px rgba(138, 43, 226, 0.3);
        }

        /* Ajustements pour mobile */
        @media (max-width: 768px) {
            .onboarding-container {
                padding: 20px;
                margin: 10px;
            }
            
            .subscription-plans {
                gap: 15px;
            }
            
            .form-row {
                flex-direction: column;
                gap: 10px;
            }

            .bottom-navigation {
                padding-bottom: max(12px, env(safe-area-inset-bottom));
            }
        }

        /* Masquer la navigation bottom sur desktop */
        @media (min-width: 1024px) {
            .bottom-navigation {
                display: none;
            }
        }

        /* Gestion d'abonnement */
        .subscription-management-container {
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
        }

        .current-subscription-card {
            background: linear-gradient(135deg, #8A2BE2, #9C27B0);
            color: white;
            padding: 25px;
            border-radius: 16px;
            margin-bottom: 30px;
            text-align: center;
        }

        .subscription-status h3 {
            font-size: 24px;
            margin-bottom: 10px;
        }

        .subscription-status p {
            margin-bottom: 15px;
            opacity: 0.9;
        }

        .trial-progress {
            background: rgba(255,255,255,0.2);
            border-radius: 10px;
            padding: 15px;
            margin-top: 15px;
        }

        .trial-days {
            font-size: 36px;
            font-weight: 700;
            margin-bottom: 5px;
        }

        .available-plans h3 {
            color: #333;
            margin-bottom: 20px;
            font-size: 20px;
        }

        .plan-comparison {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .plan-item {
            border: 2px solid #e1e8ed;
            border-radius: 16px;
            padding: 25px;
            position: relative;
            background: white;
            transition: all 0.3s ease;
        }

        .plan-item:hover {
            transform: translateY(-4px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.1);
        }

        .plan-item.premium-plan {
            border-color: #8A2BE2;
            box-shadow: 0 4px 20px rgba(138, 43, 226, 0.15);
        }

        .plan-item.annual-plan {
            border-color: #4CAF50;
            box-shadow: 0 4px 20px rgba(76, 175, 80, 0.15);
        }

        .plan-badge {
            position: absolute;
            top: -10px;
            right: 20px;
            background: #8A2BE2;
            color: white;
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
        }

        .plan-badge.savings {
            background: #4CAF50;
        }

        .plan-header {
            text-align: center;
            margin-bottom: 20px;
        }

        .plan-header h4 {
            font-size: 20px;
            color: #333;
            margin-bottom: 10px;
        }

        .plan-price {
            font-size: 28px;
            font-weight: 700;
            color: #8A2BE2;
        }

        .plan-price .period {
            font-size: 14px;
            color: #666;
            font-weight: 400;
        }

        .plan-features {
            list-style: none;
            padding: 0;
            margin: 0 0 20px 0;
        }

        .plan-features li {
            padding: 8px 0;
            font-size: 14px;
            border-bottom: 1px solid #f0f0f0;
        }

        .plan-features li:last-child {
            border-bottom: none;
        }

        .plan-action-btn {
            width: 100%;
            padding: 12px;
            border-radius: 10px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 2px solid #e1e8ed;
            background: white;
            color: #666;
        }

        .plan-action-btn.premium {
            background: #8A2BE2;
            color: white;
            border-color: #8A2BE2;
        }

        .plan-action-btn.premium:hover {
            background: #7B1FA2;
            transform: translateY(-2px);
        }

        .plan-action-btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }

        .billing-info, .payment-history {
            margin-top: 30px;
        }

        .billing-info h3, .payment-history h3 {
            color: #333;
            margin-bottom: 15px;
        }

        .billing-card {
            background: #f8f9fa;
            border: 1px solid #e1e8ed;
            border-radius: 12px;
            padding: 20px;
        }

        .billing-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px 0;
            border-bottom: 1px solid #e1e8ed;
        }

        .billing-item:last-child {
            border-bottom: none;
        }

        .billing-label {
            font-weight: 600;
            color: #333;
        }

        .billing-value {
            color: #666;
        }

        .billing-actions {
            display: flex;
            gap: 10px;
            margin-top: 20px;
            flex-wrap: wrap;
        }

        .secondary-btn {
            background: transparent;
            color: #8A2BE2;
            border: 2px solid #8A2BE2;
            padding: 10px 20px;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            flex: 1;
        }

        .secondary-btn:hover {
            background: #8A2BE2;
            color: white;
        }

        .danger-btn {
            background: #f44336;
            color: white;
            border: 2px solid #f44336;
            padding: 10px 20px;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            flex: 1;
        }

        .danger-btn:hover {
            background: #d32f2f;
            border-color: #d32f2f;
        }

        .payment-list {
            background: white;
            border: 1px solid #e1e8ed;
            border-radius: 12px;
            overflow: hidden;
        }

        .payment-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 20px;
            border-bottom: 1px solid #f0f0f0;
        }

        .payment-item:last-child {
            border-bottom: none;
        }

        .payment-info {
            display: flex;
            gap: 15px;
        }

        .payment-date {
            font-weight: 600;
            color: #333;
        }

        .payment-amount {
            color: #666;
        }

        .payment-status {
            padding: 4px 12px;
            border-radius: 15px;
            font-size: 12px;
            font-weight: 600;
        }

        .payment-status.success {
            background: #e8f5e8;
            color: #4CAF50;
        }

        /* Responsive pour la gestion d'abonnement */
        @media (max-width: 768px) {
            .plan-comparison {
                grid-template-columns: 1fr;
            }
            
            .billing-actions {
                flex-direction: column;
            }
            
            .secondary-btn, .danger-btn {
                flex: none;
                width: 100%;
            }
        }

        /* Styles pour les nouvelles sections du profil */
        
        /* Diagnostic de sant√© */
        .health-diagnostic-container {
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
        }

        .health-summary-card {
            background: linear-gradient(135deg, #4CAF50, #45a049);
            color: white;
            padding: 30px;
            border-radius: 20px;
            margin-bottom: 30px;
            display: flex;
            gap: 30px;
            align-items: center;
            flex-wrap: wrap;
        }

        .health-score {
            text-align: center;
        }

        .score-circle {
            width: 100px;
            height: 100px;
            border: 4px solid rgba(255,255,255,0.3);
            border-radius: 50%;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            margin-bottom: 10px;
        }

        .score-number {
            font-size: 36px;
            font-weight: 700;
        }

        .score-label {
            font-size: 12px;
            opacity: 0.9;
        }

        .score-trend {
            display: flex;
            align-items: center;
            gap: 5px;
            font-size: 14px;
        }

        .health-indicators {
            display: flex;
            gap: 20px;
            flex-wrap: wrap;
        }

        .indicator {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 5px;
        }

        .indicator-icon {
            font-size: 24px;
        }

        .indicator-label {
            font-size: 12px;
            opacity: 0.9;
        }

        .indicator-value {
            font-size: 14px;
            font-weight: 600;
            padding: 2px 8px;
            border-radius: 12px;
            background: rgba(255,255,255,0.2);
        }

        .indicator-value.good {
            background: rgba(76, 175, 80, 0.3);
        }

        .indicator-value.warning {
            background: rgba(255, 193, 7, 0.3);
        }

        .ai-recommendations {
            margin-bottom: 30px;
        }

        .ai-recommendations h3 {
            color: #333;
            margin-bottom: 20px;
        }

        .recommendation-card {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .recommendation-priority {
            background: white;
            border: 2px solid #e1e8ed;
            border-radius: 16px;
            padding: 20px;
            position: relative;
        }

        .recommendation-priority.high {
            border-color: #f44336;
            background: #ffebee;
        }

        .recommendation-priority.medium {
            border-color: #ff9800;
            background: #fff3e0;
        }

        .priority-badge {
            position: absolute;
            top: -8px;
            left: 20px;
            background: #f44336;
            color: white;
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: 600;
        }

        .recommendation-priority.medium .priority-badge {
            background: #ff9800;
        }

        .recommendation-priority h4 {
            margin: 10px 0;
            color: #333;
        }

        .recommendation-priority p {
            color: #666;
            margin-bottom: 15px;
        }

        .action-btn {
            background: #8A2BE2;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .action-btn:hover {
            background: #7B1FA2;
            transform: translateY(-2px);
        }

        .action-btn.secondary {
            background: transparent;
            color: #8A2BE2;
            border: 2px solid #8A2BE2;
        }

        .action-btn.secondary:hover {
            background: #8A2BE2;
            color: white;
        }

        /* Timeline pour l'historique */
        .diagnostic-history h3 {
            color: #333;
            margin-bottom: 20px;
        }

        .history-timeline {
            position: relative;
            padding-left: 30px;
        }

        .history-timeline::before {
            content: '';
            position: absolute;
            left: 10px;
            top: 0;
            bottom: 0;
            width: 2px;
            background: #e1e8ed;
        }

        .timeline-item {
            position: relative;
            margin-bottom: 20px;
            background: white;
            border: 1px solid #e1e8ed;
            border-radius: 12px;
            padding: 15px;
        }

        .timeline-item::before {
            content: '';
            position: absolute;
            left: -25px;
            top: 20px;
            width: 10px;
            height: 10px;
            border-radius: 50%;
            background: #8A2BE2;
        }

        .timeline-date {
            font-size: 12px;
            color: #666;
            margin-bottom: 5px;
        }

        .timeline-content h4 {
            color: #333;
            margin-bottom: 5px;
        }

        .timeline-status {
            display: inline-block;
            padding: 2px 8px;
            border-radius: 10px;
            font-size: 12px;
            font-weight: 600;
            margin-top: 5px;
        }

        .timeline-status.improved {
            background: #e8f5e8;
            color: #4CAF50;
        }

        .timeline-status.declined {
            background: #ffebee;
            color: #f44336;
        }

        /* Rappels et notifications */
        .reminders-container {
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
        }

        .active-reminders h3 {
            color: #333;
            margin-bottom: 20px;
        }

        .reminder-list {
            display: flex;
            flex-direction: column;
            gap: 15px;
            margin-bottom: 20px;
        }

        .reminder-item {
            display: flex;
            align-items: center;
            gap: 15px;
            background: white;
            border: 2px solid #e1e8ed;
            border-radius: 12px;
            padding: 15px;
            transition: all 0.3s ease;
        }

        .reminder-item.active {
            border-color: #4CAF50;
            background: #f8fff8;
        }

        .reminder-item.inactive {
            opacity: 0.6;
        }

        .reminder-icon {
            font-size: 24px;
            width: 40px;
            text-align: center;
        }

        .reminder-content {
            flex: 1;
        }

        .reminder-content h4 {
            color: #333;
            margin-bottom: 5px;
        }

        .reminder-content p {
            color: #666;
            font-size: 14px;
            margin: 0;
        }

        .reminder-controls {
            display: flex;
            gap: 10px;
            align-items: center;
        }

        .toggle-btn {
            background: #4CAF50;
            color: white;
            border: none;
            padding: 6px 12px;
            border-radius: 15px;
            font-size: 12px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            min-width: 40px;
        }

        .toggle-btn:not(.active) {
            background: #ccc;
        }

        .edit-btn {
            background: transparent;
            border: none;
            font-size: 16px;
            cursor: pointer;
            padding: 5px;
            border-radius: 50%;
            transition: background 0.3s ease;
        }

        .edit-btn:hover {
            background: rgba(138, 43, 226, 0.1);
        }

        .add-reminder-btn {
            background: #8A2BE2;
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 10px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            width: 100%;
        }

        .add-reminder-btn:hover {
            background: #7B1FA2;
            transform: translateY(-2px);
        }

        /* Param√®tres de notifications */
        .notification-settings {
            margin-top: 30px;
        }

        .notification-settings h3 {
            color: #333;
            margin-bottom: 20px;
        }

        .settings-list {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .setting-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: white;
            border: 1px solid #e1e8ed;
            border-radius: 12px;
            padding: 15px;
        }

        .setting-info h4 {
            color: #333;
            margin-bottom: 5px;
        }

        .setting-info p {
            color: #666;
            font-size: 14px;
            margin: 0;
        }

        .toggle-switch {
            position: relative;
            width: 50px;
            height: 25px;
            background: #ccc;
            border: none;
            border-radius: 25px;
            cursor: pointer;
            transition: background 0.3s ease;
        }

        .toggle-switch.active {
            background: #4CAF50;
        }

        .switch-slider {
            position: absolute;
            top: 2px;
            left: 2px;
            width: 21px;
            height: 21px;
            background: white;
            border-radius: 50%;
            transition: transform 0.3s ease;
        }

        .toggle-switch.active .switch-slider {
            transform: translateX(25px);
        }

        /* Apparence et th√®me */
        .appearance-container {
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
        }

        .mood-theme-section {
            margin-bottom: 30px;
        }

        .mood-theme-section h3 {
            color: #333;
            margin-bottom: 10px;
        }

        .mood-theme-section p {
            color: #666;
            margin-bottom: 20px;
        }

        .theme-preview {
            background: white;
            border: 2px solid #e1e8ed;
            border-radius: 16px;
            padding: 20px;
            margin-bottom: 20px;
        }

        .current-theme {
            text-align: center;
        }

        .theme-colors {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin-bottom: 15px;
        }

        .color-dot {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            border: 2px solid rgba(255,255,255,0.5);
        }

        .current-theme h4 {
            color: #333;
            margin-bottom: 5px;
        }

        .current-theme p {
            color: #666;
            font-size: 14px;
            margin: 0;
        }

        .mood-themes {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }

        .theme-option {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 10px;
            background: white;
            border: 2px solid #e1e8ed;
            border-radius: 12px;
            padding: 15px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .theme-option:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }

        .theme-option.selected {
            border-color: #8A2BE2;
            background: rgba(138, 43, 226, 0.05);
        }

        .adaptive-setting {
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: #f8f9fa;
            border: 1px solid #e1e8ed;
            border-radius: 12px;
            padding: 15px;
        }

        .appearance-options {
            margin-top: 30px;
        }

        .appearance-options h3 {
            color: #333;
            margin-bottom: 20px;
        }

        .font-size-selector, .language-selector, .date-format-selector, .ai-setting-select {
            background: white;
            border: 2px solid #e1e8ed;
            border-radius: 8px;
            padding: 8px 12px;
            font-size: 14px;
            cursor: pointer;
        }

        .font-size-selector:focus, .language-selector:focus, .date-format-selector:focus, .ai-setting-select:focus {
            outline: none;
            border-color: #8A2BE2;
        }

        /* Guide de suivi */
        .follow-up-container {
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
        }

        .personal-progress {
            margin-bottom: 30px;
        }

        .personal-progress h3 {
            color: #333;
            margin-bottom: 20px;
        }

        .progress-overview {
            display: flex;
            gap: 30px;
            align-items: center;
            background: white;
            border: 2px solid #e1e8ed;
            border-radius: 16px;
            padding: 25px;
            flex-wrap: wrap;
        }

        .progress-stat {
            text-align: center;
        }

        .stat-circle {
            width: 80px;
            height: 80px;
            border: 3px solid #8A2BE2;
            border-radius: 50%;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            margin-bottom: 10px;
        }

        .stat-number {
            font-size: 24px;
            font-weight: 700;
            color: #8A2BE2;
        }

        .stat-unit {
            font-size: 10px;
            color: #666;
        }

        .stat-label {
            font-size: 14px;
            color: #333;
            font-weight: 600;
        }

        .progress-chart {
            flex: 1;
            text-align: center;
        }

        .progress-chart p {
            color: #666;
            font-size: 14px;
            margin-top: 10px;
        }

        .personal-goals {
            margin-bottom: 30px;
        }

        .personal-goals h3 {
            color: #333;
            margin-bottom: 20px;
        }

        .goals-list {
            display: flex;
            flex-direction: column;
            gap: 15px;
            margin-bottom: 20px;
        }

        .goal-item {
            display: flex;
            align-items: center;
            gap: 15px;
            background: white;
            border: 2px solid #e1e8ed;
            border-radius: 12px;
            padding: 15px;
        }

        .goal-item.completed {
            border-color: #4CAF50;
            background: #f8fff8;
        }

        .goal-item.in-progress {
            border-color: #ff9800;
            background: #fff8f0;
        }

        .goal-icon {
            font-size: 24px;
            width: 40px;
            text-align: center;
        }

        .goal-content {
            flex: 1;
        }

        .goal-content h4 {
            color: #333;
            margin-bottom: 5px;
        }

        .goal-content p {
            color: #666;
            font-size: 14px;
            margin-bottom: 10px;
        }

        .goal-progress {
            width: 100%;
        }

        .progress-bar {
            width: 100%;
            height: 8px;
            background: #e1e8ed;
            border-radius: 4px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: #4CAF50;
            transition: width 0.3s ease;
        }

        .add-goal-btn {
            background: #8A2BE2;
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 10px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            width: 100%;
        }

        .add-goal-btn:hover {
            background: #7B1FA2;
            transform: translateY(-2px);
        }

        /* Parcours recommand√© */
        .recommended-journey h3 {
            color: #333;
            margin-bottom: 20px;
        }

        .journey-steps {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .journey-step {
            display: flex;
            align-items: center;
            gap: 20px;
            background: white;
            border: 2px solid #e1e8ed;
            border-radius: 12px;
            padding: 20px;
            position: relative;
        }

        .journey-step.completed {
            border-color: #4CAF50;
            background: #f8fff8;
        }

        .journey-step.current {
            border-color: #8A2BE2;
            background: rgba(138, 43, 226, 0.05);
        }

        .journey-step.upcoming {
            opacity: 0.6;
        }

        .step-number {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: #e1e8ed;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            color: #666;
        }

        .journey-step.completed .step-number {
            background: #4CAF50;
            color: white;
        }

        .journey-step.current .step-number {
            background: #8A2BE2;
            color: white;
        }

        .step-content {
            flex: 1;
        }

        .step-content h4 {
            color: #333;
            margin-bottom: 5px;
        }

        .step-content p {
            color: #666;
            font-size: 14px;
            margin-bottom: 10px;
        }

        .continue-btn {
            background: #8A2BE2;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 6px;
            font-size: 12px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .continue-btn:hover {
            background: #7B1FA2;
        }

        /* Assistante IA */
        .ai-assistant-container {
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
        }

        .ai-introduction {
            display: flex;
            gap: 20px;
            align-items: center;
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            padding: 25px;
            border-radius: 20px;
            margin-bottom: 30px;
        }

        .ai-avatar {
            text-align: center;
        }

        .avatar-circle {
            width: 80px;
            height: 80px;
            border: 3px solid rgba(255,255,255,0.3);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 10px;
        }

        .avatar-emoji {
            font-size: 36px;
        }

        .ai-status {
            display: flex;
            align-items: center;
            gap: 5px;
            font-size: 12px;
            opacity: 0.9;
        }

        .status-dot {
            width: 8px;
            height: 8px;
            background: #4CAF50;
            border-radius: 50%;
        }

        .ai-intro-text h3 {
            margin-bottom: 10px;
        }

        .ai-intro-text p {
            opacity: 0.9;
            line-height: 1.5;
        }

        /* Chat avec l'IA */
        .ai-chat-section {
            margin-bottom: 30px;
        }

        .ai-chat-section h3 {
            color: #333;
            margin-bottom: 20px;
        }

        .chat-container {
            background: white;
            border: 2px solid #e1e8ed;
            border-radius: 16px;
            padding: 20px;
            max-height: 400px;
            overflow-y: auto;
            margin-bottom: 15px;
        }

        .chat-message {
            display: flex;
            gap: 12px;
            margin-bottom: 20px;
            align-items: flex-start;
        }

        .chat-message.user-message {
            flex-direction: row-reverse;
        }

        .message-avatar {
            width: 35px;
            height: 35px;
            border-radius: 50%;
            background: #f0f0f0;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 16px;
            flex-shrink: 0;
        }

        .ai-message .message-avatar {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
        }

        .user-message .message-avatar {
            background: #8A2BE2;
            color: white;
        }

        .message-content {
            background: #f8f9fa;
            padding: 12px 16px;
            border-radius: 16px;
            max-width: 70%;
            position: relative;
        }

        .user-message .message-content {
            background: #8A2BE2;
            color: white;
        }

        .message-content p {
            margin: 0 0 8px 0;
            line-height: 1.4;
        }

        .message-time {
            font-size: 11px;
            opacity: 0.7;
        }

        .message-actions {
            display: flex;
            gap: 8px;
            margin-top: 10px;
        }

        .quick-action-btn {
            background: rgba(138, 43, 226, 0.1);
            color: #8A2BE2;
            border: 1px solid rgba(138, 43, 226, 0.3);
            padding: 6px 12px;
            border-radius: 15px;
            font-size: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .quick-action-btn:hover {
            background: #8A2BE2;
            color: white;
        }

        .chat-input-section {
            background: white;
            border: 2px solid #e1e8ed;
            border-radius: 12px;
            padding: 10px;
        }

        .chat-input-container {
            display: flex;
            gap: 10px;
            align-items: center;
        }

        #aiChatInput {
            flex: 1;
            border: none;
            outline: none;
            padding: 10px;
            font-size: 14px;
        }

        .send-btn {
            background: #8A2BE2;
            color: white;
            border: none;
            padding: 8px 12px;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .send-btn:hover {
            background: #7B1FA2;
        }

        /* Personnalisation IA */
        .ai-customization h3 {
            color: #333;
            margin-bottom: 20px;
        }

        .customization-options {
            background: white;
            border: 2px solid #e1e8ed;
            border-radius: 16px;
            padding: 20px;
        }

        .focus-areas {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-top: 10px;
        }

        .checkbox-tag {
            display: inline-flex;
            align-items: center;
            background: #f8f9fa;
            border: 1px solid #e1e8ed;
            border-radius: 20px;
            padding: 8px 12px;
            font-size: 14px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .checkbox-tag:hover {
            background: rgba(138, 43, 226, 0.1);
        }

        .checkbox-tag input {
            margin-right: 8px;
        }

        .checkbox-tag input:checked {
            accent-color: #8A2BE2;
        }

        /* Param√®tres avanc√©s */
        .advanced-settings-container {
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
        }

        .language-settings, .privacy-settings, .accessibility-settings, .account-actions {
            margin-bottom: 30px;
        }

        .language-settings h3, .privacy-settings h3, .accessibility-settings h3, .account-actions h3 {
            color: #333;
            margin-bottom: 20px;
        }

        .manage-btn {
            background: #8A2BE2;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 6px;
            font-size: 14px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .manage-btn:hover {
            background: #7B1FA2;
            transform: translateY(-1px);
        }

        .action-buttons {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .export-btn, .reset-btn, .delete-btn {
            padding: 15px 20px;
            border: none;
            border-radius: 10px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: left;
        }

        .export-btn {
            background: #4CAF50;
            color: white;
        }

        .export-btn:hover {
            background: #45a049;
            transform: translateY(-2px);
        }

        .reset-btn {
            background: #ff9800;
            color: white;
        }

        .reset-btn:hover {
            background: #f57c00;
            transform: translateY(-2px);
        }

        .delete-btn {
            background: #f44336;
            color: white;
        }

        .delete-btn:hover {
            background: #d32f2f;
            transform: translateY(-2px);
        }

        /* Responsive pour les nouvelles sections */
        @media (max-width: 768px) {
            .health-summary-card {
                flex-direction: column;
                text-align: center;
            }
            
            .health-indicators {
                justify-content: center;
            }
            
            .progress-overview {
                flex-direction: column;
                text-align: center;
            }
            
            .mood-themes {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .journey-steps {
                gap: 10px;
            }
            
            .journey-step {
                flex-direction: column;
                text-align: center;
                gap: 15px;
            }
            
            .ai-introduction {
                flex-direction: column;
                text-align: center;
            }
            
            .message-content {
                max-width: 85%;
            }
            
            .action-buttons {
                gap: 10px;
            }
        }

        /* Styles pour les rappels configurables (F05.1) */
        .reminder-settings-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.7);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 10000;
        }

        .settings-content {
            background: white;
            max-width: 600px;
            width: 90%;
            max-height: 90vh;
            border-radius: 15px;
            overflow-y: auto;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
        }

        .settings-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            border-radius: 15px 15px 0 0;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .settings-header h3 {
            margin: 0;
            font-size: 1.5rem;
        }

        .settings-header .close-btn {
            background: rgba(255, 255, 255, 0.2);
            border: none;
            color: white;
            width: 35px;
            height: 35px;
            border-radius: 50%;
            font-size: 1.2rem;
            cursor: pointer;
            transition: background-color 0.3s;
        }

        .settings-header .close-btn:hover {
            background: rgba(255, 255, 255, 0.3);
        }

        .settings-body {
            padding: 25px;
        }

        .setting-group {
            margin-bottom: 25px;
            padding-bottom: 20px;
            border-bottom: 1px solid #eee;
        }

        .setting-group:last-child {
            border-bottom: none;
        }

        .setting-group h4 {
            color: #333;
            margin: 0 0 15px 0;
            font-size: 1.1rem;
        }

        .setting-label {
            display: flex;
            align-items: center;
            font-weight: 500;
            color: #555;
            cursor: pointer;
            margin-bottom: 8px;
        }

        .setting-label input[type="checkbox"] {
            margin-right: 10px;
            transform: scale(1.2);
        }

        .setting-description {
            color: #777;
            font-size: 0.9rem;
            margin: 5px 0 0 0;
            line-height: 1.4;
        }

        .frequency-options {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .radio-option {
            display: flex;
            align-items: center;
            padding: 10px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .radio-option:hover {
            border-color: #667eea;
            background-color: #f8f9ff;
        }

        .radio-option input[type="radio"] {
            margin-right: 10px;
        }

        .radio-option input[type="radio"]:checked {
            accent-color: #667eea;
        }

        .radio-option:has(input:checked) {
            border-color: #667eea;
            background-color: #f0f2ff;
        }

        .time-slots {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-top: 15px;
        }

        @media (max-width: 768px) {
            .time-slots {
                grid-template-columns: 1fr;
            }
        }

        .time-slot {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 10px;
            border: 1px solid #e9ecef;
        }

        .time-slot label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: #495057;
        }

        .time-slot input[type="time"] {
            width: 100%;
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 1rem;
        }

        .checkbox-option {
            margin-top: 10px;
            font-size: 0.9rem;
        }

        .settings-preview {
            background: #f8f9ff;
            padding: 20px;
            margin: 20px 25px;
            border-radius: 10px;
            border: 1px solid #e0e6ff;
        }

        .settings-preview h4 {
            margin: 0 0 15px 0;
            color: #667eea;
        }

        .preview-content {
            color: #555;
        }

        .preview-disabled {
            color: #999;
            font-style: italic;
        }

        .preview-enabled p {
            margin: 8px 0;
        }

        .preview-notification {
            background: white;
            padding: 15px;
            border-radius: 8px;
            margin-top: 15px;
            border-left: 4px solid #667eea;
        }

        .preview-notification h5 {
            margin: 0 0 10px 0;
            color: #667eea;
        }

        .notification-example {
            background: #f0f2ff;
            padding: 10px;
            border-radius: 6px;
            margin: 0;
            font-style: italic;
            color: #333;
        }

        .settings-actions {
            padding: 25px;
            background: #f8f9fa;
            border-radius: 0 0 15px 15px;
            display: flex;
            gap: 10px;
            justify-content: flex-end;
        }

        .settings-actions .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 500;
            transition: transform 0.2s;
        }

        .settings-actions .btn-primary:hover {
            transform: translateY(-2px);
        }

        .settings-actions .btn-secondary {
            background: white;
            color: #667eea;
            border: 2px solid #667eea;
            padding: 10px 20px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.3s;
        }

        .settings-actions .btn-secondary:hover {
            background: #667eea;
            color: white;
        }

        /* Style pour la popup de rappel dans l'app */
        .reminder-popup {
            position: fixed;
            top: 20px;
            right: 20px;
            background: white;
            border: 2px solid #667eea;
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
            z-index: 9999;
            max-width: 350px;
            animation: slideInRight 0.3s ease-out;
        }

        @keyframes slideInRight {
            from {
                transform: translateX(100%);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }

        .popup-content h4 {
            margin: 0 0 10px 0;
            color: #667eea;
        }

        .popup-content p {
            margin: 0 0 15px 0;
            color: #555;
            line-height: 1.4;
        }

        .popup-actions {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .popup-actions button {
            padding: 10px 15px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.3s;
        }

        .popup-actions button:first-child {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .popup-actions button:first-child:hover {
            transform: translateY(-2px);
        }

        .popup-actions button:not(:first-child) {
            background: #f8f9fa;
            color: #666;
            border: 1px solid #ddd;
        }

        .popup-actions button:not(:first-child):hover {
            background: #e9ecef;
        }

        /* Styles pour le menu de param√®tres du profil */
        .profile-settings-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.7);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 10000;
        }

        .settings-modal-content {
            background: white;
            max-width: 500px;
            width: 90%;
            max-height: 80vh;
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
        }

        .settings-modal-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .settings-modal-header h3 {
            margin: 0;
            font-size: 1.4rem;
        }

        .settings-modal-header .close-btn {
            background: rgba(255, 255, 255, 0.2);
            border: none;
            color: white;
            width: 35px;
            height: 35px;
            border-radius: 50%;
            font-size: 1.2rem;
            cursor: pointer;
            transition: background-color 0.3s;
        }

        .settings-modal-header .close-btn:hover {
            background: rgba(255, 255, 255, 0.3);
        }

        .settings-modal-body {
            padding: 0;
        }

        .settings-menu {
            display: flex;
            flex-direction: column;
        }

        .settings-menu-item {
            display: flex;
            align-items: center;
            padding: 20px;
            border: none;
            background: white;
            cursor: pointer;
            transition: background-color 0.3s;
            border-bottom: 1px solid #f0f0f0;
        }

        .settings-menu-item:hover {
            background: #f8f9ff;
        }

        .settings-menu-item:last-child {
            border-bottom: none;
        }

        .menu-icon {
            font-size: 1.5rem;
            margin-right: 15px;
            width: 40px;
            text-align: center;
        }

        .menu-content {
            flex: 1;
            text-align: left;
        }

        .menu-content h4 {
            margin: 0 0 5px 0;
            font-size: 1rem;
            color: #333;
        }

        .menu-content p {
            margin: 0;
            font-size: 0.9rem;
            color: #666;
        }

        .menu-arrow {
            font-size: 1.2rem;
            color: #ccc;
            margin-left: 10px;
        }

        .settings-footer {
            padding: 20px;
            background: #f8f9fa;
            text-align: center;
            border-top: 1px solid #eee;
        }

        .settings-footer p {
            margin: 5px 0;
            font-size: 0.9rem;
            color: #777;
        }

        .settings-footer p:first-child {
            font-weight: 500;
            color: #333;
        }

        /* Styles pour les statistiques visuelles (F05.2) */
        .statistics-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.8);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 10000;
        }

        .stats-content {
            background: white;
            max-width: 1200px;
            width: 95%;
            max-height: 95vh;
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.3);
        }

        .stats-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .stats-header h3 {
            margin: 0;
            font-size: 1.5rem;
        }

        .stats-body {
            max-height: calc(95vh - 120px);
            overflow-y: auto;
            padding: 0;
        }

        .stats-loading, .stats-error {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 60px 20px;
            text-align: center;
        }

        .loading-spinner {
            width: 40px;
            height: 40px;
            border: 4px solid #f3f3f3;
            border-top: 4px solid #667eea;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-bottom: 20px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .stats-overview {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            padding: 25px;
            background: #f8f9ff;
            border-bottom: 1px solid #e0e6ff;
        }

        .stat-card {
            background: white;
            border-radius: 12px;
            padding: 20px;
            text-align: center;
            box-shadow: 0 2px 10px rgba(102, 126, 234, 0.1);
            border: 1px solid #e0e6ff;
        }

        .stat-icon {
            font-size: 2rem;
            margin-bottom: 10px;
            color: #667eea;
        }

        .stat-value {
            font-size: 2.5rem;
            font-weight: bold;
            color: #333;
            margin-bottom: 5px;
        }

        .stat-label {
            font-size: 0.9rem;
            color: #666;
            margin-bottom: 10px;
        }

        .stat-trend {
            font-size: 0.8rem;
            font-weight: 500;
            padding: 4px 8px;
            border-radius: 15px;
            display: inline-block;
        }

        .stat-trend.positive {
            background: #e8f5e8;
            color: #4caf50;
        }

        .stat-trend.negative {
            background: #ffeaea;
            color: #f44336;
        }

        .stat-trend.neutral {
            background: #f0f2ff;
            color: #667eea;
        }

        .charts-section {
            padding: 25px;
        }

        .chart-container {
            margin-bottom: 40px;
            background: white;
            border-radius: 12px;
            padding: 25px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
            border: 1px solid #e0e0e0;
        }

        .chart-container h4 {
            margin: 0 0 20px 0;
            color: #333;
            font-size: 1.2rem;
        }

        .chart-loading, .chart-error {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 200px;
            text-align: center;
        }

        .chart-loading .loading-spinner {
            width: 30px;
            height: 30px;
            margin-bottom: 15px;
        }

        .chart-error p {
            color: #666;
            margin-bottom: 15px;
        }

        .chart-error button {
            background: #667eea;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 500;
        }

        canvas {
            max-width: 100%;
            height: 300px;
        }

        .insights-section {
            padding: 25px;
            background: #fafbff;
            border-top: 1px solid #e0e6ff;
        }

        .insights-section h4 {
            margin: 0 0 20px 0;
            color: #333;
            font-size: 1.2rem;
        }

        .insight-card {
            display: flex;
            align-items: flex-start;
            background: white;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 15px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
            border-left: 4px solid #667eea;
        }

        .insight-card.positive {
            border-left-color: #4caf50;
        }

        .insight-card.support {
            border-left-color: #ff9800;
        }

        .insight-card.achievement {
            border-left-color: #9c27b0;
        }

        .insight-card.pattern {
            border-left-color: #2196f3;
        }

        .insight-icon {
            font-size: 1.5rem;
            margin-right: 15px;
            margin-top: 2px;
            color: #667eea;
        }

        .insight-card.positive .insight-icon {
            color: #4caf50;
        }

        .insight-card.support .insight-icon {
            color: #ff9800;
        }

        .insight-card.achievement .insight-icon {
            color: #9c27b0;
        }

        .insight-card.pattern .insight-icon {
            color: #2196f3;
        }

        .insight-content h5 {
            margin: 0 0 8px 0;
            color: #333;
            font-size: 1rem;
        }

        .insight-content p {
            margin: 0;
            color: #666;
            line-height: 1.5;
            font-size: 0.9rem;
        }

        .stats-actions {
            padding: 20px 25px;
            background: #f8f9fa;
            border-top: 1px solid #e0e0e0;
            display: flex;
            gap: 10px;
            justify-content: flex-end;
        }

        .stats-actions .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 500;
            transition: transform 0.2s;
        }

        .stats-actions .btn-primary:hover {
            transform: translateY(-2px);
        }

        .stats-actions .btn-secondary {
            background: white;
            color: #667eea;
            border: 2px solid #667eea;
            padding: 10px 20px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.3s;
        }

        .stats-actions .btn-secondary:hover {
            background: #667eea;
            color: white;
        }

        .error-icon {
            font-size: 3rem;
            color: #f44336;
            margin-bottom: 15px;
        }

        .stats-error h4 {
            color: #333;
            margin-bottom: 10px;
        }

        .stats-error p {
            color: #666;
            margin-bottom: 20px;
        }

        .stats-error button {
            background: #667eea;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 500;
        }

        /* Responsive pour les statistiques */
        @media (max-width: 768px) {
            .stats-content {
                width: 98%;
                max-height: 98vh;
            }
            
            .stats-overview {
                grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
                gap: 15px;
                padding: 20px;
            }
            
            .stat-card {
                padding: 15px;
            }
            
            .stat-value {
                font-size: 2rem;
            }
            
            .charts-section {
                padding: 20px;
            }
            
            .chart-container {
                padding: 20px;
                margin-bottom: 25px;
            }
            
            .insights-section {
                padding: 20px;
            }
            
            .insight-card {
                flex-direction: column;
                text-align: center;
            }
            
            .insight-icon {
                margin-right: 0;
                margin-bottom: 10px;
            }
            
            .stats-actions {
                flex-direction: column;
            }
        }

        /* Styles pour le syst√®me multi-langues (F09.1) */
        .language-settings-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.7);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 10000;
        }

        .language-content {
            background: white;
            max-width: 500px;
            width: 90%;
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
        }

        .language-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .language-header h3 {
            margin: 0;
            font-size: 1.4rem;
        }

        .language-body {
            padding: 25px;
        }

        .language-description {
            color: #666;
            margin-bottom: 25px;
            text-align: center;
            line-height: 1.5;
        }

        .language-options {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .language-option {
            display: flex;
            align-items: center;
            padding: 20px;
            border: 2px solid #e0e0e0;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            background: white;
        }

        .language-option:hover {
            border-color: #667eea;
            background: #f8f9ff;
            transform: translateY(-2px);
        }

        .language-option.active {
            border-color: #667eea;
            background: #f0f2ff;
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.2);
        }

        .language-flag {
            font-size: 2rem;
            margin-right: 15px;
        }

        .language-info {
            flex: 1;
        }

        .language-info h4 {
            margin: 0 0 5px 0;
            color: #333;
            font-size: 1.1rem;
        }

        .language-info p {
            margin: 0;
            color: #666;
            font-size: 0.9rem;
        }

        .language-check {
            font-size: 1.2rem;
            color: #4caf50;
            font-weight: bold;
            min-width: 20px;
            text-align: center;
        }

        .language-note {
            margin-top: 20px;
            padding: 15px;
            background: #f8f9ff;
            border-radius: 8px;
            border-left: 4px solid #667eea;
        }

        .language-note p {
            margin: 0;
            color: #555;
            font-size: 0.9rem;
        }

        .language-actions {
            padding: 20px 25px;
            background: #f8f9fa;
            border-top: 1px solid #e0e0e0;
            display: flex;
            justify-content: center;
        }

        .language-actions .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 12px 30px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 500;
            transition: transform 0.2s;
        }

        .language-actions .btn-primary:hover {
            transform: translateY(-2px);
        }

        /* Notification de changement de langue */
        .language-notification {
            position: fixed;
            top: 20px;
            right: 20px;
            background: white;
            border: 2px solid #4caf50;
            border-radius: 10px;
            padding: 15px 20px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
            z-index: 10001;
            transform: translateX(100%);
            opacity: 0;
            transition: all 0.3s ease;
        }

        .language-notification.show {
            transform: translateX(0);
            opacity: 1;
        }

        .notification-content {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .notification-icon {
            color: #4caf50;
            font-size: 1.2rem;
        }

        .notification-text {
            color: #333;
            font-weight: 500;
        }

        /* Responsive pour s√©lection langue */
        @media (max-width: 768px) {
            .language-content {
                width: 95%;
            }
            
            .language-body {
                padding: 20px;
            }
            
            .language-option {
                padding: 15px;
            }
            
            .language-flag {
                font-size: 1.5rem;
            }
            
            .language-notification {
                top: 10px;
                right: 10px;
                left: 10px;
                transform: translateY(-100%);
            }
            
            .language-notification.show {
                transform: translateY(0);
            }
        }

        /* Styles pour les nouvelles fonctionnalit√©s bas√©es sur la recherche */
        
        /* Analyse du stress et overthinking */
        .stress-analysis-container {
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
        }

        .stress-questionnaire {
            background: white;
            border: 2px solid #e1e8ed;
            border-radius: 16px;
            padding: 25px;
            margin-bottom: 30px;
        }

        .stress-questionnaire h3 {
            color: #333;
            margin-bottom: 10px;
        }

        .stress-questionnaire p {
            color: #666;
            margin-bottom: 25px;
        }

        .question-card {
            background: #f8f9fa;
            border: 1px solid #e1e8ed;
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 20px;
        }

        .question-card h4 {
            color: #333;
            margin-bottom: 15px;
        }

        .stress-scale {
            margin-bottom: 10px;
        }

        .stress-scale input[type="range"] {
            width: 100%;
            height: 8px;
            border-radius: 4px;
            background: #e1e8ed;
            outline: none;
            -webkit-appearance: none;
        }

        .stress-scale input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 24px;
            height: 24px;
            border-radius: 50%;
            background: #8A2BE2;
            cursor: pointer;
        }

        .scale-labels {
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 14px;
            color: #666;
            margin-top: 10px;
        }

        #stressValue {
            background: #8A2BE2;
            color: white;
            padding: 4px 8px;
            border-radius: 12px;
            font-weight: 600;
        }

        .radio-options, .checkbox-options {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .radio-options label, .checkbox-options label {
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 14px;
            color: #333;
            cursor: pointer;
            padding: 8px;
            border-radius: 8px;
            transition: background 0.3s ease;
        }

        .radio-options label:hover, .checkbox-options label:hover {
            background: rgba(138, 43, 226, 0.1);
        }

        .radio-options input, .checkbox-options input {
            accent-color: #8A2BE2;
        }

        .analyze-btn {
            width: 100%;
            background: linear-gradient(135deg, #8A2BE2, #9C27B0);
            color: white;
            border: none;
            padding: 18px;
            border-radius: 12px;
            font-size: 18px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .analyze-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 25px rgba(138, 43, 226, 0.3);
        }

        /* R√©sultats d'analyse */
        .stress-results {
            background: white;
            border: 2px solid #e1e8ed;
            border-radius: 16px;
            padding: 25px;
        }

        .stress-results h3 {
            color: #333;
            margin-bottom: 20px;
        }

        .results-overview {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .result-card {
            text-align: center;
            padding: 25px;
            border-radius: 16px;
            color: white;
        }

        .result-card.stress-score {
            background: linear-gradient(135deg, #f44336, #d32f2f);
        }

        .result-card.overthinking-score {
            background: linear-gradient(135deg, #ff9800, #f57c00);
        }

        .result-card h4 {
            margin-bottom: 15px;
            opacity: 0.9;
        }

        .score-display {
            display: flex;
            align-items: baseline;
            justify-content: center;
            gap: 5px;
            margin-bottom: 10px;
        }

        .score-number {
            font-size: 48px;
            font-weight: 700;
        }

        .score-max {
            font-size: 24px;
            opacity: 0.8;
        }

        .score-category {
            font-size: 16px;
            font-weight: 600;
            padding: 4px 12px;
            background: rgba(255,255,255,0.2);
            border-radius: 12px;
            display: inline-block;
        }

        .detailed-analysis, .recommendations, .action-plan {
            margin-bottom: 25px;
        }

        .detailed-analysis h4, .recommendations h4, .action-plan h4 {
            color: #333;
            margin-bottom: 15px;
        }

        .analysis-text {
            background: #f8f9fa;
            border-left: 4px solid #8A2BE2;
            padding: 15px;
            border-radius: 8px;
            color: #333;
            line-height: 1.6;
        }

        .recommendation-list, .plan-steps {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .recommendation-item, .plan-step {
            display: flex;
            align-items: center;
            gap: 12px;
            background: #f8f9fa;
            padding: 12px;
            border-radius: 8px;
            border-left: 4px solid #4CAF50;
        }

        .recommendation-icon, .step-icon {
            font-size: 20px;
            flex-shrink: 0;
        }

        /* Adaptation rythme de vie */
        .lifestyle-container {
            max-width: 900px;
            margin: 0 auto;
            padding: 20px;
        }

        .profile-selector {
            margin-bottom: 30px;
        }

        .profile-selector h3 {
            color: #333;
            margin-bottom: 10px;
        }

        .profile-selector p {
            color: #666;
            margin-bottom: 25px;
        }

        .profile-options {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
        }

        .profile-card {
            background: white;
            border: 2px solid #e1e8ed;
            border-radius: 16px;
            padding: 25px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
        }

        .profile-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.1);
        }

        .profile-card.selected {
            border-color: #8A2BE2;
            background: rgba(138, 43, 226, 0.05);
        }

        .profile-card.student .profile-icon {
            background: linear-gradient(135deg, #4CAF50, #45a049);
        }

        .profile-card.professional .profile-icon {
            background: linear-gradient(135deg, #2196F3, #1976D2);
        }

        .profile-card.mixed .profile-icon {
            background: linear-gradient(135deg, #ff9800, #f57c00);
        }

        .profile-icon {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 36px;
            color: white;
            margin: 0 auto 15px;
        }

        .profile-card h4 {
            color: #333;
            margin-bottom: 10px;
        }

        .profile-card p {
            color: #666;
            margin-bottom: 15px;
        }

        .profile-card ul {
            list-style: none;
            padding: 0;
            text-align: left;
        }

        .profile-card li {
            color: #666;
            font-size: 14px;
            padding: 4px 0;
            position: relative;
            padding-left: 20px;
        }

        .profile-card li::before {
            content: '‚Ä¢';
            color: #8A2BE2;
            position: absolute;
            left: 0;
        }

        /* Configuration personnalis√©e */
        .lifestyle-config {
            background: white;
            border: 2px solid #e1e8ed;
            border-radius: 16px;
            padding: 25px;
            margin-bottom: 30px;
        }

        .lifestyle-config h3 {
            color: #333;
            margin-bottom: 20px;
        }

        .config-section {
            margin-bottom: 25px;
            padding-bottom: 20px;
            border-bottom: 1px solid #e1e8ed;
        }

        .config-section:last-child {
            border-bottom: none;
        }

        .config-section h4 {
            color: #333;
            margin-bottom: 15px;
        }

        .schedule-config {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .time-slot {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px;
            background: #f8f9fa;
            border-radius: 8px;
        }

        .time-slot label {
            font-weight: 600;
            color: #333;
        }

        .time-slot select {
            background: white;
            border: 1px solid #e1e8ed;
            border-radius: 6px;
            padding: 6px 12px;
            cursor: pointer;
        }

        .priority-config {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .priority-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px;
            background: #f8f9fa;
            border-radius: 8px;
        }

        .priority-item label {
            font-weight: 600;
            color: #333;
        }

        .priority-item input[type="range"] {
            width: 150px;
            accent-color: #8A2BE2;
        }

        .session-duration {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .session-duration label {
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 14px;
            color: #333;
            cursor: pointer;
            padding: 10px;
            border-radius: 8px;
            transition: background 0.3s ease;
        }

        .session-duration label:hover {
            background: rgba(138, 43, 226, 0.1);
        }

        .session-duration input {
            accent-color: #8A2BE2;
        }

        .save-config-btn {
            width: 100%;
            background: #4CAF50;
            color: white;
            border: none;
            padding: 15px;
            border-radius: 12px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .save-config-btn:hover {
            background: #45a049;
            transform: translateY(-2px);
        }

        /* Aper√ßu personnalis√© */
        .personalized-preview {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            border-radius: 16px;
            padding: 25px;
        }

        .personalized-preview h3 {
            margin-bottom: 20px;
        }

        .preview-cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
        }

        .preview-card {
            background: rgba(255,255,255,0.1);
            border-radius: 12px;
            padding: 15px;
        }

        .preview-card h4 {
            margin-bottom: 8px;
        }

        .preview-card p {
            font-size: 14px;
            opacity: 0.9;
            margin: 0;
        }

        /* Centre de recherche */
        .research-center-container {
            max-width: 1000px;
            margin: 0 auto;
            padding: 20px;
        }

        .live-stats-section {
            margin-bottom: 30px;
        }

        .live-stats-section h3 {
            color: #333;
            margin-bottom: 20px;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
        }

        .stat-item {
            background: white;
            border: 2px solid #e1e8ed;
            border-radius: 16px;
            padding: 20px;
            display: flex;
            gap: 15px;
            align-items: center;
        }

        .stat-icon {
            font-size: 36px;
            flex-shrink: 0;
        }

        .stat-content h4 {
            color: #333;
            margin-bottom: 8px;
        }

        .stat-number {
            font-size: 32px;
            font-weight: 700;
            color: #8A2BE2;
            margin: 0;
        }

        .stat-label {
            color: #666;
            font-size: 14px;
            margin: 5px 0;
        }

        .stat-content small {
            color: #999;
            font-size: 12px;
        }

        /* √âtudes scientifiques */
        .scientific-studies {
            margin-bottom: 30px;
        }

        .scientific-studies h3 {
            color: #333;
            margin-bottom: 20px;
        }

        .study-card {
            background: white;
            border: 2px solid #e1e8ed;
            border-radius: 16px;
            padding: 25px;
            margin-bottom: 20px;
            transition: all 0.3s ease;
        }

        .study-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.1);
        }

        .study-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 15px;
        }

        .study-header h4 {
            color: #333;
            flex: 1;
            margin-right: 15px;
        }

        .study-date {
            background: #e8f5e8;
            color: #4CAF50;
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: 600;
            white-space: nowrap;
        }

        .study-summary {
            color: #666;
            line-height: 1.6;
            margin-bottom: 15px;
        }

        .study-metrics {
            display: flex;
            gap: 15px;
            margin-bottom: 15px;
            flex-wrap: wrap;
        }

        .metric {
            background: #f8f9fa;
            padding: 4px 8px;
            border-radius: 8px;
            font-size: 12px;
            color: #666;
        }

        .read-more-btn {
            background: #8A2BE2;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 6px;
            font-size: 14px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .read-more-btn:hover {
            background: #7B1FA2;
            transform: translateY(-1px);
        }

        /* Tendances */
        .trends-section {
            margin-bottom: 30px;
        }

        .trends-section h3 {
            color: #333;
            margin-bottom: 20px;
        }

        .trend-item {
            background: white;
            border: 2px solid #e1e8ed;
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 15px;
            display: flex;
            gap: 15px;
            align-items: center;
        }

        .trend-icon {
            font-size: 24px;
            flex-shrink: 0;
        }

        .trend-content {
            flex: 1;
        }

        .trend-content h4 {
            color: #333;
            margin-bottom: 5px;
        }

        .trend-content p {
            color: #666;
            margin-bottom: 10px;
        }

        .trend-actions {
            display: flex;
            gap: 10px;
            align-items: center;
        }

        .trend-tag {
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: 600;
        }

        .trend-tag.urgent {
            background: #ffebee;
            color: #f44336;
        }

        .trend-tag.positive {
            background: #e8f5e8;
            color: #4CAF50;
        }

        .trend-tag.innovation {
            background: #e3f2fd;
            color: #2196F3;
        }

        .trend-btn {
            background: transparent;
            color: #8A2BE2;
            border: 1px solid #8A2BE2;
            padding: 4px 12px;
            border-radius: 6px;
            font-size: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .trend-btn:hover {
            background: #8A2BE2;
            color: white;
        }

        /* Contribution √† la recherche */
        .research-contribution h3 {
            color: #333;
            margin-bottom: 20px;
        }

        .contribution-card {
            background: linear-gradient(135deg, #4CAF50, #45a049);
            color: white;
            border-radius: 16px;
            padding: 25px;
            text-align: center;
        }

        .contribution-card h4 {
            margin-bottom: 10px;
        }

        .contribution-card p {
            opacity: 0.9;
            margin-bottom: 20px;
        }

        .contribution-benefits {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .benefit {
            background: rgba(255,255,255,0.2);
            padding: 6px 12px;
            border-radius: 12px;
            font-size: 14px;
        }

        .contribute-btn {
            background: white;
            color: #4CAF50;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .contribute-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 15px rgba(0,0,0,0.2);
        }

        /* Responsive pour les nouvelles fonctionnalit√©s */
        @media (max-width: 768px) {
            .results-overview {
                grid-template-columns: 1fr;
            }
            
            .profile-options {
                grid-template-columns: 1fr;
            }
            
            .schedule-config .time-slot {
                flex-direction: column;
                gap: 8px;
                align-items: flex-start;
            }
            
            .priority-config .priority-item {
                flex-direction: column;
                gap: 8px;
                align-items: stretch;
            }
            
            .priority-item input[type="range"] {
                width: 100%;
            }
            
            .stats-grid {
                grid-template-columns: 1fr;
            }
            
            .study-header {
                flex-direction: column;
                gap: 10px;
            }
            
            .study-metrics {
                flex-direction: column;
                gap: 8px;
            }
            
            .trend-item {
                flex-direction: column;
                text-align: center;
                gap: 10px;
            }
            
            .contribution-benefits {
                flex-direction: column;
                gap: 8px;
            }
        }
    </style>
</head>
<body>
    <div class="app-container">
        <!-- Desktop Sidebar - Visible uniquement sur PC -->
        <div class="desktop-sidebar">
            <div class="sidebar-header">
                <div class="sidebar-logo">MINDLY</div>
                <div class="sidebar-subtitle">Bien-√™tre F√©minin</div>
            </div>
            <nav class="sidebar-nav">
                <a href="#" class="sidebar-nav-item active" onclick="showScreen('welcome-screen')">
                    <span class="sidebar-nav-icon">üè†</span>
                    <span class="sidebar-nav-text">Accueil</span>
                </a>
                <a href="#" class="sidebar-nav-item" onclick="showScreen('dashboard-screen')">
                    <span class="sidebar-nav-icon">üìä</span>
                    <span class="sidebar-nav-text">Dashboard</span>
                </a>
                <a href="#" class="sidebar-nav-item" onclick="showScreen('mood-screen')">
                    <span class="sidebar-nav-icon">üåô</span>
                    <span class="sidebar-nav-text">Journal d'Humeur</span>
                </a>
                <a href="#" class="sidebar-nav-item" onclick="showScreen('chat-screen')">
                    <span class="sidebar-nav-icon">üí¨</span>
                    <span class="sidebar-nav-text">Assistant IA</span>
                </a>
                <a href="#" class="sidebar-nav-item" onclick="showScreen('community-screen')">
                    <span class="sidebar-nav-icon">üë•</span>
                    <span class="sidebar-nav-text">Communaut√©</span>
                </a>
                <a href="#" class="sidebar-nav-item" onclick="showScreen('login-screen')">
                    <span class="sidebar-nav-icon">üë§</span>
                    <span class="sidebar-nav-text">Mon Compte</span>
                </a>
            </nav>
        </div>

        <!-- Main Content Area -->
        <div class="main-content">
            <!-- Top Menu Bar - Responsive -->
            <div class="top-menu">
                <span class="app-title">MINDLY</span>
                <button class="menu-button" onclick="toggleMenu()">Menu ‚ñº</button>
            <div class="menu-dropdown" id="menuDropdown">
                <div class="menu-item" onclick="showScreen('profile-screen')">
                    <span class="menu-item-icon">üë§</span>
                    <span>Profil</span>
                </div>
                <div class="menu-item" onclick="showScreen('mood-screen')">
                    <span class="menu-item-icon">üåô</span>
                    <span>Humeur</span>
                </div>
                <div class="menu-item" onclick="showScreen('chat-screen')">
                    <span class="menu-item-icon">üí¨</span>
                    <span>Chat</span>
                </div>
                <div class="menu-item" onclick="showScreen('community-screen')">
                    <span class="menu-item-icon">üë•</span>
                    <span>Communaut√©</span>
                </div>
            </div>
        </div>
        
            <!-- Content Wrapper -->
            <div class="content-wrapper">
                <!-- Welcome Screen -->
                <div class="screen-content active" id="welcome-screen">
                <div class="welcome-screen">
                    <div class="welcome-header">
                        <div class="logo">
                            <span class="logo-text">üß†</span>
                        </div>
                        <h1 class="welcome-title">Prends soin de ton esprit, chaque jour</h1>
                        <p class="welcome-subtitle">Cultivez votre s√©r√©nit√©</p>
                        <p class="welcome-description">Une application d√©di√©e √† votre bien-√™tre mental, avec des outils personnalis√©s pour vous accompagner au quotidien dans votre d√©veloppement personnel et √©motionnel.</p>
                    </div>
                    
                    <div class="auth-buttons">
                        <button class="auth-btn signup-btn" onclick="showScreen('signup-screen')">S'inscrire</button>
                        <button class="auth-btn login-btn" onclick="showScreen('login-screen')">Se connecter</button>
                    </div>
                </div>
            </div>

            <!-- Login Screen (Page 3) - Syst√®me d'authentification complet -->
            <div class="screen-content" id="login-screen">
                <div class="auth-screen">
                    <div class="auth-header">
                        <h1 class="auth-title">MINDLY</h1>
                        <p class="auth-subtitle">Votre compagnon bien-√™tre</p>
                    </div>
                    
                    <!-- Mode Navigation Anonyme (F01.4) -->
                    <div class="anonymous-access">
                        <button class="anonymous-btn" onclick="startAnonymousMode()">
                            <span class="anonymous-icon">üë§</span>
                            <div class="anonymous-text">
                                <span class="anonymous-main">Essayer anonymement</span>
                                <span class="anonymous-sub">Testez l'app sans cr√©er de compte</span>
                            </div>
                        </button>
                    </div>
                    
                    <div class="auth-separator small">
                        <span>ou cr√©er un compte</span>
                    </div>
                    
                    <!-- Messages d'√©tat -->
                    <div id="auth-messages" class="auth-messages" style="display: none;">
                        <div id="auth-error" class="message error-message" style="display: none;"></div>
                        <div id="auth-success" class="message success-message" style="display: none;"></div>
                        <div id="auth-loading" class="message loading-message" style="display: none;">
                            <span class="spinner"></span>
                            <span>Connexion en cours...</span>
                        </div>
                    </div>
                    
                    <!-- Authentification OAuth (F01.1, F01.2) -->
                    <div class="oauth-section">
                        <button class="oauth-btn google-btn" onclick="signInWithGoogle()" id="google-signin-btn">
                            <span class="oauth-icon">üîç</span>
                            <span class="oauth-text">Continuer avec Google</span>
                        </button>
                        <button class="oauth-btn apple-btn" onclick="signInWithApple()" id="apple-signin-btn">
                            <span class="oauth-icon">üçé</span>
                            <span class="oauth-text">Continuer avec Apple</span>
                        </button>
                    </div>
                    
                    <div class="auth-separator">
                        <span>ou avec email</span>
                    </div>
                    
                    <!-- Formulaire de connexion -->
                    <form id="login-form" class="auth-form" style="display: block;">
                        <div class="form-group">
                            <label class="form-label">Email</label>
                            <input type="email" id="login-email" class="form-input" placeholder="votre@email.com" required>
                            <span class="input-error" id="login-email-error"></span>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">Mot de passe</label>
                            <input type="password" id="login-password" class="form-input" placeholder="Votre mot de passe" required>
                            <span class="input-error" id="login-password-error"></span>
                        </div>
                        
                        <div class="forgot-password">
                            <a href="#" onclick="showForgotPassword()">Mot de passe oubli√© ?</a>
                        </div>
                        
                        <button type="button" class="submit-btn" onclick="loginWithEmail()" id="login-submit-btn">
                            Se connecter
                        </button>
                    </form>
                    
                    <!-- Formulaire d'inscription (F01.3) -->
                    <form id="signup-form" class="auth-form" style="display: none;">
                        <div class="form-group">
                            <label class="form-label">Pr√©nom</label>
                            <input type="text" id="signup-firstname" class="form-input" placeholder="Votre pr√©nom" required>
                            <span class="input-error" id="signup-firstname-error"></span>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">Nom</label>
                            <input type="text" id="signup-lastname" class="form-input" placeholder="Votre nom" required>
                            <span class="input-error" id="signup-lastname-error"></span>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">Email</label>
                            <input type="email" id="signup-email" class="form-input" placeholder="votre@email.com" required>
                            <span class="input-error" id="signup-email-error"></span>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">Mot de passe (min. 12 caract√®res)</label>
                            <input type="password" id="signup-password" class="form-input" placeholder="Mot de passe s√©curis√©" required oninput="checkPasswordStrength(this.value)">
                            <div class="password-strength" id="password-strength"></div>
                            <span class="input-error" id="signup-password-error"></span>
                            <div class="password-requirements">
                                <small>Doit contenir: 1 majuscule, 1 minuscule, 1 chiffre, 1 symbole</small>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">Confirmer le mot de passe</label>
                            <input type="password" id="signup-confirm-password" class="form-input" placeholder="Confirmer le mot de passe" required>
                            <span class="input-error" id="signup-confirm-password-error"></span>
                        </div>
                        
                        <!-- Consentements RGPD (F01.5) -->
                        <div class="consent-section">
                            <div class="consent-item required">
                                <input type="checkbox" id="consent-terms" class="consent-checkbox" required>
                                <label for="consent-terms" class="consent-label">
                                    J'accepte les <a href="#" onclick="showTerms()">Conditions G√©n√©rales d'Utilisation</a> *
                                </label>
                                <span class="input-error" id="consent-terms-error"></span>
                            </div>
                            
                            <div class="consent-item required">
                                <input type="checkbox" id="consent-privacy" class="consent-checkbox" required>
                                <label for="consent-privacy" class="consent-label">
                                    J'accepte la <a href="#" onclick="showPrivacy()">Politique de Confidentialit√©</a> *
                                </label>
                                <span class="input-error" id="consent-privacy-error"></span>
                            </div>
                            
                            <div class="consent-item optional">
                                <input type="checkbox" id="consent-marketing" class="consent-checkbox">
                                <label for="consent-marketing" class="consent-label">
                                    J'accepte de recevoir des communications marketing (optionnel)
                                </label>
                            </div>
                        </div>
                        
                        <button type="button" class="submit-btn" onclick="signupWithEmail()" id="signup-submit-btn">
                            Cr√©er mon compte
                        </button>
                    </form>
                    
                    <div class="auth-link">
                        <p><a href="#" onclick="toggleAuthMode()" id="auth-toggle">Cr√©er un compte</a></p>
                    </div>
                </div>
                
                <!-- Modal de v√©rification email -->
                <div id="email-verification-modal" class="modal" style="display: none;">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h3>üìß V√©rifiez votre email</h3>
                        </div>
                        <div class="modal-body">
                            <p>Un email de v√©rification a √©t√© envoy√© √†:</p>
                            <p class="verification-email"><strong id="verification-email"></strong></p>
                            <p>Cliquez sur le lien dans l'email pour activer votre compte.</p>
                            <p class="expiry-note">‚è∞ Ce lien expire dans 24 heures.</p>
                        </div>
                        <div class="modal-actions">
                            <button class="btn-secondary" onclick="resendVerificationEmail()">Renvoyer l'email</button>
                            <button class="btn-primary" onclick="closeEmailVerificationModal()">Fermer</button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Signup Screen (Page 2) -->
            <div class="screen-content" id="signup-screen">
                <div class="auth-screen">
                    <div class="auth-header">
                        <h1 class="auth-title">Inscription</h1>
                        <p class="auth-subtitle">Cr√©ez votre compte</p>
                    </div>
                    
                    <form class="signup-form">
                        <div class="form-row">
                            <div class="form-group half">
                                <label class="form-label">Pr√©nom</label>
                                <input type="text" class="form-input" placeholder="Votre pr√©nom">
                            </div>
                            <div class="form-group half">
                                <label class="form-label">Nom</label>
                                <input type="text" class="form-input" placeholder="Votre nom">
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">Adresse e-mail</label>
                            <input type="email" class="form-input" placeholder="votre@email.com">
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">Pseudonyme (visible)</label>
                            <input type="text" class="form-input" placeholder="Votre pseudonyme">
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">Date de naissance</label>
                            <input type="date" class="form-input">
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">Mot de passe</label>
                            <input type="password" class="form-input" placeholder="Cr√©ez un mot de passe">
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">Photo de profil (optionnel)</label>
                            <div class="photo-upload">
                                <button type="button" class="upload-btn">üì∑ Ajouter une photo</button>
                            </div>
                        </div>
                        
                        <div class="checkbox-group">
                            <label class="checkbox-label">
                                <input type="checkbox" required>
                                <span class="checkmark"></span>
                                J'accepte les <a href="#">Conditions G√©n√©rales d'Utilisation</a>
                            </label>
                            <label class="checkbox-label">
                                <input type="checkbox" required>
                                <span class="checkmark"></span>
                                J'accepte la <a href="#">Politique RGPD</a>
                            </label>
                        </div>
                        
                        <button type="submit" class="submit-btn" onclick="showScreen('dashboard-screen')">Cr√©er un compte</button>
                    </form>
                    
                    <div class="auth-link">
                        <a href="#" onclick="showScreen('login-screen')">D√©j√† un compte ? Connectez-vous</a>
                    </div>
                </div>
            </div>

            <!-- Onboarding Screen -->
            <div class="screen-content" id="onboarding-screen">
                <div class="onboarding-screen">
                    <div class="onboarding-content">
                        <div class="onboarding-icon" id="onboarding-icon">üå∏</div>
                        <h2 class="onboarding-title" id="onboarding-title">Bienvenue dans MINDLY</h2>
                        <p class="onboarding-description" id="onboarding-description">
                            D√©couvrez une approche moderne du bien-√™tre f√©minin avec des outils personnalis√©s.
                        </p>
                    </div>
                    
                    <div class="onboarding-navigation">
                        <button class="nav-step-btn prev-btn">Pr√©c√©dent</button>
                        <div class="nav-dots">
                            <div class="dot active"></div>
                            <div class="dot"></div>
                            <div class="dot"></div>
                            <div class="dot"></div>
                        </div>
                        <button class="nav-step-btn next-btn">Suivant</button>
                    </div>
                </div>
            </div>

            <!-- Dashboard Screen (Page 6) -->
            <div class="screen-content" id="dashboard-screen">
                <div class="main-app">
                    <div class="app-header">
                        <h1 class="greeting">Bonjour, Sarah!</h1>
                        <p class="mood-question">Comment te sens-tu aujourd'hui ?</p>
                    </div>
                    
                    <div class="app-content">
                        <div class="shortcuts-section">
                            <h3 class="section-title">Raccourcis</h3>
                            <div class="shortcuts-grid">
                                <button class="shortcut-btn" onclick="showScreen('mood-screen')">
                                    <span class="shortcut-icon">üåô</span>
                                    <span class="shortcut-label">Mon Humeur</span>
                                </button>
                                
                                <button class="shortcut-btn" onclick="showScreen('chat-screen')">
                                    <span class="shortcut-icon">ü§ñ</span>
                                    <span class="shortcut-label">MindSafe</span>
                                </button>
                                
                                <button class="shortcut-btn" onclick="showScreen('community-screen')">
                                    <span class="shortcut-icon">üí¨</span>
                                    <span class="shortcut-label">Discussions</span>
                                </button>
                                
                                <button class="shortcut-btn" onclick="showScreen('profile-screen')">
                                    <span class="shortcut-icon">üë§</span>
                                    <span class="shortcut-label">Mon Profil</span>
                                </button>
                            </div>
                        </div>
                        
                        <div class="charts-section">
                            <h3 class="section-title">Graphiques d'√©volution</h3>
                            
                            <div class="chart-card">
                                <div class="chart-header">
                                    <h4>Humeur</h4>
                                    <a href="#" class="view-trends">Voir toutes les tendances</a>
                                </div>
                                <div class="chart-placeholder">
                                    <div class="chart-line">üìà Tendance positive cette semaine</div>
                                </div>
                            </div>
                            
                            <div class="chart-card">
                                <div class="chart-header">
                                    <h4>Stress</h4>
                                    <a href="#" class="view-trends">Voir toutes les tendances</a>
                                </div>
                                <div class="chart-placeholder">
                                    <div class="chart-line">üìä Niveau stable</div>
                                </div>
                            </div>
                            
                            <div class="chart-card">
                                <div class="chart-header">
                                    <h4>√ânergie</h4>
                                    <a href="#" class="view-trends">Voir toutes les tendances</a>
                                </div>
                                <div class="chart-placeholder">
                                    <div class="chart-line">‚ö° En am√©lioration</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Home Screen -->
            <div class="screen-content" id="home-screen">
                <div class="main-app">
                    <div class="app-header">
                        <h1 class="app-title">MINDLY</h1>
                        <p class="date-text">Lundi 18 Novembre 2024</p>
                    </div>
                    
                    <div class="app-content">
                        <div class="mood-question">
                            <h2>Comment vous sentez-vous ?</h2>
                            <p class="subtitle">Choisissez votre humeur actuelle</p>
                        </div>
                        
                        <div class="mood-grid">
                            <div class="mood-item">
                                <span class="mood-icon">üå∏</span>
                                <div class="mood-label">√âpanouie</div>
                            </div>
                            <div class="mood-item">
                                <span class="mood-icon">üåø</span>
                                <div class="mood-label">Sereine</div>
                            </div>
                            <div class="mood-item">
                                <span class="mood-icon">üåô</span>
                                <div class="mood-label">Neutre</div>
                            </div>
                            <div class="mood-item">
                                <span class="mood-icon">üí§</span>
                                <div class="mood-label">Fatigu√©e</div>
                            </div>
                        </div>
                        
                        <div class="actions-section">
                            <h3 class="section-title">Prendre soin de moi</h3>
                            
                            <div class="action-cards">
                                <div class="action-card">
                                    <div class="action-icon">üßò‚Äç‚ôÄÔ∏è</div>
                                    <div class="action-content">
                                        <div class="action-title">M√©ditation guid√©e</div>
                                        <div class="action-subtitle">5 minutes de d√©tente</div>
                                    </div>
                                </div>
                                
                                <div class="action-card">
                                    <div class="action-icon">üí¨</div>
                                    <div class="action-content">
                                        <div class="action-title">Parler √† MindSafe</div>
                                        <div class="action-subtitle">Votre compagnon IA bienveillant</div>
                                    </div>
                                </div>
                                
                                <div class="action-card">
                                    <div class="action-icon">üìù</div>
                                    <div class="action-content">
                                        <div class="action-title">Journal personnel</div>
                                        <div class="action-subtitle">Notez vos pens√©es</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="tab-navigation">
                        <button class="tab-item active">
                            <span class="tab-icon">üè†</span>
                            <span class="tab-label">Accueil</span>
                        </button>
                        <button class="tab-item">
                            <span class="tab-icon">üå∏</span>
                            <span class="tab-label">Humeur</span>
                        </button>
                        <button class="tab-item">
                            <span class="tab-icon">üí¨</span>
                            <span class="tab-label">Chat</span>
                        </button>
                        <button class="tab-item">
                            <span class="tab-icon">üë•</span>
                            <span class="tab-label">Communaut√©</span>
                        </button>
                        <button class="tab-item">
                            <span class="tab-icon">üë§</span>
                            <span class="tab-label">Profil</span>
                        </button>
                    </div>
                </div>
            </div>

            <!-- Mood Screen -->
            <div class="screen-content" id="mood-screen">
                <div class="main-app">
                    <div class="app-header">
                        <h1 class="app-title">√âvaluation d'humeur IA</h1>
                        <p class="date-text">Diagnostic personnalis√© & suivi avanc√©</p>
                        <div class="mood-nav-buttons">
                            <button class="mood-nav-btn active" onclick="showMoodSection('evaluation')" id="evalBtn">
                                üìù √âvaluation
                            </button>
                            <button class="mood-nav-btn" onclick="showMoodSection('diagnostic')" id="diagBtn">
                                üß† Diagnostic IA
                            </button>
                            <button class="mood-nav-btn" onclick="showMoodSection('exercises')" id="exercBtn">
                                üèÉ‚Äç‚ôÄÔ∏è Exercices
                            </button>
                            <button class="mood-nav-btn" onclick="showMoodSection('tracking')" id="trackBtn">
                                üìä Suivi
                            </button>
                        </div>
                    </div>
                    
                    <!-- Section √âvaluation rapide (F02.1, F20.5) - <3 clics, <10 secondes -->
                    <div class="app-content mood-section active" id="evaluation-section">
                        <div class="quick-mood-container">
                            <div class="quick-intro">
                                <h3>‚ö° Comment vous sentez-vous maintenant ?</h3>
                                <p>S√©lectionnez votre humeur en 1 clic ‚Ä¢ Ajoutez des tags (optionnel) ‚Ä¢ Sauvegardez</p>
                                <div class="time-indicator">
                                    <span class="timer-icon">‚è±Ô∏è</span>
                                    <span id="moodTimer">0s</span> / 10s max
                                </div>
                            </div>
                            
                            <!-- √âtape 1: S√©lection rapide d'humeur (1 clic) -->
                            <div class="mood-quick-select">
                                <h4>1Ô∏è‚É£ Votre humeur g√©n√©rale (1-5)</h4>
                                <div class="mood-scale-buttons">
                                    <button class="mood-btn" data-value="1" onclick="selectMoodLevel(1)">
                                        <div class="mood-emoji">üòü</div>
                                        <div class="mood-label">Tr√®s mal</div>
                                        <div class="mood-number">1</div>
                                    </button>
                                    <button class="mood-btn" data-value="2" onclick="selectMoodLevel(2)">
                                        <div class="mood-emoji">üòï</div>
                                        <div class="mood-label">Mal</div>
                                        <div class="mood-number">2</div>
                                    </button>
                                    <button class="mood-btn" data-value="3" onclick="selectMoodLevel(3)">
                                        <div class="mood-emoji">üòê</div>
                                        <div class="mood-label">Moyen</div>
                                        <div class="mood-number">3</div>
                                    </button>
                                    <button class="mood-btn" data-value="4" onclick="selectMoodLevel(4)">
                                        <div class="mood-emoji">üôÇ</div>
                                        <div class="mood-label">Bien</div>
                                        <div class="mood-number">4</div>
                                    </button>
                                    <button class="mood-btn" data-value="5" onclick="selectMoodLevel(5)">
                                        <div class="mood-emoji">üòä</div>
                                        <div class="mood-label">Tr√®s bien</div>
                                        <div class="mood-number">5</div>
                                    </button>
                                </div>
                            </div>
                            
                            <!-- √âtape 2: Tags rapides (optionnel, 1 clic) -->
                            <div class="mood-tags-section" id="moodTagsSection" style="display: none;">
                                <h4>2Ô∏è‚É£ Qu'est-ce qui influence votre humeur ? (optionnel)</h4>
                                <div class="quick-tags">
                                    <button class="mood-tag" data-tag="stress" onclick="toggleMoodTag('stress')">
                                        üíº Stress
                                    </button>
                                    <button class="mood-tag" data-tag="fatigue" onclick="toggleMoodTag('fatigue')">
                                        üò¥ Fatigue
                                    </button>
                                    <button class="mood-tag" data-tag="energie" onclick="toggleMoodTag('energie')">
                                        ‚ö° √ânergie
                                    </button>
                                    <button class="mood-tag" data-tag="anxiete" onclick="toggleMoodTag('anxiete')">
                                        üò∞ Anxi√©t√©
                                    </button>
                                    <button class="mood-tag" data-tag="joie" onclick="toggleMoodTag('joie')">
                                        üòÑ Joie
                                    </button>
                                    <button class="mood-tag" data-tag="solitude" onclick="toggleMoodTag('solitude')">
                                        ü§ó Social
                                    </button>
                                    <button class="mood-tag" data-tag="travail" onclick="toggleMoodTag('travail')">
                                        üíª Travail
                                    </button>
                                    <button class="mood-tag" data-tag="sante" onclick="toggleMoodTag('sante')">
                                        üè• Sant√©
                                    </button>
                                </div>
                                <button class="skip-tags-btn" onclick="skipTags()">
                                    Passer cette √©tape ‚Üí
                                </button>
                            </div>
                            
                            <!-- √âtape 3: Sauvegarde (1 clic) -->
                            <div class="mood-save-section" id="moodSaveSection" style="display: none;">
                                <h4>3Ô∏è‚É£ Enregistrer votre humeur</h4>
                                <div class="mood-summary" id="moodSummary">
                                    <!-- R√©sum√© sera g√©n√©r√© automatiquement -->
                                </div>
                                <div class="save-actions">
                                    <button class="save-mood-btn primary" onclick="saveMoodEntry()">
                                        ‚úÖ Enregistrer (1 clic)
                                    </button>
                                    <button class="save-mood-btn secondary" onclick="saveMoodWithNote()">
                                        üìù Ajouter une note
                                    </button>
                                </div>
                            </div>
                            
                            <!-- Note optionnelle -->
                            <div class="mood-note-section" id="moodNoteSection" style="display: none;">
                                <h4>üí≠ Note personnelle (optionnel)</h4>
                                <textarea 
                                    id="moodNote" 
                                    class="mood-note-input" 
                                    placeholder="D√©crivez bri√®vement ce qui se passe..."
                                    maxlength="200"></textarea>
                                <div class="note-actions">
                                    <button class="save-mood-btn primary" onclick="saveMoodEntryWithNote()">
                                        ‚úÖ Enregistrer avec note
                                    </button>
                                    <button class="save-mood-btn secondary" onclick="saveMoodEntry()">
                                        Enregistrer sans note
                                    </button>
                                </div>
                            </div>
                            
                            <!-- Confirmation rapide -->
                            <div class="mood-success" id="moodSuccess" style="display: none;">
                                <div class="success-content">
                                    <div class="success-icon">üéâ</div>
                                    <h4>Humeur enregistr√©e !</h4>
                                    <p>Temps pris: <span id="finalTime">0s</span></p>
                                    <div class="success-actions">
                                        <button class="success-btn" onclick="resetMoodEntry()">
                                            üìä Voir mes tendances
                                        </button>
                                        <button class="success-btn" onclick="showMoodRecommendations()">
                                            üí° Suggestions personnalis√©es
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Mode √©valuation compl√®te (pour utilisateurs avanc√©s) -->
                        <div class="advanced-toggle">
                            <button class="toggle-btn" onclick="toggleAdvancedMode()">
                                <span id="advancedToggleText">üî¨ Mode √©valuation compl√®te</span>
                            </button>
                        </div>
                        
                        <!-- Section d'√©valuation d√©taill√©e (masqu√©e par d√©faut) -->
                        <div class="detailed-evaluation" id="detailedEvaluation" style="display: none;">
                            <div class="evaluation-intro">
                                <h3>üéØ √âvaluation compl√®te de votre √©tat √©motionnel</h3>
                                <p>Utilisez les curseurs pour indiquer votre niveau actuel pour chaque dimension :</p>
                            </div>
                            
                            <div class="mood-dimensions">
                                <!-- Tristesse -->
                                <div class="dimension-item">
                                    <div class="dimension-header">
                                        <span class="dimension-icon">üò¢</span>
                                        <h4 class="dimension-title">Tristesse</h4>
                                        <span class="dimension-value" id="sadness-value">5</span>
                                    </div>
                                    <div class="dimension-slider">
                                        <input type="range" min="0" max="10" value="5" class="advanced-slider" id="sadness-slider" oninput="updateDimension('sadness', this.value)">
                                        <div class="slider-labels">
                                            <span>Aucune</span>
                                            <span>Mod√©r√©e</span>
                                            <span>Intense</span>
                                        </div>
                                    </div>
                                </div>

                                <!-- Joie -->
                                <div class="dimension-item">
                                    <div class="dimension-header">
                                        <span class="dimension-icon">üòä</span>
                                        <h4 class="dimension-title">Joie</h4>
                                        <span class="dimension-value" id="joy-value">5</span>
                                    </div>
                                    <div class="dimension-slider">
                                        <input type="range" min="0" max="10" value="5" class="advanced-slider" id="joy-slider" oninput="updateDimension('joy', this.value)">
                                        <div class="slider-labels">
                                            <span>Aucune</span>
                                            <span>Mod√©r√©e</span>
                                            <span>Euphorie</span>
                                        </div>
                                    </div>
                                </div>

                                <!-- √ânergie -->
                                <div class="dimension-item">
                                    <div class="dimension-header">
                                        <span class="dimension-icon">‚ö°</span>
                                        <h4 class="dimension-title">√ânergie</h4>
                                        <span class="dimension-value" id="energy-value">5</span>
                                    </div>
                                    <div class="dimension-slider">
                                        <input type="range" min="0" max="10" value="5" class="advanced-slider" id="energy-slider" oninput="updateDimension('energy', this.value)">
                                        <div class="slider-labels">
                                            <span>√âpuis√©</span>
                                            <span>Normal</span>
                                            <span>√ânergique</span>
                                        </div>
                                    </div>
                                </div>

                                <!-- Sensibilit√© -->
                                <div class="dimension-item">
                                    <div class="dimension-header">
                                        <span class="dimension-icon">üå∏</span>
                                        <h4 class="dimension-title">Sensibilit√©</h4>
                                        <span class="dimension-value" id="sensitivity-value">5</span>
                                    </div>
                                    <div class="dimension-slider">
                                        <input type="range" min="0" max="10" value="5" class="advanced-slider" id="sensitivity-slider" oninput="updateDimension('sensitivity', this.value)">
                                        <div class="slider-labels">
                                            <span>Insensible</span>
                                            <span>√âquilibr√©</span>
                                            <span>Tr√®s sensible</span>
                                        </div>
                                    </div>
                                </div>

                                <!-- Irritabilit√© -->
                                <div class="dimension-item">
                                    <div class="dimension-header">
                                        <span class="dimension-icon">üò§</span>
                                        <h4 class="dimension-title">Irritabilit√©</h4>
                                        <span class="dimension-value" id="irritability-value">5</span>
                                    </div>
                                    <div class="dimension-slider">
                                        <input type="range" min="0" max="10" value="5" class="advanced-slider" id="irritability-slider" oninput="updateDimension('irritability', this.value)">
                                        <div class="slider-labels">
                                            <span>Calme</span>
                                            <span>Normal</span>
                                            <span>Tr√®s irritable</span>
                                        </div>
                                    </div>
                                </div>

                                <!-- Sauts d'humeur -->
                                <div class="dimension-item">
                                    <div class="dimension-header">
                                        <span class="dimension-icon">üé¢</span>
                                        <h4 class="dimension-title">Sauts d'humeur</h4>
                                        <span class="dimension-value" id="mood-swings-value">5</span>
                                    </div>
                                    <div class="dimension-slider">
                                        <input type="range" min="0" max="10" value="5" class="advanced-slider" id="mood-swings-slider" oninput="updateDimension('mood-swings', this.value)">
                                        <div class="slider-labels">
                                            <span>Stable</span>
                                            <span>Occasionnels</span>
                                            <span>Fr√©quents</span>
                                        </div>
                                    </div>
                                </div>

                                <!-- Col√®re -->
                                <div class="dimension-item">
                                    <div class="dimension-header">
                                        <span class="dimension-icon">üò°</span>
                                        <h4 class="dimension-title">Col√®re</h4>
                                        <span class="dimension-value" id="anger-value">5</span>
                                    </div>
                                    <div class="dimension-slider">
                                        <input type="range" min="0" max="10" value="5" class="advanced-slider" id="anger-slider" oninput="updateDimension('anger', this.value)">
                                        <div class="slider-labels">
                                            <span>Serein</span>
                                            <span>Agac√©</span>
                                            <span>Furieux</span>
                                        </div>
                                    </div>
                                </div>

                                <!-- Confiance -->
                                <div class="dimension-item">
                                    <div class="dimension-header">
                                        <span class="dimension-icon">üí™</span>
                                        <h4 class="dimension-title">Confiance</h4>
                                        <span class="dimension-value" id="confidence-value">5</span>
                                    </div>
                                    <div class="dimension-slider">
                                        <input type="range" min="0" max="10" value="5" class="advanced-slider" id="confidence-slider" oninput="updateDimension('confidence', this.value)">
                                        <div class="slider-labels">
                                            <span>Tr√®s faible</span>
                                            <span>Mod√©r√©e</span>
                                            <span>Tr√®s √©lev√©e</span>
                                        </div>
                                    </div>
                                </div>

                                <!-- Enthousiasme -->
                                <div class="dimension-item">
                                    <div class="dimension-header">
                                        <span class="dimension-icon">üåü</span>
                                        <h4 class="dimension-title">Enthousiasme</h4>
                                        <span class="dimension-value" id="enthusiasm-value">5</span>
                                    </div>
                                    <div class="dimension-slider">
                                        <input type="range" min="0" max="10" value="5" class="advanced-slider" id="enthusiasm-slider" oninput="updateDimension('enthusiasm', this.value)">
                                        <div class="slider-labels">
                                            <span>Apathique</span>
                                            <span>Int√©ress√©</span>
                                            <span>Passionn√©</span>
                                        </div>
                                    </div>
                                </div>

                                <!-- Anxi√©t√© -->
                                <div class="dimension-item">
                                    <div class="dimension-header">
                                        <span class="dimension-icon">üò∞</span>
                                        <h4 class="dimension-title">Anxi√©t√©</h4>
                                        <span class="dimension-value" id="anxiety-value">5</span>
                                    </div>
                                    <div class="dimension-slider">
                                        <input type="range" min="0" max="10" value="5" class="advanced-slider" id="anxiety-slider" oninput="updateDimension('anxiety', this.value)">
                                        <div class="slider-labels">
                                            <span>D√©tendu</span>
                                            <span>Pr√©occup√©</span>
                                            <span>Panique</span>
                                        </div>
                                    </div>
                                </div>

                                <!-- Indiff√©rence -->
                                <div class="dimension-item">
                                    <div class="dimension-header">
                                        <span class="dimension-icon">üòë</span>
                                        <h4 class="dimension-title">Indiff√©rence</h4>
                                        <span class="dimension-value" id="indifference-value">5</span>
                                    </div>
                                    <div class="dimension-slider">
                                        <input type="range" min="0" max="10" value="5" class="advanced-slider" id="indifference-slider" oninput="updateDimension('indifference', this.value)">
                                        <div class="slider-labels">
                                            <span>Impliqu√©</span>
                                            <span>Neutre</span>
                                            <span>D√©tach√©</span>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="context-input">
                                <h4>üí≠ Contexte et notes personnelles</h4>
                                <textarea id="mood-context" placeholder="D√©crivez ce qui influence votre humeur aujourd'hui : √©v√©nements, pens√©es, sensations physiques..."></textarea>
                            </div>

                            <button class="analyze-btn" onclick="analyzeMoodWithAI()">
                                üß† Analyser avec l'IA
                            </button>
                        </div>
                    </div>

                    <!-- Section Diagnostic IA -->
                    <div class="app-content mood-section" id="diagnostic-section" style="display: none;">
                        <div class="diagnostic-container">
                            <div class="diagnostic-header">
                                <h3>üß† Diagnostic IA personnalis√©</h3>
                                <div class="ai-status" id="ai-status">
                                    En attente d'analyse...
                                </div>
                            </div>
                            
                            <div class="diagnostic-results" id="diagnostic-results">
                                <div class="waiting-analysis">
                                    <div class="analysis-placeholder">
                                        <span class="placeholder-icon">ü§ñ</span>
                                        <h4>Effectuez d'abord une √©valuation</h4>
                                        <p>L'IA analysera vos r√©ponses pour vous fournir un diagnostic personnalis√©</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Section Exercices personnalis√©s -->
                    <div class="app-content mood-section" id="exercises-section" style="display: none;">
                        <div class="exercises-container">
                            <div class="exercises-header">
                                <h3>üèÉ‚Äç‚ôÄÔ∏è Exercices personnalis√©s</h3>
                                <p>Recommandations bas√©es sur votre profil</p>
                            </div>
                            
                            <div class="recommended-exercises" id="recommended-exercises">
                                <div class="waiting-exercises">
                                    <div class="exercise-placeholder">
                                        <span class="placeholder-icon">üéØ</span>
                                        <h4>Exercices en pr√©paration</h4>
                                        <p>Compl√©tez votre √©valuation pour recevoir des exercices adapt√©s</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Section Suivi et historique -->
                    <div class="app-content mood-section" id="tracking-section" style="display: none;">
                        <div class="tracking-container">
                            <div class="tracking-header">
                                <h3>üìä Suivi et √©volution</h3>
                                <div class="tracking-period">
                                    <button class="period-btn active" onclick="showTrackingPeriod('week')">7j</button>
                                    <button class="period-btn" onclick="showTrackingPeriod('month')">30j</button>
                                    <button class="period-btn" onclick="showTrackingPeriod('quarter')">90j</button>
                                </div>
                            </div>
                            
                            <div class="mood-charts" id="mood-charts">
                                <div class="chart-placeholder">
                                    <span class="chart-icon">üìà</span>
                                    <h4>Graphiques de suivi</h4>
                                    <p>Vos donn√©es d'humeur appara√Ætront ici apr√®s quelques √©valuations</p>
                                </div>
                            </div>
                            
                            <div class="insights-summary" id="insights-summary">
                                <h4>üîç Tendances d√©tect√©es</h4>
                                <div class="no-insights">
                                    <p>Continuez vos √©valuations pour que l'IA puisse identifier des patterns dans votre humeur</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                    
                    <div class="tab-navigation">
                        <button class="tab-item">
                            <span class="tab-icon">üè†</span>
                            <span class="tab-label">Accueil</span>
                        </button>
                        <button class="tab-item active">
                            <span class="tab-icon">üå∏</span>
                            <span class="tab-label">Humeur</span>
                        </button>
                        <button class="tab-item">
                            <span class="tab-icon">üí¨</span>
                            <span class="tab-label">Chat</span>
                        </button>
                        <button class="tab-item">
                            <span class="tab-icon">üë•</span>
                            <span class="tab-label">Communaut√©</span>
                        </button>
                        <button class="tab-item">
                            <span class="tab-icon">üë§</span>
                            <span class="tab-label">Profil</span>
                        </button>
                    </div>
                </div>
            </div>

            <!-- Chat Screen -->
            <div class="screen-content" id="chat-screen">
                <div class="main-app">
                    <div class="app-header">
                        <h1 class="app-title">Assistant IA</h1>
                        <p class="date-text">Votre compagnon d'√©coute</p>
                    </div>
                    
                    <div class="app-content">
                        <div class="chat-messages" id="chatMessages">
                            <div class="ai-message">
                                <div class="message-avatar">ÔøΩ</div>
                                <div class="message-content">
                                    <p>Bonjour ! Je suis votre assistant IA bien-√™tre. Comment vous sentez-vous aujourd'hui ? Je suis l√† pour vous √©couter et vous aider. üå∏</p>
                                </div>
                            </div>
                        </div>
                        
                        <div class="quick-suggestions">
                            <button class="suggestion-btn" onclick="sendMessage('Je me sens stress√©e')">
                                üí´ Je me sens stress√©e
                            </button>
                            <button class="suggestion-btn" onclick="sendMessage('J\'ai besoin de conseils')">
                                üí° J'ai besoin de conseils
                            </button>
                            <button class="suggestion-btn" onclick="sendMessage('Je veux faire de la m√©ditation')">
                                üßò‚Äç‚ôÄÔ∏è M√©ditation
                            </button>
                        </div>
                        
                        <div class="chat-input-container">
                            <input type="text" id="chatInput" class="chat-input" placeholder="Tapez votre message..." onkeypress="handleKeyPress(event)">
                            <button class="send-btn" onclick="sendUserMessage()">
                                <span>üì§</span>
                            </button>
                        </div>
                            
                            <div class="action-card">
                                <div class="action-icon">üîí</div>
                                <div class="action-content">
                                    <div class="action-title">S√©curis√©</div>
                                    <div class="action-subtitle">Vos conversations sont priv√©es et s√©curis√©es</div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="tab-navigation">
                        <button class="tab-item">
                            <span class="tab-icon">üè†</span>
                            <span class="tab-label">Accueil</span>
                        </button>
                        <button class="tab-item">
                            <span class="tab-icon">üå∏</span>
                            <span class="tab-label">Humeur</span>
                        </button>
                        <button class="tab-item active">
                            <span class="tab-icon">üí¨</span>
                            <span class="tab-label">Chat</span>
                        </button>
                        <button class="tab-item">
                            <span class="tab-icon">üë•</span>
                            <span class="tab-label">Communaut√©</span>
                        </button>
                        <button class="tab-item">
                            <span class="tab-icon">üë§</span>
                            <span class="tab-label">Profil</span>
                        </button>
                    </div>
                </div>
            </div>

            <!-- Profile Screen -->
            <div class="screen-content" id="profile-screen">
                <div class="main-app">
                    <div class="app-header">
                        <h1 class="app-title" data-translate="profile.title">Profil</h1>
                        <p class="date-text" data-translate="profile.subtitle">Votre espace personnel</p>
                        <div class="profile-actions">
                            <button class="create-profile-btn" onclick="showCreateProfile()">
                                ‚ûï Cr√©er un profil
                            </button>
                            <button class="settings-btn" onclick="showProfileSettings()">
                                ${icons.settings} <span data-translate="profile.settings">Param√®tres</span>
                            </button>
                        </div>
                    </div>
                    
                    <!-- Section principale du profil -->
                    <div class="app-content" id="main-profile-content">
                        <div class="profile-card">
                            <div class="profile-photo-container">
                                <div class="profile-photo" onclick="changeProfilePhoto()">
                                    <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Ccircle cx='50' cy='50' r='50' fill='%234CAF50'/%3E%3Ctext x='50' y='55' text-anchor='middle' fill='white' font-size='30' font-weight='bold'%3Eüë§%3C/text%3E%3C/svg%3E" alt="Photo de profil" id="profileImage">
                                </div>
                                <button class="change-photo-btn" onclick="changeProfilePhoto()">
                                    üì∑ Changer la photo
                                </button>
                            </div>
                            <h2 class="profile-name" id="profileName">Sarah Martin</h2>
                            <p class="profile-email" id="profileEmail">sarah.martin@email.com</p>
                            <div class="profile-status">
                                <span class="anonymity-status" id="anonymityStatus">
                                    üëÅÔ∏è Visible dans la communaut√©
                                </span>
                            </div>
                        </div>

                        <!-- Menu de navigation du profil -->
                        <div class="profile-menu">
                            <button class="profile-menu-item" onclick="showMoodFeedback()">
                                <span class="menu-icon">üìä</span>
                                <div class="menu-content">
                                    <h3>Feedback d'humeur</h3>
                                    <p>Consultez vos statistiques</p>
                                </div>
                                <span class="menu-arrow">‚Üí</span>
                            </button>
                            
                            <button class="profile-menu-item" onclick="showLanguageSettings()">
                                <span class="menu-icon">üåê</span>
                                <div class="menu-content">
                                    <h3>Langue</h3>
                                    <p id="currentLanguage">Fran√ßais</p>
                                </div>
                                <span class="menu-arrow">‚Üí</span>
                            </button>
                            
                            <button class="profile-menu-item" onclick="showAnonymitySettings()">
                                <span class="menu-icon">ÔøΩÔ∏è</span>
                                <div class="menu-content">
                                    <h3>Anonymat</h3>
                                    <p>G√©rer votre visibilit√©</p>
                                </div>
                                <span class="menu-arrow">‚Üí</span>
                            </button>
                            
                            <button class="profile-menu-item" onclick="showCreateProfile()">
                                <span class="menu-icon">üìù</span>
                                <div class="menu-content">
                                    <h3>Cr√©er un nouveau profil</h3>
                                    <p>Ajouter un profil suppl√©mentaire</p>
                                </div>
                                <span class="menu-arrow">‚Üí</span>
                            </button>
                            
                            <button class="profile-menu-item" onclick="showHealthDiagnostic()">
                                <span class="menu-icon">üè•</span>
                                <div class="menu-content">
                                    <h3>Mon diagnostic de sant√©</h3>
                                    <p>Voir mes analyses et recommandations</p>
                                </div>
                                <span class="menu-arrow">‚Üí</span>
                            </button>
                            
                            <button class="profile-menu-item" onclick="showRemindersNotifications()">
                                <span class="menu-icon">üîî</span>
                                <div class="menu-content">
                                    <h3>Rappels & Notifications</h3>
                                    <p>G√©rer mes alertes personnalis√©es</p>
                                </div>
                                <span class="menu-arrow">‚Üí</span>
                            </button>
                            
                            <button class="profile-menu-item" onclick="showAppearanceSettings()">
                                <span class="menu-icon">üé®</span>
                                <div class="menu-content">
                                    <h3>Apparence & Th√®me</h3>
                                    <p>Personnaliser selon mon humeur</p>
                                </div>
                                <span class="menu-arrow">‚Üí</span>
                            </button>
                            
                            <button class="profile-menu-item" onclick="showFollowUpGuide()">
                                <span class="menu-icon">üìà</span>
                                <div class="menu-content">
                                    <h3>Guide de suivi</h3>
                                    <p>Mon parcours personnalis√©</p>
                                </div>
                                <span class="menu-arrow">‚Üí</span>
                            </button>
                            
                            <button class="profile-menu-item" onclick="showAIAssistant()">
                                <span class="menu-icon">ü§ñ</span>
                                <div class="menu-content">
                                    <h3>Assistante IA</h3>
                                    <p>Personnaliser mon accompagnement</p>
                                </div>
                                <span class="menu-arrow">‚Üí</span>
                            </button>
                            
                            <button class="profile-menu-item" onclick="showStressAnalysis()">
                                <span class="menu-icon">üìä</span>
                                <div class="menu-content">
                                    <h3>Analyse stress & overthinking</h3>
                                    <p>√âvaluation approfondie de vos niveaux</p>
                                </div>
                                <span class="menu-arrow">‚Üí</span>
                            </button>
                            
                            <button class="profile-menu-item" onclick="showLifestyleAdapter()">
                                <span class="menu-icon">üéì</span>
                                <div class="menu-content">
                                    <h3>Adaptation rythme de vie</h3>
                                    <p>√âtudiant ou professionnel</p>
                                </div>
                                <span class="menu-arrow">‚Üí</span>
                            </button>
                            
                            <button class="profile-menu-item" onclick="showAdvancedSettings()">
                                <span class="menu-icon">‚öôÔ∏è</span>
                                <div class="menu-content">
                                    <h3>Param√®tres avanc√©s</h3>
                                    <p>Confidentialit√©, langue, pr√©f√©rences</p>
                                </div>
                                <span class="menu-arrow">‚Üí</span>
                            </button>
                            
                            <button class="profile-menu-item" onclick="showSubscriptionManagement()">
                                <span class="menu-icon">üíé</span>
                                <div class="menu-content">
                                    <h3>Mon abonnement</h3>
                                    <p id="subscriptionStatusText">G√©rer votre abonnement</p>
                                </div>
                                <span class="menu-arrow">‚Üí</span>
                            </button>
                        </div>

                        <!-- Statistiques rapides -->
                        <div class="stats-grid">
                            <div class="stat-card">
                                <span class="stat-icon">üìÖ</span>
                                <div class="stat-number">12</div>
                                <div class="stat-label">Jours cons√©cutifs</div>
                            </div>
                            <div class="stat-card">
                                <span class="stat-icon">üå∏</span>
                                <div class="stat-number">47</div>
                                <div class="stat-label">Entr√©es d'humeur</div>
                            </div>
                            <div class="stat-card">
                                <span class="stat-icon">‚≠ê</span>
                                <div class="stat-number">85%</div>
                                <div class="stat-label">Score bien-√™tre</div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Section de cr√©ation de profil -->
                    <div class="app-content profile-section" id="create-profile-section" style="display: none;">
                        <div class="create-profile-container">
                            <div class="section-header">
                                <button class="back-btn" onclick="showMainProfile()">‚Üê Retour</button>
                                <h2>Cr√©er un nouveau profil</h2>
                            </div>
                            
                            <div class="id-card-upload">
                                <div class="upload-area" onclick="uploadIdCard()">
                                    <div class="upload-icon">üì±</div>
                                    <h3>T√©l√©charger votre carte d'identit√©</h3>
                                    <p>Pour v√©rifier votre identit√©</p>
                                    <button class="upload-btn">Choisir un fichier</button>
                                </div>
                                <div class="upload-status" id="uploadStatus" style="display: none;">
                                    <span class="status-icon">‚úÖ</span>
                                    <span class="status-text">Document t√©l√©charg√© avec succ√®s</span>
                                </div>
                            </div>
                            
                            <form class="profile-form" id="profileForm">
                                <div class="form-group">
                                    <label for="fullName">Nom complet</label>
                                    <input type="text" id="fullName" placeholder="Votre nom complet" required>
                                </div>
                                
                                <div class="form-group">
                                    <label for="email">Email</label>
                                    <input type="email" id="email" placeholder="votre.email@exemple.com" required>
                                </div>
                                
                                <div class="form-group">
                                    <label for="dateOfBirth">Date de naissance</label>
                                    <input type="date" id="dateOfBirth" required>
                                </div>
                                
                                <div class="form-group">
                                    <label for="profileLanguage">Langue pr√©f√©r√©e</label>
                                    <select id="profileLanguage" required>
                                        <option value="fr">Fran√ßais</option>
                                        <option value="nl">Nederlands</option>
                                        <option value="en">English</option>
                                    </select>
                                </div>
                                
                                <div class="form-group">
                                    <label class="checkbox-label">
                                        <input type="checkbox" id="anonymousMode">
                                        <span class="checkmark"></span>
                                        Rester anonyme dans la communaut√©
                                    </label>
                                </div>
                                
                                <button type="submit" class="create-profile-submit" onclick="createNewProfile(event)">
                                    Cr√©er le profil
                                </button>
                            </form>
                        </div>
                    </div>
                    
                    <!-- Section Feedback d'humeur -->
                    <div class="app-content profile-section" id="mood-feedback-section" style="display: none;">
                        <div class="feedback-container">
                            <div class="section-header">
                                <button class="back-btn" onclick="showMainProfile()">‚Üê Retour</button>
                                <h2>Feedback d'humeur</h2>
                            </div>
                            
                            <div class="mood-stats">
                                <div class="mood-chart">
                                    <h3>Tendance de votre humeur</h3>
                                    <div class="chart-container">
                                        <div class="mood-bars">
                                            <div class="mood-bar happy" style="height: 70%">
                                                <span class="bar-label">üòä</span>
                                                <span class="bar-value">70%</span>
                                            </div>
                                            <div class="mood-bar neutral" style="height: 20%">
                                                <span class="bar-label">üòê</span>
                                                <span class="bar-value">20%</span>
                                            </div>
                                            <div class="mood-bar sad" style="height: 10%">
                                                <span class="bar-label">üò¢</span>
                                                <span class="bar-value">10%</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="mood-insights">
                                    <h3>Insights personnalis√©s</h3>
                                    <div class="insight-card">
                                        <span class="insight-icon">üåü</span>
                                        <div class="insight-content">
                                            <h4>Excellent progr√®s !</h4>
                                            <p>Votre humeur s'am√©liore de 15% cette semaine</p>
                                        </div>
                                    </div>
                                    <div class="insight-card">
                                        <span class="insight-icon">üï∞Ô∏è</span>
                                        <div class="insight-content">
                                            <h4>Moment optimal</h4>
                                            <p>Vous √™tes plus heureux le matin vers 9h</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Section Param√®tres de langue -->
                    <div class="app-content profile-section" id="language-settings-section" style="display: none;">
                        <div class="settings-container">
                            <div class="section-header">
                                <button class="back-btn" onclick="showMainProfile()">‚Üê Retour</button>
                                <h2>Choisir la langue</h2>
                            </div>
                            
                            <div class="language-options">
                                <button class="language-option active" onclick="selectLanguage('fr')">
                                    <span class="flag">üá´üá∑</span>
                                    <div class="language-info">
                                        <h3>Fran√ßais</h3>
                                        <p>Langue actuelle</p>
                                    </div>
                                    <span class="check-icon">‚úì</span>
                                </button>
                                
                                <button class="language-option" onclick="selectLanguage('nl')">
                                    <span class="flag">üá≥üá±</span>
                                    <div class="language-info">
                                        <h3>Nederlands</h3>
                                        <p>Nederlandse taal</p>
                                    </div>
                                </button>
                                
                                <button class="language-option" onclick="selectLanguage('en')">
                                    <span class="flag">üá¨üáß</span>
                                    <div class="language-info">
                                        <h3>English</h3>
                                        <p>English language</p>
                                    </div>
                                </button>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Section Param√®tres d'anonymat -->
                    <div class="app-content profile-section" id="anonymity-settings-section" style="display: none;">
                        <div class="settings-container">
                            <div class="section-header">
                                <button class="back-btn" onclick="showMainProfile()">‚Üê Retour</button>
                                <h2>Param√®tres d'anonymat</h2>
                            </div>
                            
                            <div class="anonymity-options">
                                <div class="anonymity-card">
                                    <div class="card-header">
                                        <span class="card-icon">üëÅÔ∏è</span>
                                        <h3>Visible dans la communaut√©</h3>
                                    </div>
                                    <p>Votre nom et photo apparaissent dans vos posts</p>
                                    <button class="anonymity-btn" onclick="setAnonymity(false)" id="visibleBtn">
                                        Activer
                                    </button>
                                </div>
                                
                                <div class="anonymity-card">
                                    <div class="card-header">
                                        <span class="card-icon">üï∂Ô∏è</span>
                                        <h3>Mode anonyme</h3>
                                    </div>
                                    <p>Vos posts apparaissent avec un pseudonyme</p>
                                    <button class="anonymity-btn secondary" onclick="setAnonymity(true)" id="anonymousBtn">
                                        Activer
                                    </button>
                                </div>
                            </div>
                            
                            <div class="anonymity-preview">
                                <h3>Aper√ßu dans la communaut√©</h3>
                                <div class="preview-post">
                                    <div class="post-header">
                                        <div class="post-avatar" id="previewAvatar">S</div>
                                        <div class="post-info">
                                            <h4 class="post-author" id="previewName">Sarah Martin</h4>
                                            <p class="post-time">Il y a 5 min</p>
                                        </div>
                                    </div>
                                    <div class="post-content">
                                        <p>Exemple de post dans la communaut√©...</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                    
                    <div class="tab-navigation">
                        <button class="tab-item">
                            <span class="tab-icon">üè†</span>
                            <span class="tab-label">Accueil</span>
                        </button>
                        <button class="tab-item">
                            <span class="tab-icon">üå∏</span>
                            <span class="tab-label">Humeur</span>
                        </button>
                        <button class="tab-item">
                            <span class="tab-icon">üí¨</span>
                            <span class="tab-label">Chat</span>
                        </button>
                        <button class="tab-item">
                            <span class="tab-icon">üë•</span>
                            <span class="tab-label">Communaut√©</span>
                        </button>
                        <button class="tab-item active">
                            <span class="tab-icon">üë§</span>
                            <span class="tab-label">Profil</span>
                        </button>
                    </div>
                </div>
            </div>

            <!-- Section de gestion d'abonnement -->
            <div class="app-content profile-section" id="subscription-management-section" style="display: none;">
                <div class="subscription-management-container">
                    <div class="section-header">
                        <button class="back-btn" onclick="showMainProfile()">‚Üê Retour au profil</button>
                        <h2>Mon abonnement</h2>
                    </div>
                    
                    <!-- Statut actuel de l'abonnement -->
                    <div class="current-subscription-card">
                        <div class="subscription-status" id="currentSubscriptionStatus">
                            <!-- Status sera rempli dynamiquement -->
                        </div>
                    </div>
                    
                    <!-- Plans disponibles -->
                    <div class="available-plans" id="availablePlansSection">
                        <h3>Plans disponibles</h3>
                        
                        <div class="plan-comparison">
                            <div class="plan-item free-plan">
                                <div class="plan-header">
                                    <h4>Plan Gratuit</h4>
                                    <div class="plan-price">0‚Ç¨</div>
                                </div>
                                <ul class="plan-features">
                                    <li>‚úÖ 3 √©valuations d'humeur/mois</li>
                                    <li>‚úÖ Exercices de base</li>
                                    <li>‚ùå Diagnostic IA limit√©</li>
                                    <li>‚ùå Communaut√© restreinte</li>
                                </ul>
                                <button class="plan-action-btn" onclick="switchToPlan('free')" id="freePlanBtn">
                                    Plan actuel
                                </button>
                            </div>
                            
                            <div class="plan-item premium-plan">
                                <div class="plan-badge">‚≠ê Populaire</div>
                                <div class="plan-header">
                                    <h4>Premium Mensuel</h4>
                                    <div class="plan-price">9,99‚Ç¨<span class="period">/mois</span></div>
                                </div>
                                <ul class="plan-features">
                                    <li>‚úÖ √âvaluations illimit√©es</li>
                                    <li>‚úÖ Diagnostic IA avanc√©</li>
                                    <li>‚úÖ Exercices personnalis√©s</li>
                                    <li>‚úÖ Communaut√© compl√®te</li>
                                    <li>‚úÖ Support prioritaire</li>
                                </ul>
                                <button class="plan-action-btn premium" onclick="upgradeToPremium('monthly')" id="monthlyPlanBtn">
                                    Passer au premium
                                </button>
                            </div>
                            
                            <div class="plan-item annual-plan">
                                <div class="plan-badge savings">üí∞ √âconomisez 50%</div>
                                <div class="plan-header">
                                    <h4>Premium Annuel</h4>
                                    <div class="plan-price">59,99‚Ç¨<span class="period">/an</span></div>
                                </div>
                                <ul class="plan-features">
                                    <li>‚úÖ Tous les avantages Premium</li>
                                    <li>‚úÖ √âconomisez 60‚Ç¨ par an</li>
                                    <li>‚úÖ Rapports mensuels d√©taill√©s</li>
                                    <li>‚úÖ Acc√®s prioritaire nouvelles fonctionnalit√©s</li>
                                </ul>
                                <button class="plan-action-btn premium" onclick="upgradeToPremium('annual')" id="annualPlanBtn">
                                    Meilleure offre
                                </button>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Informations de facturation (pour les abonn√©s premium) -->
                    <div class="billing-info" id="billingInfo" style="display: none;">
                        <h3>Informations de facturation</h3>
                        <div class="billing-card">
                            <div class="billing-item">
                                <span class="billing-label">Prochaine facturation :</span>
                                <span class="billing-value" id="nextBillingDate">-</span>
                            </div>
                            <div class="billing-item">
                                <span class="billing-label">M√©thode de paiement :</span>
                                <span class="billing-value">‚Ä¢‚Ä¢‚Ä¢‚Ä¢ ‚Ä¢‚Ä¢‚Ä¢‚Ä¢ ‚Ä¢‚Ä¢‚Ä¢‚Ä¢ 1234</span>
                            </div>
                            <div class="billing-actions">
                                <button class="secondary-btn" onclick="updatePaymentMethod()">
                                    Modifier le paiement
                                </button>
                                <button class="danger-btn" onclick="cancelSubscription()">
                                    Annuler l'abonnement
                                </button>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Historique des paiements -->
                    <div class="payment-history" id="paymentHistory" style="display: none;">
                        <h3>Historique des paiements</h3>
                        <div class="payment-list">
                            <div class="payment-item">
                                <div class="payment-info">
                                    <span class="payment-date">15 Jan 2024</span>
                                    <span class="payment-amount">9,99‚Ç¨</span>
                                </div>
                                <span class="payment-status success">Pay√©</span>
                            </div>
                            <!-- Plus d'entr√©es peuvent √™tre ajout√©es dynamiquement -->
                        </div>
                    </div>
                </div>
            </div>

            <!-- Section diagnostic de sant√© -->
            <div class="app-content profile-section" id="health-diagnostic-section" style="display: none;">
                <div class="health-diagnostic-container">
                    <div class="section-header">
                        <button class="back-btn" onclick="showMainProfile()">‚Üê Retour au profil</button>
                        <h2>Mon diagnostic de sant√©</h2>
                    </div>
                    
                    <!-- R√©sum√© de sant√© actuel -->
                    <div class="health-summary-card">
                        <div class="health-score">
                            <div class="score-circle">
                                <span class="score-number" id="healthScore">78</span>
                                <span class="score-label">Score sant√©</span>
                            </div>
                            <div class="score-trend">
                                <span class="trend-icon">üìà</span>
                                <span class="trend-text">+5 points cette semaine</span>
                            </div>
                        </div>
                        
                        <div class="health-indicators">
                            <div class="indicator">
                                <span class="indicator-icon">üòä</span>
                                <span class="indicator-label">Humeur</span>
                                <span class="indicator-value good">Stable</span>
                            </div>
                            <div class="indicator">
                                <span class="indicator-icon">üò¥</span>
                                <span class="indicator-label">Sommeil</span>
                                <span class="indicator-value warning">√Ä am√©liorer</span>
                            </div>
                            <div class="indicator">
                                <span class="indicator-icon">üßò</span>
                                <span class="indicator-label">Stress</span>
                                <span class="indicator-value good">Contr√¥l√©</span>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Recommandations IA -->
                    <div class="ai-recommendations">
                        <h3>ü§ñ Recommandations personnalis√©es</h3>
                        <div class="recommendation-card">
                            <div class="recommendation-priority high">
                                <span class="priority-badge">Priorit√© haute</span>
                                <h4>Am√©liorer la qualit√© du sommeil</h4>
                                <p>Vos donn√©es montrent des troubles du sommeil r√©currents. Essayez une routine de coucher plus r√©guli√®re.</p>
                                <button class="action-btn" onclick="startSleepProgram()">Commencer un programme</button>
                            </div>
                            
                            <div class="recommendation-priority medium">
                                <span class="priority-badge">Recommand√©</span>
                                <h4>Exercices de respiration quotidiens</h4>
                                <p>5 minutes d'exercices respiratoires peuvent r√©duire votre stress de 40%.</p>
                                <button class="action-btn secondary" onclick="startBreathingExercise()">Essayer maintenant</button>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Historique des diagnostics -->
                    <div class="diagnostic-history">
                        <h3>üìä Historique des analyses</h3>
                        <div class="history-timeline">
                            <div class="timeline-item">
                                <div class="timeline-date">10 Nov 2024</div>
                                <div class="timeline-content">
                                    <h4>Analyse compl√®te</h4>
                                    <p>Score g√©n√©ral : 78/100 (+5)</p>
                                    <span class="timeline-status improved">Am√©lior√©</span>
                                </div>
                            </div>
                            <div class="timeline-item">
                                <div class="timeline-date">3 Nov 2024</div>
                                <div class="timeline-content">
                                    <h4>√âvaluation hebdomadaire</h4>
                                    <p>Score g√©n√©ral : 73/100 (-2)</p>
                                    <span class="timeline-status declined">En baisse</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Section rappels et notifications -->
            <div class="app-content profile-section" id="reminders-notifications-section" style="display: none;">
                <div class="reminders-container">
                    <div class="section-header">
                        <button class="back-btn" onclick="showMainProfile()">‚Üê Retour au profil</button>
                        <h2>Rappels & Notifications</h2>
                    </div>
                    
                    <!-- Rappels actifs -->
                    <div class="active-reminders">
                        <h3>üîî Rappels actifs</h3>
                        <div class="reminder-list">
                            <div class="reminder-item active">
                                <div class="reminder-icon">üå∏</div>
                                <div class="reminder-content">
                                    <h4>√âvaluation d'humeur quotidienne</h4>
                                    <p>Tous les jours √† 20h00</p>
                                </div>
                                <div class="reminder-controls">
                                    <button class="toggle-btn active" onclick="toggleReminder('mood-daily')">ON</button>
                                    <button class="edit-btn" onclick="editReminder('mood-daily')">‚úèÔ∏è</button>
                                </div>
                            </div>
                            
                            <div class="reminder-item active">
                                <div class="reminder-icon">üßò</div>
                                <div class="reminder-content">
                                    <h4>Pause m√©ditation</h4>
                                    <p>Lun, Mer, Ven √† 12h00</p>
                                </div>
                                <div class="reminder-controls">
                                    <button class="toggle-btn active" onclick="toggleReminder('meditation')">ON</button>
                                    <button class="edit-btn" onclick="editReminder('meditation')">‚úèÔ∏è</button>
                                </div>
                            </div>
                            
                            <div class="reminder-item inactive">
                                <div class="reminder-icon">üíä</div>
                                <div class="reminder-content">
                                    <h4>Prise de m√©dicaments</h4>
                                    <p>D√©sactiv√©</p>
                                </div>
                                <div class="reminder-controls">
                                    <button class="toggle-btn" onclick="toggleReminder('medication')">OFF</button>
                                    <button class="edit-btn" onclick="editReminder('medication')">‚úèÔ∏è</button>
                                </div>
                            </div>
                        </div>
                        
                        <button class="add-reminder-btn" onclick="addNewReminder()">+ Ajouter un rappel</button>
                    </div>
                    
                    <!-- Param√®tres de notifications -->
                    <div class="notification-settings">
                        <h3>üì± Param√®tres de notifications</h3>
                        <div class="settings-list">
                            <div class="setting-item">
                                <div class="setting-info">
                                    <h4>Notifications push</h4>
                                    <p>Recevoir des alertes sur votre appareil</p>
                                </div>
                                <button class="toggle-switch active" onclick="toggleSetting('push-notifications')">
                                    <span class="switch-slider"></span>
                                </button>
                            </div>
                            
                            <div class="setting-item">
                                <div class="setting-info">
                                    <h4>Notifications par email</h4>
                                    <p>R√©sum√©s hebdomadaires et rappels importants</p>
                                </div>
                                <button class="toggle-switch" onclick="toggleSetting('email-notifications')">
                                    <span class="switch-slider"></span>
                                </button>
                            </div>
                            
                            <div class="setting-item">
                                <div class="setting-info">
                                    <h4>Mode silencieux nocturne</h4>
                                    <p>22h00 - 7h00</p>
                                </div>
                                <button class="toggle-switch active" onclick="toggleSetting('night-mode')">
                                    <span class="switch-slider"></span>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Section apparence et th√®me -->
            <div class="app-content profile-section" id="appearance-settings-section" style="display: none;">
                <div class="appearance-container">
                    <div class="section-header">
                        <button class="back-btn" onclick="showMainProfile()">‚Üê Retour au profil</button>
                        <h2>Apparence & Th√®me</h2>
                    </div>
                    
                    <!-- Th√®me adaptatif √† l'humeur -->
                    <div class="mood-theme-section">
                        <h3>üé® Th√®me adaptatif √† l'humeur</h3>
                        <p>L'apparence de l'application s'adapte automatiquement √† votre √©tat d'esprit</p>
                        
                        <div class="theme-preview">
                            <div class="current-theme" id="currentThemePreview">
                                <div class="theme-colors">
                                    <div class="color-dot primary" style="background: #8A2BE2;"></div>
                                    <div class="color-dot secondary" style="background: #E8E3F3;"></div>
                                    <div class="color-dot accent" style="background: #9C27B0;"></div>
                                </div>
                                <h4>Th√®me S√©r√©nit√©</h4>
                                <p>Adapt√© √† votre humeur calme actuelle</p>
                            </div>
                        </div>
                        
                        <div class="mood-themes">
                            <div class="theme-option" onclick="selectMoodTheme('joy')">
                                <div class="theme-colors">
                                    <div class="color-dot" style="background: #FFD700;"></div>
                                    <div class="color-dot" style="background: #FFF8DC;"></div>
                                    <div class="color-dot" style="background: #FF6347;"></div>
                                </div>
                                <span>üòä Joie</span>
                            </div>
                            
                            <div class="theme-option" onclick="selectMoodTheme('calm')">
                                <div class="theme-colors">
                                    <div class="color-dot" style="background: #4FC3F7;"></div>
                                    <div class="color-dot" style="background: #E3F2FD;"></div>
                                    <div class="color-dot" style="background: #29B6F6;"></div>
                                </div>
                                <span>üòå Calme</span>
                            </div>
                            
                            <div class="theme-option" onclick="selectMoodTheme('energy')">
                                <div class="theme-colors">
                                    <div class="color-dot" style="background: #FF5722;"></div>
                                    <div class="color-dot" style="background: #FFEBEE;"></div>
                                    <div class="color-dot" style="background: #F44336;"></div>
                                </div>
                                <span>‚ö° √ânergie</span>
                            </div>
                            
                            <div class="theme-option selected" onclick="selectMoodTheme('serenity')">
                                <div class="theme-colors">
                                    <div class="color-dot" style="background: #8A2BE2;"></div>
                                    <div class="color-dot" style="background: #E8E3F3;"></div>
                                    <div class="color-dot" style="background: #9C27B0;"></div>
                                </div>
                                <span>üå∏ S√©r√©nit√©</span>
                            </div>
                        </div>
                        
                        <div class="adaptive-setting">
                            <div class="setting-info">
                                <h4>Adaptation automatique</h4>
                                <p>Le th√®me change selon vos √©valuations d'humeur</p>
                            </div>
                            <button class="toggle-switch active" onclick="toggleAdaptiveTheme()">
                                <span class="switch-slider"></span>
                            </button>
                        </div>
                    </div>
                    
                    <!-- Autres param√®tres d'apparence -->
                    <div class="appearance-options">
                        <h3>üñºÔ∏è Options d'affichage</h3>
                        
                        <div class="setting-item">
                            <div class="setting-info">
                                <h4>Mode sombre</h4>
                                <p>Interface sombre pour r√©duire la fatigue oculaire</p>
                            </div>
                            <button class="toggle-switch" onclick="toggleDarkMode()">
                                <span class="switch-slider"></span>
                            </button>
                        </div>
                        
                        <div class="setting-item">
                            <div class="setting-info">
                                <h4>Animation des √©mojis</h4>
                                <p>√âmojis anim√©s dans l'interface</p>
                            </div>
                            <button class="toggle-switch active" onclick="toggleAnimatedEmojis()">
                                <span class="switch-slider"></span>
                            </button>
                        </div>
                        
                        <div class="setting-item">
                            <div class="setting-info">
                                <h4>Taille de police</h4>
                                <p>Ajuster la lisibilit√© du texte</p>
                            </div>
                            <select class="font-size-selector" onchange="changeFontSize(this.value)">
                                <option value="small">Petite</option>
                                <option value="medium" selected>Moyenne</option>
                                <option value="large">Grande</option>
                            </select>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Section guide de suivi -->
            <div class="app-content profile-section" id="follow-up-guide-section" style="display: none;">
                <div class="follow-up-container">
                    <div class="section-header">
                        <button class="back-btn" onclick="showMainProfile()">‚Üê Retour au profil</button>
                        <h2>Guide de suivi</h2>
                    </div>
                    
                    <!-- Progression personnelle -->
                    <div class="personal-progress">
                        <h3>üìà Ma progression</h3>
                        <div class="progress-overview">
                            <div class="progress-stat">
                                <div class="stat-circle">
                                    <span class="stat-number">42</span>
                                    <span class="stat-unit">jours</span>
                                </div>
                                <span class="stat-label">Suivi continu</span>
                            </div>
                            
                            <div class="progress-chart">
                                <canvas id="progressChart" width="200" height="100"></canvas>
                                <p>√âvolution de votre bien-√™tre sur 30 jours</p>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Objectifs personnalis√©s -->
                    <div class="personal-goals">
                        <h3>üéØ Mes objectifs</h3>
                        <div class="goals-list">
                            <div class="goal-item completed">
                                <div class="goal-icon">‚úÖ</div>
                                <div class="goal-content">
                                    <h4>√âvaluations quotidiennes</h4>
                                    <p>7 jours cons√©cutifs</p>
                                    <div class="goal-progress">
                                        <div class="progress-bar">
                                            <div class="progress-fill" style="width: 100%;"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="goal-item in-progress">
                                <div class="goal-icon">üéØ</div>
                                <div class="goal-content">
                                    <h4>M√©ditation quotidienne</h4>
                                    <p>4/7 jours cette semaine</p>
                                    <div class="goal-progress">
                                        <div class="progress-bar">
                                            <div class="progress-fill" style="width: 57%;"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="goal-item pending">
                                <div class="goal-icon">‚è≥</div>
                                <div class="goal-content">
                                    <h4>Am√©liorer le sommeil</h4>
                                    <p>Objectif : 8h par nuit</p>
                                    <div class="goal-progress">
                                        <div class="progress-bar">
                                            <div class="progress-fill" style="width: 25%;"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <button class="add-goal-btn" onclick="addPersonalGoal()">+ Ajouter un objectif</button>
                    </div>
                    
                    <!-- Parcours recommand√© -->
                    <div class="recommended-journey">
                        <h3>üó∫Ô∏è Parcours recommand√©</h3>
                        <div class="journey-steps">
                            <div class="journey-step completed">
                                <div class="step-number">1</div>
                                <div class="step-content">
                                    <h4>√âvaluation initiale</h4>
                                    <p>Compl√©t√©e le 1er nov.</p>
                                </div>
                            </div>
                            
                            <div class="journey-step completed">
                                <div class="step-number">2</div>
                                <div class="step-content">
                                    <h4>Routine d'√©valuation</h4>
                                    <p>√âtablie avec succ√®s</p>
                                </div>
                            </div>
                            
                            <div class="journey-step current">
                                <div class="step-number">3</div>
                                <div class="step-content">
                                    <h4>Techniques de gestion du stress</h4>
                                    <p>En cours - 2/5 modules</p>
                                    <button class="continue-btn" onclick="continueJourney('stress-management')">Continuer</button>
                                </div>
                            </div>
                            
                            <div class="journey-step upcoming">
                                <div class="step-number">4</div>
                                <div class="step-content">
                                    <h4>Optimisation du sommeil</h4>
                                    <p>D√©bloqu√© dans 3 jours</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Section assistante IA -->
            <div class="app-content profile-section" id="ai-assistant-section" style="display: none;">
                <div class="ai-assistant-container">
                    <div class="section-header">
                        <button class="back-btn" onclick="showMainProfile()">‚Üê Retour au profil</button>
                        <h2>Assistante IA LUNA</h2>
                    </div>
                    
                    <!-- Pr√©sentation de l'assistante -->
                    <div class="ai-introduction">
                        <div class="ai-avatar">
                            <div class="avatar-circle">
                                <span class="avatar-emoji">ü§ñ</span>
                            </div>
                            <div class="ai-status online">
                                <span class="status-dot"></span>
                                En ligne
                            </div>
                        </div>
                        
                        <div class="ai-intro-text">
                            <h3>Bonjour ! Je suis LUNA üëã</h3>
                            <p>Votre assistante IA personnelle pour votre bien-√™tre. Je vous accompagne dans votre parcours de sant√© mentale avec des conseils adapt√©s √† votre profil unique.</p>
                        </div>
                    </div>
                    
                    <!-- Chat avec l'IA -->
                    <div class="ai-chat-section">
                        <h3>üí¨ Conversation</h3>
                        <div class="chat-container" id="aiChatContainer">
                            <div class="chat-message ai-message">
                                <div class="message-avatar">ü§ñ</div>
                                <div class="message-content">
                                    <p>Bonjour ! Comment vous sentez-vous aujourd'hui ? Je remarque que vous n'avez pas fait votre √©valuation d'humeur ce matin.</p>
                                    <span class="message-time">Il y a 5 min</span>
                                </div>
                            </div>
                            
                            <div class="chat-message user-message">
                                <div class="message-content">
                                    <p>Salut LUNA ! Je me sens un peu stress√© avec le travail.</p>
                                    <span class="message-time">Il y a 3 min</span>
                                </div>
                                <div class="message-avatar">üë§</div>
                            </div>
                            
                            <div class="chat-message ai-message">
                                <div class="message-avatar">ü§ñ</div>
                                <div class="message-content">
                                    <p>Je comprends. Bas√© sur vos habitudes, je recommande un exercice de respiration de 5 minutes. Voulez-vous que je vous guide ?</p>
                                    <div class="message-actions">
                                        <button class="quick-action-btn" onclick="startGuidedBreathing()">üßò Commencer</button>
                                        <button class="quick-action-btn" onclick="postponeActivity()">‚è∞ Plus tard</button>
                                    </div>
                                    <span class="message-time">Il y a 1 min</span>
                                </div>
                            </div>
                        </div>
                        
                        <div class="chat-input-section">
                            <div class="chat-input-container">
                                <input type="text" id="aiChatInput" placeholder="√âcrivez votre message √† LUNA..." />
                                <button class="send-btn" onclick="sendMessageToAI()">üì§</button>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Personnalisation de l'IA -->
                    <div class="ai-customization">
                        <h3>‚öôÔ∏è Personnaliser LUNA</h3>
                        
                        <div class="customization-options">
                            <div class="setting-item">
                                <div class="setting-info">
                                    <h4>Style de communication</h4>
                                    <p>Comment LUNA doit-elle vous parler ?</p>
                                </div>
                                <select class="ai-setting-select" onchange="updateAIPersonality(this.value)">
                                    <option value="friendly">Amical et d√©contract√©</option>
                                    <option value="professional" selected>Professionnel et bienveillant</option>
                                    <option value="motivational">Motivant et √©nergique</option>
                                    <option value="gentle">Doux et rassurant</option>
                                </select>
                            </div>
                            
                            <div class="setting-item">
                                <div class="setting-info">
                                    <h4>Fr√©quence des check-ins</h4>
                                    <p>√Ä quelle fr√©quence LUNA vous contacte</p>
                                </div>
                                <select class="ai-setting-select" onchange="updateCheckInFrequency(this.value)">
                                    <option value="multiple">Plusieurs fois par jour</option>
                                    <option value="daily" selected>Une fois par jour</option>
                                    <option value="weekly">Hebdomadaire</option>
                                    <option value="ondemand">Sur demande uniquement</option>
                                </select>
                            </div>
                            
                            <div class="setting-item">
                                <div class="setting-info">
                                    <h4>Domaines de focus</h4>
                                    <p>Sur quoi LUNA doit-elle se concentrer ?</p>
                                </div>
                                <div class="focus-areas">
                                    <label class="checkbox-tag">
                                        <input type="checkbox" checked> Gestion du stress
                                    </label>
                                    <label class="checkbox-tag">
                                        <input type="checkbox" checked> Am√©lioration du sommeil
                                    </label>
                                    <label class="checkbox-tag">
                                        <input type="checkbox"> Exercice physique
                                    </label>
                                    <label class="checkbox-tag">
                                        <input type="checkbox" checked> Relations sociales
                                    </label>
                                    <label class="checkbox-tag">
                                        <input type="checkbox"> Nutrition
                                    </label>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Section param√®tres avanc√©s -->
            <div class="app-content profile-section" id="advanced-settings-section" style="display: none;">
                <div class="advanced-settings-container">
                    <div class="section-header">
                        <button class="back-btn" onclick="showMainProfile()">‚Üê Retour au profil</button>
                        <h2>Param√®tres avanc√©s</h2>
                    </div>
                    
                    <!-- Param√®tres de langue -->
                    <div class="language-settings">
                        <h3>üåê Langue et r√©gion</h3>
                        
                        <div class="setting-item">
                            <div class="setting-info">
                                <h4>Langue de l'interface</h4>
                                <p>Changer la langue de l'application</p>
                            </div>
                            <select class="language-selector" onchange="changeAppLanguage(this.value)" id="appLanguageSelect">
                                <option value="fr" selected>Fran√ßais üá´üá∑</option>
                                <option value="en">English üá∫üá∏</option>
                                <option value="nl">Nederlands üá≥üá±</option>
                                <option value="es">Espa√±ol üá™üá∏</option>
                                <option value="de">Deutsch üá©üá™</option>
                            </select>
                        </div>
                        
                        <div class="setting-item">
                            <div class="setting-info">
                                <h4>Format de date</h4>
                                <p>DD/MM/AAAA ou MM/DD/AAAA</p>
                            </div>
                            <select class="date-format-selector" onchange="changeDateFormat(this.value)">
                                <option value="dd/mm/yyyy" selected>DD/MM/AAAA</option>
                                <option value="mm/dd/yyyy">MM/DD/AAAA</option>
                                <option value="yyyy-mm-dd">AAAA-MM-DD</option>
                            </select>
                        </div>
                    </div>
                    
                    <!-- Param√®tres de confidentialit√© -->
                    <div class="privacy-settings">
                        <h3>üîê Confidentialit√© et s√©curit√©</h3>
                        
                        <div class="setting-item">
                            <div class="setting-info">
                                <h4>Donn√©es de sant√©</h4>
                                <p>Contr√¥ler l'utilisation de vos donn√©es de sant√©</p>
                            </div>
                            <button class="manage-btn" onclick="manageHealthDataPrivacy()">G√©rer</button>
                        </div>
                        
                        <div class="setting-item">
                            <div class="setting-info">
                                <h4>Partage de donn√©es anonymes</h4>
                                <p>Aider √† am√©liorer l'IA en partageant des donn√©es anonymis√©es</p>
                            </div>
                            <button class="toggle-switch active" onclick="toggleAnonymousDataSharing()">
                                <span class="switch-slider"></span>
                            </button>
                        </div>
                        
                        <div class="setting-item">
                            <div class="setting-info">
                                <h4>Authentification biom√©trique</h4>
                                <p>Utiliser empreinte/Face ID pour plus de s√©curit√©</p>
                            </div>
                            <button class="toggle-switch" onclick="toggleBiometricAuth()">
                                <span class="switch-slider"></span>
                            </button>
                        </div>
                        
                        <div class="setting-item">
                            <div class="setting-info">
                                <h4>Historique des donn√©es</h4>
                                <p>Voir et g√©rer vos donn√©es stock√©es</p>
                            </div>
                            <button class="manage-btn" onclick="manageDataHistory()">Consulter</button>
                        </div>
                    </div>
                    
                    <!-- Param√®tres d'accessibilit√© -->
                    <div class="accessibility-settings">
                        <h3>‚ôø Accessibilit√©</h3>
                        
                        <div class="setting-item">
                            <div class="setting-info">
                                <h4>Contraste √©lev√©</h4>
                                <p>Am√©liorer la lisibilit√© pour les malvoyants</p>
                            </div>
                            <button class="toggle-switch" onclick="toggleHighContrast()">
                                <span class="switch-slider"></span>
                            </button>
                        </div>
                        
                        <div class="setting-item">
                            <div class="setting-info">
                                <h4>Lecture vocale</h4>
                                <p>Activer la synth√®se vocale pour les textes</p>
                            </div>
                            <button class="toggle-switch" onclick="toggleTextToSpeech()">
                                <span class="switch-slider"></span>
                            </button>
                        </div>
                        
                        <div class="setting-item">
                            <div class="setting-info">
                                <h4>R√©duction des animations</h4>
                                <p>R√©duire les effets visuels qui peuvent d√©ranger</p>
                            </div>
                            <button class="toggle-switch" onclick="toggleReducedMotion()">
                                <span class="switch-slider"></span>
                            </button>
                        </div>
                    </div>
                    
                    <!-- Actions sur le compte -->
                    <div class="account-actions">
                        <h3>‚ö†Ô∏è Gestion du compte</h3>
                        
                        <div class="action-buttons">
                            <button class="export-btn" onclick="exportUserData()">
                                üì§ Exporter mes donn√©es
                            </button>
                            
                            <button class="reset-btn" onclick="resetAppData()">
                                üîÑ R√©initialiser l'application
                            </button>
                            
                            <button class="delete-btn" onclick="deleteAccount()">
                                üóëÔ∏è Supprimer mon compte
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Section analyse du stress et overthinking -->
            <div class="app-content profile-section" id="stress-analysis-section" style="display: none;">
                <div class="stress-analysis-container">
                    <div class="section-header">
                        <button class="back-btn" onclick="showMainProfile()">‚Üê Retour au profil</button>
                        <h2>Analyse stress & overthinking</h2>
                    </div>
                    
                    <!-- Questionnaire de stress -->
                    <div class="stress-questionnaire">
                        <h3>üìã √âvaluation compl√®te</h3>
                        <p>R√©pondez honn√™tement pour obtenir une analyse personnalis√©e</p>
                        
                        <div class="questionnaire-form" id="stressQuestionnaire">
                            <div class="question-card">
                                <h4>1. Niveau de stress g√©n√©ral (derni√®re semaine)</h4>
                                <div class="stress-scale">
                                    <input type="range" id="stressLevel" min="1" max="10" value="5" oninput="updateStressValue(this.value)">
                                    <div class="scale-labels">
                                        <span>Tr√®s faible</span>
                                        <span id="stressValue">5</span>
                                        <span>Tr√®s √©lev√©</span>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="question-card">
                                <h4>2. Fr√©quence de l'overthinking</h4>
                                <div class="radio-options">
                                    <label><input type="radio" name="overthinking" value="1"> Rarement</label>
                                    <label><input type="radio" name="overthinking" value="2"> Parfois</label>
                                    <label><input type="radio" name="overthinking" value="3" checked> Souvent</label>
                                    <label><input type="radio" name="overthinking" value="4"> Tr√®s souvent</label>
                                    <label><input type="radio" name="overthinking" value="5"> Constamment</label>
                                </div>
                            </div>
                            
                            <div class="question-card">
                                <h4>3. Sources principales de stress (s√©lectionner toutes celles qui s'appliquent)</h4>
                                <div class="checkbox-options">
                                    <label><input type="checkbox" value="travail"> Travail/√âtudes</label>
                                    <label><input type="checkbox" value="financier"> Probl√®mes financiers</label>
                                    <label><input type="checkbox" value="relations"> Relations personnelles</label>
                                    <label><input type="checkbox" value="sante"> Sant√©</label>
                                    <label><input type="checkbox" value="avenir"> Incertitude sur l'avenir</label>
                                    <label><input type="checkbox" value="social"> Pression sociale</label>
                                </div>
                            </div>
                            
                            <div class="question-card">
                                <h4>4. Impact sur votre quotidien</h4>
                                <div class="radio-options">
                                    <label><input type="radio" name="impact" value="1"> Aucun impact</label>
                                    <label><input type="radio" name="impact" value="2"> Impact l√©ger</label>
                                    <label><input type="radio" name="impact" value="3" checked> Impact mod√©r√©</label>
                                    <label><input type="radio" name="impact" value="4"> Impact important</label>
                                    <label><input type="radio" name="impact" value="5"> Impact tr√®s important</label>
                                </div>
                            </div>
                            
                            <div class="question-card">
                                <h4>5. Sympt√¥mes physiques ressentis</h4>
                                <div class="checkbox-options">
                                    <label><input type="checkbox" value="fatigue"> Fatigue chronique</label>
                                    <label><input type="checkbox" value="sommeil"> Troubles du sommeil</label>
                                    <label><input type="checkbox" value="tension"> Tensions musculaires</label>
                                    <label><input type="checkbox" value="digestif"> Probl√®mes digestifs</label>
                                    <label><input type="checkbox" value="mal-tete"> Maux de t√™te</label>
                                    <label><input type="checkbox" value="coeur"> Palpitations</label>
                                </div>
                            </div>
                        </div>
                        
                        <button class="analyze-btn" onclick="analyzeStressData()">üîç Analyser mes donn√©es</button>
                    </div>
                    
                    <!-- R√©sultats d'analyse -->
                    <div class="stress-results" id="stressResults" style="display: none;">
                        <h3>üìä Vos r√©sultats</h3>
                        
                        <div class="results-overview">
                            <div class="result-card stress-score">
                                <h4>Score de stress</h4>
                                <div class="score-display">
                                    <span class="score-number" id="overallStressScore">7.2</span>
                                    <span class="score-max">/10</span>
                                </div>
                                <div class="score-category" id="stressCategory">Niveau √©lev√©</div>
                            </div>
                            
                            <div class="result-card overthinking-score">
                                <h4>Indice d'overthinking</h4>
                                <div class="score-display">
                                    <span class="score-number" id="overthinkingScore">8.5</span>
                                    <span class="score-max">/10</span>
                                </div>
                                <div class="score-category" id="overthinkingCategory">Tr√®s √©lev√©</div>
                            </div>
                        </div>
                        
                        <div class="detailed-analysis">
                            <h4>üéØ Analyse d√©taill√©e</h4>
                            <div class="analysis-text" id="analysisText">
                                <!-- Texte g√©n√©r√© dynamiquement -->
                            </div>
                        </div>
                        
                        <div class="recommendations">
                            <h4>üí° Recommandations personnalis√©es</h4>
                            <div class="recommendation-list" id="recommendationList">
                                <!-- Recommandations g√©n√©r√©es dynamiquement -->
                            </div>
                        </div>
                        
                        <div class="action-plan">
                            <h4>üìã Plan d'action</h4>
                            <div class="plan-steps" id="actionPlan">
                                <!-- Plan g√©n√©r√© dynamiquement -->
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Section adaptation rythme de vie -->
            <div class="app-content profile-section" id="lifestyle-adapter-section" style="display: none;">
                <div class="lifestyle-container">
                    <div class="section-header">
                        <button class="back-btn" onclick="showMainProfile()">‚Üê Retour au profil</button>
                        <h2>Adaptation rythme de vie</h2>
                    </div>
                    
                    <!-- S√©lection du profil -->
                    <div class="profile-selector">
                        <h3>üë§ Votre profil</h3>
                        <p>S√©lectionnez votre situation principale pour une exp√©rience personnalis√©e</p>
                        
                        <div class="profile-options">
                            <div class="profile-card student" onclick="selectLifestyleProfile('student')">
                                <div class="profile-icon">üéì</div>
                                <h4>√âtudiant</h4>
                                <p>Coll√®ge, universit√©, √©tudes sup√©rieures</p>
                                <ul>
                                    <li>Examens et deadlines</li>
                                    <li>Horaires flexibles</li>
                                    <li>Budget √©tudiant</li>
                                    <li>Pression acad√©mique</li>
                                </ul>
                            </div>
                            
                            <div class="profile-card professional" onclick="selectLifestyleProfile('professional')">
                                <div class="profile-icon">üíº</div>
                                <h4>Professionnel</h4>
                                <p>Salari√©, freelance, entrepreneur</p>
                                <ul>
                                    <li>Horaires de bureau</li>
                                    <li>Responsabilit√©s</li>
                                    <li>√âquilibre vie pro/perso</li>
                                    <li>Stress professionnel</li>
                                </ul>
                            </div>
                            
                            <div class="profile-card mixed" onclick="selectLifestyleProfile('mixed')">
                                <div class="profile-icon">‚öñÔ∏è</div>
                                <h4>Mixte</h4>
                                <p>√âtudiant-travailleur, transition</p>
                                <ul>
                                    <li>Double contrainte</li>
                                    <li>Horaires variables</li>
                                    <li>Gestion du temps</li>
                                    <li>Stress multiple</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Configuration personnalis√©e -->
                    <div class="lifestyle-config" id="lifestyleConfig" style="display: none;">
                        <h3>‚öôÔ∏è Configuration personnalis√©e</h3>
                        
                        <div class="config-section">
                            <h4>üìÖ Horaires de disponibilit√©</h4>
                            <div class="schedule-config">
                                <div class="time-slot">
                                    <label>Matin (r√©veil - 12h)</label>
                                    <select id="morningAvailability">
                                        <option value="high">Tr√®s disponible</option>
                                        <option value="medium" selected>Moyennement disponible</option>
                                        <option value="low">Peu disponible</option>
                                        <option value="none">Indisponible</option>
                                    </select>
                                </div>
                                
                                <div class="time-slot">
                                    <label>Apr√®s-midi (12h - 18h)</label>
                                    <select id="afternoonAvailability">
                                        <option value="high">Tr√®s disponible</option>
                                        <option value="medium" selected>Moyennement disponible</option>
                                        <option value="low">Peu disponible</option>
                                        <option value="none">Indisponible</option>
                                    </select>
                                </div>
                                
                                <div class="time-slot">
                                    <label>Soir√©e (18h - 22h)</label>
                                    <select id="eveningAvailability">
                                        <option value="high" selected>Tr√®s disponible</option>
                                        <option value="medium">Moyennement disponible</option>
                                        <option value="low">Peu disponible</option>
                                        <option value="none">Indisponible</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                        
                        <div class="config-section">
                            <h4>üéØ Priorit√©s de well-being</h4>
                            <div class="priority-config">
                                <div class="priority-item">
                                    <label>Gestion du stress</label>
                                    <input type="range" min="1" max="5" value="4" id="stressPriority">
                                </div>
                                <div class="priority-item">
                                    <label>Am√©lioration du sommeil</label>
                                    <input type="range" min="1" max="5" value="3" id="sleepPriority">
                                </div>
                                <div class="priority-item">
                                    <label>Motivation et productivit√©</label>
                                    <input type="range" min="1" max="5" value="5" id="motivationPriority">
                                </div>
                                <div class="priority-item">
                                    <label>Relations sociales</label>
                                    <input type="range" min="1" max="5" value="2" id="socialPriority">
                                </div>
                            </div>
                        </div>
                        
                        <div class="config-section">
                            <h4>‚è∞ Dur√©e des sessions</h4>
                            <div class="session-duration">
                                <label>
                                    <input type="radio" name="sessionDuration" value="short" checked>
                                    Courtes (3-5 min) - Id√©al pour les pauses
                                </label>
                                <label>
                                    <input type="radio" name="sessionDuration" value="medium">
                                    Moyennes (10-15 min) - √âquilibre optimal
                                </label>
                                <label>
                                    <input type="radio" name="sessionDuration" value="long">
                                    Longues (20-30 min) - S√©ances approfondies
                                </label>
                            </div>
                        </div>
                        
                        <button class="save-config-btn" onclick="saveLifestyleConfiguration()">üíæ Sauvegarder ma configuration</button>
                    </div>
                    
                    <!-- Aper√ßu personnalis√© -->
                    <div class="personalized-preview" id="personalizedPreview" style="display: none;">
                        <h3>üé® Votre exp√©rience personnalis√©e</h3>
                        
                        <div class="preview-cards">
                            <div class="preview-card">
                                <h4>üîî Rappels adapt√©s</h4>
                                <p id="remindersPreview">Notifications ajust√©es √† vos horaires √©tudiants</p>
                            </div>
                            
                            <div class="preview-card">
                                <h4>üßò Exercices recommand√©s</h4>
                                <p id="exercisesPreview">Sessions courtes pour vos pauses entre cours</p>
                            </div>
                            
                            <div class="preview-card">
                                <h4>üìä Suivi personnalis√©</h4>
                                <p id="trackingPreview">M√©triques centr√©es sur la performance acad√©mique</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Nouveau √©cran Centre de recherche -->
            <div class="screen-content" id="research-center-screen" style="display: none;">
                <div class="research-center-container">
                    <div class="app-header">
                        <h1 class="app-title">Centre de recherche</h1>
                        <p class="subtitle">Donn√©es scientifiques sur le bien-√™tre mental</p>
                    </div>
                    
                    <div class="app-content">
                        <!-- Statistiques en temps r√©el -->
                        <div class="live-stats-section">
                            <h3>üìä Donn√©es en temps r√©el</h3>
                            <div class="stats-grid">
                                <div class="stat-item">
                                    <div class="stat-icon">üáßüá™</div>
                                    <div class="stat-content">
                                        <h4>Belgique</h4>
                                        <p class="stat-number">23%</p>
                                        <p class="stat-label">des adultes souffrent d'anxi√©t√©</p>
                                        <small>Source: Sciensano 2024</small>
                                    </div>
                                </div>
                                
                                <div class="stat-item">
                                    <div class="stat-icon">üéì</div>
                                    <div class="stat-content">
                                        <h4>√âtudiants</h4>
                                        <p class="stat-number">35%</p>
                                        <p class="stat-label">rapportent un stress √©lev√©</p>
                                        <small>Source: Enqu√™te universitaire 2024</small>
                                    </div>
                                </div>
                                
                                <div class="stat-item">
                                    <div class="stat-icon">üíº</div>
                                    <div class="stat-content">
                                        <h4>Professionnels</h4>
                                        <p class="stat-number">42%</p>
                                        <p class="stat-label">vivent un burnout</p>
                                        <small>Source: OMS 2024</small>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- √âtudes scientifiques -->
                        <div class="scientific-studies">
                            <h3>üî¨ √âtudes r√©centes</h3>
                            
                            <div class="study-card">
                                <div class="study-header">
                                    <h4>Impact de la m√©ditation sur l'anxi√©t√© √©tudiante</h4>
                                    <span class="study-date">Novembre 2024</span>
                                </div>
                                <p class="study-summary">
                                    Une √©tude de l'Universit√© de Louvain montre que 10 minutes de m√©ditation quotidienne 
                                    r√©duisent l'anxi√©t√© de 34% chez les √©tudiants en p√©riode d'examens.
                                </p>
                                <div class="study-metrics">
                                    <span class="metric">üìä 1,250 participants</span>
                                    <span class="metric">‚è±Ô∏è 8 semaines</span>
                                    <span class="metric">‚úÖ Peer-reviewed</span>
                                </div>
                                <button class="read-more-btn" onclick="showStudyDetails('meditation-anxiety')">Lire l'√©tude compl√®te</button>
                            </div>
                            
                            <div class="study-card">
                                <div class="study-header">
                                    <h4>Th√©rapies num√©riques pour la sant√© mentale</h4>
                                    <span class="study-date">Octobre 2024</span>
                                </div>
                                <p class="study-summary">
                                    Les applications de bien-√™tre mental montrent une efficacit√© de 67% 
                                    compar√©e aux th√©rapies traditionnelles pour les troubles l√©gers √† mod√©r√©s.
                                </p>
                                <div class="study-metrics">
                                    <span class="metric">üìä 5,000 participants</span>
                                    <span class="metric">‚è±Ô∏è 12 mois</span>
                                    <span class="metric">‚úÖ Multi-centres</span>
                                </div>
                                <button class="read-more-btn" onclick="showStudyDetails('digital-therapy')">Lire l'√©tude compl√®te</button>
                            </div>
                            
                            <div class="study-card">
                                <div class="study-header">
                                    <h4>Overthinking et performance cognitive</h4>
                                    <span class="study-date">Septembre 2024</span>
                                </div>
                                <p class="study-summary">
                                    Le surmenage mental r√©duit les performances cognitives de 28% et peut √™tre 
                                    efficacement trait√© par des techniques de pleine conscience cibl√©es.
                                </p>
                                <div class="study-metrics">
                                    <span class="metric">üìä 800 participants</span>
                                    <span class="metric">‚è±Ô∏è 6 mois</span>
                                    <span class="metric">‚úÖ Contr√¥le randomis√©</span>
                                </div>
                                <button class="read-more-btn" onclick="showStudyDetails('overthinking-performance')">Lire l'√©tude compl√®te</button>
                            </div>
                        </div>
                        
                        <!-- Tendances et insights -->
                        <div class="trends-section">
                            <h3>üìà Tendances et insights</h3>
                            
                            <div class="trend-item">
                                <div class="trend-icon">‚¨ÜÔ∏è</div>
                                <div class="trend-content">
                                    <h4>Augmentation des troubles anxieux</h4>
                                    <p>+15% depuis 2023 chez les 18-25 ans en Belgique</p>
                                    <div class="trend-actions">
                                        <span class="trend-tag urgent">Urgent</span>
                                        <button class="trend-btn" onclick="showTrendAnalysis('anxiety-increase')">Analyser</button>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="trend-item">
                                <div class="trend-icon">üí°</div>
                                <div class="trend-content">
                                    <h4>Adoption des solutions num√©riques</h4>
                                    <p>73% des jeunes pr√©f√®rent les apps aux consultations traditionnelles</p>
                                    <div class="trend-actions">
                                        <span class="trend-tag positive">Opportunit√©</span>
                                        <button class="trend-btn" onclick="showTrendAnalysis('digital-adoption')">Analyser</button>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="trend-item">
                                <div class="trend-icon">üéØ</div>
                                <div class="trend-content">
                                    <h4>Personnalisation des traitements</h4>
                                    <p>L'IA am√©liore l'efficacit√© des interventions de 45%</p>
                                    <div class="trend-actions">
                                        <span class="trend-tag innovation">Innovation</span>
                                        <button class="trend-btn" onclick="showTrendAnalysis('ai-personalization')">Analyser</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Contribution √† la recherche -->
                        <div class="research-contribution">
                            <h3>ü§ù Contribuer √† la recherche</h3>
                            <div class="contribution-card">
                                <h4>Participez √† nos √©tudes</h4>
                                <p>Vos donn√©es anonymis√©es aident √† am√©liorer le bien-√™tre mental pour tous</p>
                                <div class="contribution-benefits">
                                    <span class="benefit">üîí 100% anonyme</span>
                                    <span class="benefit">üéÅ R√©compenses exclusives</span>
                                    <span class="benefit">üìä Acc√®s aux r√©sultats</span>
                                </div>
                                <button class="contribute-btn" onclick="joinResearchProgram()">Rejoindre le programme</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Community Screen -->
            <div class="screen-content" id="community-screen">
                <div class="main-app">
                    <div class="app-header">
                        <h1 class="app-title">Communaut√©</h1>
                        <p class="date-text">Partagez et connectez-vous</p>
                        <button class="create-post-btn" onclick="createNewPost()">‚úèÔ∏è Nouveau post</button>
                    </div>
                    
                    <div class="app-content">
                        <div class="community-posts">
                            <div class="post-card">
                                <div class="post-header">
                                    <div class="post-avatar">M</div>
                                    <div class="post-info">
                                        <h3 class="post-author">Marie</h3>
                                        <p class="post-time">Il y a 2h</p>
                                    </div>
                                </div>
                                <div class="post-content">
                                    <p>Aujourd'hui j'ai commenc√© ma journ√©e avec une m√©ditation de 10 minutes. √áa fait vraiment du bien ! üå∏</p>
                                </div>
                                <div class="post-actions">
                                    <button class="action-btn" onclick="toggleLike(this)">‚ù§Ô∏è 12</button>
                                    <button class="action-btn" onclick="showComments(this)">üí¨ 3</button>
                                    <button class="action-btn" onclick="sharePost(this)">üì§</button>
                                </div>
                            </div>

                            <div class="post-card">
                                <div class="post-header">
                                    <div class="post-avatar">L</div>
                                    <div class="post-info">
                                        <h3 class="post-author">Laura</h3>
                                        <p class="post-time">Il y a 4h</p>
                                    </div>
                                </div>
                                <div class="post-content">
                                    <p>Des conseils pour g√©rer le stress au travail ? J'ai besoin de vos astuces ! üíº</p>
                                </div>
                                <div class="post-actions">
                                    <button class="action-btn" onclick="toggleLike(this)">‚ù§Ô∏è 8</button>
                                    <button class="action-btn" onclick="showComments(this)">üí¨ 7</button>
                                    <button class="action-btn" onclick="sharePost(this)">üì§</button>
                                </div>
                            </div>

                            <div class="post-card">
                                <div class="post-header">
                                    <div class="post-avatar">S</div>
                                    <div class="post-info">
                                        <h3 class="post-author">Sophie</h3>
                                        <p class="post-time">Il y a 6h</p>
                                    </div>
                                </div>
                                <div class="post-content">
                                    <p>Exercice de gratitude : 3 choses pour lesquelles je suis reconnaissante aujourd'hui üôè</p>
                                </div>
                                <div class="post-actions">
                                    <button class="action-btn" onclick="toggleLike(this)">‚ù§Ô∏è 15</button>
                                    <button class="action-btn" onclick="showComments(this)">üí¨ 5</button>
                                    <button class="action-btn" onclick="sharePost(this)">üì§</button>
                                </div>
                            </div>
                        </div>

                        <button class="new-post-btn">
                            <span>‚úçÔ∏è Nouveau post</span>
                        </button>
                    </div>
                </div>
            </div>
            </div>

            <!-- Bottom Navigation Bar - Responsive -->
            <div class="bottom-nav">
            <button class="bottom-nav-btn active" onclick="showScreen('welcome-screen')">
                <span class="nav-icon">üè†</span>
                <span class="nav-label">Accueil</span>
            </button>
            <button class="bottom-nav-btn" onclick="showScreen('dashboard-screen')">
                <span class="nav-icon">üìä</span>
                <span class="nav-label">Dashboard</span>
            </button>
            <button class="bottom-nav-btn" onclick="showScreen('login-screen')">
                <span class="nav-icon">üë§</span>
                <span class="nav-label">Compte</span>
            </button>
        </div>
        </div>
    </div>

    <script>
        // Haptic feedback for mobile
        function hapticFeedback(type = 'light') {
            if (navigator.vibrate) {
                switch(type) {
                    case 'light':
                        navigator.vibrate(10);
                        break;
                    case 'medium':
                        navigator.vibrate(20);
                        break;
                    case 'heavy':
                        navigator.vibrate([30, 10, 30]);
                        break;
                }
            }
        }

        // Touch events for better mobile interaction
        function addTouchEvents() {
            const touchElements = document.querySelectorAll('button, .menu-item, .action-btn');
            touchElements.forEach(element => {
                element.addEventListener('touchstart', function() {
                    hapticFeedback('light');
                }, { passive: true });
            });
        }

        // Toggle menu dropdown
        function toggleMenu() {
            const dropdown = document.getElementById('menuDropdown');
            if (dropdown) {
                dropdown.classList.toggle('active');
            }
        }

        // Upload profile photo
        function uploadPhoto() {
            const input = document.createElement('input');
            input.type = 'file';
            input.accept = 'image/*';
            input.onchange = function(e) {
                const file = e.target.files[0];
                if (file) {
                    const reader = new FileReader();
                    reader.onload = function(e) {
                        const profilePhoto = document.querySelector('.profile-photo');
                        if (profilePhoto) {
                            profilePhoto.style.backgroundImage = `url(${e.target.result})`;
                        }
                    };
                    reader.readAsDataURL(file);
                }
            };
            input.click();
        }

        // Record mood from quick buttons
        function recordMood(mood) {
            hapticFeedback('light');
            
            const messages = {
                'heureuse': 'Fantastique ! üòä Continuez √† cultiver cette joie !',
                'neutre': 'C\'est parfaitement normal üåô Chaque jour est diff√©rent.',
                'triste': 'Je comprends üåßÔ∏è Il est important d\'honorer vos √©motions.'
            };
            
            // Afficher un message de confirmation
            const notification = document.createElement('div');
            notification.style.cssText = `
                position: fixed;
                top: 50%;
                left: 50%;
                transform: translate(-50%, -50%);
                background: #4CAF50;
                color: white;
                padding: 20px;
                border-radius: 12px;
                text-align: center;
                z-index: 10000;
                max-width: 300px;
            `;
            notification.textContent = messages[mood] || 'Humeur enregistr√©e !';
            document.body.appendChild(notification);
            
            setTimeout(() => {
                document.body.removeChild(notification);
            }, 3000);
        }

        // ========== FONCTIONS COMMUNAUT√â ========== 

        // Like/Unlike un post
        function toggleLike(button) {
            hapticFeedback('light');
            
            const currentText = button.textContent;
            const isLiked = button.classList.contains('liked');
            
            if (isLiked) {
                // Unlike
                button.classList.remove('liked');
                const count = parseInt(currentText.match(/\d+/)[0]) - 1;
                button.textContent = `‚ù§Ô∏è ${count}`;
                button.style.color = '#666666';
            } else {
                // Like
                button.classList.add('liked');
                const count = parseInt(currentText.match(/\d+/)[0]) + 1;
                button.textContent = `‚ù§Ô∏è ${count}`;
                button.style.color = '#FF6B9D';
            }
        }

        // Afficher les commentaires d'un post
        function showComments(button) {
            hapticFeedback('light');
            
            const postCard = button.closest('.post-card');
            let commentSection = postCard.querySelector('.comment-section');
            
            if (commentSection) {
                // Basculer l'affichage
                commentSection.style.display = commentSection.style.display === 'none' ? 'block' : 'none';
            } else {
                // Cr√©er la section de commentaires
                commentSection = document.createElement('div');
                commentSection.className = 'comment-section';
                commentSection.innerHTML = `
                    <div class="comments-list">
                        <div class="comment">
                            <div class="comment-avatar">A</div>
                            <div class="comment-content">
                                <strong>Anna:</strong> Merci pour ce partage ! üòä
                            </div>
                        </div>
                        <div class="comment">
                            <div class="comment-avatar">L</div>
                            <div class="comment-content">
                                <strong>Lisa:</strong> C'est tr√®s inspirant üåü
                            </div>
                        </div>
                    </div>
                    <div class="comment-input-container">
                        <input type="text" class="comment-input" placeholder="√âcrire un commentaire...">
                        <button class="comment-send-btn" onclick="addComment(this)">üì§</button>
                    </div>
                `;
                postCard.appendChild(commentSection);
            }
        }

        // Partager un post
        function sharePost(button) {
            hapticFeedback('medium');
            
            const postCard = button.closest('.post-card');
            const author = postCard.querySelector('.post-author').textContent;
            const content = postCard.querySelector('.post-content p').textContent;
            
            if (navigator.share) {
                navigator.share({
                    title: `Post de ${author}`,
                    text: content,
                    url: window.location.href
                });
            } else {
                // Fallback pour les navigateurs qui ne supportent pas Web Share API
                const notification = document.createElement('div');
                notification.style.cssText = `
                    position: fixed;
                    top: 50%;
                    left: 50%;
                    transform: translate(-50%, -50%);
                    background: #4CAF50;
                    color: white;
                    padding: 20px;
                    border-radius: 12px;
                    text-align: center;
                    z-index: 10000;
                    max-width: 300px;
                `;
                notification.textContent = 'Lien copi√© dans le presse-papiers !';
                document.body.appendChild(notification);
                
                // Copier dans le presse-papier
                navigator.clipboard.writeText(window.location.href + '#community');
                
                setTimeout(() => {
                    document.body.removeChild(notification);
                }, 2000);
            }
        }

        // Ajouter un commentaire avec mod√©ration
        function addComment(button) {
            hapticFeedback('light');
            
            const commentInput = button.previousElementSibling;
            const comment = commentInput.value.trim();
            
            if (comment) {
                // Mod√©ration du commentaire
                const moderationResult = moderateMessage(comment, 'comment');
                
                if (!moderationResult.approved) {
                    // Commentaire bloqu√©
                    showModerationDialog(moderationResult);
                    
                    // Afficher un commentaire bloqu√©
                    const commentsList = button.closest('.comment-section').querySelector('.comments-list');
                    const blockedComment = document.createElement('div');
                    blockedComment.className = 'comment blocked-comment';
                    blockedComment.innerHTML = `
                        <div class="comment-avatar">ü§ñ</div>
                        <div class="comment-content message-blocked">
                            üö´ Commentaire filtr√© par l'IA de bien-√™tre
                        </div>
                    `;
                    commentsList.appendChild(blockedComment);
                    commentInput.value = '';
                    
                    // Ajouter une suggestion constructive
                    setTimeout(() => {
                        const suggestionComment = document.createElement('div');
                        suggestionComment.className = 'comment ai-comment';
                        suggestionComment.innerHTML = `
                            <div class="comment-avatar">üí°</div>
                            <div class="comment-content ai-suggestion">
                                ${moderationResult.supportMessage}
                            </div>
                        `;
                        commentsList.appendChild(suggestionComment);
                    }, 1000);
                    
                    return;
                }
                
                // Commentaire approuv√©
                const commentsList = button.closest('.comment-section').querySelector('.comments-list');
                const isAnonymous = localStorage.getItem('isAnonymous') === 'true';
                const userName = isAnonymous ? 'Utilisateur anonyme' : 'Vous';
                const userAvatar = isAnonymous ? 'üï∂Ô∏è' : (localStorage.getItem('profileName') ? localStorage.getItem('profileName')[0] : 'V');
                
                const newComment = document.createElement('div');
                newComment.className = 'comment';
                newComment.innerHTML = `
                    <div class="comment-avatar">${userAvatar}</div>
                    <div class="comment-content">
                        <strong>${userName}:</strong> ${comment}
                    </div>
                `;
                commentsList.appendChild(newComment);
                commentInput.value = '';
                
                // Animation d'apparition
                newComment.style.opacity = '0';
                newComment.style.transform = 'translateY(10px)';
                setTimeout(() => {
                    newComment.style.transition = 'all 0.3s ease';
                    newComment.style.opacity = '1';
                    newComment.style.transform = 'translateY(0)';
                }, 100);
            }
        }

        // Cr√©er un nouveau post avec mod√©ration
        function createNewPost() {
            hapticFeedback('medium');
            
            const postText = prompt('Que voulez-vous partager avec la communaut√© ?');
            if (postText && postText.trim()) {
                // Mod√©ration du post avant publication
                const moderationResult = moderateMessage(postText, 'community');
                
                if (!moderationResult.approved) {
                    // Post bloqu√© - afficher la modal de mod√©ration
                    showModerationDialog(moderationResult);
                    return;
                }
                
                // Post approuv√© - le publier
                const communityPosts = document.querySelector('.community-posts');
                const isAnonymous = localStorage.getItem('isAnonymous') === 'true';
                const userName = isAnonymous ? 'Utilisateur anonyme' : (localStorage.getItem('profileName') || 'Vous');
                const userAvatar = isAnonymous ? 'üï∂Ô∏è' : (localStorage.getItem('profileName') ? localStorage.getItem('profileName')[0] : 'V');
                
                const newPost = document.createElement('div');
                newPost.className = 'post-card';
                newPost.innerHTML = `
                    <div class="post-header">
                        <div class="post-avatar">${userAvatar}</div>
                        <div class="post-info">
                            <h3 class="post-author">${userName}</h3>
                            <p class="post-time">√Ä l'instant</p>
                        </div>
                    </div>
                    <div class="post-content">
                        <p>${postText}</p>
                    </div>
                    <div class="post-actions">
                        <button class="action-btn" onclick="toggleLike(this)">‚ù§Ô∏è 0</button>
                        <button class="action-btn" onclick="showComments(this)">üí¨ 0</button>
                        <button class="action-btn" onclick="sharePost(this)">üì§</button>
                    </div>
                `;
                
                // Ins√©rer en premi√®re position
                communityPosts.insertBefore(newPost, communityPosts.firstChild);
                
                // Animation d'apparition
                newPost.style.opacity = '0';
                newPost.style.transform = 'translateY(-20px)';
                setTimeout(() => {
                    newPost.style.transition = 'all 0.5s ease';
                    newPost.style.opacity = '1';
                    newPost.style.transform = 'translateY(0)';
                }, 100);
                
                // Notification de succ√®s avec message d'encouragement de l'IA
                const encouragementMessages = {
                    fr: '‚úÖ Post publi√© ! Merci de partager positivement avec la communaut√© üåü',
                    en: '‚úÖ Post published! Thank you for sharing positively with the community üåü',
                    nl: '‚úÖ Post gepubliceerd! Bedankt voor het positief delen met de gemeenschap üåü'
                };
                
                const currentLang = localStorage.getItem('currentLanguage') || 'fr';
                showNotification(encouragementMessages[currentLang], 'success');
            }
        }

        // ========== FONCTIONS PROFIL AVANC√â ========== 

        // Variables globales pour le profil
        let currentLanguage = 'fr';
        let isAnonymous = false;

        // Navigation entre les sections du profil
        function showMainProfile() {
            document.getElementById('main-profile-content').style.display = 'block';
            document.getElementById('create-profile-section').style.display = 'none';
            document.getElementById('mood-feedback-section').style.display = 'none';
            document.getElementById('language-settings-section').style.display = 'none';
            document.getElementById('anonymity-settings-section').style.display = 'none';
        }

        function showCreateProfile() {
            hapticFeedback('light');
            document.getElementById('main-profile-content').style.display = 'none';
            document.getElementById('create-profile-section').style.display = 'block';
        }

        function showMoodFeedback() {
            hapticFeedback('light');
            document.getElementById('main-profile-content').style.display = 'none';
            document.getElementById('mood-feedback-section').style.display = 'block';
        }

        function showLanguageSettings() {
            hapticFeedback('light');
            document.getElementById('main-profile-content').style.display = 'none';
            document.getElementById('language-settings-section').style.display = 'block';
        }

        function showAnonymitySettings() {
            hapticFeedback('light');
            document.getElementById('main-profile-content').style.display = 'none';
            document.getElementById('anonymity-settings-section').style.display = 'block';
        }

        function showProfileSettings() {
            hapticFeedback('light');
            
            const settingsHTML = `
                <div class="profile-settings-modal">
                    <div class="settings-modal-content">
                        <div class="settings-modal-header">
                            <h3>‚öôÔ∏è Param√®tres</h3>
                            <button class="close-btn" onclick="closeProfileSettings()">&times;</button>
                        </div>
                        
                        <div class="settings-modal-body">
                            <div class="settings-menu">
                                <button class="settings-menu-item" onclick="showStatisticsView(); closeProfileSettings();">
                                    <div class="menu-icon">${icons.heart}</div>
                                    <div class="menu-content">
                                        <h4>Statistiques visuelles</h4>
                                        <p>Graphiques et analyses de votre bien-√™tre</p>
                                    </div>
                                    <div class="menu-arrow">‚Ä∫</div>
                                </button>
                                
                                <button class="settings-menu-item" onclick="showReminderSettings(); closeProfileSettings();">
                                    <div class="menu-icon">${icons.clock}</div>
                                    <div class="menu-content">
                                        <h4>Rappels d'humeur</h4>
                                        <p>Configurer vos notifications de bien-√™tre</p>
                                    </div>
                                    <div class="menu-arrow">‚Ä∫</div>
                                </button>
                                
                                <button class="settings-menu-item" onclick="showLanguageSettings(); closeProfileSettings();">
                                    <div class="menu-icon">‚óå</div>
                                    <div class="menu-content">
                                        <h4>Langue</h4>
                                        <p>Fran√ßais, Anglais, Nederlands</p>
                                    </div>
                                    <div class="menu-arrow">‚Ä∫</div>
                                </button>
                                
                                <button class="settings-menu-item" onclick="showNotificationSettings();">
                                    <div class="menu-icon">${icons.bell}</div>
                                    <div class="menu-content">
                                        <h4>Notifications</h4>
                                        <p>G√©rer vos pr√©f√©rences de notification</p>
                                    </div>
                                    <div class="menu-arrow">‚Ä∫</div>
                                </button>
                                
                                <button class="settings-menu-item" onclick="showPrivacySettings();">
                                    <div class="menu-icon">‚óà</div>
                                    <div class="menu-content">
                                        <h4>Confidentialit√©</h4>
                                        <p>Param√®tres de confidentialit√© et donn√©es</p>
                                    </div>
                                    <div class="menu-arrow">‚Ä∫</div>
                                </button>
                                
                                <button class="settings-menu-item" onclick="exportUserData();">
                                    <div class="menu-icon">${icons.download}</div>
                                    <div class="menu-content">
                                        <h4>Mes donn√©es</h4>
                                        <p>Exporter ou supprimer vos donn√©es</p>
                                    </div>
                                    <div class="menu-arrow">‚Ä∫</div>
                                </button>
                            </div>
                            
                            <div class="settings-footer">
                                <p>Version 1.2.0 ‚Ä¢ MINDLY</p>
                                <p>D√©velopp√© avec üíô pour votre bien-√™tre</p>
                            </div>
                        </div>
                    </div>
                </div>
            `;
            
            document.body.insertAdjacentHTML('beforeend', settingsHTML);
        }
        
        function closeProfileSettings() {
            const modal = document.querySelector('.profile-settings-modal');
            if (modal) {
                document.body.removeChild(modal);
            }
        }
        
        function showNotificationSettings() {
            alert('‚ö†Ô∏è Fonctionnalit√© en d√©veloppement - Les param√®tres de notifications seront disponibles dans une future mise √† jour.');
            closeProfileSettings();
        }
        
        function showPrivacySettings() {
            alert('‚ö†Ô∏è Fonctionnalit√© en d√©veloppement - Les param√®tres de confidentialit√© seront disponibles dans une future mise √† jour.');
            closeProfileSettings();
        }
        
        function exportUserData() {
            alert('‚ö†Ô∏è Fonctionnalit√© en d√©veloppement - L\'export de donn√©es sera disponible dans une future mise √† jour.');
            closeProfileSettings();
        }

        // Upload de la carte d'identit√©
        function uploadIdCard() {
            hapticFeedback('medium');
            
            const input = document.createElement('input');
            input.type = 'file';
            input.accept = 'image/*,.pdf';
            input.onchange = function(e) {
                const file = e.target.files[0];
                if (file) {
                    // Simuler l'upload
                    setTimeout(() => {
                        document.getElementById('uploadStatus').style.display = 'block';
                        
                        const notification = document.createElement('div');
                        notification.style.cssText = `
                            position: fixed;
                            top: 20px;
                            left: 50%;
                            transform: translateX(-50%);
                            background: #4CAF50;
                            color: white;
                            padding: 16px 24px;
                            border-radius: 12px;
                            z-index: 10000;
                            font-weight: 600;
                        `;
                        notification.textContent = 'üìÑ Document v√©rifi√© avec succ√®s !';
                        document.body.appendChild(notification);
                        
                        setTimeout(() => {
                            document.body.removeChild(notification);
                        }, 3000);
                    }, 1500);
                }
            };
            input.click();
        }

        // Cr√©er un nouveau profil
        function createNewProfile(event) {
            event.preventDefault();
            hapticFeedback('medium');
            
            const fullName = document.getElementById('fullName').value;
            const email = document.getElementById('email').value;
            const language = document.getElementById('profileLanguage').value;
            const anonymous = document.getElementById('anonymousMode').checked;
            
            if (!fullName || !email) {
                alert('Veuillez remplir tous les champs obligatoires.');
                return;
            }
            
            // Sauvegarder le profil
            localStorage.setItem('profileName', fullName);
            localStorage.setItem('profileEmail', email);
            localStorage.setItem('currentLanguage', language);
            localStorage.setItem('isAnonymous', anonymous.toString());
            
            // Mettre √† jour l'interface
            document.getElementById('profileName').textContent = fullName;
            document.getElementById('profileEmail').textContent = email;
            updateLanguageDisplay(language);
            updateAnonymityStatus(anonymous);
            
            // Notification de succ√®s
            const notification = document.createElement('div');
            notification.style.cssText = `
                position: fixed;
                top: 20px;
                left: 50%;
                transform: translateX(-50%);
                background: #4CAF50;
                color: white;
                padding: 16px 24px;
                border-radius: 12px;
                z-index: 10000;
                font-weight: 600;
            `;
            notification.textContent = 'üéâ Profil cr√©√© avec succ√®s !';
            document.body.appendChild(notification);
            
            setTimeout(() => {
                document.body.removeChild(notification);
                showMainProfile();
            }, 2000);
        }

        // S√©lection de langue
        function selectLanguage(lang) {
            hapticFeedback('light');
            
            // Retirer la classe active de tous les boutons
            document.querySelectorAll('.language-option').forEach(btn => {
                btn.classList.remove('active');
                btn.querySelector('.check-icon')?.remove();
            });
            
            // Ajouter la classe active au bouton s√©lectionn√©
            event.target.closest('.language-option').classList.add('active');
            const checkIcon = document.createElement('span');
            checkIcon.className = 'check-icon';
            checkIcon.textContent = '‚úì';
            event.target.closest('.language-option').appendChild(checkIcon);
            
            // Sauvegarder et mettre √† jour
            currentLanguage = lang;
            localStorage.setItem('currentLanguage', lang);
            updateLanguageDisplay(lang);
            
            // Notification
            const langNames = { fr: 'Fran√ßais', nl: 'Nederlands', en: 'English' };
            const notification = document.createElement('div');
            notification.style.cssText = `
                position: fixed;
                top: 20px;
                left: 50%;
                transform: translateX(-50%);
                background: #4CAF50;
                color: white;
                padding: 16px 24px;
                border-radius: 12px;
                z-index: 10000;
                font-weight: 600;
            `;
            notification.textContent = `‚úÖ Langue chang√©e : ${langNames[lang]}`;
            document.body.appendChild(notification);
            
            setTimeout(() => {
                document.body.removeChild(notification);
            }, 2000);
        }

        // Mettre √† jour l'affichage de la langue
        function updateLanguageDisplay(lang) {
            const langNames = { fr: 'Fran√ßais', nl: 'Nederlands', en: 'English' };
            const currentLangElement = document.getElementById('currentLanguage');
            if (currentLangElement) {
                currentLangElement.textContent = langNames[lang] || 'Fran√ßais';
            }
        }

        // Param√®tres d'anonymat
        function setAnonymity(anonymous) {
            hapticFeedback('medium');
            
            isAnonymous = anonymous;
            localStorage.setItem('isAnonymous', anonymous.toString());
            
            // Mettre √† jour les boutons
            document.getElementById('visibleBtn').classList.toggle('secondary', anonymous);
            document.getElementById('anonymousBtn').classList.toggle('secondary', !anonymous);
            
            // Mettre √† jour l'aper√ßu
            updateAnonymityPreview(anonymous);
            updateAnonymityStatus(anonymous);
            
            const message = anonymous ? 'Mode anonyme activ√©' : 'Profil visible activ√©';
            const notification = document.createElement('div');
            notification.style.cssText = `
                position: fixed;
                top: 20px;
                left: 50%;
                transform: translateX(-50%);
                background: #4CAF50;
                color: white;
                padding: 16px 24px;
                border-radius: 12px;
                z-index: 10000;
                font-weight: 600;
            `;
            notification.textContent = `${anonymous ? 'üï∂Ô∏è' : 'üëÅÔ∏è'} ${message}`;
            document.body.appendChild(notification);
            
            setTimeout(() => {
                document.body.removeChild(notification);
            }, 2000);
        }

        // Mettre √† jour l'aper√ßu d'anonymat
        function updateAnonymityPreview(anonymous) {
            const previewName = document.getElementById('previewName');
            const previewAvatar = document.getElementById('previewAvatar');
            
            if (anonymous) {
                previewName.textContent = 'Utilisateur anonyme';
                previewAvatar.textContent = 'üï∂Ô∏è';
            } else {
                const profileName = localStorage.getItem('profileName') || 'Sarah Martin';
                previewName.textContent = profileName;
                previewAvatar.textContent = profileName[0];
            }
        }

        // Mettre √† jour le statut d'anonymat
        function updateAnonymityStatus(anonymous) {
            const statusElement = document.getElementById('anonymityStatus');
            if (statusElement) {
                if (anonymous) {
                    statusElement.innerHTML = 'üï∂Ô∏è Mode anonyme activ√©';
                    statusElement.style.background = 'rgba(255, 152, 0, 0.1)';
                    statusElement.style.color = '#FF9800';
                } else {
                    statusElement.innerHTML = 'üëÅÔ∏è Visible dans la communaut√©';
                    statusElement.style.background = 'rgba(76, 175, 80, 0.1)';
                    statusElement.style.color = '#4CAF50';
                }
            }
        }

        // Initialiser le profil au chargement
        function initializeProfile() {
            // Charger les donn√©es du profil depuis localStorage
            const profileName = localStorage.getItem('profileName');
            const profileEmail = localStorage.getItem('profileEmail');
            const savedLanguage = localStorage.getItem('currentLanguage') || 'fr';
            const savedAnonymity = localStorage.getItem('isAnonymous') === 'true';
            
            if (profileName) {
                document.getElementById('profileName').textContent = profileName;
            }
            if (profileEmail) {
                document.getElementById('profileEmail').textContent = profileEmail;
            }
            
            currentLanguage = savedLanguage;
            isAnonymous = savedAnonymity;
            
            updateLanguageDisplay(savedLanguage);
            updateAnonymityStatus(savedAnonymity);
            updateAnonymityPreview(savedAnonymity);
        }

        // Initialiser la mod√©ration IA
        function initializeModerationSystem() {
            // Afficher l'indicateur de mod√©ration active
            const indicator = document.createElement('div');
            indicator.className = 'moderation-indicator';
            indicator.innerHTML = 'ü§ñ IA Bien-√™tre active';
            document.body.appendChild(indicator);
            
            // Masquer l'indicateur apr√®s 3 secondes
            setTimeout(() => {
                if (document.body.contains(indicator)) {
                    indicator.style.animation = 'fadeOutRight 0.5s ease';
                    setTimeout(() => {
                        if (document.body.contains(indicator)) {
                            document.body.removeChild(indicator);
                        }
                    }, 500);
                }
            }, 3000);
            
            // Message de bienvenue de l'IA
            const welcomeMessages = {
                fr: "ü§ñ Bonjour ! Je suis votre assistant de bien-√™tre. Je veille √† maintenir un environnement bienveillant pour tous.",
                en: "ü§ñ Hello! I'm your wellness assistant. I help maintain a caring environment for everyone.",
                nl: "ü§ñ Hallo! Ik ben je welzijnsassistent. Ik help een zorgzame omgeving voor iedereen te behouden."
            };
            
            const currentLang = localStorage.getItem('currentLanguage') || 'fr';
            console.log(welcomeMessages[currentLang]);
        }

        // Ajouter une fonction d'aide rapide pour la mod√©ration
        function showModerationHelp() {
            const helpMessages = {
                fr: {
                    title: "ü§ñ Assistant IA de Bien-√™tre",
                    content: `
                        <p><strong>Je suis l√† pour vous aider :</strong></p>
                        <ul>
                            <li>‚úÖ Filtrer les contenus inappropri√©s</li>
                            <li>üíô Vous accompagner dans les moments difficiles</li>
                            <li>üåü Encourager les interactions positives</li>
                            <li>üÜò Vous orienter vers l'aide professionnelle si n√©cessaire</li>
                        </ul>
                        <p><em>Votre bien-√™tre est ma priorit√© !</em></p>
                    `
                },
                en: {
                    title: "ü§ñ AI Wellness Assistant",
                    content: `
                        <p><strong>I'm here to help you:</strong></p>
                        <ul>
                            <li>‚úÖ Filter inappropriate content</li>
                            <li>üíô Support you during difficult times</li>
                            <li>üåü Encourage positive interactions</li>
                            <li>üÜò Guide you to professional help if needed</li>
                        </ul>
                        <p><em>Your wellbeing is my priority!</em></p>
                    `
                },
                nl: {
                    title: "ü§ñ AI Welzijns Assistent",
                    content: `
                        <p><strong>Ik ben er om je te helpen:</strong></p>
                        <ul>
                            <li>‚úÖ Ongepaste inhoud filteren</li>
                            <li>üíô Je ondersteunen in moeilijke tijden</li>
                            <li>üåü Positieve interacties aanmoedigen</li>
                            <li>üÜò Je naar professionele hulp leiden indien nodig</li>
                        </ul>
                        <p><em>Jouw welzijn is mijn prioriteit!</em></p>
                    `
                }
            };
            
            const currentLang = localStorage.getItem('currentLanguage') || 'fr';
            const help = helpMessages[currentLang];
            
            const modal = document.createElement('div');
            modal.className = 'moderation-modal';
            modal.innerHTML = `
                <div class="moderation-content">
                    <div class="moderation-header">
                        <h3>${help.title}</h3>
                        <button class="close-btn" onclick="closeModerationModal()">&times;</button>
                    </div>
                    <div class="moderation-body">
                        ${help.content}
                        <div class="moderation-actions">
                            <button class="btn-primary" onclick="closeModerationModal()">
                                Merci pour votre aide ! üíô
                            </button>
                        </div>
                    </div>
                </div>
            `;
            
            document.body.appendChild(modal);
            modal.style.display = 'flex';
            setTimeout(() => modal.classList.add('show'), 100);
        }

        // Ajouter des CSS pour l'animation de disparition
        const additionalCSS = `
            @keyframes fadeOutRight {
                from {
                    opacity: 1;
                    transform: translateX(0);
                }
                to {
                    opacity: 0;
                    transform: translateX(100%);
                }
            }
        `;
        
        const style = document.createElement('style');
        style.textContent = additionalCSS;
        document.head.appendChild(style);

        // ========== SYST√àME DE DIAGNOSTIC D'HUMEUR IA ========== 

        // Variables globales pour le suivi d'humeur
        let currentMoodData = {
            sadness: 5,
            joy: 5,
            energy: 5,
            sensitivity: 5,
            irritability: 5,
            moodSwings: 5,
            anger: 5,
            confidence: 5,
            enthusiasm: 5,
            anxiety: 5,
            indifference: 5,
            context: '',
            timestamp: null
        };

        let moodHistory = JSON.parse(localStorage.getItem('moodHistory')) || [];

        // Navigation entre les sections
        function showMoodSection(sectionName) {
            // Masquer toutes les sections
            document.querySelectorAll('.mood-section').forEach(section => {
                section.classList.remove('active');
                section.style.display = 'none';
            });
            
            // Masquer tous les boutons actifs
            document.querySelectorAll('.mood-nav-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            
            // Afficher la section s√©lectionn√©e
            const targetSection = document.getElementById(sectionName + '-section');
            if (targetSection) {
                targetSection.classList.add('active');
                targetSection.style.display = 'block';
            }
            
            // Activer le bouton correspondant
            const targetBtn = document.getElementById(sectionName.substring(0, 4) + 'Btn');
            if (targetBtn) {
                targetBtn.classList.add('active');
            }
            
            hapticFeedback('light');
        }

        // Mettre √† jour les valeurs des dimensions
        function updateDimension(dimension, value) {
            hapticFeedback('light');
            
            // Mettre √† jour la valeur affich√©e
            const valueElement = document.getElementById(dimension + '-value');
            if (valueElement) {
                valueElement.textContent = value;
            }
            
            // Sauvegarder dans les donn√©es actuelles
            currentMoodData[dimension.replace('-', '')] = parseInt(value);
            
            // Animation du curseur
            const slider = document.getElementById(dimension + '-slider');
            if (slider) {
                const percentage = (value / 10) * 100;
                slider.style.background = `linear-gradient(to right, #FF6B9D 0%, #4ECDC4 ${percentage}%, #E8E8E8 ${percentage}%, #E8E8E8 100%)`;
            }
        }

        // Analyser l'humeur avec l'IA
        function analyzeMoodWithAI() {
            hapticFeedback('medium');
            
            // R√©cup√©rer le contexte
            const contextInput = document.getElementById('mood-context');
            currentMoodData.context = contextInput ? contextInput.value : '';
            currentMoodData.timestamp = new Date().toISOString();
            
            // Sauvegarder l'entr√©e
            moodHistory.push({...currentMoodData});
            localStorage.setItem('moodHistory', JSON.stringify(moodHistory));
            
            // Afficher l'√©tat d'analyse
            const aiStatus = document.getElementById('ai-status');
            if (aiStatus) {
                aiStatus.textContent = 'üîÑ Analyse en cours...';
                aiStatus.className = 'ai-status analyzing';
            }
            
            // Simuler l'analyse IA
            setTimeout(() => {
                const diagnosis = generateAIDiagnosis(currentMoodData);
                displayDiagnosis(diagnosis);
                
                const exercises = generatePersonalizedExercises(currentMoodData);
                displayExercises(exercises);
                
                updateTrackingCharts();
                
                if (aiStatus) {
                    aiStatus.textContent = '‚úÖ Analyse termin√©e';
                    aiStatus.className = 'ai-status completed';
                }
                
                // Passer automatiquement au diagnostic
                showMoodSection('diagnostic');
                
                showNotification('üß† Analyse IA termin√©e ! Consultez votre diagnostic personnalis√©.', 'success');
            }, 3000);
            
            showNotification('üîÑ Analyse de votre humeur en cours...', 'info');
        }

        // G√©n√©rer un diagnostic IA personnalis√©
        function generateAIDiagnosis(moodData) {
            const currentLang = localStorage.getItem('currentLanguage') || 'fr';
            
            // Calculer les scores de risque
            const depressionRisk = calculateDepressionRisk(moodData);
            const anxietyRisk = calculateAnxietyRisk(moodData);
            const moodStabilityRisk = calculateMoodStabilityRisk(moodData);
            const energyLevel = calculateEnergyLevel(moodData);
            
            // G√©n√©rer les insights personnalis√©s
            const insights = generateMoodInsights(moodData, currentLang);
            
            return {
                overallScore: calculateOverallWellbeing(moodData),
                risks: {
                    depression: depressionRisk,
                    anxiety: anxietyRisk,
                    moodStability: moodStabilityRisk
                },
                energyLevel: energyLevel,
                insights: insights,
                recommendations: generateRecommendations(moodData, currentLang),
                trends: analyzeTrends(moodHistory),
                alerts: generateAlerts(moodData, currentLang)
            };
        }

        // Calculer le risque de d√©pression
        function calculateDepressionRisk(data) {
            const sadnessWeight = data.sadness * 0.3;
            const joyWeight = (10 - data.joy) * 0.25;
            const energyWeight = (10 - data.energy) * 0.2;
            const indifferenceWeight = data.indifference * 0.15;
            const confidenceWeight = (10 - data.confidence) * 0.1;
            
            const riskScore = (sadnessWeight + joyWeight + energyWeight + indifferenceWeight + confidenceWeight) / 10;
            
            if (riskScore > 7) return { level: 'high', score: riskScore };
            if (riskScore > 4) return { level: 'medium', score: riskScore };
            return { level: 'low', score: riskScore };
        }

        // Calculer le risque d'anxi√©t√©
        function calculateAnxietyRisk(data) {
            const anxietyWeight = data.anxiety * 0.4;
            const irritabilityWeight = data.irritability * 0.2;
            const sensitivityWeight = data.sensitivity * 0.15;
            const moodSwingsWeight = data.moodSwings * 0.15;
            const energyWeight = data.energy > 7 ? (data.energy - 7) * 0.1 : 0;
            
            const riskScore = (anxietyWeight + irritabilityWeight + sensitivityWeight + moodSwingsWeight + energyWeight) / 10;
            
            if (riskScore > 7) return { level: 'high', score: riskScore };
            if (riskScore > 4) return { level: 'medium', score: riskScore };
            return { level: 'low', score: riskScore };
        }

        // Calculer la stabilit√© d'humeur
        function calculateMoodStabilityRisk(data) {
            const moodSwingsWeight = data.moodSwings * 0.4;
            const irritabilityWeight = data.irritability * 0.3;
            const angerWeight = data.anger * 0.2;
            const sensitivityWeight = data.sensitivity * 0.1;
            
            const instabilityScore = (moodSwingsWeight + irritabilityWeight + angerWeight + sensitivityWeight) / 10;
            
            if (instabilityScore > 7) return { level: 'high', score: instabilityScore };
            if (instabilityScore > 4) return { level: 'medium', score: instabilityScore };
            return { level: 'low', score: instabilityScore };
        }

        // Calculer le niveau d'√©nergie
        function calculateEnergyLevel(data) {
            const energyScore = data.energy;
            const enthusiasmBonus = data.enthusiasm > 6 ? (data.enthusiasm - 6) * 0.5 : 0;
            const sadnessPenalty = data.sadness > 6 ? (data.sadness - 6) * 0.3 : 0;
            
            const finalScore = Math.min(10, Math.max(0, energyScore + enthusiasmBonus - sadnessPenalty));
            
            if (finalScore > 7) return { level: 'high', score: finalScore };
            if (finalScore > 4) return { level: 'normal', score: finalScore };
            return { level: 'low', score: finalScore };
        }

        // Calculer le bien-√™tre g√©n√©ral
        function calculateOverallWellbeing(data) {
            const positiveFactors = (data.joy + data.confidence + data.enthusiasm + data.energy) / 4;
            const negativeFactors = (data.sadness + data.anxiety + data.anger + data.indifference) / 4;
            const stabilityFactors = (10 - data.moodSwings + 10 - data.irritability) / 2;
            
            const overallScore = (positiveFactors * 0.4 + (10 - negativeFactors) * 0.4 + stabilityFactors * 0.2);
            
            return Math.round(overallScore * 10) / 10;
        }

        // G√©n√©rer des insights personnalis√©s
        function generateMoodInsights(data, lang) {
            const insights = [];
            
            const insightTemplates = {
                fr: {
                    highSadness: "Votre niveau de tristesse est √©lev√©. Il est important de reconna√Ætre et d'accepter ces √©motions.",
                    lowJoy: "Votre joie semble limit√©e. Essayez de vous concentrer sur de petites choses positives.",
                    highAnxiety: "Votre anxi√©t√© est pr√©occupante. Des techniques de relaxation pourraient vous aider.",
                    lowEnergy: "Votre √©nergie est faible. Accordez-vous du repos et veillez √† votre sommeil.",
                    highMoodSwings: "Vos sauts d'humeur sont fr√©quents. La r√©gularit√© dans vos activit√©s peut aider.",
                    lowConfidence: "Votre confiance pourrait √™tre renforc√©e. C√©l√©brez vos petites victoires.",
                    balancedMood: "Votre humeur semble relativement √©quilibr√©e aujourd'hui.",
                    needsSupport: "Votre profil sugg√®re qu'un soutien professionnel pourrait √™tre b√©n√©fique."
                },
                en: {
                    highSadness: "Your sadness level is high. It's important to acknowledge and accept these emotions.",
                    lowJoy: "Your joy seems limited. Try focusing on small positive things.",
                    highAnxiety: "Your anxiety is concerning. Relaxation techniques could help you.",
                    lowEnergy: "Your energy is low. Give yourself rest and take care of your sleep.",
                    highMoodSwings: "Your mood swings are frequent. Regularity in activities can help.",
                    lowConfidence: "Your confidence could be strengthened. Celebrate your small victories.",
                    balancedMood: "Your mood seems relatively balanced today.",
                    needsSupport: "Your profile suggests professional support could be beneficial."
                },
                nl: {
                    highSadness: "Je niveau van verdriet is hoog. Het is belangrijk om deze emoties te erkennen en accepteren.",
                    lowJoy: "Je vreugde lijkt beperkt. Probeer je te concentreren op kleine positieve dingen.",
                    highAnxiety: "Je angst is zorgwekkend. Ontspanningstechnieken kunnen je helpen.",
                    lowEnergy: "Je energie is laag. Gun jezelf rust en zorg voor je slaap.",
                    highMoodSwings: "Je stemmingswisselingen zijn frequent. Regelmaat in activiteiten kan helpen.",
                    lowConfidence: "Je zelfvertrouwen kan worden versterkt. Vier je kleine overwinningen.",
                    balancedMood: "Je stemming lijkt relatief gebalanceerd vandaag.",
                    needsSupport: "Je profiel suggereert dat professionele ondersteuning gunstig zou kunnen zijn."
                }
            };
            
            const templates = insightTemplates[lang] || insightTemplates.fr;
            
            // Analyser les donn√©es et g√©n√©rer des insights
            if (data.sadness > 7) insights.push(templates.highSadness);
            if (data.joy < 4) insights.push(templates.lowJoy);
            if (data.anxiety > 7) insights.push(templates.highAnxiety);
            if (data.energy < 4) insights.push(templates.lowEnergy);
            if (data.moodSwings > 7) insights.push(templates.highMoodSwings);
            if (data.confidence < 4) insights.push(templates.lowConfidence);
            
            // Si le profil est √† risque
            const overallRisk = (data.sadness + data.anxiety + data.anger + 10 - data.joy + 10 - data.confidence) / 5;
            if (overallRisk > 7) insights.push(templates.needsSupport);
            
            // Si relativement √©quilibr√©
            if (insights.length === 0) insights.push(templates.balancedMood);
            
            return insights;
        }

        // G√©n√©rer des recommandations
        function generateRecommendations(data, lang) {
            const recommendations = [];
            
            const recTemplates = {
                fr: {
                    meditation: "üßò‚Äç‚ôÄÔ∏è Essayez 10 minutes de m√©ditation quotidienne",
                    exercise: "üèÉ‚Äç‚ôÄÔ∏è Une activit√© physique douce peut am√©liorer votre humeur",
                    social: "üë• Connectez-vous avec vos proches",
                    sleep: "üò¥ Veillez √† avoir un sommeil de qualit√© (7-8h)",
                    professional: "üë®‚Äç‚öïÔ∏è Consid√©rez consulter un professionnel de sant√© mentale",
                    breathing: "üå¨Ô∏è Pratiquez des exercices de respiration",
                    journaling: "üìî Tenez un journal de vos √©motions",
                    nature: "üå≥ Passez du temps dans la nature"
                },
                // Ajouter autres langues...
            };
            
            const templates = recTemplates[lang] || recTemplates.fr;
            
            if (data.anxiety > 6) recommendations.push(templates.meditation, templates.breathing);
            if (data.sadness > 6) recommendations.push(templates.social, templates.exercise);
            if (data.energy < 4) recommendations.push(templates.sleep, templates.nature);
            if (data.moodSwings > 6) recommendations.push(templates.journaling);
            
            // Si situation critique
            const criticalScore = (data.sadness + data.anxiety + data.anger) / 3;
            if (criticalScore > 8) recommendations.push(templates.professional);
            
            return recommendations.slice(0, 4); // Limiter √† 4 recommandations
        }

        // Afficher le diagnostic
        function displayDiagnosis(diagnosis) {
            const resultsContainer = document.getElementById('diagnostic-results');
            if (!resultsContainer) return;
            
            const riskLevelClass = {
                'low': 'risk-low',
                'medium': 'risk-medium', 
                'high': 'risk-high'
            };
            
            resultsContainer.innerHTML = `
                <div class="diagnostic-card">
                    <h4 class="diagnostic-title">üéØ Score de bien-√™tre g√©n√©ral</h4>
                    <div class="diagnostic-content">
                        <div class="wellbeing-score" style="text-align: center; margin: 16px 0;">
                            <div style="font-size: 48px; font-weight: bold; color: #FF6B9D;">${diagnosis.overallScore}/10</div>
                            <p>Votre niveau de bien-√™tre √©motionnel</p>
                        </div>
                    </div>
                </div>
                
                <div class="diagnostic-card">
                    <h4 class="diagnostic-title">‚ö†Ô∏è √âvaluation des risques</h4>
                    <div class="diagnostic-content">
                        <div style="margin-bottom: 12px;">
                            <span class="risk-indicator ${riskLevelClass[diagnosis.risks.depression.level]}">
                                D√©pression: ${diagnosis.risks.depression.level === 'low' ? 'Faible' : diagnosis.risks.depression.level === 'medium' ? 'Mod√©r√©' : '√âlev√©'}
                            </span>
                        </div>
                        <div style="margin-bottom: 12px;">
                            <span class="risk-indicator ${riskLevelClass[diagnosis.risks.anxiety.level]}">
                                Anxi√©t√©: ${diagnosis.risks.anxiety.level === 'low' ? 'Faible' : diagnosis.risks.anxiety.level === 'medium' ? 'Mod√©r√©' : '√âlev√©'}
                            </span>
                        </div>
                        <div>
                            <span class="risk-indicator ${riskLevelClass[diagnosis.risks.moodStability.level]}">
                                Stabilit√©: ${diagnosis.risks.moodStability.level === 'low' ? 'Bonne' : diagnosis.risks.moodStability.level === 'medium' ? 'Moyenne' : 'Instable'}
                            </span>
                        </div>
                    </div>
                </div>
                
                <div class="diagnostic-card">
                    <h4 class="diagnostic-title">üí° Insights personnalis√©s</h4>
                    <div class="diagnostic-content">
                        ${diagnosis.insights.map(insight => `<p>‚Ä¢ ${insight}</p>`).join('')}
                    </div>
                </div>
                
                <div class="diagnostic-card">
                    <h4 class="diagnostic-title">üéØ Recommandations</h4>
                    <div class="diagnostic-content">
                        ${diagnosis.recommendations.map(rec => `<p>${rec}</p>`).join('')}
                    </div>
                </div>
            `;
        }

        // G√©n√©rer des exercices personnalis√©s
        function generatePersonalizedExercises(data) {
            const exercises = [];
            
            // Exercices bas√©s sur le profil
            if (data.anxiety > 6) {
                exercises.push({
                    title: "Respiration 4-7-8",
                    icon: "üå¨Ô∏è",
                    duration: "5 min",
                    description: "Technique de respiration pour r√©duire l'anxi√©t√©. Inspirez 4s, retenez 7s, expirez 8s.",
                    type: "breathing"
                });
            }
            
            if (data.sadness > 6) {
                exercises.push({
                    title: "Gratitude quotidienne",
                    icon: "üôè",
                    duration: "3 min",
                    description: "Listez 3 choses pour lesquelles vous √™tes reconnaissant(e) aujourd'hui.",
                    type: "gratitude"
                });
            }
            
            if (data.energy < 4) {
                exercises.push({
                    title: "Marche √©nergisante",
                    icon: "üö∂‚Äç‚ôÄÔ∏è",
                    duration: "10 min",
                    description: "Une courte marche √† l'ext√©rieur pour booster votre √©nergie naturellement.",
                    type: "movement"
                });
            }
            
            if (data.moodSwings > 6) {
                exercises.push({
                    title: "M√©ditation de stabilit√©",
                    icon: "üßò‚Äç‚ôÄÔ∏è",
                    duration: "8 min",
                    description: "M√©ditation guid√©e pour retrouver votre √©quilibre √©motionnel.",
                    type: "meditation"
                });
            }
            
            // Toujours inclure un exercice de base
            exercises.push({
                title: "Check-in √©motionnel",
                icon: "üí≠",
                duration: "2 min",
                description: "Prenez un moment pour observer vos √©motions sans jugement.",
                type: "awareness"
            });
            
            return exercises.slice(0, 4); // Maximum 4 exercices
        }

        // Afficher les exercices
        function displayExercises(exercises) {
            const exercisesContainer = document.getElementById('recommended-exercises');
            if (!exercisesContainer) return;
            
            exercisesContainer.innerHTML = exercises.map(exercise => `
                <div class="exercise-card">
                    <div class="exercise-header">
                        <span class="exercise-icon">${exercise.icon}</span>
                        <h4 class="exercise-title">${exercise.title}</h4>
                        <span class="exercise-duration">${exercise.duration}</span>
                    </div>
                    <p class="exercise-description">${exercise.description}</p>
                    <button class="exercise-btn" onclick="startExercise('${exercise.type}')">
                        Commencer l'exercice
                    </button>
                </div>
            `).join('');
        }

        // D√©marrer un exercice
        function startExercise(type) {
            hapticFeedback('medium');
            
            const exerciseMessages = {
                breathing: "üå¨Ô∏è Trouvez une position confortable et suivez le rythme : Inspirez 4s, Retenez 7s, Expirez 8s",
                gratitude: "üôè Pensez √† 3 choses positives dans votre vie aujourd'hui et ressentez la gratitude",
                movement: "üö∂‚Äç‚ôÄÔ∏è Sortez prendre l'air et marchez d'un pas √©nergique pendant 10 minutes",
                meditation: "üßò‚Äç‚ôÄÔ∏è Asseyez-vous confortablement, fermez les yeux et concentrez-vous sur votre respiration",
                awareness: "üí≠ Prenez une pause et observez vos √©motions actuelles avec bienveillance"
            };
            
            const message = exerciseMessages[type] || "Prenez un moment pour vous centrer et respirer profond√©ment.";
            
            showNotification(message, 'info');
            
            // Simuler le d√©marrage d'un exercice guid√©
            setTimeout(() => {
                showNotification("‚ú® Excellent travail ! Exercice termin√© avec succ√®s.", 'success');
            }, 5000);
        }

        // Mettre √† jour l'historique et les graphiques
        function updateTrackingCharts() {
            // Cette fonction sera √©tendue pour cr√©er de vrais graphiques
            const chartsContainer = document.getElementById('mood-charts');
            if (!chartsContainer) return;
            
            if (moodHistory.length < 2) {
                chartsContainer.innerHTML = `
                    <div class="chart-placeholder">
                        <span class="chart-icon">üìà</span>
                        <h4>Graphiques en construction</h4>
                        <p>Continuez vos √©valuations pour voir l'√©volution de votre humeur</p>
                    </div>
                `;
                return;
            }
            
            // Affichage simple de l'√©volution
            const latestEntry = moodHistory[moodHistory.length - 1];
            const previousEntry = moodHistory[moodHistory.length - 2];
            
            const improvements = [];
            const concerns = [];
            
            Object.keys(latestEntry).forEach(key => {
                if (typeof latestEntry[key] === 'number' && typeof previousEntry[key] === 'number') {
                    const diff = latestEntry[key] - previousEntry[key];
                    if (key === 'sadness' || key === 'anxiety' || key === 'anger' || key === 'irritability') {
                        if (diff < -1) improvements.push(key);
                        if (diff > 1) concerns.push(key);
                    } else {
                        if (diff > 1) improvements.push(key);
                        if (diff < -1) concerns.push(key);
                    }
                }
            });
            
            chartsContainer.innerHTML = `
                <h4>üìä √âvolution r√©cente</h4>
                ${improvements.length > 0 ? `
                    <div style="background: rgba(76, 175, 80, 0.1); padding: 12px; border-radius: 8px; margin: 12px 0;">
                        <strong style="color: #4CAF50;">‚úÖ Am√©liorations :</strong><br>
                        ${improvements.map(item => `‚Ä¢ ${item}`).join('<br>')}
                    </div>
                ` : ''}
                ${concerns.length > 0 ? `
                    <div style="background: rgba(255, 193, 7, 0.1); padding: 12px; border-radius: 8px; margin: 12px 0;">
                        <strong style="color: #FF9800;">‚ö†Ô∏è Points d'attention :</strong><br>
                        ${concerns.map(item => `‚Ä¢ ${item}`).join('<br>')}
                    </div>
                ` : ''}
                <p style="color: #666; font-size: 14px; margin-top: 16px;">
                    ${moodHistory.length} √©valuations enregistr√©es
                </p>
            `;
        }

        // Initialiser au chargement de la page
        document.addEventListener('DOMContentLoaded', function() {
            initializeProfile();
            initializeModerationSystem();
            
            // Initialiser les valeurs par d√©faut des sliders
            document.querySelectorAll('.advanced-slider').forEach(slider => {
                const dimension = slider.id.replace('-slider', '');
                updateDimension(dimension, slider.value);
            });
        });

        // ========== SYST√àME DE MOD√âRATION IA ========== 

        // Listes de mots interdits par langue
        const bannedWords = {
            fr: [
                // Mots li√©s au suicide et √† l'automutilation
                'suicide', 'suicider', 'tuer', 'mourir', 'mort', 'disparaitre', 'dispara√Ætre', 
                'finir', 'automutilation', 'couper', 'br√ªler', 'blesser',
                
                // Insultes communes
                'connard', 'salope', 'pute', 'merde', 'con', 'conne', 'idiot', 'idiote', 
                'imbecile', 'imb√©cile', 'cr√©tin', 'd√©bile', 'stupide', 'nul', 'nulle',
                'pd', 'p√©d√©', 'gay', 'homo', 'tapette', 'tarlouze',
                
                // Mots de haine
                'raciste', 'nazi', 'fasciste', 'sale', 'd√©gage', 'crever', 'enfoir√©',
                'batard', 'b√¢tard', 'pourri', 'ordure', 'd√©chet', 'cancer',
                
                // Vulgarit√© excessive
                'putain', 'bordel', 'foutre', 'chier', 'merdique', 'd√©gueulasse'
            ],
            
            en: [
                // Suicide related
                'suicide', 'kill myself', 'end it', 'die', 'death', 'hurt myself',
                'cut myself', 'self harm', 'overdose', 'jump', 'hang',
                
                // Common insults
                'stupid', 'idiot', 'moron', 'dumb', 'retard', 'loser', 'freak',
                'ugly', 'fat', 'worthless', 'pathetic', 'disgusting',
                
                // Hate speech
                'racist', 'nazi', 'fascist', 'terrorist', 'criminal', 'trash',
                'scum', 'piece of shit', 'asshole', 'bitch', 'whore', 'slut'
            ],
            
            nl: [
                // Zelfmoord gerelateerd
                'zelfmoord', 'suicide', 'doodgaan', 'sterven', 'ophangen', 'springen',
                'zichzelf pijn', 'snijden', 'verbranden',
                
                // Scheldwoorden
                'idioot', 'dom', 'stom', 'sukkel', 'loser', 'eikel', 'klootzak',
                'trut', 'hoer', 'slet', 'kanker', 'mongool', 'debiel',
                
                // Haatspraak
                'racist', 'nazi', 'fascist', 'vuil', 'smerig', 'waardeloos',
                'afval', 'rot op', 'kankerlijer'
            ]
        };

        // Messages d'encouragement et conseils par contexte
        const supportiveMessages = {
            suicidal: {
                fr: [
                    "Je comprends que tu traverses une p√©riode difficile. Tu n'es pas seul(e) dans cette √©preuve. üíô",
                    "Tes sentiments sont importants et valides. Parlons-en ensemble, je suis l√† pour t'√©couter. ü§ó",
                    "La vie peut √™tre compliqu√©e, mais il y a toujours de l'espoir. Prenons les choses une √©tape √† la fois. üåÖ",
                    "Tu as de la valeur et tu m√©rites d'√™tre soutenu(e). Es-tu en contact avec un professionnel ? üíö"
                ],
                en: [
                    "I understand you're going through a tough time. You're not alone in this struggle. üíô",
                    "Your feelings are important and valid. Let's talk about it, I'm here to listen. ü§ó",
                    "Life can be complicated, but there's always hope. Let's take things one step at a time. üåÖ",
                    "You have value and deserve support. Are you in contact with a professional? üíö"
                ],
                nl: [
                    "Ik begrijp dat je een moeilijke tijd doormaakt. Je bent niet alleen in deze strijd. üíô",
                    "Je gevoelens zijn belangrijk en geldig. Laten we erover praten, ik ben er om te luisteren. ü§ó",
                    "Het leven kan ingewikkeld zijn, maar er is altijd hoop. Laten we stap voor stap gaan. üåÖ",
                    "Je hebt waarde en verdient ondersteuning. Ben je in contact met een professional? üíö"
                ]
            },
            
            negative: {
                fr: [
                    "Je vois que tu exprimes de la frustration. C'est normal de ressentir cela parfois. Veux-tu en parler ? üå∏",
                    "Il semble que tu passes une journ√©e difficile. Respire profond√©ment, tu vas y arriver. üí™",
                    "Tes √©motions sont l√©gitimes. Essayons de transformer cette √©nergie en quelque chose de positif. ‚ú®",
                    "Parfois, exprimer nos sentiments nous aide. Comment puis-je mieux t'accompagner aujourd'hui ? ü§ù"
                ],
                en: [
                    "I see you're expressing frustration. It's normal to feel this way sometimes. Want to talk about it? üå∏",
                    "It seems you're having a difficult day. Take a deep breath, you've got this. üí™",
                    "Your emotions are valid. Let's try to transform this energy into something positive. ‚ú®",
                    "Sometimes expressing our feelings helps us. How can I better support you today? ü§ù"
                ],
                nl: [
                    "Ik zie dat je frustratie uit. Het is normaal om dit soms te voelen. Wil je erover praten? üå∏",
                    "Het lijkt erop dat je een moeilijke dag hebt. Adem diep in, je kunt dit aan. üí™",
                    "Je emoties zijn geldig. Laten we proberen deze energie om te zetten in iets positiefs. ‚ú®",
                    "Soms helpt het om onze gevoelens te uiten. Hoe kan ik je vandaag beter ondersteunen? ü§ù"
                ]
            },
            
            general: {
                fr: [
                    "Je remarque que ton message contient des mots qui pourraient blesser. Reformulons ensemble d'une mani√®re plus bienveillante. üòä",
                    "Tes sentiments sont importants, mais exprimons-les de fa√ßon respectueuse. Comment puis-je t'aider ? üí≠",
                    "Je suis l√† pour t'accompagner dans tes √©motions. Trouvons ensemble des mots plus doux. üåª",
                    "Tu m√©rites d'√™tre entendu(e), mais utilisons des mots qui construisent plut√¥t que d√©truisent. üèóÔ∏è"
                ],
                en: [
                    "I notice your message contains words that might hurt. Let's rephrase it together in a kinder way. üòä",
                    "Your feelings matter, but let's express them respectfully. How can I help you? üí≠",
                    "I'm here to support you with your emotions. Let's find gentler words together. üåª",
                    "You deserve to be heard, but let's use words that build up rather than tear down. üèóÔ∏è"
                ],
                nl: [
                    "Ik merk dat je bericht woorden bevat die kunnen kwetsen. Laten we het samen herformuleren op een vriendelijkere manier. üòä",
                    "Je gevoelens zijn belangrijk, maar laten we ze respectvol uitdrukken. Hoe kan ik je helpen? üí≠",
                    "Ik ben er om je te ondersteunen met je emoties. Laten we samen zachtere woorden vinden. üåª",
                    "Je verdient het om gehoord te worden, maar laten we woorden gebruiken die opbouwen in plaats van afbreken. üèóÔ∏è"
                ]
            }
        };

        // Suggestions alternatives pour remplacer les mots n√©gatifs
        const wordAlternatives = {
            fr: {
                'nul': 'd√©cevant', 'merde': 'zut', 'con': 'frustrant', 'idiot': 'pas fut√©',
                'stupide': 'peu r√©fl√©chi', 'd√©bile': 'pas tr√®s malin', 'cr√©tin': 'pas tr√®s brillant',
                'pourri': 'pas terrible', 'd√©gueulasse': 'pas app√©tissant', 'merdique': 'pas fameux'
            },
            en: {
                'stupid': 'unwise', 'dumb': 'not clever', 'idiot': 'not smart', 'moron': 'not bright',
                'ugly': 'not attractive', 'fat': 'overweight', 'loser': 'struggling', 'freak': 'unique'
            },
            nl: {
                'dom': 'niet slim', 'stom': 'niet handig', 'idioot': 'niet pienter', 'sukkel': 'pechvogel',
                'debiel': 'niet scherp', 'mongool': 'niet helder'
            }
        };

        // Num√©ros d'urgence par pays
        const emergencyContacts = {
            fr: {
                suicide: "SOS Amiti√©: 09 72 39 40 50 (24h/24)",
                help: "Num√©ro national: 3114 (gratuit, 24h/24)"
            },
            en: {
                suicide: "Crisis Text Line: Text HOME to 741741",
                help: "National Suicide Prevention Lifeline: 988"
            },
            nl: {
                suicide: "Zelfmoordlijn 1813: 1813 (24u/24)",
                help: "113 Zelfmoordpreventie: 0900-0113"
            }
        };

        // Fonction principale de mod√©ration
        function moderateMessage(message, context = 'general') {
            const currentLang = localStorage.getItem('currentLanguage') || 'fr';
            const lowerMessage = message.toLowerCase();
            
            // V√©rifier les mots interdits
            const foundBadWords = [];
            const currentBannedWords = bannedWords[currentLang] || bannedWords.fr;
            
            currentBannedWords.forEach(word => {
                if (lowerMessage.includes(word.toLowerCase())) {
                    foundBadWords.push(word);
                }
            });
            
            // Analyser le contexte et la gravit√©
            const analysis = analyzeMessageSeverity(lowerMessage, currentLang);
            
            if (foundBadWords.length > 0 || analysis.severity > 0) {
                return {
                    approved: false,
                    severity: analysis.severity,
                    badWords: foundBadWords,
                    context: analysis.context,
                    supportMessage: generateSupportMessage(analysis.context, currentLang),
                    alternatives: generateAlternatives(foundBadWords, currentLang),
                    emergencyInfo: analysis.severity >= 3 ? emergencyContacts[currentLang] : null
                };
            }
            
            return {
                approved: true,
                message: "Message approuv√© ‚úÖ"
            };
        }

        // Analyser la gravit√© du message
        function analyzeMessageSeverity(message, lang) {
            let severity = 0;
            let context = 'general';
            
            // Mots li√©s au suicide (gravit√© maximale)
            const suicidalKeywords = {
                fr: ['suicide', 'suicider', 'mourir', 'disparaitre', 'finir', 'tuer', 'mort'],
                en: ['suicide', 'kill myself', 'end it', 'die', 'death', 'hurt myself'],
                nl: ['zelfmoord', 'suicide', 'doodgaan', 'sterven', 'ophangen']
            };
            
            const currentSuicidalWords = suicidalKeywords[lang] || suicidalKeywords.fr;
            if (currentSuicidalWords.some(word => message.includes(word))) {
                severity = 3;
                context = 'suicidal';
                return { severity, context };
            }
            
            // Insultes graves (gravit√© √©lev√©e)
            const severeInsults = {
                fr: ['connard', 'salope', 'pute', 'enfoir√©', 'batard', 'cancer'],
                en: ['asshole', 'bitch', 'whore', 'piece of shit', 'scum'],
                nl: ['klootzak', 'hoer', 'slet', 'kankerlijer', 'eikel']
            };
            
            const currentSevereInsults = severeInsults[lang] || severeInsults.fr;
            if (currentSevereInsults.some(word => message.includes(word))) {
                severity = 2;
                context = 'negative';
                return { severity, context };
            }
            
            // Insultes l√©g√®res (gravit√© mod√©r√©e)
            const lightInsults = {
                fr: ['con', 'idiot', 'stupide', 'nul', 'd√©bile'],
                en: ['stupid', 'idiot', 'dumb', 'loser'],
                nl: ['dom', 'stom', 'idioot', 'sukkel']
            };
            
            const currentLightInsults = lightInsults[lang] || lightInsults.fr;
            if (currentLightInsults.some(word => message.includes(word))) {
                severity = 1;
                context = 'negative';
                return { severity, context };
            }
            
            return { severity, context };
        }

        // G√©n√©rer un message de soutien personnalis√©
        function generateSupportMessage(context, lang) {
            const messages = supportiveMessages[context] && supportiveMessages[context][lang] 
                ? supportiveMessages[context][lang] 
                : supportiveMessages.general[lang] || supportiveMessages.general.fr;
            
            return messages[Math.floor(Math.random() * messages.length)];
        }

        // G√©n√©rer des alternatives aux mots interdits
        function generateAlternatives(badWords, lang) {
            const alternatives = wordAlternatives[lang] || wordAlternatives.fr;
            const suggestions = [];
            
            badWords.forEach(word => {
                if (alternatives[word.toLowerCase()]) {
                    suggestions.push({
                        original: word,
                        alternative: alternatives[word.toLowerCase()]
                    });
                }
            });
            
            return suggestions;
        }

        // Afficher une notification de mod√©ration
        function showModerationDialog(moderationResult) {
            const modal = document.createElement('div');
            modal.className = 'moderation-modal';
            
            let emergencyInfo = '';
            if (moderationResult.emergencyInfo) {
                emergencyInfo = `
                    <div class="emergency-info">
                        <h4>üÜò Besoin d'aide imm√©diate ?</h4>
                        <p><strong>Suicide:</strong> ${moderationResult.emergencyInfo.suicide}</p>
                        <p><strong>Aide:</strong> ${moderationResult.emergencyInfo.help}</p>
                    </div>
                `;
            }
            
            let alternatives = '';
            if (moderationResult.alternatives && moderationResult.alternatives.length > 0) {
                alternatives = `
                    <div class="alternatives">
                        <h4>üí° Suggestions alternatives:</h4>
                        ${moderationResult.alternatives.map(alt => 
                            `<p>"${alt.original}" ‚Üí "${alt.alternative}"</p>`
                        ).join('')}
                    </div>
                `;
            }
            
            modal.innerHTML = `
                <div class="moderation-content">
                    <div class="moderation-header">
                        <h3>ü§ñ Assistant de bien-√™tre</h3>
                        <button class="close-btn" onclick="closeModerationModal()">&times;</button>
                    </div>
                    
                    <div class="moderation-body">
                        <div class="support-message">
                            <p>${moderationResult.supportMessage}</p>
                        </div>
                        
                        ${emergencyInfo}
                        ${alternatives}
                        
                        <div class="moderation-actions">
                            <button class="btn-primary" onclick="acceptModerationSuggestion()">
                                Merci pour les conseils üíô
                            </button>
                            <button class="btn-secondary" onclick="reviseModerationMessage()">
                                Reformuler mon message ‚úèÔ∏è
                            </button>
                        </div>
                    </div>
                </div>
            `;
            
            document.body.appendChild(modal);
            modal.style.display = 'flex';
            
            // Animation d'entr√©e
            setTimeout(() => {
                modal.classList.add('show');
            }, 100);
        }

        // Fermer la modal de mod√©ration
        function closeModerationModal() {
            const modal = document.querySelector('.moderation-modal');
            if (modal) {
                modal.classList.remove('show');
                setTimeout(() => {
                    document.body.removeChild(modal);
                }, 300);
            }
        }

        // Accepter les suggestions de mod√©ration
        function acceptModerationSuggestion() {
            hapticFeedback('light');
            closeModerationModal();
            
            const thankYouMessage = {
                fr: "C'est formidable de voir que tu prends soin de ton bien-√™tre ! üåü",
                en: "It's wonderful to see you taking care of your well-being! üåü",
                nl: "Het is geweldig om te zien dat je zorgt voor je welzijn! üåü"
            };
            
            const currentLang = localStorage.getItem('currentLanguage') || 'fr';
            showNotification(thankYouMessage[currentLang], 'success');
        }

        // Proposer de reformuler le message
        function reviseModerationMessage() {
            hapticFeedback('light');
            closeModerationModal();
            
            const reviseMessage = {
                fr: "Prenons un moment pour reformuler ton message avec des mots plus doux üòä",
                en: "Let's take a moment to rephrase your message with gentler words üòä",
                nl: "Laten we even de tijd nemen om je bericht te herformuleren met vriendelijkere woorden üòä"
            };
            
            const currentLang = localStorage.getItem('currentLanguage') || 'fr';
            showNotification(reviseMessage[currentLang], 'info');
        }

        // Fonction utilitaire pour afficher les notifications
        function showNotification(message, type = 'info') {
            const notification = document.createElement('div');
            notification.className = `notification ${type}`;
            notification.style.cssText = `
                position: fixed;
                top: 20px;
                left: 50%;
                transform: translateX(-50%);
                background: ${type === 'success' ? '#4CAF50' : type === 'error' ? '#f44336' : '#2196F3'};
                color: white;
                padding: 16px 24px;
                border-radius: 12px;
                z-index: 10001;
                font-weight: 600;
                max-width: 90%;
                text-align: center;
                box-shadow: 0 4px 20px rgba(0,0,0,0.3);
                animation: slideInDown 0.3s ease;
            `;
            notification.textContent = message;
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.style.animation = 'slideOutUp 0.3s ease';
                setTimeout(() => {
                    if (document.body.contains(notification)) {
                        document.body.removeChild(notification);
                    }
                }, 300);
            }, 4000);
        }

        // Update sidebar active state (for desktop)
        function updateSidebarActiveState() {
            // Cette fonction est appel√©e mais n'est plus n√©cessaire en mode mobile only
            return;
        }

        // Screen size detection (simplifi√© pour mobile)
        function detectScreenSize() {
            // Fonction simplifi√©e car nous utilisons maintenant un layout mobile fixe
            return;
        }

        // Initialize mobile enhancements
        document.addEventListener('DOMContentLoaded', function() {
            addTouchEvents();
            setupKeyboardHandling();
            detectScreenSize();
            
            // Listen for resize events
            window.addEventListener('resize', detectScreenSize);
            window.addEventListener('orientationchange', function() {
                setTimeout(detectScreenSize, 100);
            });
            
            // Prevent double-tap zoom on buttons
            let lastTouchEnd = 0;
            document.addEventListener('touchend', function (event) {
                const now = (new Date()).getTime();
                if (now - lastTouchEnd <= 300) {
                    event.preventDefault();
                }
                lastTouchEnd = now;
            }, false);
        });

        // Update sidebar active state for desktop
        function updateSidebarActiveState() {
            const sidebarItems = document.querySelectorAll('.sidebar-nav-item');
            const activeScreen = document.querySelector('.screen-content.active');
            
            sidebarItems.forEach(item => {
                item.classList.remove('active');
            });
            
            if (activeScreen) {
                const screenId = activeScreen.id;
                const correspondingItem = document.querySelector(`[onclick*="${screenId}"]`);
                if (correspondingItem && correspondingItem.classList.contains('sidebar-nav-item')) {
                    correspondingItem.classList.add('active');
                }
            }
        }

        // Handle key press (Enter to send message)
        function handleKeyPress(event) {
            if (event.key === 'Enter') {
                sendUserMessage();
            }
        }

        // Handle mobile keyboard appearance
        function setupKeyboardHandling() {
            const inputs = document.querySelectorAll('input, textarea');
            inputs.forEach(input => {
                input.addEventListener('focus', function() {
                    // Adjust viewport when keyboard appears
                    setTimeout(() => {
                        this.scrollIntoView({ behavior: 'smooth', block: 'center' });
                    }, 300);
                });
                
                input.addEventListener('blur', function() {
                    // Reset viewport when keyboard disappears
                    setTimeout(() => {
                        window.scrollTo(0, 0);
                    }, 300);
                });
            });
        }

        // Onboarding data
        const onboardingSteps = [
            {
                icon: 'üå∏',
                title: 'Bienvenue dans MINDLY',
                description: 'D√©couvrez une approche moderne du bien-√™tre f√©minin avec des outils personnalis√©s.'
            },
            {
                icon: 'üåø',
                title: 'Suivez votre bien-√™tre',
                description: 'Enregistrez votre humeur quotidienne et d√©couvrez vos habitudes √©motionnelles.'
            },
            {
                icon: 'ü§ù',
                title: 'Connectez-vous',
                description: 'Rejoignez une communaut√© bienveillante et partagez vos exp√©riences.'
            },
            {
                icon: 'ü§ñ',
                title: 'Assistant personnel',
                description: 'B√©n√©ficiez de conseils personnalis√©s gr√¢ce √† notre intelligence artificielle.'
            }
        ];

        let currentStep = 0;

        // Toggle menu dropdown
        function toggleMenu() {
            const dropdown = document.getElementById('menuDropdown');
            dropdown.classList.toggle('active');
            
            // Close menu when clicking outside
            if (dropdown.classList.contains('active')) {
                document.addEventListener('click', closeMenuOnClickOutside);
            }
        }

        function closeMenuOnClickOutside(event) {
            const dropdown = document.getElementById('menuDropdown');
            const menuButton = document.querySelector('.menu-button');
            
            if (!dropdown.contains(event.target) && !menuButton.contains(event.target)) {
                dropdown.classList.remove('active');
                document.removeEventListener('click', closeMenuOnClickOutside);
            }
        }

        // Screen navigation
        function showScreen(screenId) {
            // Haptic feedback for screen transitions
            hapticFeedback('light');
            
            // Hide all screens
            document.querySelectorAll('.screen-content').forEach(screen => {
                screen.classList.remove('active');
            });
            
            // Reset profile sections if switching to profile screen
            if (screenId === 'profile-screen') {
                showMainProfile();
            }
            
            // Show selected screen with animation
            const targetScreen = document.getElementById(screenId);
            if (targetScreen) {
                targetScreen.classList.add('active');
                // Smooth scroll to top when changing screens
                targetScreen.scrollTop = 0;
                
                // Update sidebar active state if on desktop
                if (window.innerWidth >= 1024) {
                    updateSidebarActiveState();
                }
            }
            
            // Close menu dropdown if open
            document.getElementById('menuDropdown').classList.remove('active');
            
            // Update navigation buttons
            document.querySelectorAll('.bottom-nav-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            
            // Find the button that was clicked and add active class
            if (event && event.target) {
                let button = event.target.closest('.bottom-nav-btn');
                if (button) {
                    button.classList.add('active');
                }
            }
        }

        // Onboarding navigation
        function updateOnboarding() {
            if (typeof onboardingSteps === 'undefined' || !onboardingSteps[currentStep]) return;
            
            const step = onboardingSteps[currentStep];
            const iconEl = document.getElementById('onboarding-icon');
            const titleEl = document.getElementById('onboarding-title');
            const descEl = document.getElementById('onboarding-description');
            
            if (iconEl) iconEl.textContent = step.icon;
            if (titleEl) titleEl.textContent = step.title;
            if (descEl) descEl.textContent = step.description;
            
            // Update dots
            document.querySelectorAll('.dot').forEach((dot, index) => {
                dot.classList.toggle('active', index === currentStep);
            });
        }

        // Event listeners for onboarding (avec v√©rifications)
        const prevBtn = document.querySelector('.prev-btn');
        const nextBtn = document.querySelector('.next-btn');
        
        if (prevBtn) {
            prevBtn.addEventListener('click', () => {
                if (currentStep > 0) {
                    currentStep--;
                    updateOnboarding();
                }
            });
        }

        if (nextBtn) {
            nextBtn.addEventListener('click', () => {
                if (typeof onboardingSteps !== 'undefined' && currentStep < onboardingSteps.length - 1) {
                    currentStep++;
                    updateOnboarding();
                } else {
                    showScreen('welcome-screen');
                }
            });
        }

        // Tab navigation
        document.querySelectorAll('.tab-item').forEach(tab => {
            tab.addEventListener('click', (e) => {
                const parent = e.target.closest('.main-app');
                if (parent) {
                    parent.querySelectorAll('.tab-item').forEach(t => t.classList.remove('active'));
                    e.target.closest('.tab-item').classList.add('active');
                }
            });
        });

        // Mood selection function
        function selectMood(mood, emoji) {
            const messages = {
                'joyeuse': 'Formidable ! üå∫ Vous rayonnez de joie aujourd\'hui. Continuez √† cultiver cette belle √©nergie positive !',
                'sereine': 'Magnifique ! üåø Votre s√©r√©nit√© est inspirante. Prenez un moment pour savourer cette paix int√©rieure.',
                'neutre': 'C\'est parfaitement normal ! üåô Chaque jour est diff√©rent. Voulez-vous faire une petite m√©ditation ?',
                'triste': 'Je comprends üåßÔ∏è Il est important d\'honorer vos √©motions. Voulez-vous parler avec notre IA ou rejoindre la communaut√© ?'
            };
            
            alert(`${emoji} ${messages[mood]}`);
            
            // Enregistrer l'humeur et proposer des actions
            setTimeout(() => {
                if (mood === 'triste' || mood === 'neutre') {
                    if (confirm('Voulez-vous parler avec notre assistant IA ?')) {
                        showScreen('chat-screen');
                    }
                }
            }, 2000);
        }

        // Chat functions
        function sendMessage(message) {
            addUserMessage(message);
            setTimeout(() => {
                generateAIResponse(message);
            }, 1000);
        }

        function sendUserMessage() {
            const input = document.getElementById('chatInput');
            if (!input) return;
            
            const message = input.value.trim();
            if (message) {
                // Mod√©ration du message avant envoi
                const moderationResult = moderateMessage(message, 'chat');
                
                if (!moderationResult.approved) {
                    // Message bloqu√© - afficher la modal de mod√©ration
                    showModerationDialog(moderationResult);
                    
                    // Afficher un message bloqu√© dans le chat
                    addBlockedMessage(message, moderationResult);
                    input.value = '';
                    return;
                }
                
                // Message approuv√© - l'envoyer normalement
                addUserMessage(message);
                input.value = '';
                setTimeout(() => {
                    generateAIResponse(message);
                }, 1000);
            }
        }

        function addUserMessage(message) {
            const chatMessages = document.getElementById('chatMessages');
            if (!chatMessages) return;
            
            const messageDiv = document.createElement('div');
            messageDiv.className = 'user-message';
            messageDiv.innerHTML = `
                <div class="message-avatar">üë§</div>
                <div class="message-content">
                    <p>${message}</p>
                </div>
            `;
            chatMessages.appendChild(messageDiv);
            chatMessages.scrollTop = chatMessages.scrollHeight;
        }

        function addBlockedMessage(originalMessage, moderationResult) {
            const chatMessages = document.getElementById('chatMessages');
            if (!chatMessages) return;
            
            const messageDiv = document.createElement('div');
            messageDiv.className = 'blocked-message';
            messageDiv.innerHTML = `
                <div class="message-blocked">
                    üö´ Message filtr√© par l'IA de bien-√™tre
                </div>
                <div class="ai-suggestion">
                    ${moderationResult.supportMessage}
                </div>
            `;
            chatMessages.appendChild(messageDiv);
            chatMessages.scrollTop = chatMessages.scrollHeight;
            
            // Ajouter automatiquement une r√©ponse IA empathique
            setTimeout(() => {
                const aiResponse = generateEmpathicResponse(moderationResult.context);
                addAIMessage(aiResponse);
            }, 1500);
        }

        function generateEmpathicResponse(context) {
            const currentLang = localStorage.getItem('currentLanguage') || 'fr';
            
            const empathicResponses = {
                suicidal: {
                    fr: [
                        "Je per√ßois que tu traverses une p√©riode tr√®s difficile. Tes sentiments sont l√©gitimes et tu as le droit de les exprimer. Peux-tu me parler de ce qui te pr√©occupe en ce moment ? üíô",
                        "Il est courageux de ta part de partager tes √©motions. Je suis l√† pour t'√©couter sans jugement. Qu'est-ce qui pourrait t'aider √† te sentir un peu mieux aujourd'hui ? ü§ó",
                        "Je comprends que la douleur peut sembler insurmontable parfois. Tu n'es pas seul(e) dans cette lutte. As-tu quelqu'un en qui tu as confiance dans ta vie ? üåü"
                    ],
                    en: [
                        "I sense you're going through a very difficult time. Your feelings are valid and you have the right to express them. Can you tell me what's troubling you right now? üíô",
                        "It's brave of you to share your emotions. I'm here to listen without judgment. What could help you feel a little better today? ü§ó",
                        "I understand that pain can feel overwhelming sometimes. You're not alone in this struggle. Do you have someone you trust in your life? üåü"
                    ],
                    nl: [
                        "Ik merk dat je een zeer moeilijke tijd doormaakt. Je gevoelens zijn geldig en je hebt het recht om ze te uiten. Kun je me vertellen wat je nu zorgen baart? üíô",
                        "Het is moedig van je om je emoties te delen. Ik ben er om zonder oordeel te luisteren. Wat zou je kunnen helpen om je vandaag een beetje beter te voelen? ü§ó",
                        "Ik begrijp dat pijn soms overweldigend kan aanvoelen. Je bent niet alleen in deze strijd. Heb je iemand die je vertrouwt in je leven? üåü"
                    ]
                },
                negative: {
                    fr: [
                        "Je sens de la frustration dans tes mots. C'est normal de ressentir cela parfois. Qu'est-ce qui te met en col√®re ou te d√©√ßoit en ce moment ? üòî",
                        "Tes √©motions sont importantes. Parfois, quand on est boulevers√©, les mots sortent diff√©remment. Peux-tu me dire ce qui ne va pas ? üí≠",
                        "Il semble que tu aies besoin de te d√©fouler. Je suis l√† pour t'√©couter. Qu'est-ce qui te p√®se sur le c≈ìur ? üå∏"
                    ],
                    en: [
                        "I sense frustration in your words. It's normal to feel this way sometimes. What's making you angry or disappointed right now? üòî",
                        "Your emotions are important. Sometimes when we're upset, words come out differently. Can you tell me what's wrong? üí≠",
                        "It seems like you need to vent. I'm here to listen. What's weighing on your heart? üå∏"
                    ],
                    nl: [
                        "Ik voel frustratie in je woorden. Het is normaal om dit soms te voelen. Wat maakt je boos of teleurgesteld op dit moment? üòî",
                        "Je emoties zijn belangrijk. Soms als we van streek zijn, komen woorden er anders uit. Kun je me vertellen wat er mis is? üí≠",
                        "Het lijkt erop dat je je hart moet luchten. Ik ben er om te luisteren. Wat drukt op je hart? üå∏"
                    ]
                },
                general: {
                    fr: [
                        "Je remarque que tu essaies de communiquer quelque chose d'important. Prenons un moment pour explorer tes sentiments ensemble. Que se passe-t-il vraiment ? ü§î",
                        "Tes mots montrent que tu as des choses √† exprimer. Je suis l√† pour t'aider √† les formuler de mani√®re constructive. De quoi aimerais-tu parler ? üí¨",
                        "Il semble que tu aies besoin de soutien. C'est tout √† fait normal. Comment puis-je t'accompagner aujourd'hui ? ü§ù"
                    ],
                    en: [
                        "I notice you're trying to communicate something important. Let's take a moment to explore your feelings together. What's really going on? ü§î",
                        "Your words show you have things to express. I'm here to help you phrase them constructively. What would you like to talk about? üí¨",
                        "It seems you need support. That's completely normal. How can I help you today? ü§ù"
                    ],
                    nl: [
                        "Ik merk dat je iets belangrijks probeert te communiceren. Laten we even de tijd nemen om samen je gevoelens te verkennen. Wat is er echt aan de hand? ü§î",
                        "Je woorden tonen dat je dingen hebt om uit te drukken. Ik ben er om je te helpen ze constructief te formuleren. Waar zou je over willen praten? üí¨",
                        "Het lijkt erop dat je ondersteuning nodig hebt. Dat is volkomen normaal. Hoe kan ik je vandaag helpen? ü§ù"
                    ]
                }
            };
            
            const responses = empathicResponses[context] && empathicResponses[context][currentLang] 
                ? empathicResponses[context][currentLang] 
                : empathicResponses.general[currentLang] || empathicResponses.general.fr;
            
            return responses[Math.floor(Math.random() * responses.length)];
        }

        function addAIMessage(message) {
            const chatMessages = document.getElementById('chatMessages');
            const messageDiv = document.createElement('div');
            messageDiv.className = 'ai-message';
            messageDiv.innerHTML = `
                <div class="message-avatar">ü§ñ</div>
                <div class="message-content">
                    <p>${message}</p>
                </div>
            `;
            chatMessages.appendChild(messageDiv);
            chatMessages.scrollTop = chatMessages.scrollHeight;
        }

        function generateAIResponse(userMessage) {
            const responses = {
                'stress': 'Je comprends que vous vous sentiez stress√©e. Essayons ensemble un exercice de respiration : Inspirez pendant 4 secondes, retenez 4 secondes, expirez 6 secondes. R√©p√©tez 5 fois. üå∏',
                'conseils': 'Je suis l√† pour vous aider ! Pouvez-vous me parler un peu plus de votre situation ? Que vous arrive-t-il en ce moment ? üí≠',
                'm√©ditation': 'Excellente id√©e ! Commen√ßons par vous installer confortablement. Fermez les yeux et concentrez-vous sur votre respiration. Inspirez la paix, expirez le stress. üßò‚Äç‚ôÄÔ∏è',
                'default': 'Merci de partager cela avec moi. Vos √©motions sont importantes et valides. Comment puis-je vous aider √† vous sentir mieux aujourd\'hui ? üíô'
            };

            let response = responses.default;
            const message = userMessage.toLowerCase();
            
            if (message.includes('stress') || message.includes('stress√©e')) {
                response = responses.stress;
            } else if (message.includes('conseil') || message.includes('aide')) {
                response = responses.conseils;
            } else if (message.includes('m√©ditation') || message.includes('respiration')) {
                response = responses.m√©ditation;
            }
            
            addAIMessage(response);
        }

        function handleKeyPress(event) {
            if (event.key === 'Enter') {
                sendUserMessage();
            }
        }

        // Mood Journal functions
        function saveMoodEntry() {
            const moodScale = document.getElementById('moodScale');
            const energyScale = document.getElementById('energyScale');
            const stressScale = document.getElementById('stressScale');
            const feelingsTextarea = document.querySelector('.feelings-textarea');
            
            const moodValue = moodScale ? moodScale.value : 4;
            const energyValue = energyScale ? energyScale.value : 3;
            const stressValue = stressScale ? stressScale.value : 2;
            const feelings = feelingsTextarea ? feelingsTextarea.value : '';
            
            // Haptic feedback for successful save
            hapticFeedback('medium');
            
            // Simulate saving with mobile-friendly notification
            const notification = document.createElement('div');
            notification.style.cssText = `
                position: fixed;
                top: 20px;
                left: 50%;
                transform: translateX(-50%);
                background: #4CAF50;
                color: white;
                padding: 16px 24px;
                border-radius: 12px;
                box-shadow: 0 4px 12px rgba(0,0,0,0.3);
                z-index: 10000;
                font-size: 16px;
                font-weight: 600;
            `;
            notification.textContent = '‚úÖ Entr√©e sauvegard√©e !';
            document.body.appendChild(notification);
            
            // Remove notification after 2 seconds
            setTimeout(() => {
                document.body.removeChild(notification);
            }, 2000);
            
            // Return to dashboard
            setTimeout(() => {
                showScreen('dashboard-screen');
            }, 1500);
        }

        // Profile photo function
        function changeProfilePhoto() {
            const photos = [
                "data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Ccircle cx='50' cy='50' r='50' fill='%23FF6B9D'/%3E%3Ctext x='50' y='55' text-anchor='middle' fill='white' font-size='25'%3Eüå∏%3C/text%3E%3C/svg%3E",
                "data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Ccircle cx='50' cy='50' r='50' fill='%234CAF50'/%3E%3Ctext x='50' y='55' text-anchor='middle' fill='white' font-size='25'%3Eüåø%3C/text%3E%3C/svg%3E",
                "data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Ccircle cx='50' cy='50' r='50' fill='%2345B7D1'/%3E%3Ctext x='50' y='55' text-anchor='middle' fill='white' font-size='25'%3Eüåô%3C/text%3E%3C/svg%3E",
                "data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Ccircle cx='50' cy='50' r='50' fill='%239C27B0'/%3E%3Ctext x='50' y='55' text-anchor='middle' fill='white' font-size='25'%3Eü¶ã%3C/text%3E%3C/svg%3E"
            ];
            
            const currentPhoto = document.getElementById('profileImage');
            const currentIndex = photos.indexOf(currentPhoto.src);
            const nextIndex = (currentIndex + 1) % photos.length;
            currentPhoto.src = photos[nextIndex];
        }

        // Syst√®me d'onboarding et d'abonnement
        let currentSubscription = {
            plan: 'none',
            status: 'none', // none, trial, active, expired
            trialEnd: null,
            daysLeft: 0
        };

        // Navigation principale
        function showMainScreen(screenId) {
            // V√©rifier si l'utilisateur a acc√®s
            if (!hasAppAccess()) {
                startOnboarding();
                return;
            }

            // Masquer tous les √©crans principaux
            document.querySelectorAll('.screen-content:not(.onboarding-screen)').forEach(screen => {
                screen.style.display = 'none';
            });

            // Afficher l'√©cran demand√©
            const screen = document.getElementById(screenId);
            if (screen) {
                screen.style.display = 'block';
            }

            // Mettre √† jour la navigation active
            updateBottomNavigation(screenId);
        }

        function updateBottomNavigation(activeScreen) {
            document.querySelectorAll('.nav-item').forEach(item => {
                item.classList.remove('active');
                if (item.dataset.screen === activeScreen.replace('-screen', '')) {
                    item.classList.add('active');
                }
            });
        }

        // Gestion de l'onboarding
        function hasAppAccess() {
            const hasAcceptedTerms = localStorage.getItem('termsAccepted') === 'true';
            const hasValidSubscription = localStorage.getItem('subscriptionStatus');
            return hasAcceptedTerms && hasValidSubscription;
        }

        function startOnboarding() {
            // Masquer tous les √©crans
            document.querySelectorAll('.screen-content').forEach(screen => {
                screen.style.display = 'none';
            });
            
            // Masquer la navigation et le menu
            document.getElementById('bottomNav').style.display = 'none';
            document.querySelector('.top-menu').style.display = 'none';

            // Afficher l'√©cran des conditions
            document.getElementById('terms-screen').style.display = 'block';
        }

        // Gestion des conditions d'utilisation
        function validateTermsAndContinue() {
            const rgpdAccepted = document.getElementById('acceptRGPD').checked;
            const termsAccepted = document.getElementById('acceptTerms').checked;

            if (rgpdAccepted && termsAccepted) {
                localStorage.setItem('termsAccepted', 'true');
                showSubscriptionScreen();
            }
        }

        function showSubscriptionScreen() {
            document.getElementById('terms-screen').style.display = 'none';
            document.getElementById('subscription-screen').style.display = 'block';
        }

        // Gestion des abonnements
        function selectPlan(planType, price) {
            if (planType === 'free') {
                // Plan gratuit - acc√®s direct mais limit√©
                currentSubscription = {
                    plan: 'free',
                    status: 'active',
                    trialEnd: null,
                    daysLeft: 0
                };
                localStorage.setItem('subscriptionPlan', 'free');
                localStorage.setItem('subscriptionStatus', 'active');
                finishOnboarding();
            } else {
                // Plans premium - n√©cessitent un paiement
                showPaymentScreen(planType, price);
            }
        }

        function showPaymentScreen(planType, price) {
            document.getElementById('subscription-screen').style.display = 'none';
            
            // Remplir le r√©sum√© du plan
            const planSummary = document.getElementById('planSummary');
            const planName = planType === 'annual' ? 'Premium Annuel' : 'Premium Mensuel';
            const trialEndDate = new Date();
            trialEndDate.setDate(trialEndDate.getDate() + 7);
            
            planSummary.innerHTML = `
                <h3>üìã R√©capitulatif</h3>
                <div style="display: flex; justify-content: space-between; align-items: center; margin: 10px 0;">
                    <span><strong>${planName}</strong></span>
                    <span><strong>${price}‚Ç¨</strong></span>
                </div>
                <p style="color: #666; font-size: 14px; margin: 0;">
                    Essai gratuit de 7 jours, puis facturation automatique.
                </p>
            `;

            // Mettre √† jour la date de fin d'essai
            document.getElementById('trialEndDate').textContent = trialEndDate.toLocaleDateString('fr-FR');
            
            document.getElementById('payment-screen').style.display = 'block';

            // Stocker les informations du plan temporairement
            sessionStorage.setItem('selectedPlan', planType);
            sessionStorage.setItem('selectedPrice', price);
        }

        function processPayment() {
            // Validation basique des champs
            const cardNumber = document.getElementById('cardNumber').value;
            const expiryDate = document.getElementById('expiryDate').value;
            const cvv = document.getElementById('cvv').value;
            const cardName = document.getElementById('cardName').value;

            if (!cardNumber || !expiryDate || !cvv || !cardName) {
                alert('Veuillez remplir tous les champs de paiement');
                return;
            }

            // Validation du num√©ro de carte (basique)
            if (cardNumber.replace(/\s/g, '').length < 16) {
                alert('Num√©ro de carte invalide');
                return;
            }

            // Simulation du traitement de paiement
            document.querySelector('.payment-btn').textContent = 'Traitement en cours...';
            document.querySelector('.payment-btn').disabled = true;

            setTimeout(() => {
                // Succ√®s du paiement simul√©
                const planType = sessionStorage.getItem('selectedPlan');
                const price = sessionStorage.getItem('selectedPrice');

                // Configurer l'abonnement premium avec essai
                const trialEnd = new Date();
                trialEnd.setDate(trialEnd.getDate() + 7);

                currentSubscription = {
                    plan: planType,
                    status: 'trial',
                    trialEnd: trialEnd,
                    daysLeft: 7
                };

                localStorage.setItem('subscriptionPlan', planType);
                localStorage.setItem('subscriptionStatus', 'trial');
                localStorage.setItem('trialEndDate', trialEnd.toISOString());
                localStorage.setItem('subscriptionPrice', price);

                // Nettoyer les donn√©es temporaires
                sessionStorage.removeItem('selectedPlan');
                sessionStorage.removeItem('selectedPrice');

                showWelcomeScreen();
            }, 2000);
        }

        function showWelcomeScreen() {
            document.getElementById('payment-screen').style.display = 'none';
            document.getElementById('welcome-screen').style.display = 'block';

            // Mettre √† jour le d√©compte des jours
            updateTrialCountdown();
        }

        function updateTrialCountdown() {
            const trialEnd = localStorage.getItem('trialEndDate');
            if (trialEnd) {
                const endDate = new Date(trialEnd);
                const now = new Date();
                const daysLeft = Math.max(0, Math.ceil((endDate - now) / (1000 * 60 * 60 * 24)));
                
                const daysLeftElement = document.getElementById('trialDaysLeft');
                if (daysLeftElement) {
                    daysLeftElement.textContent = daysLeft;
                }

                currentSubscription.daysLeft = daysLeft;
            }
        }

        function startUsingApp() {
            // Masquer l'√©cran de bienvenue
            document.getElementById('welcome-screen').style.display = 'none';
            
            // Afficher la navigation et l'interface principale
            document.querySelector('.top-menu').style.display = 'flex';
            document.getElementById('bottomNav').style.display = 'flex';
            
            // Afficher l'√©cran d'accueil par d√©faut
            showMainScreen('dashboard-screen');
        }

        function finishOnboarding() {
            // Pour le plan gratuit, aller directement √† l'application
            document.getElementById('subscription-screen').style.display = 'none';
            
            // Afficher la navigation et l'interface principale
            document.querySelector('.top-menu').style.display = 'flex';
            document.getElementById('bottomNav').style.display = 'flex';
            
            // Afficher l'√©cran d'accueil par d√©faut
            showMainScreen('dashboard-screen');
        }

        // Gestion des √©v√©nements pour les conditions
        document.addEventListener('DOMContentLoaded', function() {
            const acceptRGPD = document.getElementById('acceptRGPD');
            const acceptTerms = document.getElementById('acceptTerms');
            const termsBtn = document.getElementById('termsBtn');

            if (acceptRGPD && acceptTerms && termsBtn) {
                function checkTermsAcceptance() {
                    termsBtn.disabled = !(acceptRGPD.checked && acceptTerms.checked);
                }

                acceptRGPD.addEventListener('change', checkTermsAcceptance);
                acceptTerms.addEventListener('change', checkTermsAcceptance);
            }

            // Formatage automatique des champs de paiement
            const cardNumberInput = document.getElementById('cardNumber');
            if (cardNumberInput) {
                cardNumberInput.addEventListener('input', function(e) {
                    let value = e.target.value.replace(/\s/g, '');
                    value = value.replace(/(.{4})/g, '$1 ').trim();
                    e.target.value = value;
                });
            }

            const expiryInput = document.getElementById('expiryDate');
            if (expiryInput) {
                expiryInput.addEventListener('input', function(e) {
                    let value = e.target.value.replace(/\D/g, '');
                    if (value.length >= 2) {
                        value = value.substring(0, 2) + '/' + value.substring(2, 4);
                    }
                    e.target.value = value;
                });
            }
        });

        // V√©rification de l'√©tat de l'abonnement au chargement
        function checkSubscriptionStatus() {
            const termsAccepted = localStorage.getItem('termsAccepted') === 'true';
            const subscriptionStatus = localStorage.getItem('subscriptionStatus');
            
            if (!termsAccepted || !subscriptionStatus) {
                startOnboarding();
                return;
            }

            // Restaurer l'√©tat de l'abonnement
            currentSubscription = {
                plan: localStorage.getItem('subscriptionPlan') || 'free',
                status: subscriptionStatus,
                trialEnd: localStorage.getItem('trialEndDate') ? new Date(localStorage.getItem('trialEndDate')) : null,
                daysLeft: 0
            };

            // V√©rifier si l'essai a expir√©
            if (currentSubscription.status === 'trial' && currentSubscription.trialEnd) {
                const now = new Date();
                if (now > currentSubscription.trialEnd) {
                    currentSubscription.status = 'expired';
                    localStorage.setItem('subscriptionStatus', 'expired');
                }
            }

            // Mettre √† jour le d√©compte si en essai
            if (currentSubscription.status === 'trial') {
                updateTrialCountdown();
            }

            // Afficher l'interface normale
            document.querySelector('.top-menu').style.display = 'flex';
            document.getElementById('bottomNav').style.display = 'flex';
            showMainScreen('dashboard-screen');
            
            // Mettre √† jour le texte d'abonnement dans le profil
            updateProfileSubscriptionText();
        }

        // Gestion d'abonnement dans le profil
        function showSubscriptionManagement() {
            document.getElementById('profile-main-section').style.display = 'none';
            document.getElementById('subscription-management-section').style.display = 'block';
            updateSubscriptionDisplay();
        }

        function updateSubscriptionDisplay() {
            const statusContainer = document.getElementById('currentSubscriptionStatus');
            const plan = localStorage.getItem('subscriptionPlan') || 'none';
            const status = localStorage.getItem('subscriptionStatus') || 'none';
            
            if (plan === 'free' || plan === 'none') {
                statusContainer.innerHTML = `
                    <h3>Plan Gratuit</h3>
                    <p>Vous utilisez actuellement le plan gratuit</p>
                    <div style="margin-top: 15px;">
                        <strong>Limites actuelles :</strong>
                        <ul style="margin: 10px 0; text-align: left; max-width: 300px; margin-left: auto; margin-right: auto;">
                            <li>3 √©valuations d'humeur par mois</li>
                            <li>Fonctionnalit√©s de base uniquement</li>
                        </ul>
                    </div>
                `;
                
                // Mettre √† jour les boutons
                document.getElementById('freePlanBtn').textContent = 'Plan actuel';
                document.getElementById('freePlanBtn').disabled = true;
                document.getElementById('monthlyPlanBtn').textContent = 'Passer au premium';
                document.getElementById('annualPlanBtn').textContent = 'Meilleure offre';
                
                // Masquer les informations de facturation
                document.getElementById('billingInfo').style.display = 'none';
                document.getElementById('paymentHistory').style.display = 'none';
                
            } else if (status === 'trial') {
                const trialEnd = localStorage.getItem('trialEndDate');
                const endDate = new Date(trialEnd);
                const now = new Date();
                const daysLeft = Math.max(0, Math.ceil((endDate - now) / (1000 * 60 * 60 * 24)));
                
                const planName = plan === 'annual' ? 'Premium Annuel' : 'Premium Mensuel';
                
                statusContainer.innerHTML = `
                    <h3>üéÅ Essai gratuit ${planName}</h3>
                    <p>Profitez de toutes les fonctionnalit√©s premium</p>
                    <div class="trial-progress">
                        <div class="trial-days">${daysLeft}</div>
                        <div>jours restants</div>
                        <div style="margin-top: 10px; font-size: 14px;">
                            Fin de l'essai : ${endDate.toLocaleDateString('fr-FR')}
                        </div>
                    </div>
                `;
                
                // Mettre √† jour les boutons
                if (plan === 'monthly') {
                    document.getElementById('monthlyPlanBtn').textContent = 'Plan actuel (Essai)';
                    document.getElementById('monthlyPlanBtn').disabled = true;
                } else {
                    document.getElementById('annualPlanBtn').textContent = 'Plan actuel (Essai)';
                    document.getElementById('annualPlanBtn').disabled = true;
                }
                
                document.getElementById('freePlanBtn').textContent = 'R√©trograder (Fin d\'essai)';
                
                // Afficher les informations de facturation
                document.getElementById('billingInfo').style.display = 'block';
                updateBillingInfo(plan, endDate);
                
            } else if (status === 'active') {
                const planName = plan === 'annual' ? 'Premium Annuel' : 'Premium Mensuel';
                const price = plan === 'annual' ? '59,99‚Ç¨/an' : '9,99‚Ç¨/mois';
                
                statusContainer.innerHTML = `
                    <h3>‚ú® ${planName} Actif</h3>
                    <p>Vous avez acc√®s √† toutes les fonctionnalit√©s premium</p>
                    <div style="margin-top: 15px; font-size: 18px;">
                        <strong>${price}</strong>
                    </div>
                `;
                
                // Mettre √† jour les boutons
                if (plan === 'monthly') {
                    document.getElementById('monthlyPlanBtn').textContent = 'Plan actuel';
                    document.getElementById('monthlyPlanBtn').disabled = true;
                    document.getElementById('annualPlanBtn').textContent = '√âconomiser avec l\'annuel';
                } else {
                    document.getElementById('annualPlanBtn').textContent = 'Plan actuel';
                    document.getElementById('annualPlanBtn').disabled = true;
                    document.getElementById('monthlyPlanBtn').textContent = 'Passer au mensuel';
                }
                
                document.getElementById('freePlanBtn').textContent = 'R√©trograder au gratuit';
                
                // Afficher les informations de facturation
                document.getElementById('billingInfo').style.display = 'block';
                document.getElementById('paymentHistory').style.display = 'block';
                updateBillingInfo(plan);
            }
            
            // Mettre √† jour le texte dans le menu du profil
            updateProfileSubscriptionText();
        }

        function updateProfileSubscriptionText() {
            const textElement = document.getElementById('subscriptionStatusText');
            const plan = localStorage.getItem('subscriptionPlan') || 'none';
            const status = localStorage.getItem('subscriptionStatus') || 'none';
            
            if (plan === 'free' || plan === 'none') {
                textElement.textContent = 'Plan Gratuit - Passer au Premium';
            } else if (status === 'trial') {
                const trialEnd = localStorage.getItem('trialEndDate');
                const endDate = new Date(trialEnd);
                const now = new Date();
                const daysLeft = Math.max(0, Math.ceil((endDate - now) / (1000 * 60 * 60 * 24)));
                textElement.textContent = `Essai Premium - ${daysLeft} jours restants`;
            } else if (status === 'active') {
                const planName = plan === 'annual' ? 'Premium Annuel' : 'Premium Mensuel';
                textElement.textContent = `${planName} Actif`;
            }
        }

        function updateBillingInfo(plan, trialEnd = null) {
            const nextBillingElement = document.getElementById('nextBillingDate');
            
            if (trialEnd) {
                nextBillingElement.textContent = trialEnd.toLocaleDateString('fr-FR');
            } else {
                // Simuler une date de facturation
                const nextBilling = new Date();
                if (plan === 'annual') {
                    nextBilling.setFullYear(nextBilling.getFullYear() + 1);
                } else {
                    nextBilling.setMonth(nextBilling.getMonth() + 1);
                }
                nextBillingElement.textContent = nextBilling.toLocaleDateString('fr-FR');
            }
        }

        function switchToPlan(planType) {
            if (planType === 'free') {
                if (confirm('√ätes-vous s√ªr de vouloir passer au plan gratuit ? Vous perdrez l\'acc√®s aux fonctionnalit√©s premium.')) {
                    localStorage.setItem('subscriptionPlan', 'free');
                    localStorage.setItem('subscriptionStatus', 'active');
                    localStorage.removeItem('trialEndDate');
                    updateSubscriptionDisplay();
                    alert('Vous √™tes maintenant sur le plan gratuit.');
                }
            }
        }

        function upgradeToPremium(planType) {
            // Rediriger vers l'√©cran de paiement pour la mise √† niveau
            alert(`Redirection vers le paiement pour le plan ${planType === 'annual' ? 'annuel' : 'mensuel'}...`);
            // Ici on pourrait impl√©menter la logique de paiement compl√®te
        }

        function updatePaymentMethod() {
            alert('Fonctionnalit√© de mise √† jour du moyen de paiement √† impl√©menter.');
        }

        function cancelSubscription() {
            if (confirm('√ätes-vous s√ªr de vouloir annuler votre abonnement ? Vous garderez l\'acc√®s jusqu\'√† la fin de votre p√©riode de facturation actuelle.')) {
                // Simuler l'annulation
                localStorage.setItem('subscriptionStatus', 'cancelled');
                alert('Votre abonnement a √©t√© annul√©. Vous garderez l\'acc√®s jusqu\'√† la fin de votre p√©riode de facturation.');
                updateSubscriptionDisplay();
            }
        }

        // Fonctions pour les nouvelles sections du profil
        
        // Diagnostic de sant√©
        function showHealthDiagnostic() {
            document.getElementById('profile-main-section').style.display = 'none';
            document.getElementById('health-diagnostic-section').style.display = 'block';
            updateHealthScore();
        }

        function updateHealthScore() {
            // Simuler un calcul de score de sant√© bas√© sur les donn√©es utilisateur
            const moodData = JSON.parse(localStorage.getItem('userMoodHistory') || '[]');
            let baseScore = 70;
            
            if (moodData.length > 0) {
                const recentMoods = moodData.slice(-7);
                const avgMood = recentMoods.reduce((sum, entry) => sum + (entry.overallScore || 5), 0) / recentMoods.length;
                baseScore = Math.round((avgMood / 10) * 100);
            }
            
            document.getElementById('healthScore').textContent = baseScore;
        }

        function startSleepProgram() {
            alert('Programme d\'am√©lioration du sommeil d√©marr√© ! Vous recevrez des conseils personnalis√©s chaque jour.');
        }

        function startBreathingExercise() {
            alert('Redirection vers l\'exercice de respiration guid√©e...');
        }

        // Rappels et notifications
        function showRemindersNotifications() {
            document.getElementById('profile-main-section').style.display = 'none';
            document.getElementById('reminders-notifications-section').style.display = 'block';
        }

        function toggleReminder(reminderId) {
            const button = event.target;
            const isActive = button.classList.contains('active');
            
            if (isActive) {
                button.classList.remove('active');
                button.textContent = 'OFF';
                localStorage.setItem(`reminder_${reminderId}`, 'false');
            } else {
                button.classList.add('active');
                button.textContent = 'ON';
                localStorage.setItem(`reminder_${reminderId}`, 'true');
            }
        }

        function editReminder(reminderId) {
            const reminderName = reminderId.replace('-', ' ').replace(/\b\w/g, l => l.toUpperCase());
            const newTime = prompt(`Nouvelle heure pour ${reminderName}:`, '20:00');
            if (newTime) {
                localStorage.setItem(`reminder_${reminderId}_time`, newTime);
                alert(`Rappel "${reminderName}" mis √† jour pour ${newTime}`);
            }
        }

        function addNewReminder() {
            const reminderType = prompt('Type de rappel:\n1. M√©dication\n2. Exercice\n3. M√©ditation\n4. Autre', '4');
            const reminderName = prompt('Nom du rappel:', '');
            const reminderTime = prompt('Heure (HH:MM):', '20:00');
            
            if (reminderName && reminderTime) {
                alert(`Nouveau rappel "${reminderName}" cr√©√© pour ${reminderTime}`);
                // Ici on pourrait ajouter le rappel √† l'interface
            }
        }

        function toggleSetting(settingName) {
            const button = event.target;
            button.classList.toggle('active');
            const isActive = button.classList.contains('active');
            localStorage.setItem(`setting_${settingName}`, isActive.toString());
        }

        // Apparence et th√®me
        function showAppearanceSettings() {
            document.getElementById('profile-main-section').style.display = 'none';
            document.getElementById('appearance-settings-section').style.display = 'block';
        }

        function selectMoodTheme(themeName) {
            // Retirer la s√©lection pr√©c√©dente
            document.querySelectorAll('.theme-option').forEach(option => {
                option.classList.remove('selected');
            });
            
            // S√©lectionner le nouveau th√®me
            event.target.closest('.theme-option').classList.add('selected');
            
            // Sauvegarder la pr√©f√©rence
            localStorage.setItem('selectedTheme', themeName);
            
            // Appliquer le th√®me
            applyTheme(themeName);
        }

        function applyTheme(themeName) {
            const themes = {
                joy: {
                    primary: '#FFD700',
                    secondary: '#FFF8DC',
                    accent: '#FF6347'
                },
                calm: {
                    primary: '#4FC3F7',
                    secondary: '#E3F2FD',
                    accent: '#29B6F6'
                },
                energy: {
                    primary: '#FF5722',
                    secondary: '#FFEBEE',
                    accent: '#F44336'
                },
                serenity: {
                    primary: '#8A2BE2',
                    secondary: '#E8E3F3',
                    accent: '#9C27B0'
                }
            };
            
            const theme = themes[themeName] || themes.serenity;
            
            // Appliquer les couleurs (simulation)
            document.documentElement.style.setProperty('--primary-color', theme.primary);
            document.documentElement.style.setProperty('--secondary-color', theme.secondary);
            document.documentElement.style.setProperty('--accent-color', theme.accent);
            
            // Mettre √† jour l'aper√ßu
            updateThemePreview(themeName, theme);
        }

        function updateThemePreview(themeName, theme) {
            const preview = document.getElementById('currentThemePreview');
            const colorDots = preview.querySelectorAll('.color-dot');
            colorDots[0].style.background = theme.primary;
            colorDots[1].style.background = theme.secondary;
            colorDots[2].style.background = theme.accent;
            
            const themeNames = {
                joy: 'Joie',
                calm: 'Calme',
                energy: '√ânergie',
                serenity: 'S√©r√©nit√©'
            };
            
            preview.querySelector('h4').textContent = `Th√®me ${themeNames[themeName]}`;
        }

        function toggleAdaptiveTheme() {
            const button = event.target;
            button.classList.toggle('active');
            const isActive = button.classList.contains('active');
            localStorage.setItem('adaptiveTheme', isActive.toString());
        }

        function toggleDarkMode() {
            const button = event.target;
            button.classList.toggle('active');
            const isActive = button.classList.contains('active');
            document.body.classList.toggle('dark-mode', isActive);
            localStorage.setItem('darkMode', isActive.toString());
        }

        function toggleAnimatedEmojis() {
            const button = event.target;
            button.classList.toggle('active');
            const isActive = button.classList.contains('active');
            localStorage.setItem('animatedEmojis', isActive.toString());
        }

        function changeFontSize(size) {
            const sizes = {
                small: '14px',
                medium: '16px',
                large: '18px'
            };
            
            document.documentElement.style.setProperty('--base-font-size', sizes[size]);
            localStorage.setItem('fontSize', size);
        }

        // Guide de suivi
        function showFollowUpGuide() {
            document.getElementById('profile-main-section').style.display = 'none';
            document.getElementById('follow-up-guide-section').style.display = 'block';
            initProgressChart();
        }

        function initProgressChart() {
            const canvas = document.getElementById('progressChart');
            if (canvas && canvas.getContext) {
                const ctx = canvas.getContext('2d');
                
                // Donn√©es simul√©es pour le graphique
                const data = [65, 70, 68, 75, 72, 78, 76, 82, 85, 80, 88];
                const max = Math.max(...data);
                const min = Math.min(...data);
                
                // Dessiner le graphique
                ctx.clearRect(0, 0, canvas.width, canvas.height);
                ctx.strokeStyle = '#8A2BE2';
                ctx.lineWidth = 3;
                ctx.beginPath();
                
                for (let i = 0; i < data.length; i++) {
                    const x = (i / (data.length - 1)) * (canvas.width - 20) + 10;
                    const y = canvas.height - 10 - ((data[i] - min) / (max - min)) * (canvas.height - 20);
                    
                    if (i === 0) {
                        ctx.moveTo(x, y);
                    } else {
                        ctx.lineTo(x, y);
                    }
                }
                
                ctx.stroke();
                
                // Points
                ctx.fillStyle = '#8A2BE2';
                for (let i = 0; i < data.length; i++) {
                    const x = (i / (data.length - 1)) * (canvas.width - 20) + 10;
                    const y = canvas.height - 10 - ((data[i] - min) / (max - min)) * (canvas.height - 20);
                    
                    ctx.beginPath();
                    ctx.arc(x, y, 4, 0, 2 * Math.PI);
                    ctx.fill();
                }
            }
        }

        function addPersonalGoal() {
            const goalName = prompt('Nom de l\'objectif:', '');
            const goalDescription = prompt('Description:', '');
            
            if (goalName && goalDescription) {
                alert(`Nouvel objectif "${goalName}" ajout√© avec succ√®s !`);
                // Ici on pourrait ajouter l'objectif √† l'interface
            }
        }

        function continueJourney(journeyId) {
            alert(`Redirection vers le module "${journeyId}"...`);
        }

        // Assistante IA
        function showAIAssistant() {
            document.getElementById('profile-main-section').style.display = 'none';
            document.getElementById('ai-assistant-section').style.display = 'block';
        }

        function sendMessageToAI() {
            const input = document.getElementById('aiChatInput');
            const message = input.value.trim();
            
            if (message) {
                addChatMessage(message, 'user');
                input.value = '';
                
                // Simuler une r√©ponse de l'IA apr√®s un d√©lai
                setTimeout(() => {
                    const aiResponse = generateAIResponse(message);
                    addChatMessage(aiResponse, 'ai');
                }, 1000);
            }
        }

        function addChatMessage(message, sender) {
            const chatContainer = document.getElementById('aiChatContainer');
            const messageDiv = document.createElement('div');
            messageDiv.className = `chat-message ${sender}-message`;
            
            const now = new Date();
            const timeString = now.toLocaleTimeString('fr-FR', {hour: '2-digit', minute: '2-digit'});
            
            if (sender === 'ai') {
                messageDiv.innerHTML = `
                    <div class="message-avatar">ü§ñ</div>
                    <div class="message-content">
                        <p>${message}</p>
                        <span class="message-time">√Ä l'instant</span>
                    </div>
                `;
            } else {
                messageDiv.innerHTML = `
                    <div class="message-content">
                        <p>${message}</p>
                        <span class="message-time">√Ä l'instant</span>
                    </div>
                    <div class="message-avatar">üë§</div>
                `;
            }
            
            chatContainer.appendChild(messageDiv);
            chatContainer.scrollTop = chatContainer.scrollHeight;
        }

        function generateAIResponse(userMessage) {
            const responses = [
                "Je comprends votre situation. Voici quelques suggestions personnalis√©es pour vous aider.",
                "Bas√© sur vos habitudes, je recommande de prendre quelques minutes pour vous d√©tendre.",
                "C'est tout √† fait normal de se sentir ainsi. Voulez-vous essayer un exercice de relaxation ?",
                "Je remarque que vous avez fait des progr√®s r√©cemment. Continuez sur cette voie !",
                "Prenons un moment pour analyser vos sentiments actuels. Que ressentez-vous le plus ?",
                "Votre bien-√™tre est important. Je suis l√† pour vous accompagner dans votre parcours."
            ];
            
            return responses[Math.floor(Math.random() * responses.length)];
        }

        function startGuidedBreathing() {
            alert('D√©marrage de l\'exercice de respiration guid√©e...');
        }

        function postponeActivity() {
            alert('Activit√© report√©e. Je vous rappellerai plus tard.');
        }

        function updateAIPersonality(personality) {
            localStorage.setItem('aiPersonality', personality);
            alert(`Personnalit√© de LUNA mise √† jour vers: ${personality}`);
        }

        function updateCheckInFrequency(frequency) {
            localStorage.setItem('aiCheckInFrequency', frequency);
            alert(`Fr√©quence des check-ins mise √† jour vers: ${frequency}`);
        }

        // Param√®tres avanc√©s
        function showAdvancedSettings() {
            document.getElementById('profile-main-section').style.display = 'none';
            document.getElementById('advanced-settings-section').style.display = 'block';
        }

        function changeAppLanguage(language) {
            localStorage.setItem('appLanguage', language);
            alert(`Langue chang√©e vers: ${language}. L'application red√©marrera pour appliquer les changements.`);
            // Ici on pourrait impl√©menter la vraie logique de changement de langue
        }

        function changeDateFormat(format) {
            localStorage.setItem('dateFormat', format);
            alert(`Format de date chang√© vers: ${format}`);
        }

        function manageHealthDataPrivacy() {
            alert('Redirection vers la gestion de la confidentialit√© des donn√©es de sant√©...');
        }

        function toggleAnonymousDataSharing() {
            const button = event.target;
            button.classList.toggle('active');
            const isActive = button.classList.contains('active');
            localStorage.setItem('anonymousDataSharing', isActive.toString());
        }

        function toggleBiometricAuth() {
            const button = event.target;
            button.classList.toggle('active');
            const isActive = button.classList.contains('active');
            localStorage.setItem('biometricAuth', isActive.toString());
            
            if (isActive) {
                alert('Authentification biom√©trique activ√©e. Configurez votre empreinte ou Face ID dans les param√®tres de votre appareil.');
            }
        }

        function manageDataHistory() {
            alert('Redirection vers l\'historique et gestion des donn√©es...');
        }

        function toggleHighContrast() {
            const button = event.target;
            button.classList.toggle('active');
            const isActive = button.classList.contains('active');
            document.body.classList.toggle('high-contrast', isActive);
            localStorage.setItem('highContrast', isActive.toString());
        }

        function toggleTextToSpeech() {
            const button = event.target;
            button.classList.toggle('active');
            const isActive = button.classList.contains('active');
            localStorage.setItem('textToSpeech', isActive.toString());
        }

        function toggleReducedMotion() {
            const button = event.target;
            button.classList.toggle('active');
            const isActive = button.classList.contains('active');
            document.body.classList.toggle('reduced-motion', isActive);
            localStorage.setItem('reducedMotion', isActive.toString());
        }

        function exportUserData() {
            if (confirm('Voulez-vous exporter toutes vos donn√©es ? Un fichier sera t√©l√©charg√©.')) {
                // Simuler l'export des donn√©es
                const userData = {
                    profile: JSON.parse(localStorage.getItem('userProfile') || '{}'),
                    moodHistory: JSON.parse(localStorage.getItem('userMoodHistory') || '[]'),
                    settings: {
                        language: localStorage.getItem('appLanguage') || 'fr',
                        theme: localStorage.getItem('selectedTheme') || 'serenity',
                        notifications: localStorage.getItem('setting_push-notifications') === 'true'
                    },
                    exportDate: new Date().toISOString()
                };
                
                const dataStr = JSON.stringify(userData, null, 2);
                const dataBlob = new Blob([dataStr], {type: 'application/json'});
                const url = URL.createObjectURL(dataBlob);
                
                const link = document.createElement('a');
                link.href = url;
                link.download = 'mindly-data-export.json';
                link.click();
                
                URL.revokeObjectURL(url);
                alert('Vos donn√©es ont √©t√© export√©es avec succ√®s !');
            }
        }

        function resetAppData() {
            if (confirm('ATTENTION: Cette action supprimera toutes vos donn√©es et param√®tres. Cette action est irr√©versible. Continuer ?')) {
                // Sauvegarder les donn√©es d'abonnement
                const subscriptionData = {
                    plan: localStorage.getItem('subscriptionPlan'),
                    status: localStorage.getItem('subscriptionStatus'),
                    trialEnd: localStorage.getItem('trialEndDate')
                };
                
                // Vider le localStorage
                localStorage.clear();
                
                // Restaurer les donn√©es d'abonnement
                if (subscriptionData.plan) {
                    localStorage.setItem('subscriptionPlan', subscriptionData.plan);
                    localStorage.setItem('subscriptionStatus', subscriptionData.status);
                    if (subscriptionData.trialEnd) {
                        localStorage.setItem('trialEndDate', subscriptionData.trialEnd);
                    }
                }
                
                alert('Application r√©initialis√©e. La page va se recharger.');
                location.reload();
            }
        }

        function deleteAccount() {
            const confirmation = prompt('Pour supprimer votre compte, tapez "SUPPRIMER" (en majuscules):');
            
            if (confirmation === 'SUPPRIMER') {
                if (confirm('Derni√®re confirmation: Voulez-vous vraiment supprimer d√©finitivement votre compte et toutes vos donn√©es ?')) {
                    // Simuler la suppression du compte
                    localStorage.clear();
                    alert('Votre compte a √©t√© supprim√©. Merci d\'avoir utilis√© MINDLY.');
                    // Rediriger vers une page de confirmation ou recharger
                    location.reload();
                }
            } else if (confirmation !== null) {
                alert('Suppression annul√©e. Vous devez taper exactement "SUPPRIMER" pour confirmer.');
            }
        }

        // Gestion de l'√©cran de param√®tres avanc√©s Enter key
        document.addEventListener('DOMContentLoaded', function() {
            const aiChatInput = document.getElementById('aiChatInput');
            if (aiChatInput) {
                aiChatInput.addEventListener('keypress', function(e) {
                    if (e.key === 'Enter') {
                        sendMessageToAI();
                    }
                });
            }
        });

        // Nouvelles fonctionnalit√©s bas√©es sur la recherche utilisateur
        
        // Analyse du stress et overthinking
        function showStressAnalysis() {
            document.getElementById('profile-main-section').style.display = 'none';
            document.getElementById('stress-analysis-section').style.display = 'block';
        }

        function updateStressValue(value) {
            document.getElementById('stressValue').textContent = value;
        }

        function analyzeStressData() {
            // R√©cup√©rer les donn√©es du questionnaire
            const stressLevel = document.getElementById('stressLevel').value;
            const overthinking = document.querySelector('input[name="overthinking"]:checked').value;
            const impact = document.querySelector('input[name="impact"]:checked').value;
            
            // R√©cup√©rer les sources de stress
            const stressSources = Array.from(document.querySelectorAll('.checkbox-options input[type="checkbox"]:checked'))
                .map(cb => cb.value);
            
            // R√©cup√©rer les sympt√¥mes
            const symptoms = Array.from(document.querySelectorAll('.checkbox-options input[type="checkbox"]:checked'))
                .map(cb => cb.value);
            
            // Calculer les scores
            const stressScore = parseFloat(stressLevel);
            const overthinkingScore = parseFloat(overthinking) * 2; // Sur 10
            const impactScore = parseFloat(impact) * 2;
            
            // Afficher les r√©sultats
            document.getElementById('overallStressScore').textContent = stressScore.toFixed(1);
            document.getElementById('overthinkingScore').textContent = overthinkingScore.toFixed(1);
            
            // D√©terminer les cat√©gories
            const stressCategory = getStressCategory(stressScore);
            const overthinkingCategory = getStressCategory(overthinkingScore);
            
            document.getElementById('stressCategory').textContent = stressCategory;
            document.getElementById('overthinkingCategory').textContent = overthinkingCategory;
            
            // G√©n√©rer l'analyse
            generateStressAnalysis(stressScore, overthinkingScore, stressSources, symptoms, impactScore);
            
            // Afficher les r√©sultats
            document.getElementById('stressResults').style.display = 'block';
            document.getElementById('stressResults').scrollIntoView({ behavior: 'smooth' });
            
            // Sauvegarder pour l'historique
            saveStressAnalysis({
                date: new Date().toISOString(),
                stressScore,
                overthinkingScore,
                stressSources,
                symptoms,
                impactScore
            });
        }

        function getStressCategory(score) {
            if (score <= 3) return 'Faible';
            if (score <= 5) return 'Mod√©r√©';
            if (score <= 7) return '√âlev√©';
            return 'Tr√®s √©lev√©';
        }

        function generateStressAnalysis(stressScore, overthinkingScore, sources, symptoms, impact) {
            const analysisElement = document.getElementById('analysisText');
            const recommendationElement = document.getElementById('recommendationList');
            const actionPlanElement = document.getElementById('actionPlan');
            
            // G√©n√©rer l'analyse textuelle
            let analysisText = `Votre √©valuation r√©v√®le un niveau de stress de ${stressScore}/10 et un indice d'overthinking de ${overthinkingScore}/10. `;
            
            if (stressScore >= 7) {
                analysisText += "Votre niveau de stress est pr√©occupant et n√©cessite une attention imm√©diate. ";
            } else if (stressScore >= 5) {
                analysisText += "Votre stress est dans une zone d'attention qui b√©n√©ficierait d'interventions cibl√©es. ";
            }
            
            if (overthinkingScore >= 7) {
                analysisText += "Le niveau d'overthinking d√©tect√© peut significativement affecter votre bien-√™tre quotidien et vos performances cognitives.";
            }
            
            analysisElement.textContent = analysisText;
            
            // G√©n√©rer les recommandations
            const recommendations = generateRecommendations(stressScore, overthinkingScore, sources);
            recommendationElement.innerHTML = recommendations.map(rec => 
                `<div class="recommendation-item">
                    <span class="recommendation-icon">${rec.icon}</span>
                    <span>${rec.text}</span>
                </div>`
            ).join('');
            
            // G√©n√©rer le plan d'action
            const actionSteps = generateActionPlan(stressScore, overthinkingScore);
            actionPlanElement.innerHTML = actionSteps.map((step, index) => 
                `<div class="plan-step">
                    <span class="step-icon">${index + 1}Ô∏è‚É£</span>
                    <span>${step}</span>
                </div>`
            ).join('');
        }

        function generateRecommendations(stressScore, overthinkingScore, sources) {
            const recommendations = [];
            
            if (stressScore >= 7) {
                recommendations.push({
                    icon: 'üö®',
                    text: 'Consultez un professionnel de la sant√© mentale dans les plus brefs d√©lais'
                });
            }
            
            if (overthinkingScore >= 6) {
                recommendations.push({
                    icon: 'üßò',
                    text: 'Pratiquez la m√©ditation de pleine conscience 10 minutes par jour'
                });
            }
            
            if (sources.includes('travail')) {
                recommendations.push({
                    icon: '‚öñÔ∏è',
                    text: '√âtablissez des limites claires entre vie professionnelle et personnelle'
                });
            }
            
            recommendations.push({
                icon: 'üò¥',
                text: 'Am√©liorez votre hygi√®ne de sommeil avec une routine r√©guli√®re'
            });
            
            recommendations.push({
                icon: 'üèÉ',
                text: 'Int√©grez 30 minutes d\'activit√© physique quotidienne'
            });
            
            return recommendations;
        }

        function generateActionPlan(stressScore, overthinkingScore) {
            const steps = [
                'Commencez par 5 minutes de respiration profonde chaque matin',
                'Tenez un journal des pens√©es pendant une semaine',
                'Identifiez vos d√©clencheurs de stress principaux',
                'Planifiez des pauses r√©guli√®res dans votre journ√©e'
            ];
            
            if (stressScore >= 6) {
                steps.push('Consultez votre m√©decin traitant pour discuter de votre stress');
            }
            
            if (overthinkingScore >= 7) {
                steps.push('Pratiquez des techniques de d√©fusion cognitive');
            }
            
            return steps;
        }

        function saveStressAnalysis(data) {
            const history = JSON.parse(localStorage.getItem('stressAnalysisHistory') || '[]');
            history.unshift(data);
            // Garder seulement les 10 derni√®res analyses
            if (history.length > 10) {
                history.splice(10);
            }
            localStorage.setItem('stressAnalysisHistory', JSON.stringify(history));
        }

        // Adaptation rythme de vie
        function showLifestyleAdapter() {
            document.getElementById('profile-main-section').style.display = 'none';
            document.getElementById('lifestyle-adapter-section').style.display = 'block';
        }

        function selectLifestyleProfile(profileType) {
            // Retirer les s√©lections pr√©c√©dentes
            document.querySelectorAll('.profile-card').forEach(card => {
                card.classList.remove('selected');
            });
            
            // S√©lectionner le nouveau profil
            event.target.closest('.profile-card').classList.add('selected');
            
            // Sauvegarder le choix
            localStorage.setItem('lifestyleProfile', profileType);
            
            // Configurer l'interface selon le profil
            configureForProfile(profileType);
            
            // Afficher la configuration
            document.getElementById('lifestyleConfig').style.display = 'block';
        }

        function configureForProfile(profileType) {
            const config = {
                student: {
                    morningAvailability: 'medium',
                    afternoonAvailability: 'high',
                    eveningAvailability: 'high',
                    stressPriority: 4,
                    sleepPriority: 3,
                    motivationPriority: 5,
                    socialPriority: 4,
                    sessionDuration: 'short'
                },
                professional: {
                    morningAvailability: 'low',
                    afternoonAvailability: 'low',
                    eveningAvailability: 'medium',
                    stressPriority: 5,
                    sleepPriority: 4,
                    motivationPriority: 4,
                    socialPriority: 2,
                    sessionDuration: 'medium'
                },
                mixed: {
                    morningAvailability: 'low',
                    afternoonAvailability: 'medium',
                    eveningAvailability: 'medium',
                    stressPriority: 5,
                    sleepPriority: 5,
                    motivationPriority: 5,
                    socialPriority: 3,
                    sessionDuration: 'short'
                }
            };
            
            const settings = config[profileType];
            
            // Appliquer les param√®tres par d√©faut
            document.getElementById('morningAvailability').value = settings.morningAvailability;
            document.getElementById('afternoonAvailability').value = settings.afternoonAvailability;
            document.getElementById('eveningAvailability').value = settings.eveningAvailability;
            document.getElementById('stressPriority').value = settings.stressPriority;
            document.getElementById('sleepPriority').value = settings.sleepPriority;
            document.getElementById('motivationPriority').value = settings.motivationPriority;
            document.getElementById('socialPriority').value = settings.socialPriority;
            document.querySelector(`input[name="sessionDuration"][value="${settings.sessionDuration}"]`).checked = true;
        }

        function saveLifestyleConfiguration() {
            const config = {
                profile: localStorage.getItem('lifestyleProfile'),
                availability: {
                    morning: document.getElementById('morningAvailability').value,
                    afternoon: document.getElementById('afternoonAvailability').value,
                    evening: document.getElementById('eveningAvailability').value
                },
                priorities: {
                    stress: parseInt(document.getElementById('stressPriority').value),
                    sleep: parseInt(document.getElementById('sleepPriority').value),
                    motivation: parseInt(document.getElementById('motivationPriority').value),
                    social: parseInt(document.getElementById('socialPriority').value)
                },
                sessionDuration: document.querySelector('input[name="sessionDuration"]:checked').value,
                configuredAt: new Date().toISOString()
            };
            
            localStorage.setItem('lifestyleConfiguration', JSON.stringify(config));
            
            // G√©n√©rer et afficher l'aper√ßu personnalis√©
            generatePersonalizedPreview(config);
            document.getElementById('personalizedPreview').style.display = 'block';
            
            alert('Configuration sauvegard√©e avec succ√®s ! Votre exp√©rience MINDLY est maintenant personnalis√©e.');
        }

        function generatePersonalizedPreview(config) {
            const remindersElement = document.getElementById('remindersPreview');
            const exercisesElement = document.getElementById('exercisesPreview');
            const trackingElement = document.getElementById('trackingPreview');
            
            // Personnaliser selon le profil
            if (config.profile === 'student') {
                remindersElement.textContent = 'Rappels adapt√©s aux horaires d\'√©tudes avec notifications entre les cours';
                exercisesElement.textContent = 'Sessions courtes de 3-5 minutes pour les pauses entre les cours';
                trackingElement.textContent = 'Suivi centr√© sur la gestion du stress d\'examens et la motivation';
            } else if (config.profile === 'professional') {
                remindersElement.textContent = 'Notifications discr√®tes pendant les heures de bureau';
                exercisesElement.textContent = 'Exercices de d√©compression pour les pauses d√©jeuner';
                trackingElement.textContent = 'M√©triques ax√©es sur l\'√©quilibre vie pro/perso et le burnout';
            } else {
                remindersElement.textContent = 'Rappels flexibles s\'adaptant √† votre emploi du temps variable';
                exercisesElement.textContent = 'Mix d\'exercices courts et moyens selon votre disponibilit√©';
                trackingElement.textContent = 'Suivi global prenant en compte vos multiples responsabilit√©s';
            }
        }

        // Centre de recherche
        function showStudyDetails(studyId) {
            const studies = {
                'meditation-anxiety': {
                    title: 'Impact de la m√©ditation sur l\'anxi√©t√© √©tudiante',
                    fullText: 'Cette √©tude men√©e par l\'Universit√© de Louvain sur 1,250 √©tudiants montre que la pratique quotidienne de 10 minutes de m√©ditation de pleine conscience r√©duit significativement les niveaux d\'anxi√©t√©. Les participants ont montr√© une am√©lioration de 34% de leurs scores d\'anxi√©t√© apr√®s 8 semaines de pratique r√©guli√®re...',
                    methodology: 'Essai contr√¥l√© randomis√© en double aveugle',
                    keyFindings: ['R√©duction de 34% de l\'anxi√©t√©', 'Am√©lioration du sommeil de 28%', 'Augmentation de la concentration de 22%']
                },
                'digital-therapy': {
                    title: 'Th√©rapies num√©riques pour la sant√© mentale',
                    fullText: 'Une m√©ta-analyse de 15 √©tudes internationales d√©montre l\'efficacit√© des applications de sant√© mentale...',
                    methodology: 'M√©ta-analyse de 15 √©tudes contr√¥l√©es',
                    keyFindings: ['Efficacit√© de 67% vs th√©rapie traditionnelle', 'Co√ªt r√©duit de 45%', 'Accessibilit√© 24h/24']
                },
                'overthinking-performance': {
                    title: 'Overthinking et performance cognitive',
                    fullText: 'Cette recherche examine l\'impact du surmenage mental sur les capacit√©s cognitives...',
                    methodology: '√âtude longitudinale sur 6 mois',
                    keyFindings: ['R√©duction de 28% des performances', 'Am√©lioration avec pleine conscience', 'Effets r√©versibles']
                }
            };
            
            const study = studies[studyId];
            if (study) {
                alert(`${study.title}\n\n${study.fullText}\n\nM√©thodologie: ${study.methodology}\n\nR√©sultats cl√©s:\n${study.keyFindings.join('\n')}`);
            }
        }

        function showTrendAnalysis(trendId) {
            const analyses = {
                'anxiety-increase': 'L\'augmentation de 15% des troubles anxieux chez les 18-25 ans est li√©e aux facteurs socio-√©conomiques, √† l\'incertitude professionnelle et aux impacts de la pand√©mie.',
                'digital-adoption': 'La pr√©f√©rence pour les solutions num√©riques refl√®te le besoin d\'accessibilit√©, d\'anonymat et de flexibilit√© de cette g√©n√©ration.',
                'ai-personalization': 'L\'intelligence artificielle permet d\'adapter les interventions en temps r√©el selon les besoins individuels, am√©liorant significativement l\'efficacit√©.'
            };
            
            alert(analyses[trendId] || 'Analyse non disponible.');
        }

        function joinResearchProgram() {
            if (confirm('Souhaitez-vous participer √† nos √©tudes de recherche ? Vos donn√©es resteront 100% anonymes et vous aiderez √† am√©liorer le bien-√™tre mental pour tous.')) {
                localStorage.setItem('researchParticipant', 'true');
                alert('Merci ! Vous faites maintenant partie de notre programme de recherche. Vous recevrez des invitations √† participer √† des √©tudes pertinentes.');
            }
        }

        // Tests d'utilisabilit√© int√©gr√©s
        function initUsabilityTesting() {
            // Suivre les interactions utilisateur pour am√©liorer l'UX
            let interactionData = JSON.parse(localStorage.getItem('usabilityData') || '[]');
            
            // Tracker les clics sur les √©l√©ments principaux
            document.addEventListener('click', function(e) {
                const element = e.target;
                const timestamp = new Date().toISOString();
                
                // Enregistrer les interactions importantes
                if (element.classList.contains('nav-item') || 
                    element.classList.contains('profile-menu-item') ||
                    element.classList.contains('mood-option')) {
                    
                    interactionData.push({
                        type: 'click',
                        element: element.className,
                        timestamp: timestamp,
                        screen: getCurrentScreen()
                    });
                    
                    // Limiter les donn√©es stock√©es
                    if (interactionData.length > 100) {
                        interactionData = interactionData.slice(-50);
                    }
                    
                    localStorage.setItem('usabilityData', JSON.stringify(interactionData));
                }
            });
        }

        function getCurrentScreen() {
            const visibleScreens = document.querySelectorAll('.screen-content:not([style*="display: none"])');
            return visibleScreens.length > 0 ? visibleScreens[0].id : 'unknown';
        }

        // Syst√®me de feedback continu
        function initFeedbackSystem() {
            // Afficher un prompt de feedback apr√®s certaines actions
            let actionCount = parseInt(localStorage.getItem('actionCount') || '0');
            actionCount++;
            localStorage.setItem('actionCount', actionCount.toString());
            
            // Demander feedback apr√®s 10 actions
            if (actionCount % 10 === 0) {
                setTimeout(() => {
                    if (confirm('Aidez-nous √† am√©liorer MINDLY ! Souhaitez-vous donner votre avis sur votre exp√©rience ?')) {
                        showFeedbackForm();
                    }
                }, 2000);
            }
        }

        function showFeedbackForm() {
            const feedback = prompt(`√âvaluez votre exp√©rience MINDLY (1-5 √©toiles) et ajoutez vos commentaires:

‚≠ê = Tr√®s mauvais
‚≠ê‚≠ê = Mauvais  
‚≠ê‚≠ê‚≠ê = Correct
‚≠ê‚≠ê‚≠ê‚≠ê = Bon
‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê = Excellent

Note (1-5): `);
            
            if (feedback) {
                const rating = parseInt(feedback);
                if (rating >= 1 && rating <= 5) {
                    const comment = prompt('Commentaires additionnels (optionnel):');
                    
                    // Sauvegarder le feedback
                    const feedbackData = {
                        rating: rating,
                        comment: comment || '',
                        timestamp: new Date().toISOString(),
                        userProfile: localStorage.getItem('lifestyleProfile') || 'unknown'
                    };
                    
                    const feedbackHistory = JSON.parse(localStorage.getItem('userFeedback') || '[]');
                    feedbackHistory.unshift(feedbackData);
                    localStorage.setItem('userFeedback', JSON.stringify(feedbackHistory));
                    
                    alert('Merci pour votre feedback ! Il nous aide √† am√©liorer continuellement MINDLY.');
                }
            }
        }

        // Adaptation automatique selon les donn√©es
        function adaptAppBasedOnUsage() {
            const usageData = JSON.parse(localStorage.getItem('usabilityData') || '[]');
            const userProfile = localStorage.getItem('lifestyleProfile');
            
            // Analyser les patterns d'usage
            if (usageData.length > 20) {
                const moodInteractions = usageData.filter(d => d.element.includes('mood')).length;
                const communityInteractions = usageData.filter(d => d.element.includes('community')).length;
                
                // Ajuster les recommandations
                if (moodInteractions > communityInteractions * 2) {
                    // L'utilisateur pr√©f√®re les fonctionnalit√©s de mood
                    localStorage.setItem('preferredFeature', 'mood-tracking');
                } else if (communityInteractions > moodInteractions * 2) {
                    // L'utilisateur pr√©f√®re la communaut√©
                    localStorage.setItem('preferredFeature', 'community');
                }
            }
        }

        // === SYST√àME D'AUTHENTIFICATION COMPLET ===
        
        // Variables globales pour l'authentification
        let isSignupMode = false;
        let googleAuth = null;
        let appleAuth = null;
        
        // F01.4 - Navigation anonyme
        function startAnonymousMode() {
            showAuthMessage('D√©marrage du mode anonyme...', 'loading');
            
            // G√©n√©rer un ID √©ph√©m√®re
            const anonymousId = 'anon_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9);
            
            // Marquer comme utilisateur anonyme
            const anonymousUser = {
                id: anonymousId,
                type: 'anonymous',
                createdAt: new Date().toISOString(),
                isDataSynced: false,
                canConvertToFullAccount: true
            };
            
            localStorage.setItem('currentUser', JSON.stringify(anonymousUser));
            localStorage.setItem('isAnonymous', 'true');
            
            showAuthMessage('Mode anonyme activ√© ! Vous pouvez explorer toutes les fonctionnalit√©s.', 'success');
            
            setTimeout(() => {
                showScreen('dashboard-screen');
                updateUIForAnonymousUser();
            }, 1500);
        }
        
        function updateUIForAnonymousUser() {
            // Ajouter des indications que l'utilisateur est en mode anonyme
            const dashboardTitle = document.querySelector('.dashboard-header h1');
            if (dashboardTitle) {
                dashboardTitle.innerHTML = 'MINDLY <span style="font-size: 0.6em; opacity: 0.7;">(Mode anonyme)</span>';
            }
            
            // Afficher un bouton de conversion vers compte complet
            showAnonymousConversionPrompt();
        }
        
        function showAnonymousConversionPrompt() {
            const conversionBanner = document.createElement('div');
            conversionBanner.className = 'anonymous-conversion-banner';
            conversionBanner.innerHTML = `
                <div class="conversion-content">
                    <span class="conversion-icon">üíæ</span>
                    <div class="conversion-text">
                        <strong>Cr√©ez un compte pour sauvegarder vos donn√©es</strong>
                        <small>Vos progr√®s ne seront pas perdus</small>
                    </div>
                    <button class="conversion-btn" onclick="convertAnonymousToFullAccount()">Cr√©er un compte</button>
                </div>
            `;
            
            const dashboard = document.getElementById('dashboard-screen');
            if (dashboard) {
                dashboard.insertBefore(conversionBanner, dashboard.firstChild);
            }
        }
        
        function convertAnonymousToFullAccount() {
            localStorage.setItem('convertingAnonymous', 'true');
            showScreen('login-screen');
            toggleAuthMode(); // Basculer vers inscription
            showAuthMessage('Cr√©ez votre compte pour sauvegarder vos donn√©es anonymes.', 'success');
        }
        
        // F01.1 - Authentification Google
        async function signInWithGoogle() {
            showAuthMessage('Connexion avec Google...', 'loading');
            
            try {
                // Simulation de l'OAuth Google (en production, utiliser l'API Google)
                const googleUser = await simulateGoogleOAuth();
                
                if (googleUser) {
                    await processOAuthLogin(googleUser, 'google');
                } else {
                    throw new Error('Connexion Google annul√©e');
                }
            } catch (error) {
                console.error('Erreur Google Auth:', error);
                showAuthMessage('Erreur lors de la connexion Google: ' + error.message, 'error');
            }
        }
        
        // F01.2 - Authentification Apple
        async function signInWithApple() {
            showAuthMessage('Connexion avec Apple...', 'loading');
            
            try {
                // Simulation de l'OAuth Apple (en production, utiliser Sign in with Apple)
                const appleUser = await simulateAppleOAuth();
                
                if (appleUser) {
                    await processOAuthLogin(appleUser, 'apple');
                } else {
                    throw new Error('Connexion Apple annul√©e');
                }
            } catch (error) {
                console.error('Erreur Apple Auth:', error);
                showAuthMessage('Erreur lors de la connexion Apple: ' + error.message, 'error');
            }
        }
        
        // Simulation OAuth pour d√©monstration
        async function simulateGoogleOAuth() {
            return new Promise((resolve) => {
                setTimeout(() => {
                    // Simuler les donn√©es retourn√©es par Google
                    resolve({
                        id: 'google_' + Math.random().toString(36).substr(2, 9),
                        email: 'utilisateur@gmail.com',
                        firstName: 'Jean',
                        lastName: 'Dupont',
                        picture: 'https://via.placeholder.com/150',
                        provider: 'google'
                    });
                }, 1000);
            });
        }
        
        async function simulateAppleOAuth() {
            return new Promise((resolve) => {
                setTimeout(() => {
                    // Simuler les donn√©es retourn√©es par Apple (souvent avec Hide my email)
                    const hideEmail = Math.random() > 0.5;
                    resolve({
                        id: 'apple_' + Math.random().toString(36).substr(2, 9),
                        email: hideEmail ? 'privaterelay.appleid.com' : 'utilisateur@icloud.com',
                        firstName: 'Marie',
                        lastName: 'Martin',
                        isEmailHidden: hideEmail,
                        provider: 'apple'
                    });
                }, 1000);
            });
        }
        
        async function processOAuthLogin(oauthUser, provider) {
            // V√©rifier si l'utilisateur existe d√©j√†
            const existingUsers = JSON.parse(localStorage.getItem('registeredUsers') || '[]');
            let user = existingUsers.find(u => u.oauthId === oauthUser.id || u.email === oauthUser.email);
            
            if (!user) {
                // Cr√©er un nouveau compte
                user = {
                    id: 'user_' + Date.now(),
                    oauthId: oauthUser.id,
                    oauthProvider: provider,
                    email: oauthUser.email,
                    firstName: oauthUser.firstName,
                    lastName: oauthUser.lastName,
                    picture: oauthUser.picture,
                    isEmailHidden: oauthUser.isEmailHidden || false,
                    createdAt: new Date().toISOString(),
                    isVerified: true, // OAuth users are pre-verified
                    // Consentements RGPD automatiques pour OAuth
                    consents: {
                        terms: { accepted: true, timestamp: new Date().toISOString(), ip: 'oauth' },
                        privacy: { accepted: true, timestamp: new Date().toISOString(), ip: 'oauth' },
                        marketing: { accepted: false, timestamp: null, ip: null }
                    }
                };
                
                existingUsers.push(user);
                localStorage.setItem('registeredUsers', JSON.stringify(existingUsers));
                
                showAuthMessage(`Compte ${provider} cr√©√© avec succ√®s !`, 'success');
            } else {
                showAuthMessage(`Connexion ${provider} r√©ussie !`, 'success');
            }
            
            // Fusionner les donn√©es anonymes si applicable
            await mergeAnonymousData(user);
            
            // Connexion
            localStorage.setItem('currentUser', JSON.stringify(user));
            localStorage.removeItem('isAnonymous');
            
            setTimeout(() => {
                showScreen('dashboard-screen');
            }, 1500);
        }
        
        // F01.3 - Authentification par email avec validation forte
        function checkPasswordStrength(password) {
            const strengthIndicator = document.getElementById('password-strength');
            if (!strengthIndicator) return;
            
            const requirements = {
                length: password.length >= 12,
                uppercase: /[A-Z]/.test(password),
                lowercase: /[a-z]/.test(password),
                numbers: /\d/.test(password),
                symbols: /[!@#$%^&*(),.?":{}|<>]/.test(password)
            };
            
            const score = Object.values(requirements).filter(Boolean).length;
            let strength = 'weak';
            let color = '#f44336';
            
            if (score >= 5) {
                strength = 'strong';
                color = '#4caf50';
            } else if (score >= 4) {
                strength = 'good';
                color = '#2196f3';
            } else if (score >= 3) {
                strength = 'fair';
                color = '#ff9800';
            }
            
            strengthIndicator.className = `password-strength ${strength}`;
            strengthIndicator.innerHTML = `<div class="password-strength-bar" style="background: ${color}; width: ${(score/5)*100}%"></div>`;
            
            return requirements;
        }
        
        async function signupWithEmail() {
            const form = document.getElementById('signup-form');
            const submitBtn = document.getElementById('signup-submit-btn');
            
            // Validation des champs
            const firstName = document.getElementById('signup-firstname').value.trim();
            const lastName = document.getElementById('signup-lastname').value.trim();
            const email = document.getElementById('signup-email').value.trim();
            const password = document.getElementById('signup-password').value;
            const confirmPassword = document.getElementById('signup-confirm-password').value;
            const termsAccepted = document.getElementById('consent-terms').checked;
            const privacyAccepted = document.getElementById('consent-privacy').checked;
            const marketingAccepted = document.getElementById('consent-marketing').checked;
            
            // Reset des erreurs
            clearAuthErrors();
            
            let hasErrors = false;
            
            // Validation pr√©nom/nom
            if (!firstName) {
                showFieldError('signup-firstname-error', 'Le pr√©nom est requis');
                hasErrors = true;
            }
            if (!lastName) {
                showFieldError('signup-lastname-error', 'Le nom est requis');
                hasErrors = true;
            }
            
            // Validation email
            const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
            if (!email) {
                showFieldError('signup-email-error', 'L\'email est requis');
                hasErrors = true;
            } else if (!emailRegex.test(email)) {
                showFieldError('signup-email-error', 'Format d\'email invalide');
                hasErrors = true;
            }
            
            // Validation mot de passe
            const passwordReqs = checkPasswordStrength(password);
            if (!password) {
                showFieldError('signup-password-error', 'Le mot de passe est requis');
                hasErrors = true;
            } else if (!Object.values(passwordReqs).every(Boolean)) {
                showFieldError('signup-password-error', 'Le mot de passe ne respecte pas tous les crit√®res');
                hasErrors = true;
            }
            
            if (password !== confirmPassword) {
                showFieldError('signup-confirm-password-error', 'Les mots de passe ne correspondent pas');
                hasErrors = true;
            }
            
            // Validation consentements RGPD
            if (!termsAccepted) {
                showFieldError('consent-terms-error', 'Vous devez accepter les CGU');
                hasErrors = true;
            }
            if (!privacyAccepted) {
                showFieldError('consent-privacy-error', 'Vous devez accepter la politique de confidentialit√©');
                hasErrors = true;
            }
            
            if (hasErrors) return;
            
            submitBtn.disabled = true;
            showAuthMessage('Cr√©ation du compte...', 'loading');
            
            try {
                // V√©rifier si l'email existe d√©j√†
                const existingUsers = JSON.parse(localStorage.getItem('registeredUsers') || '[]');
                if (existingUsers.find(u => u.email === email)) {
                    throw new Error('Un compte existe d√©j√† avec cet email');
                }
                
                // Cr√©er le nouveau compte
                const newUser = {
                    id: 'user_' + Date.now(),
                    email: email,
                    firstName: firstName,
                    lastName: lastName,
                    password: await hashPassword(password), // En production, hasher c√¥t√© serveur
                    createdAt: new Date().toISOString(),
                    isVerified: false,
                    verificationToken: generateVerificationToken(),
                    verificationExpiry: new Date(Date.now() + 24 * 60 * 60 * 1000).toISOString(), // 24h
                    consents: {
                        terms: { 
                            accepted: true, 
                            timestamp: new Date().toISOString(), 
                            ip: await getUserIP(),
                            version: '1.0'
                        },
                        privacy: { 
                            accepted: true, 
                            timestamp: new Date().toISOString(), 
                            ip: await getUserIP(),
                            version: '1.0'
                        },
                        marketing: { 
                            accepted: marketingAccepted, 
                            timestamp: marketingAccepted ? new Date().toISOString() : null, 
                            ip: marketingAccepted ? await getUserIP() : null
                        }
                    }
                };
                
                existingUsers.push(newUser);
                localStorage.setItem('registeredUsers', JSON.stringify(existingUsers));
                
                // Envoyer email de v√©rification (simulation)
                await sendVerificationEmail(newUser);
                
                showAuthMessage('Compte cr√©√© avec succ√®s !', 'success');
                
                // Afficher la modal de v√©rification email
                showEmailVerificationModal(email);
                
            } catch (error) {
                console.error('Erreur inscription:', error);
                showAuthMessage('Erreur lors de la cr√©ation du compte: ' + error.message, 'error');
            } finally {
                submitBtn.disabled = false;
            }
        }
        
        async function loginWithEmail() {
            const email = document.getElementById('login-email').value.trim();
            const password = document.getElementById('login-password').value;
            const submitBtn = document.getElementById('login-submit-btn');
            
            clearAuthErrors();
            
            if (!email || !password) {
                showAuthMessage('Veuillez remplir tous les champs', 'error');
                return;
            }
            
            submitBtn.disabled = true;
            showAuthMessage('Connexion...', 'loading');
            
            try {
                const existingUsers = JSON.parse(localStorage.getItem('registeredUsers') || '[]');
                const user = existingUsers.find(u => u.email === email);
                
                if (!user) {
                    throw new Error('Aucun compte trouv√© avec cet email');
                }
                
                if (!user.isVerified) {
                    throw new Error('Veuillez v√©rifier votre email avant de vous connecter');
                }
                
                const isPasswordValid = await verifyPassword(password, user.password);
                if (!isPasswordValid) {
                    throw new Error('Mot de passe incorrect');
                }
                
                // Fusionner les donn√©es anonymes si applicable
                await mergeAnonymousData(user);
                
                localStorage.setItem('currentUser', JSON.stringify(user));
                localStorage.removeItem('isAnonymous');
                
                showAuthMessage('Connexion r√©ussie !', 'success');
                
                setTimeout(() => {
                    showScreen('dashboard-screen');
                }, 1500);
                
            } catch (error) {
                console.error('Erreur connexion:', error);
                showAuthMessage('Erreur de connexion: ' + error.message, 'error');
            } finally {
                submitBtn.disabled = false;
            }
        }
        
        // Fonctions utilitaires
        function toggleAuthMode() {
            isSignupMode = !isSignupMode;
            const loginForm = document.getElementById('login-form');
            const signupForm = document.getElementById('signup-form');
            const toggleLink = document.getElementById('auth-toggle');
            
            if (isSignupMode) {
                loginForm.style.display = 'none';
                signupForm.style.display = 'block';
                toggleLink.textContent = 'D√©j√† un compte ? Se connecter';
            } else {
                loginForm.style.display = 'block';
                signupForm.style.display = 'none';
                toggleLink.textContent = 'Cr√©er un compte';
            }
        }
        
        function showAuthMessage(message, type) {
            const messagesContainer = document.getElementById('auth-messages');
            const errorDiv = document.getElementById('auth-error');
            const successDiv = document.getElementById('auth-success');
            const loadingDiv = document.getElementById('auth-loading');
            
            // Reset tous les messages
            errorDiv.style.display = 'none';
            successDiv.style.display = 'none';
            loadingDiv.style.display = 'none';
            
            // Afficher le bon message
            if (type === 'error') {
                errorDiv.textContent = message;
                errorDiv.style.display = 'block';
            } else if (type === 'success') {
                successDiv.textContent = message;
                successDiv.style.display = 'block';
            } else if (type === 'loading') {
                loadingDiv.querySelector('span:last-child').textContent = message;
                loadingDiv.style.display = 'block';
            }
            
            messagesContainer.style.display = 'block';
            
            // Auto-hide apr√®s 5 secondes sauf pour loading
            if (type !== 'loading') {
                setTimeout(() => {
                    messagesContainer.style.display = 'none';
                }, 5000);
            }
        }
        
        function clearAuthErrors() {
            const errorElements = document.querySelectorAll('.input-error');
            errorElements.forEach(el => el.textContent = '');
            
            const inputs = document.querySelectorAll('.form-input');
            inputs.forEach(input => input.classList.remove('error'));
        }
        
        function showFieldError(errorId, message) {
            const errorElement = document.getElementById(errorId);
            if (errorElement) {
                errorElement.textContent = message;
                const input = errorElement.previousElementSibling;
                if (input && input.classList.contains('form-input')) {
                    input.classList.add('error');
                }
            }
        }
        
        // Modal de v√©rification email
        function showEmailVerificationModal(email) {
            document.getElementById('verification-email').textContent = email;
            document.getElementById('email-verification-modal').style.display = 'flex';
        }
        
        function closeEmailVerificationModal() {
            document.getElementById('email-verification-modal').style.display = 'none';
        }
        
        async function resendVerificationEmail() {
            const email = document.getElementById('verification-email').textContent;
            showAuthMessage('Envoi de l\'email de v√©rification...', 'loading');
            
            // Simulation d'envoi
            setTimeout(() => {
                showAuthMessage('Email de v√©rification renvoy√© !', 'success');
                closeEmailVerificationModal();
            }, 1000);
        }
        
        // Fonctions de s√©curit√© (simulation)
        async function hashPassword(password) {
            // En production, utiliser bcrypt ou similar c√¥t√© serveur
            return btoa(password + 'salt_mindly_2024');
        }
        
        async function verifyPassword(password, hashedPassword) {
            const hashed = await hashPassword(password);
            return hashed === hashedPassword;
        }
        
        function generateVerificationToken() {
            return Math.random().toString(36).substr(2) + Date.now().toString(36);
        }
        
        async function getUserIP() {
            // En production, r√©cup√©rer l'IP r√©elle
            return '127.0.0.1';
        }
        
        async function sendVerificationEmail(user) {
            // Simulation d'envoi d'email
            console.log(`Email de v√©rification envoy√© √† ${user.email} avec token: ${user.verificationToken}`);
        }
        
        async function mergeAnonymousData(user) {
            const isConverting = localStorage.getItem('convertingAnonymous');
            if (isConverting) {
                // R√©cup√©rer toutes les donn√©es stock√©es localement
                const moodData = localStorage.getItem('moodHistory');
                const stressAnalysis = localStorage.getItem('stressAnalysisHistory');
                const lifestyleConfig = localStorage.getItem('lifestyleConfiguration');
                
                // Associer ces donn√©es au compte utilisateur
                if (moodData || stressAnalysis || lifestyleConfig) {
                    user.migratedData = {
                        moodHistory: moodData ? JSON.parse(moodData) : [],
                        stressAnalysis: stressAnalysis ? JSON.parse(stressAnalysis) : [],
                        lifestyleConfig: lifestyleConfig ? JSON.parse(lifestyleConfig) : null,
                        migratedAt: new Date().toISOString()
                    };
                    
                    showAuthMessage('Vos donn√©es anonymes ont √©t√© sauvegard√©es !', 'success');
                }
                
                localStorage.removeItem('convertingAnonymous');
            }
        }
        
        function showTerms() {
            alert('Conditions G√©n√©rales d\'Utilisation\n\nVersion 1.0 - Novembre 2024\n\n1. Acceptation des termes\n2. Description du service\n3. Utilisation acceptable\n4. Confidentialit√© des donn√©es\n5. Propri√©t√© intellectuelle\n\n[Document complet disponible sur notre site web]');
        }
        
        function showPrivacy() {
            alert('Politique de Confidentialit√©\n\nVersion 1.0 - Novembre 2024\n\n1. Collecte des donn√©es\n2. Utilisation des donn√©es\n3. Partage des donn√©es\n4. S√©curit√©\n5. Vos droits RGPD\n6. Contact\n\n[Document complet disponible sur notre site web]');
        }
        
        function showForgotPassword() {
            const email = prompt('Entrez votre adresse email pour r√©initialiser votre mot de passe:');
            if (email) {
                showAuthMessage('Email de r√©initialisation envoy√© !', 'success');
            }
        }

        // === SYST√àME DE CHAT IA AM√âLIOR√â (F01.6, F01.7, F01.8) ===
        
        let chatHistory = [];
        let isAITyping = false;
        let riskLevel = 0; // 0: faible, 1: mod√©r√©, 2: √©lev√©, 3: critique
        
        // Mots-cl√©s de d√©tresse pour d√©tection automatique
        const distressKeywords = {
            critique: ['suicide', 'tuer', 'mourir', 'finir', 'dispara√Ætre', 'partir pour toujours'],
            √©lev√©: ['d√©sespoir', 'plus d\'espoir', 'inutile', 'seul au monde', 'catastrophe', 'effondre'],
            mod√©r√©: ['angoisse', 'panique', 'crise', 'd√©borde', '√©puis√©', 'bout du rouleau']
        };
        
        // F01.6 - Chat IA empathique
        function sendUserMessage() {
            const input = document.getElementById('chatInput');
            const message = input.value.trim();
            
            if (!message || message.length === 0) {
                return;
            }
            
            if (message.length > 1000) {
                alert('Votre message d√©passe 1000 caract√®res. Veuillez le raccourcir.');
                return;
            }
            
            // Ajouter le message utilisateur
            addMessageToChat('user', message);
            
            // Vider l'input
            input.value = '';
            updateCharacterCount(input);
            
            // Analyser le contenu pour les signaux de d√©tresse
            analyzeMessageForDistress(message);
            
            // Simuler la r√©ponse de l'IA
            showAITyping();
            setTimeout(() => {
                generateAIResponse(message);
            }, 1500 + Math.random() * 1000); // D√©lai r√©aliste
        }
        
        function sendSuggestion(category, message) {
            // Masquer les suggestions apr√®s utilisation
            const suggestions = document.getElementById('quickSuggestions');
            if (suggestions) {
                suggestions.style.display = 'none';
            }
            
            sendUserMessage = function() {
                addMessageToChat('user', message);
                showAITyping();
                setTimeout(() => {
                    generateContextualResponse(category, message);
                }, 1500);
            };
            sendUserMessage();
        }
        
        function addMessageToChat(sender, message, isSystemMessage = false) {
            const chatMessages = document.getElementById('chatMessages');
            const messageDiv = document.createElement('div');
            const timestamp = new Date().toLocaleTimeString('fr-FR', {hour: '2-digit', minute: '2-digit'});
            
            if (sender === 'user') {
                messageDiv.className = 'user-message';
                messageDiv.innerHTML = `
                    <div class="message-content">
                        <div class="message-header">
                            <span class="sender-name">Vous</span>
                            <span class="message-time">${timestamp}</span>
                        </div>
                        <p>${escapeHtml(message)}</p>
                    </div>
                    <div class="message-avatar">üë§</div>
                `;
            } else {
                messageDiv.className = `ai-message ${isSystemMessage ? 'system-message' : ''}`;
                messageDiv.innerHTML = `
                    <div class="message-avatar">${isSystemMessage ? '‚ö†Ô∏è' : 'üåü'}</div>
                    <div class="message-content">
                        <div class="message-header">
                            <span class="sender-name">${isSystemMessage ? 'SYST√àME' : 'LUNA'}</span>
                            <span class="message-time">${timestamp}</span>
                        </div>
                        <div class="message-text">${message}</div>
                    </div>
                `;
            }
            
            chatMessages.appendChild(messageDiv);
            chatMessages.scrollTop = chatMessages.scrollHeight;
            
            // Sauvegarder dans l'historique
            chatHistory.push({
                sender,
                message: escapeHtml(message),
                timestamp: new Date().toISOString(),
                riskLevel: sender === 'user' ? riskLevel : 0
            });
            
            // Limiter l'historique
            if (chatHistory.length > 100) {
                chatHistory = chatHistory.slice(-100);
            }
            
            localStorage.setItem('chatHistory', JSON.stringify(chatHistory));
        }
        
        function showAITyping() {
            if (isAITyping) return;
            
            isAITyping = true;
            const typingIndicator = document.getElementById('typing-indicator');
            if (typingIndicator) {
                typingIndicator.style.display = 'flex';
                
                // Scroll vers l'indicateur
                setTimeout(() => {
                    typingIndicator.scrollIntoView({ behavior: 'smooth' });
                }, 100);
            }
        }
        
        function hideAITyping() {
            isAITyping = false;
            const typingIndicator = document.getElementById('typing-indicator');
            if (typingIndicator) {
                typingIndicator.style.display = 'none';
            }
        }
        
        // F01.8 - D√©tection de signaux de d√©tresse et escalade
        function analyzeMessageForDistress(message) {
            const lowerMessage = message.toLowerCase();
            let currentRiskLevel = 0;
            let triggeredKeywords = [];
            
            // Analyser les mots-cl√©s de d√©tresse
            for (const [level, keywords] of Object.entries(distressKeywords)) {
                for (const keyword of keywords) {
                    if (lowerMessage.includes(keyword)) {
                        triggeredKeywords.push({ keyword, level });
                        if (level === 'critique') currentRiskLevel = Math.max(currentRiskLevel, 3);
                        else if (level === '√©lev√©') currentRiskLevel = Math.max(currentRiskLevel, 2);
                        else if (level === 'mod√©r√©') currentRiskLevel = Math.max(currentRiskLevel, 1);
                    }
                }
            }
            
            // Analyser la structure des phrases (n√©gations r√©p√©t√©es, intensit√©)
            const negativePatterns = ['ne plus', 'plus rien', 'aucun', 'jamais', 'impossible'];
            const intensityPatterns = ['tr√®s', 'trop', 'extr√™mement', 'compl√®tement', 'totalement'];
            
            let negativeCount = 0;
            let intensityCount = 0;
            
            negativePatterns.forEach(pattern => {
                if (lowerMessage.includes(pattern)) negativeCount++;
            });
            
            intensityPatterns.forEach(pattern => {
                if (lowerMessage.includes(pattern)) intensityCount++;
            });
            
            // Ajuster le niveau de risque selon l'intensit√©
            if (negativeCount >= 2 && intensityCount >= 1) {
                currentRiskLevel = Math.max(currentRiskLevel, 2);
            } else if (negativeCount >= 1 && intensityCount >= 2) {
                currentRiskLevel = Math.max(currentRiskLevel, 1);
            }
            
            riskLevel = currentRiskLevel;
            
            // D√©clencher l'escalade si n√©cessaire
            if (currentRiskLevel >= 2) {
                triggerEmergencyProtocol(currentRiskLevel, triggeredKeywords);
            }
            
            console.log(`Analyse de d√©tresse: niveau ${currentRiskLevel}, mots-cl√©s: ${triggeredKeywords.map(t => t.keyword).join(', ')}`);
        }
        
        function triggerEmergencyProtocol(level, keywords) {
            const emergencyAlert = document.getElementById('emergency-alert');
            
            if (level >= 3) {
                // Niveau critique - intervention imm√©diate
                setTimeout(() => {
                    emergencyAlert.style.display = 'block';
                    addMessageToChat('ai', `Je per√ßois que vous traversez un moment tr√®s difficile. Votre s√©curit√© est ma priorit√© absolue. 

üÜò <strong>Ressources d'urgence imm√©diates :</strong>
‚Ä¢ <strong>Centre de Pr√©vention du Suicide : 0800 32 123</strong> (24h/24, gratuit)
‚Ä¢ <strong>Urgences : 112</strong>

Je vous encourage vivement √† contacter l'une de ces lignes maintenant. Vous n'√™tes pas seul(e), et de l'aide professionnelle est disponible.`, true);
                    
                    showEmergencyResources();
                }, 500);
                
            } else if (level >= 2) {
                // Niveau √©lev√© - ressources et soutien
                setTimeout(() => {
                    emergencyAlert.style.display = 'block';
                    addMessageToChat('ai', `Je sens que vous passez par une p√©riode particuli√®rement difficile. Il est important que vous sachiez que vous n'√™tes pas seul(e).

üíô <strong>Ressources de soutien disponibles :</strong>
‚Ä¢ <strong>T√©l√©-Accueil : 107</strong> (24h/24, √©coute bienveillante)
‚Ä¢ <strong>SOS Amiti√© : 0800 94 455</strong> (10h-24h)

Voulez-vous que nous parlions de ce qui vous pr√©occupe, ou pr√©f√©rez-vous que je vous mette en contact avec un professionnel ?`, true);
                }, 500);
            }
        }
        
        // F01.7 - Suggestions d'exercices contextuelles
        function generateAIResponse(userMessage) {
            hideAITyping();
            
            // Analyser le contexte pour g√©n√©rer une r√©ponse appropri√©e
            const context = analyzeMessageContext(userMessage);
            let response = '';
            let suggestedExercises = [];
            
            if (riskLevel >= 2) {
                // Priorit√© √† la s√©curit√©
                response = generateSafetyFocusedResponse(userMessage, context);
            } else {
                // R√©ponse empathique normale
                response = generateEmpathicResponse(userMessage, context);
                suggestedExercises = getSuggestedExercises(context);
            }
            
            addMessageToChat('ai', response);
            
            // Afficher les exercices sugg√©r√©s si pertinents
            if (suggestedExercises.length > 0) {
                showExerciseSuggestions(suggestedExercises);
            }
        }
        
        function generateContextualResponse(category, message) {
            hideAITyping();
            
            const responses = {
                stress: {
                    response: `Je comprends que vous vous sentiez stress√©(e). Le stress fait partie de la vie, mais il est important d'apprendre √† le g√©rer sainement.

üíô <strong>Quelques techniques qui peuvent vous aider :</strong>
‚Ä¢ Respirez profond√©ment : inspirez 4 temps, retenez 4 temps, expirez 6 temps
‚Ä¢ Identifiez la source de votre stress pour mieux l'aborder
‚Ä¢ Prenez des pauses r√©guli√®res dans votre journ√©e

Voulez-vous que nous explorions ensemble ce qui vous stresse en ce moment ?`,
                    exercises: ['respiration-profonde', 'scan-corporel', 'meditation-stress']
                },
                anxiety: {
                    response: `L'anxi√©t√© peut √™tre tr√®s envahissante, et je comprends √† quel point cela peut √™tre difficile √† vivre.

üå± <strong>Techniques d'apaisement :</strong>
‚Ä¢ Technique du 5-4-3-2-1 : nommez 5 choses que vous voyez, 4 que vous touchez, 3 que vous entendez, 2 que vous sentez, 1 que vous go√ªtez
‚Ä¢ Respirations lentes et contr√¥l√©es
‚Ä¢ Ancrage dans le moment pr√©sent

Voulez-vous essayer un exercice de relaxation maintenant ?`,
                    exercises: ['technique-54321', 'respiration-calmante', 'relaxation-progressive']
                },
                sad: {
                    response: `La tristesse est une √©motion naturelle et importante. Il est ok de se sentir triste, et c'est courageux de le partager.

üíù <strong>Petits pas vers le mieux-√™tre :</strong>
‚Ä¢ Acceptez vos √©motions sans vous juger
‚Ä¢ Contactez quelqu'un en qui vous avez confiance
‚Ä¢ Faites une petite activit√© qui vous fait du bien

Voulez-vous me parler de ce qui vous rend triste ?`,
                    exercises: ['journal-emotions', 'meditation-compassion', 'gratitude-simple']
                },
                meditation: {
                    response: `Excellente id√©e ! La m√©ditation est un merveilleux outil pour cultiver la paix int√©rieure et r√©duire le stress.

üßò‚Äç‚ôÄÔ∏è <strong>Types de m√©ditation que je peux vous proposer :</strong>
‚Ä¢ M√©ditation de pleine conscience (5-20 minutes)
‚Ä¢ M√©ditation guid√©e pour d√©butants
‚Ä¢ Scan corporel relaxant
‚Ä¢ M√©ditation de compassion

Combien de temps avez-vous disponible ? Et √™tes-vous d√©butant(e) en m√©ditation ?`,
                    exercises: ['meditation-guidee', 'pleine-conscience', 'scan-corporel']
                },
                sleep: {
                    response: `Les troubles du sommeil peuvent vraiment affecter notre bien-√™tre quotidien. Je suis l√† pour vous aider √† am√©liorer votre sommeil.

üò¥ <strong>Techniques pour un meilleur sommeil :</strong>
‚Ä¢ Routine de coucher r√©guli√®re et apaisante
‚Ä¢ √âviter les √©crans 1h avant le coucher
‚Ä¢ Exercices de relaxation ou m√©ditation du soir
‚Ä¢ Environnement frais et sombre

√Ä quelle heure vous couchez-vous habituellement ? Et qu'est-ce qui vous emp√™che de bien dormir ?`,
                    exercises: ['relaxation-sommeil', 'meditation-soir', 'respiration-endormissement']
                },
                crisis: {
                    response: `Je per√ßois que vous traversez un moment particuli√®rement difficile. Votre courage de demander de l'aide est d√©j√† un premier pas important.

üÜò <strong>Vous n'√™tes pas seul(e). Ressources imm√©diates :</strong>
‚Ä¢ <strong>Centre de Pr√©vention du Suicide : 0800 32 123</strong> (24h/24, gratuit)
‚Ä¢ <strong>T√©l√©-Accueil : 107</strong> (24h/24, √©coute)
‚Ä¢ <strong>Urgences : 112</strong> si danger imm√©diat

Voulez-vous que je vous aide √† trouver du soutien professionnel, ou pr√©f√©rez-vous que nous parlions de ce que vous ressentez maintenant ?`,
                    exercises: ['respiration-urgence', 'ancrage-crise', 'auto-compassion']
                }
            };
            
            const contextResponse = responses[category];
            if (contextResponse) {
                addMessageToChat('ai', contextResponse.response);
                if (contextResponse.exercises && category !== 'crisis') {
                    showExerciseSuggestions(contextResponse.exercises);
                }
                
                if (category === 'crisis') {
                    triggerEmergencyProtocol(2, []);
                }
            }
        }
        
        function analyzeMessageContext(message) {
            const lowerMessage = message.toLowerCase();
            const contexts = [];
            
            // √âmotions
            if (lowerMessage.includes('stress') || lowerMessage.includes('tendu')) contexts.push('stress');
            if (lowerMessage.includes('anxieux') || lowerMessage.includes('inquiet')) contexts.push('anxiety');
            if (lowerMessage.includes('triste') || lowerMessage.includes('d√©prim')) contexts.push('sad');
            if (lowerMessage.includes('col√®re') || lowerMessage.includes('√©nerv√©')) contexts.push('anger');
            if (lowerMessage.includes('fatigu√©') || lowerMessage.includes('√©puis√©')) contexts.push('fatigue');
            
            // Besoins
            if (lowerMessage.includes('m√©ditation') || lowerMessage.includes('m√©diter')) contexts.push('meditation');
            if (lowerMessage.includes('sommeil') || lowerMessage.includes('dormir')) contexts.push('sleep');
            if (lowerMessage.includes('respir') || lowerMessage.includes('souffle')) contexts.push('breathing');
            if (lowerMessage.includes('exercice') || lowerMessage.includes('relaxation')) contexts.push('exercise');
            
            return contexts;
        }
        
        function generateEmpathicResponse(message, contexts) {
            const empathicStarters = [
                "Je vous entends et je comprends que",
                "Il semble que vous traversiez",
                "Je per√ßois que vous ressentez",
                "C'est tout √† fait normal de ressentir",
                "Merci de partager avec moi que"
            ];
            
            const supportiveMiddle = [
                "Vos √©motions sont valides et importantes.",
                "Il faut du courage pour exprimer ce que vous ressentez.",
                "Vous n'√™tes pas seul(e) dans ce que vous vivez.",
                "Prendre soin de soi est un acte de courage."
            ];
            
            const helpfulEnding = [
                "Comment puis-je vous accompagner aujourd'hui ?",
                "Voulez-vous que nous explorions cela ensemble ?",
                "Y a-t-il quelque chose de sp√©cifique avec lequel je peux vous aider ?",
                "Que diriez-vous d'essayer un exercice qui pourrait vous aider ?"
            ];
            
            const starter = empathicStarters[Math.floor(Math.random() * empathicStarters.length)];
            const middle = supportiveMiddle[Math.floor(Math.random() * supportiveMiddle.length)];
            const ending = helpfulEnding[Math.floor(Math.random() * helpfulEnding.length)];
            
            return `${starter} ce moment peut √™tre difficile. ${middle}

üíô ${ending}`;
        }
        
        function getSuggestedExercises(contexts) {
            const exerciseMap = {
                stress: ['respiration-profonde', 'scan-corporel', 'meditation-stress'],
                anxiety: ['technique-54321', 'respiration-calmante', 'relaxation-progressive'],
                sad: ['journal-emotions', 'meditation-compassion', 'gratitude-simple'],
                anger: ['respiration-colere', 'relaxation-musculaire', 'meditation-patience'],
                fatigue: ['micro-sieste', 'etirement-doux', 'meditation-energie'],
                meditation: ['meditation-guidee', 'pleine-conscience', 'scan-corporel'],
                sleep: ['relaxation-sommeil', 'meditation-soir', 'respiration-endormissement'],
                breathing: ['respiration-profonde', 'coherence-cardiaque', 'respiration-calmante']
            };
            
            let suggestions = [];
            contexts.forEach(context => {
                if (exerciseMap[context]) {
                    suggestions = suggestions.concat(exerciseMap[context]);
                }
            });
            
            // Retirer les doublons et limiter √† 3
            return [...new Set(suggestions)].slice(0, 3);
        }
        
        function showExerciseSuggestions(exercises) {
            const exerciseContainer = document.getElementById('exercise-suggestions');
            const exercisesList = document.getElementById('suggested-exercises');
            
            if (!exerciseContainer || !exercisesList) return;
            
            const exerciseDetails = {
                'respiration-profonde': { title: 'Respiration profonde', duration: '3 min', icon: 'ü´Å' },
                'scan-corporel': { title: 'Scan corporel', duration: '10 min', icon: 'üßò‚Äç‚ôÄÔ∏è' },
                'meditation-stress': { title: 'M√©ditation anti-stress', duration: '8 min', icon: 'üåä' },
                'technique-54321': { title: 'Technique 5-4-3-2-1', duration: '5 min', icon: 'üî¢' },
                'respiration-calmante': { title: 'Respiration calmante', duration: '4 min', icon: 'üòå' },
                'relaxation-progressive': { title: 'Relaxation progressive', duration: '15 min', icon: 'üíÜ‚Äç‚ôÄÔ∏è' }
            };
            
            exercisesList.innerHTML = exercises.map(exerciseId => {
                const exercise = exerciseDetails[exerciseId] || { title: exerciseId, duration: '5 min', icon: '‚ú®' };
                return `
                    <div class="exercise-card" onclick="startExercise('${exerciseId}')">
                        <div class="exercise-icon">${exercise.icon}</div>
                        <div class="exercise-info">
                            <div class="exercise-title">${exercise.title}</div>
                            <div class="exercise-duration">${exercise.duration}</div>
                        </div>
                        <div class="exercise-action">‚ñ∂Ô∏è</div>
                    </div>
                `;
            }).join('');
            
            exerciseContainer.style.display = 'block';
        }
        
        function startExercise(exerciseId) {
            alert(`D√©marrage de l'exercice: ${exerciseId}\n\nCette fonctionnalit√© sera bient√¥t disponible avec des guides audio et visuels !`);
        }
        
        // Fonctions utilitaires
        function updateCharacterCount(input) {
            const count = input.value.length;
            const counter = document.getElementById('characterCount');
            if (counter) {
                counter.textContent = `${count}/1000`;
                counter.style.color = count > 800 ? '#f44336' : count > 600 ? '#ff9800' : '#666';
            }
        }
        
        function handleChatKeyPress(event) {
            if (event.key === 'Enter' && !event.shiftKey) {
                event.preventDefault();
                sendUserMessage();
            }
        }
        
        function escapeHtml(text) {
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML;
        }
        
        // Fonctions d'urgence
        function showEmergencyResources() {
            const modal = document.getElementById('emergency-resources-modal');
            if (modal) {
                modal.style.display = 'flex';
            }
        }
        
        function closeEmergencyModal() {
            const modal = document.getElementById('emergency-resources-modal');
            if (modal) {
                modal.style.display = 'none';
            }
        }
        
        function contactProfessional() {
            alert(`Mise en relation avec un professionnel MINDLY...

Cette fonctionnalit√© vous permettra de :
‚Ä¢ Parler avec un psychologue certifi√©
‚Ä¢ Planifier un rendez-vous en visioconf√©rence
‚Ä¢ Acc√©der √† un suivi personnalis√©

Disponible avec l'abonnement Premium.`);
            closeEmergencyModal();
        }
        
        // Initialisation du chat
        function initializeChat() {
            // Charger l'historique s'il existe
            const savedHistory = localStorage.getItem('chatHistory');
            if (savedHistory) {
                chatHistory = JSON.parse(savedHistory);
            }
            
            // Mettre √† jour le compteur de caract√®res
            const chatInput = document.getElementById('chatInput');
            if (chatInput) {
                updateCharacterCount(chatInput);
            }
        }

        // === SYST√àME DE SAISIE D'HUMEUR OPTIMIS√â (F02.1, F20.5) ===
        
        let moodTimer = null;
        let moodStartTime = null;
        let selectedMoodLevel = null;
        let selectedTags = [];
        let moodCurrentStep = 1;
        
        // F20.5 - Saisie d'humeur en moins de 3 clics
        function selectMoodLevel(level) {
            // D√©marrer le timer si c'est le premier clic
            if (!moodStartTime) {
                startMoodTimer();
            }
            
            selectedMoodLevel = level;
            
            // Mettre √† jour l'interface
            document.querySelectorAll('.mood-btn').forEach(btn => {
                btn.classList.remove('selected');
            });
            
            document.querySelector(`[data-value="${level}"]`).classList.add('selected');
            
            // Passer automatiquement √† l'√©tape 2 apr√®s 0.5s
            setTimeout(() => {
                showMoodTagsSection();
                moodCurrentStep = 2;
            }, 500);
        }
        
        function toggleMoodTag(tag) {
            const tagBtn = document.querySelector(`[data-tag="${tag}"]`);
            
            if (selectedTags.includes(tag)) {
                selectedTags = selectedTags.filter(t => t !== tag);
                tagBtn.classList.remove('selected');
            } else {
                selectedTags.push(tag);
                tagBtn.classList.add('selected');
            }
            
            // Si c'est le premier tag s√©lectionn√©, montrer la section de sauvegarde apr√®s 0.5s
            if (selectedTags.length === 1) {
                setTimeout(() => {
                    showMoodSaveSection();
                    moodCurrentStep = 3;
                }, 500);
            }
        }
        
        function skipTags() {
            selectedTags = [];
            showMoodSaveSection();
            moodCurrentStep = 3;
        }
        
        function showMoodTagsSection() {
            const section = document.getElementById('moodTagsSection');
            if (section) {
                section.style.display = 'block';
                section.scrollIntoView({ behavior: 'smooth' });
            }
        }
        
        function showMoodSaveSection() {
            const section = document.getElementById('moodSaveSection');
            const summary = document.getElementById('moodSummary');
            
            if (section && summary) {
                // G√©n√©rer le r√©sum√©
                const moodLabels = {
                    1: { emoji: 'üòü', label: 'Tr√®s mal', color: '#f44336' },
                    2: { emoji: 'üòï', label: 'Mal', color: '#ff5722' },
                    3: { emoji: 'üòê', label: 'Moyen', color: '#ff9800' },
                    4: { emoji: 'üôÇ', label: 'Bien', color: '#4caf50' },
                    5: { emoji: 'üòä', label: 'Tr√®s bien', color: '#2196f3' }
                };
                
                const moodInfo = moodLabels[selectedMoodLevel];
                
                summary.innerHTML = `
                    <div class="mood-summary-content">
                        <div class="summary-mood">
                            <span class="summary-emoji">${moodInfo.emoji}</span>
                            <span class="summary-label" style="color: ${moodInfo.color}">${moodInfo.label} (${selectedMoodLevel}/5)</span>
                        </div>
                        ${selectedTags.length > 0 ? `
                            <div class="summary-tags">
                                <span class="tags-label">Influences:</span>
                                ${selectedTags.map(tag => `<span class="summary-tag">${tag}</span>`).join(' ')}
                            </div>
                        ` : ''}
                        <div class="summary-time">
                            <span class="time-icon">‚è±Ô∏è</span>
                            <span>Temps: ${getMoodElapsedTime()}s</span>
                        </div>
                    </div>
                `;
                
                section.style.display = 'block';
                section.scrollIntoView({ behavior: 'smooth' });
            }
        }
        
        // F02.1 - Sauvegarde avec rappels param√©trables
        function saveMoodEntry() {
            const elapsedTime = getMoodElapsedTime();
            
            const moodEntry = {
                id: 'mood_' + Date.now(),
                level: selectedMoodLevel,
                tags: selectedTags,
                note: '',
                timestamp: new Date().toISOString(),
                elapsedTime: elapsedTime,
                date: new Date().toLocaleDateString('fr-FR'),
                time: new Date().toLocaleTimeString('fr-FR', {hour: '2-digit', minute: '2-digit'})
            };
            
            // Sauvegarder dans l'historique
            saveMoodToHistory(moodEntry);
            
            // Afficher la confirmation
            showMoodSuccess(elapsedTime);
            
            // Planifier le prochain rappel si activ√©
            scheduleNextMoodReminder();
            
            // G√©n√©rer des recommandations automatiques
            generateMoodRecommendations(moodEntry);
        }
        
        function saveMoodWithNote() {
            const noteSection = document.getElementById('moodNoteSection');
            if (noteSection) {
                noteSection.style.display = 'block';
                noteSection.scrollIntoView({ behavior: 'smooth' });
                document.getElementById('moodNote').focus();
            }
        }
        
        function saveMoodEntryWithNote() {
            const note = document.getElementById('moodNote').value.trim();
            const elapsedTime = getMoodElapsedTime();
            
            const moodEntry = {
                id: 'mood_' + Date.now(),
                level: selectedMoodLevel,
                tags: selectedTags,
                note: note,
                timestamp: new Date().toISOString(),
                elapsedTime: elapsedTime,
                date: new Date().toLocaleDateString('fr-FR'),
                time: new Date().toLocaleTimeString('fr-FR', {hour: '2-digit', minute: '2-digit'})
            };
            
            saveMoodToHistory(moodEntry);
            showMoodSuccess(elapsedTime);
            scheduleNextMoodReminder();
            generateMoodRecommendations(moodEntry);
        }
        
        function saveMoodToHistory(entry) {
            let moodHistory = JSON.parse(localStorage.getItem('moodHistory') || '[]');
            moodHistory.unshift(entry);
            
            // Garder seulement les 100 derni√®res entr√©es
            if (moodHistory.length > 100) {
                moodHistory = moodHistory.slice(0, 100);
            }
            
            localStorage.setItem('moodHistory', JSON.stringify(moodHistory));
            
            // Mettre √† jour les statistiques
            updateMoodStatistics(entry);
        }
        
        function showMoodSuccess(elapsedTime) {
            // Masquer les autres sections
            document.getElementById('moodTagsSection').style.display = 'none';
            document.getElementById('moodSaveSection').style.display = 'none';
            document.getElementById('moodNoteSection').style.display = 'none';
            
            // Afficher le succ√®s
            const successSection = document.getElementById('moodSuccess');
            const finalTimeSpan = document.getElementById('finalTime');
            
            if (successSection && finalTimeSpan) {
                finalTimeSpan.textContent = elapsedTime + 's';
                successSection.style.display = 'block';
                successSection.scrollIntoView({ behavior: 'smooth' });
                
                // Arr√™ter le timer
                stopMoodTimer();
                
                // Ajouter une animation de confettis
                showConfetti();
            }
        }
        
        function resetMoodEntry() {
            // R√©initialiser les variables
            selectedMoodLevel = null;
            selectedTags = [];
            moodCurrentStep = 1;
            moodStartTime = null;
            
            // R√©initialiser l'interface
            document.querySelectorAll('.mood-btn').forEach(btn => btn.classList.remove('selected'));
            document.querySelectorAll('.mood-tag').forEach(btn => btn.classList.remove('selected'));
            
            // Masquer les sections
            document.getElementById('moodTagsSection').style.display = 'none';
            document.getElementById('moodSaveSection').style.display = 'none';
            document.getElementById('moodNoteSection').style.display = 'none';
            document.getElementById('moodSuccess').style.display = 'none';
            
            // Afficher les tendances
            showMoodSection('tracking');
        }
        
        function showMoodRecommendations() {
            const moodHistory = JSON.parse(localStorage.getItem('moodHistory') || '[]');
            if (moodHistory.length > 0) {
                const latestMood = moodHistory[0];
                generatePersonalizedRecommendations(latestMood);
            }
            resetMoodEntry();
        }
        
        // Syst√®me de timer
        function startMoodTimer() {
            moodStartTime = Date.now();
            moodTimer = setInterval(updateMoodTimer, 100);
        }
        
        function updateMoodTimer() {
            if (moodStartTime) {
                const elapsed = Math.floor((Date.now() - moodStartTime) / 1000);
                const timerElement = document.getElementById('moodTimer');
                if (timerElement) {
                    timerElement.textContent = elapsed + 's';
                    
                    // Changer la couleur si trop lent
                    if (elapsed > 10) {
                        timerElement.style.color = '#f44336';
                    } else if (elapsed > 7) {
                        timerElement.style.color = '#ff9800';
                    }
                }
            }
        }
        
        function stopMoodTimer() {
            if (moodTimer) {
                clearInterval(moodTimer);
                moodTimer = null;
            }
        }
        
        function getMoodElapsedTime() {
            return moodStartTime ? Math.floor((Date.now() - moodStartTime) / 1000) : 0;
        }
        
        // Syst√®me de rappels param√©trables
        function scheduleNextMoodReminder() {
            const reminderSettings = JSON.parse(localStorage.getItem('moodReminderSettings') || '{"enabled": true, "frequency": "daily", "times": ["09:00", "18:00"]}');
            
            if (!reminderSettings.enabled) return;
            
            // Calculer le prochain rappel
            const now = new Date();
            let nextReminder = null;
            
            if (reminderSettings.frequency === 'daily') {
                // Trouver le prochain cr√©neau aujourd'hui ou demain
                for (const timeStr of reminderSettings.times) {
                    const [hours, minutes] = timeStr.split(':').map(Number);
                    const reminderTime = new Date(now);
                    reminderTime.setHours(hours, minutes, 0, 0);
                    
                    if (reminderTime > now) {
                        nextReminder = reminderTime;
                        break;
                    }
                }
                
                // Si aucun cr√©neau aujourd'hui, prendre le premier demain
                if (!nextReminder) {
                    const [hours, minutes] = reminderSettings.times[0].split(':').map(Number);
                    nextReminder = new Date(now);
                    nextReminder.setDate(nextReminder.getDate() + 1);
                    nextReminder.setHours(hours, minutes, 0, 0);
                }
            }
            
            if (nextReminder) {
                const timeUntilReminder = nextReminder.getTime() - now.getTime();
                
                // Programmer le rappel
                setTimeout(() => {
                    showMoodReminder();
                }, timeUntilReminder);
                
                console.log(`Prochain rappel d'humeur programm√© pour: ${nextReminder.toLocaleString('fr-FR')}`);
            }
        }
        
        function showMoodReminder() {
            // V√©rifier si l'utilisateur a d√©j√† enregistr√© son humeur r√©cemment
            const moodHistory = JSON.parse(localStorage.getItem('moodHistory') || '[]');
            const now = new Date();
            const fourHoursAgo = new Date(now.getTime() - 4 * 60 * 60 * 1000);
            
            const recentEntry = moodHistory.find(entry => new Date(entry.timestamp) > fourHoursAgo);
            
            if (recentEntry) {
                // Ne pas d√©ranger si l'humeur a √©t√© enregistr√©e r√©cemment
                scheduleNextMoodReminder();
                return;
            }
            
            // Afficher le rappel
            if (Notification.permission === 'granted') {
                new Notification('MINDLY - Comment allez-vous ?', {
                    body: 'Prenez 10 secondes pour enregistrer votre humeur actuelle.',
                    icon: '/favicon.ico',
                    badge: '/favicon.ico'
                });
            } else {
                // Fallback: afficher un modal dans l'app
                alert('üå∏ MINDLY vous rappelle: Comment vous sentez-vous maintenant ? Prenez 10 secondes pour enregistrer votre humeur.');
            }
            
            // Programmer le prochain rappel
            scheduleNextMoodReminder();
        }
        
        // G√©n√©ration de recommandations
        function generateMoodRecommendations(moodEntry) {
            const recommendations = [];
            
            // Recommandations bas√©es sur le niveau d'humeur
            if (moodEntry.level <= 2) {
                recommendations.push({
                    type: 'urgent',
                    title: 'Soutien imm√©diat disponible',
                    description: 'Votre bien-√™tre est important. Parlons ensemble ou contactez un professionnel.',
                    action: 'Parler avec LUNA',
                    actionFunction: 'showScreen("chat-screen")'
                });
            } else if (moodEntry.level === 3) {
                recommendations.push({
                    type: 'improvement',
                    title: 'Exercices pour am√©liorer votre humeur',
                    description: 'Quelques minutes d\'exercice peuvent faire une grande diff√©rence.',
                    action: 'Voir les exercices',
                    actionFunction: 'showMoodSection("exercises")'
                });
            }
            
            // Recommandations bas√©es sur les tags
            if (moodEntry.tags.includes('stress')) {
                recommendations.push({
                    type: 'exercise',
                    title: 'Gestion du stress',
                    description: 'Exercices de respiration et relaxation pour r√©duire le stress.',
                    action: 'Commencer',
                    actionFunction: 'startStressRelief()'
                });
            }
            
            if (moodEntry.tags.includes('fatigue')) {
                recommendations.push({
                    type: 'wellness',
                    title: 'Am√©liorer votre √©nergie',
                    description: 'Conseils pour retrouver de l\'√©nergie et am√©liorer votre sommeil.',
                    action: 'En savoir plus',
                    actionFunction: 'showEnergyTips()'
                });
            }
            
            // Sauvegarder les recommandations
            localStorage.setItem('latestMoodRecommendations', JSON.stringify(recommendations));
        }
        
        function generatePersonalizedRecommendations(moodEntry) {
            const recommendations = JSON.parse(localStorage.getItem('latestMoodRecommendations') || '[]');
            
            if (recommendations.length > 0) {
                let modalHTML = `
                    <div class="recommendations-modal">
                        <div class="recommendations-content">
                            <h3>üéØ Recommandations personnalis√©es</h3>
                            <p>Bas√©es sur votre humeur: ${moodEntry.level}/5</p>
                            <div class="recommendations-list">
                `;
                
                recommendations.forEach(rec => {
                    modalHTML += `
                        <div class="recommendation-item ${rec.type}">
                            <h4>${rec.title}</h4>
                            <p>${rec.description}</p>
                            <button onclick="${rec.actionFunction}">${rec.action}</button>
                        </div>
                    `;
                });
                
                modalHTML += `
                            </div>
                            <button onclick="closeRecommendationsModal()">Fermer</button>
                        </div>
                    </div>
                `;
                
                document.body.insertAdjacentHTML('beforeend', modalHTML);
            }
        }
        
        // Mode avanc√©
        function toggleAdvancedMode() {
            const detailedSection = document.getElementById('detailedEvaluation');
            const toggleText = document.getElementById('advancedToggleText');
            
            if (detailedSection.style.display === 'none' || !detailedSection.style.display) {
                detailedSection.style.display = 'block';
                toggleText.textContent = '‚ö° Mode saisie rapide';
            } else {
                detailedSection.style.display = 'none';
                toggleText.textContent = 'üî¨ Mode √©valuation compl√®te';
            }
        }
        
        // Statistiques d'humeur
        function updateMoodStatistics(entry) {
            let stats = JSON.parse(localStorage.getItem('moodStatistics') || '{}');
            
            const today = new Date().toLocaleDateString('fr-FR');
            const thisWeek = getWeekKey(new Date());
            const thisMonth = new Date().getFullYear() + '-' + (new Date().getMonth() + 1).toString().padStart(2, '0');
            
            // Statistiques quotidiennes
            if (!stats.daily) stats.daily = {};
            if (!stats.daily[today]) stats.daily[today] = [];
            stats.daily[today].push(entry.level);
            
            // Statistiques hebdomadaires
            if (!stats.weekly) stats.weekly = {};
            if (!stats.weekly[thisWeek]) stats.weekly[thisWeek] = [];
            stats.weekly[thisWeek].push(entry.level);
            
            // Statistiques mensuelles
            if (!stats.monthly) stats.monthly = {};
            if (!stats.monthly[thisMonth]) stats.monthly[thisMonth] = [];
            stats.monthly[thisMonth].push(entry.level);
            
            // Tags les plus fr√©quents
            if (!stats.topTags) stats.topTags = {};
            entry.tags.forEach(tag => {
                stats.topTags[tag] = (stats.topTags[tag] || 0) + 1;
            });
            
            localStorage.setItem('moodStatistics', JSON.stringify(stats));
        }
        
        function getWeekKey(date) {
            const startOfWeek = new Date(date);
            startOfWeek.setDate(date.getDate() - date.getDay());
            return startOfWeek.toLocaleDateString('fr-FR');
        }
        
        // Animation de confettis
        function showConfetti() {
            // Simple animation de confettis avec CSS
            const confetti = document.createElement('div');
            confetti.className = 'confetti-container';
            confetti.innerHTML = `
                <div class="confetti">üéâ</div>
                <div class="confetti">‚ú®</div>
                <div class="confetti">üåü</div>
                <div class="confetti">üí´</div>
                <div class="confetti">üéä</div>
            `;
            
            document.body.appendChild(confetti);
            
            setTimeout(() => {
                document.body.removeChild(confetti);
            }, 3000);
        }
        
        // Initialisation des rappels d'humeur
        function initializeMoodReminders() {
            // Demander permission pour les notifications
            if ('Notification' in window && Notification.permission === 'default') {
                Notification.requestPermission();
            }
            
            // Programmer le prochain rappel au d√©marrage
            scheduleNextMoodReminder();
        }

        // === SYST√àME DE RAPPORT MENSUEL AUTOMATIS√â (F03.1) ===
        
        function generateMonthlyReport() {
            const now = new Date();
            const lastMonth = new Date(now.getFullYear(), now.getMonth() - 1, 1);
            const monthKey = lastMonth.getFullYear() + '-' + (lastMonth.getMonth() + 1).toString().padStart(2, '0');
            const monthName = lastMonth.toLocaleDateString('fr-FR', { month: 'long', year: 'numeric' });
            
            // Collecter les donn√©es du mois dernier
            const moodHistory = JSON.parse(localStorage.getItem('moodHistory') || '[]');
            const stressAnalysis = JSON.parse(localStorage.getItem('stressAnalysisHistory') || '[]');
            const chatHistory = JSON.parse(localStorage.getItem('chatHistory') || '[]');
            const lifestyleConfig = JSON.parse(localStorage.getItem('lifestyleConfiguration') || null);
            
            // Filtrer les donn√©es du mois dernier
            const monthlyMoods = moodHistory.filter(entry => {
                const entryDate = new Date(entry.timestamp);
                return entryDate.getMonth() === lastMonth.getMonth() && entryDate.getFullYear() === lastMonth.getFullYear();
            });
            
            const monthlyStress = stressAnalysis.filter(entry => {
                const entryDate = new Date(entry.date);
                return entryDate.getMonth() === lastMonth.getMonth() && entryDate.getFullYear() === lastMonth.getFullYear();
            });
            
            const monthlyChats = chatHistory.filter(entry => {
                const entryDate = new Date(entry.timestamp);
                return entryDate.getMonth() === lastMonth.getMonth() && entryDate.getFullYear() === lastMonth.getFullYear();
            });
            
            // G√©n√©rer le rapport
            const report = {
                id: 'report_' + monthKey,
                period: monthName,
                generatedAt: new Date().toISOString(),
                summary: generateReportSummary(monthlyMoods, monthlyStress, monthlyChats),
                progress: analyzeProgress(monthlyMoods, monthlyStress),
                insights: generateInsights(monthlyMoods, monthlyStress, monthlyChats),
                recommendations: generateMonthlyRecommendations(monthlyMoods, monthlyStress, lifestyleConfig),
                statistics: calculateMonthlyStatistics(monthlyMoods, monthlyStress, monthlyChats),
                goals: suggestMonthlyGoals(monthlyMoods, monthlyStress)
            };
            
            // Sauvegarder le rapport
            saveMonthlyReport(report);
            
            return report;
        }
        
        function generateReportSummary(moods, stress, chats) {
            const totalEntries = moods.length + stress.length + chats.filter(c => c.sender === 'user').length;
            const avgMood = moods.length > 0 ? (moods.reduce((sum, mood) => sum + mood.level, 0) / moods.length).toFixed(1) : 0;
            const avgStress = stress.length > 0 ? (stress.reduce((sum, s) => sum + s.stressScore, 0) / stress.length).toFixed(1) : 0;
            
            let summaryText = '';
            let mood_color = '#4caf50';
            
            if (avgMood >= 4) {
                summaryText = 'Excellent mois ! Vous avez maintenu un tr√®s bon √©tat d\'humeur g√©n√©ral.';
                mood_color = '#2196f3';
            } else if (avgMood >= 3.5) {
                summaryText = 'Bon mois dans l\'ensemble. Votre bien-√™tre s\'am√©liore progressivement.';
                mood_color = '#4caf50';
            } else if (avgMood >= 2.5) {
                summaryText = 'Mois mitig√© avec des hauts et des bas. Il y a des axes d\'am√©lioration.';
                mood_color = '#ff9800';
            } else {
                summaryText = 'Mois difficile. Votre bien-√™tre n√©cessite une attention particuli√®re.';
                mood_color = '#f44336';
            }
            
            return {
                text: summaryText,
                totalEntries,
                avgMood: parseFloat(avgMood),
                avgStress: parseFloat(avgStress),
                moodColor: mood_color,
                engagementLevel: calculateEngagementLevel(totalEntries)
            };
        }
        
        function analyzeProgress(currentMoods, currentStress) {
            // Comparer avec le mois pr√©c√©dent
            const twoMonthsAgo = new Date();
            twoMonthsAgo.setMonth(twoMonthsAgo.getMonth() - 2);
            const prevMonthKey = twoMonthsAgo.getFullYear() + '-' + (twoMonthsAgo.getMonth() + 1).toString().padStart(2, '0');
            
            const savedReports = JSON.parse(localStorage.getItem('monthlyReports') || '[]');
            const previousReport = savedReports.find(r => r.id.includes(prevMonthKey));
            
            let progressData = {
                moodTrend: 'stable',
                moodChange: 0,
                stressTrend: 'stable',
                stressChange: 0,
                improvements: [],
                concerns: []
            };
            
            if (previousReport) {
                const prevAvgMood = previousReport.summary.avgMood;
                const currentAvgMood = currentMoods.length > 0 ? currentMoods.reduce((sum, mood) => sum + mood.level, 0) / currentMoods.length : 0;
                
                progressData.moodChange = ((currentAvgMood - prevAvgMood) / prevAvgMood * 100).toFixed(1);
                
                if (progressData.moodChange > 5) {
                    progressData.moodTrend = 'am√©lioration';
                    progressData.improvements.push('Am√©lioration significative de l\'humeur g√©n√©rale');
                } else if (progressData.moodChange < -5) {
                    progressData.moodTrend = 'd√©t√©rioration';
                    progressData.concerns.push('Baisse notable de l\'humeur g√©n√©rale');
                }
                
                // Analyse des tendances de stress
                const prevAvgStress = previousReport.summary.avgStress;
                const currentAvgStress = currentStress.length > 0 ? currentStress.reduce((sum, s) => s.stressScore, 0) / currentStress.length : 0;
                
                if (prevAvgStress > 0) {
                    progressData.stressChange = ((currentAvgStress - prevAvgStress) / prevAvgStress * 100).toFixed(1);
                    
                    if (progressData.stressChange < -10) {
                        progressData.stressTrend = 'am√©lioration';
                        progressData.improvements.push('R√©duction significative du niveau de stress');
                    } else if (progressData.stressChange > 10) {
                        progressData.stressTrend = 'd√©t√©rioration';
                        progressData.concerns.push('Augmentation du niveau de stress');
                    }
                }
            }
            
            return progressData;
        }
        
        function generateInsights(moods, stress, chats) {
            const insights = [];
            
            // Analyse des patterns d'humeur
            if (moods.length >= 7) {
                const weekdayMoods = moods.filter(m => {
                    const day = new Date(m.timestamp).getDay();
                    return day >= 1 && day <= 5;
                });
                const weekendMoods = moods.filter(m => {
                    const day = new Date(m.timestamp).getDay();
                    return day === 0 || day === 6;
                });
                
                if (weekdayMoods.length > 0 && weekendMoods.length > 0) {
                    const weekdayAvg = weekdayMoods.reduce((sum, m) => sum + m.level, 0) / weekdayMoods.length;
                    const weekendAvg = weekendMoods.reduce((sum, m) => sum + m.level, 0) / weekendMoods.length;
                    
                    if (weekendAvg > weekdayAvg + 0.5) {
                        insights.push({
                            type: 'pattern',
                            title: 'Diff√©rence week-end/semaine',
                            description: `Votre humeur est significativement meilleure le week-end (+${(weekendAvg - weekdayAvg).toFixed(1)} points). Cela sugg√®re que le stress professionnel pourrait affecter votre bien-√™tre.`,
                            icon: 'üìä'
                        });
                    }
                }
            }
            
            // Analyse des tags les plus fr√©quents
            if (moods.length > 0) {
                const tagCounts = {};
                moods.forEach(mood => {
                    mood.tags.forEach(tag => {
                        tagCounts[tag] = (tagCounts[tag] || 0) + 1;
                    });
                });
                
                const topTag = Object.entries(tagCounts).sort(([,a], [,b]) => b - a)[0];
                if (topTag && topTag[1] >= 3) {
                    const tagInsights = {
                        'stress': 'Le stress est votre principal d√©fi ce mois-ci. Consid√©rez des techniques de relaxation r√©guli√®res.',
                        'fatigue': 'La fatigue revient souvent dans vos √©valuations. Examinez votre hygi√®ne de sommeil et votre charge de travail.',
                        'anxiete': 'L\'anxi√©t√© semble √™tre un facteur r√©current. Des exercices de pleine conscience pourraient vous aider.',
                        'energie': 'Votre niveau d\'√©nergie fluctue beaucoup. Une routine plus stable pourrait √™tre b√©n√©fique.'
                    };
                    
                    if (tagInsights[topTag[0]]) {
                        insights.push({
                            type: 'trend',
                            title: `Tendance: ${topTag[0]}`,
                            description: tagInsights[topTag[0]],
                            icon: 'üîç'
                        });
                    }
                }
            }
            
            // Analyse de l'utilisation du chat
            if (chats.length > 0) {
                const userMessages = chats.filter(c => c.sender === 'user');
                const avgMessageLength = userMessages.reduce((sum, msg) => sum + msg.message.length, 0) / userMessages.length;
                
                if (avgMessageLength > 100) {
                    insights.push({
                        type: 'engagement',
                        title: 'Communication approfondie',
                        description: 'Vous prenez le temps de bien exprimer vos pens√©es dans nos conversations. C\'est un excellent signe d\'engagement dans votre parcours de bien-√™tre.',
                        icon: 'üí¨'
                    });
                }
                
                if (userMessages.length > 20) {
                    insights.push({
                        type: 'usage',
                        title: 'Utilisation r√©guli√®re',
                        description: `Vous avez eu ${userMessages.length} conversations ce mois-ci. Cette r√©gularit√© montre votre engagement dans votre bien-√™tre mental.`,
                        icon: 'üìà'
                    });
                }
            }
            
            return insights;
        }
        
        function generateMonthlyRecommendations(moods, stress, lifestyleConfig) {
            const recommendations = [];
            
            // Recommandations bas√©es sur l'humeur moyenne
            if (moods.length > 0) {
                const avgMood = moods.reduce((sum, mood) => sum + mood.level, 0) / moods.length;
                
                if (avgMood < 3) {
                    recommendations.push({
                        priority: 'high',
                        category: 'Soutien professionnel',
                        title: 'Consid√©rer un accompagnement professionnel',
                        description: 'Votre humeur g√©n√©rale ce mois-ci sugg√®re qu\'un accompagnement par un professionnel pourrait √™tre b√©n√©fique.',
                        action: 'Prendre rendez-vous',
                        actionType: 'professional_support'
                    });
                }
                
                if (avgMood >= 3 && avgMood < 3.5) {
                    recommendations.push({
                        priority: 'medium',
                        category: 'Activit√©s bien-√™tre',
                        title: 'Int√©grer plus d\'activit√©s positives',
                        description: 'Votre humeur pourrait b√©n√©ficier d\'activit√©s qui vous apportent de la joie. Identifiez 2-3 choses que vous aimez faire et programmez-les r√©guli√®rement.',
                        action: 'Planifier des activit√©s',
                        actionType: 'lifestyle_improvement'
                    });
                }
            }
            
            // Recommandations bas√©es sur le stress
            if (stress.length > 0) {
                const avgStress = stress.reduce((sum, s) => sum + s.stressScore, 0) / stress.length;
                
                if (avgStress > 7) {
                    recommendations.push({
                        priority: 'high',
                        category: 'Gestion du stress',
                        title: 'Programme intensif de gestion du stress',
                        description: 'Votre niveau de stress est pr√©occupant. Un programme structur√© de r√©duction du stress est recommand√©.',
                        action: 'Commencer le programme',
                        actionType: 'stress_program'
                    });
                } else if (avgStress > 5) {
                    recommendations.push({
                        priority: 'medium',
                        category: 'Relaxation',
                        title: 'Techniques de relaxation quotidiennes',
                        description: 'Int√©grez 10-15 minutes de relaxation dans votre routine quotidienne pour mieux g√©rer votre stress.',
                        action: 'Apprendre les techniques',
                        actionType: 'relaxation_training'
                    });
                }
            }
            
            // Recommandations bas√©es sur le profil de vie
            if (lifestyleConfig) {
                if (lifestyleConfig.profile === 'student') {
                    recommendations.push({
                        priority: 'medium',
                        category: '√âquilibre √©tudes',
                        title: 'Optimiser votre routine d\'√©tudiant',
                        description: 'Cr√©ez un meilleur √©quilibre entre √©tudes, d√©tente et activit√©s sociales pour am√©liorer votre bien-√™tre global.',
                        action: 'Planifier ma semaine',
                        actionType: 'routine_optimization'
                    });
                } else if (lifestyleConfig.profile === 'professional') {
                    recommendations.push({
                        priority: 'medium',
                        category: '√âquilibre travail-vie',
                        title: 'Am√©liorer l\'√©quilibre travail-vie personnelle',
                        description: '√âtablissez des limites claires entre travail et vie personnelle pour r√©duire le stress et am√©liorer votre satisfaction.',
                        action: 'D√©finir des limites',
                        actionType: 'work_life_balance'
                    });
                }
            }
            
            return recommendations;
        }
        
        function calculateMonthlyStatistics(moods, stress, chats) {
            const stats = {};
            
            // Statistiques d'humeur
            if (moods.length > 0) {
                stats.mood = {
                    totalEntries: moods.length,
                    average: (moods.reduce((sum, mood) => sum + mood.level, 0) / moods.length).toFixed(1),
                    highest: Math.max(...moods.map(m => m.level)),
                    lowest: Math.min(...moods.map(m => m.level)),
                    consistency: calculateConsistency(moods.map(m => m.level)),
                    topTags: getTopTags(moods)
                };
            }
            
            // Statistiques de stress
            if (stress.length > 0) {
                stats.stress = {
                    totalAnalyses: stress.length,
                    averageStress: (stress.reduce((sum, s) => sum + s.stressScore, 0) / stress.length).toFixed(1),
                    averageOvertinking: (stress.reduce((sum, s) => sum + s.overthinkingScore, 0) / stress.length).toFixed(1),
                    improvement: calculateStressImprovement(stress)
                };
            }
            
            // Statistiques d'engagement
            const userChats = chats.filter(c => c.sender === 'user');
            stats.engagement = {
                totalConversations: userChats.length,
                averageMessageLength: userChats.length > 0 ? Math.round(userChats.reduce((sum, c) => sum + c.message.length, 0) / userChats.length) : 0,
                mostActiveDay: getMostActiveDay(chats),
                engagementScore: calculateEngagementScore(moods.length, stress.length, userChats.length)
            };
            
            return stats;
        }
        
        function suggestMonthlyGoals(moods, stress) {
            const goals = [];
            
            if (moods.length > 0) {
                const avgMood = moods.reduce((sum, mood) => sum + mood.level, 0) / moods.length;
                
                if (avgMood < 4) {
                    goals.push({
                        category: 'Humeur',
                        title: 'Am√©liorer l\'humeur g√©n√©rale',
                        target: 'Atteindre une moyenne de 4/5',
                        currentValue: avgMood.toFixed(1),
                        targetValue: '4.0',
                        unit: '/5',
                        actions: [
                            'Enregistrer son humeur quotidiennement',
                            'Pratiquer 10 min de m√©ditation par jour',
                            'Identifier et cultiver 3 sources de joie'
                        ]
                    });
                }
            }
            
            if (stress.length > 0) {
                const avgStress = stress.reduce((sum, s) => sum + s.stressScore, 0) / stress.length;
                
                if (avgStress > 5) {
                    goals.push({
                        category: 'Stress',
                        title: 'R√©duire le niveau de stress',
                        target: 'Maintenir le stress sous 5/10',
                        currentValue: avgStress.toFixed(1),
                        targetValue: '5.0',
                        unit: '/10',
                        actions: [
                            'Pratiquer des exercices de respiration quotidiens',
                            'Identifier et g√©rer les sources de stress',
                            'Am√©liorer la gestion du temps'
                        ]
                    });
                }
            }
            
            // Objectif d'engagement
            const totalEntries = moods.length + stress.length;
            if (totalEntries < 20) {
                goals.push({
                    category: 'Engagement',
                    title: 'Utiliser r√©guli√®rement MINDLY',
                    target: 'Au moins 20 interactions par mois',
                    currentValue: totalEntries.toString(),
                    targetValue: '20',
                    unit: ' interactions',
                    actions: [
                        'Enregistrer son humeur 3 fois par semaine minimum',
                        'Faire une analyse de stress hebdomadaire',
                        'Utiliser le chat IA pour obtenir du soutien'
                    ]
                });
            }
            
            return goals;
        }
        
        // Fonctions utilitaires pour les calculs
        function calculateEngagementLevel(totalEntries) {
            if (totalEntries >= 30) return 'Tr√®s √©lev√©';
            if (totalEntries >= 20) return '√âlev√©';
            if (totalEntries >= 10) return 'Mod√©r√©';
            if (totalEntries >= 5) return 'Faible';
            return 'Tr√®s faible';
        }
        
        function calculateConsistency(values) {
            if (values.length < 2) return 100;
            
            const mean = values.reduce((sum, val) => sum + val, 0) / values.length;
            const variance = values.reduce((sum, val) => sum + Math.pow(val - mean, 2), 0) / values.length;
            const stdDev = Math.sqrt(variance);
            
            // Convertir en pourcentage de consistance (inverse de la variance)
            return Math.max(0, Math.min(100, 100 - (stdDev / mean) * 100)).toFixed(0);
        }
        
        function getTopTags(moods) {
            const tagCounts = {};
            moods.forEach(mood => {
                mood.tags.forEach(tag => {
                    tagCounts[tag] = (tagCounts[tag] || 0) + 1;
                });
            });
            
            return Object.entries(tagCounts)
                .sort(([,a], [,b]) => b - a)
                .slice(0, 3)
                .map(([tag, count]) => ({ tag, count }));
        }
        
        function calculateStressImprovement(stressData) {
            if (stressData.length < 2) return 0;
            
            const firstHalf = stressData.slice(0, Math.floor(stressData.length / 2));
            const secondHalf = stressData.slice(Math.floor(stressData.length / 2));
            
            const firstAvg = firstHalf.reduce((sum, s) => sum + s.stressScore, 0) / firstHalf.length;
            const secondAvg = secondHalf.reduce((sum, s) => sum + s.stressScore, 0) / secondHalf.length;
            
            return ((firstAvg - secondAvg) / firstAvg * 100).toFixed(1);
        }
        
        function getMostActiveDay(chats) {
            const dayCounts = {};
            const dayNames = ['Dimanche', 'Lundi', 'Mardi', 'Mercredi', 'Jeudi', 'Vendredi', 'Samedi'];
            
            chats.forEach(chat => {
                const day = new Date(chat.timestamp).getDay();
                const dayName = dayNames[day];
                dayCounts[dayName] = (dayCounts[dayName] || 0) + 1;
            });
            
            const mostActive = Object.entries(dayCounts).sort(([,a], [,b]) => b - a)[0];
            return mostActive ? mostActive[0] : 'Aucun';
        }
        
        function calculateEngagementScore(moodEntries, stressEntries, chatEntries) {
            const totalPoints = moodEntries * 2 + stressEntries * 3 + Math.min(chatEntries, 30) * 1;
            return Math.min(100, totalPoints);
        }
        
        function saveMonthlyReport(report) {
            let reports = JSON.parse(localStorage.getItem('monthlyReports') || '[]');
            
            // Supprimer un √©ventuel rapport existant pour la m√™me p√©riode
            reports = reports.filter(r => r.id !== report.id);
            
            // Ajouter le nouveau rapport
            reports.unshift(report);
            
            // Garder seulement les 12 derniers rapports
            if (reports.length > 12) {
                reports = reports.slice(0, 12);
            }
            
            localStorage.setItem('monthlyReports', JSON.stringify(reports));
            
            // Marquer le rapport comme nouveau
            localStorage.setItem('newMonthlyReport', 'true');
            
            console.log(`Rapport mensuel g√©n√©r√© pour ${report.period}`);
        }
        
        function showMonthlyReport(reportId = null) {
            const reports = JSON.parse(localStorage.getItem('monthlyReports') || '[]');
            
            let report;
            if (reportId) {
                report = reports.find(r => r.id === reportId);
            } else {
                report = reports[0]; // Le plus r√©cent
            }
            
            if (!report) {
                alert('Aucun rapport mensuel disponible. Les rapports sont g√©n√©r√©s automatiquement chaque mois.');
                return;
            }
            
            // Cr√©er et afficher le modal du rapport
            displayMonthlyReportModal(report);
        }
        
        function displayMonthlyReportModal(report) {
            const modalHTML = `
                <div class="monthly-report-modal">
                    <div class="report-content">
                        <div class="report-header">
                            <h2>üìä Rapport mensuel - ${report.period}</h2>
                            <p class="report-date">G√©n√©r√© le ${new Date(report.generatedAt).toLocaleDateString('fr-FR')}</p>
                            <button class="close-report-btn" onclick="closeMonthlyReportModal()">&times;</button>
                        </div>
                        
                        <div class="report-summary">
                            <div class="summary-card">
                                <h3>üìã R√©sum√© du mois</h3>
                                <p class="summary-text">${report.summary.text}</p>
                                <div class="summary-stats">
                                    <div class="stat-item">
                                        <span class="stat-label">Humeur moyenne</span>
                                        <span class="stat-value" style="color: ${report.summary.moodColor}">${report.summary.avgMood}/5</span>
                                    </div>
                                    <div class="stat-item">
                                        <span class="stat-label">Engagement</span>
                                        <span class="stat-value">${report.summary.engagementLevel}</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="report-sections">
                            <div class="report-section">
                                <h3>üìà √âvolution</h3>
                                <div class="progress-content">
                                    <p><strong>Tendance humeur:</strong> ${report.progress.moodTrend}</p>
                                    ${report.progress.improvements.length > 0 ? `
                                        <div class="improvements">
                                            <h4>‚úÖ Am√©liorations</h4>
                                            ${report.progress.improvements.map(imp => `<p>‚Ä¢ ${imp}</p>`).join('')}
                                        </div>
                                    ` : ''}
                                    ${report.progress.concerns.length > 0 ? `
                                        <div class="concerns">
                                            <h4>‚ö†Ô∏è Points d'attention</h4>
                                            ${report.progress.concerns.map(concern => `<p>‚Ä¢ ${concern}</p>`).join('')}
                                        </div>
                                    ` : ''}
                                </div>
                            </div>
                            
                            <div class="report-section">
                                <h3>üîç Insights</h3>
                                <div class="insights-content">
                                    ${report.insights.map(insight => `
                                        <div class="insight-item">
                                            <span class="insight-icon">${insight.icon}</span>
                                            <div class="insight-text">
                                                <h4>${insight.title}</h4>
                                                <p>${insight.description}</p>
                                            </div>
                                        </div>
                                    `).join('')}
                                </div>
                            </div>
                            
                            <div class="report-section">
                                <h3>üí° Recommandations</h3>
                                <div class="recommendations-content">
                                    ${report.recommendations.map(rec => `
                                        <div class="recommendation-item ${rec.priority}">
                                            <div class="recommendation-header">
                                                <h4>${rec.title}</h4>
                                                <span class="priority-badge ${rec.priority}">${rec.priority}</span>
                                            </div>
                                            <p>${rec.description}</p>
                                            <button class="recommendation-action" onclick="handleRecommendationAction('${rec.actionType}')">${rec.action}</button>
                                        </div>
                                    `).join('')}
                                </div>
                            </div>
                        </div>
                        
                        <div class="report-actions">
                            <button class="report-btn primary" onclick="downloadReport('${report.id}')">üì• T√©l√©charger</button>
                            <button class="report-btn secondary" onclick="shareReport('${report.id}')">üì§ Partager avec professionnel</button>
                            <button class="report-btn secondary" onclick="closeMonthlyReportModal()">Fermer</button>
                        </div>
                    </div>
                </div>
            `;
            
            document.body.insertAdjacentHTML('beforeend', modalHTML);
            
            // Marquer le rapport comme lu
            localStorage.removeItem('newMonthlyReport');
        }
        
        function closeMonthlyReportModal() {
            const modal = document.querySelector('.monthly-report-modal');
            if (modal) {
                document.body.removeChild(modal);
            }
        }
        
        function handleRecommendationAction(actionType) {
            switch (actionType) {
                case 'professional_support':
                    alert('Redirection vers la prise de rendez-vous avec un professionnel...');
                    break;
                case 'stress_program':
                    alert('Ouverture du programme de gestion du stress...');
                    break;
                case 'lifestyle_improvement':
                    alert('Ouverture du planificateur d\'activit√©s bien-√™tre...');
                    break;
                default:
                    alert('Cette fonctionnalit√© sera bient√¥t disponible !');
            }
        }
        
        function downloadReport(reportId) {
            const reports = JSON.parse(localStorage.getItem('monthlyReports') || '[]');
            const report = reports.find(r => r.id === reportId);
            
            if (report) {
                const dataStr = JSON.stringify(report, null, 2);
                const dataBlob = new Blob([dataStr], {type: 'application/json'});
                const url = URL.createObjectURL(dataBlob);
                const link = document.createElement('a');
                link.href = url;
                link.download = `rapport-mindly-${report.period.replace(' ', '-')}.json`;
                link.click();
                URL.revokeObjectURL(url);
            }
        }
        
        // V√©rification et g√©n√©ration automatique des rapports
        function checkAndGenerateMonthlyReport() {
            const lastReportCheck = localStorage.getItem('lastReportCheck');
            const now = new Date();
            const currentMonth = now.getFullYear() + '-' + (now.getMonth() + 1).toString().padStart(2, '0');
            
            // V√©rifier si on est dans un nouveau mois
            if (!lastReportCheck || !lastReportCheck.includes(currentMonth)) {
                // G√©n√©rer le rapport pour le mois pr√©c√©dent
                if (lastReportCheck) {
                    const report = generateMonthlyReport();
                    
                    // Notifier l'utilisateur
                    setTimeout(() => {
                        if (confirm(`üìä Votre rapport mensuel pour ${report.period} est pr√™t ! Voulez-vous le consulter maintenant ?`)) {
                            showMonthlyReport();
                        }
                    }, 2000);
                }
                
                localStorage.setItem('lastReportCheck', currentMonth);
            }
        }

        // Initialize nouvelles fonctionnalit√©s
        document.addEventListener('DOMContentLoaded', function() {
            initUsabilityTesting();
            initFeedbackSystem();
            
            // V√©rifier et g√©n√©rer des rapports mensuels
            checkAndGenerateMonthlyReport();
            
            // Initialiser le syst√®me multi-langues
            initializeLanguage();
            
            // Initialiser les rappels d'humeur
            initializeMoodReminders();
            
            // Initialiser le chat
            initializeChat();
            
            // V√©rifier si l'utilisateur est connect√©
            const currentUser = localStorage.getItem('currentUser');
            const isAnonymous = localStorage.getItem('isAnonymous');
            
            if (currentUser) {
                if (isAnonymous) {
                    updateUIForAnonymousUser();
                }
            }
            
            // Charger la configuration de style de vie si elle existe
            const lifestyleConfig = localStorage.getItem('lifestyleConfiguration');
            if (lifestyleConfig) {
                const config = JSON.parse(lifestyleConfig);
                adaptAppBasedOnUsage();
            }
        });

        // === SYST√àME D'IC√îNES COH√âRENT ===
        const icons = {
            // Interface principale
            mood: '‚óê',
            chat: '‚óä',
            community: '‚óã',
            explore: '‚óà',
            profile: '‚óé',
            settings: '‚öô',
            
            // Actions
            add: '+',
            edit: '‚úé',
            delete: '√ó',
            save: '‚úì',
            cancel: '‚óÑ',
            close: '√ó',
            search: '‚óå',
            filter: '‚â°',
            
            // √âtats d'humeur
            happy: '‚ò∫',
            good: '‚òª',
            neutral: '‚óê',
            sad: '‚òπ',
            stressed: '‚óô',
            
            // Notifications et alertes
            bell: '‚óâ',
            warning: '‚ö†',
            info: '‚ìò',
            success: '‚úì',
            error: '!',
            
            // Temps et dates
            clock: '‚ó∑',
            calendar: '‚ó´',
            
            // Autres
            heart: '‚ô°',
            star: '‚òÜ',
            location: '‚óâ',
            link: '‚ßâ',
            download: '‚áì',
            upload: '‚áë',
            
            // Langues
            language: '‚óå',
            globe: '‚óã'
        };

        // === SYST√àME MULTI-LANGUES (F09.1) ===
        
        const translations = {
            fr: {
                // Navigation principale
                'nav.home': 'Accueil',
                'nav.mood': 'Humeur',
                'nav.chat': 'Chat',
                'nav.community': 'Communaut√©',
                'nav.explore': 'Explorer',
                'nav.profile': 'Profil',
                
                // Titres principaux
                'app.title': 'MINDLY',
                'app.subtitle': 'Votre compagnon bien-√™tre',
                'welcome.title': 'Bienvenue dans MINDLY',
                'welcome.subtitle': 'Prenez soin de votre bien-√™tre mental',
                
                // Authentification
                'auth.login': 'Se connecter',
                'auth.signup': 'S\'inscrire',
                'auth.email': 'Adresse email',
                'auth.password': 'Mot de passe',
                'auth.confirm_password': 'Confirmer le mot de passe',
                'auth.forgot_password': 'Mot de passe oubli√© ?',
                'auth.create_account': 'Cr√©er un compte',
                'auth.google_signin': 'Se connecter avec Google',
                'auth.apple_signin': 'Se connecter avec Apple',
                'auth.anonymous_mode': 'Continuer en mode anonyme',
                'auth.terms_accept': 'J\'accepte les conditions d\'utilisation',
                'auth.privacy_accept': 'J\'accepte la politique de confidentialit√©',
                
                // Suivi d'humeur
                'mood.title': 'Comment vous sentez-vous ?',
                'mood.subtitle': 'Prenez quelques secondes pour noter votre √©tat',
                'mood.very_bad': 'Tr√®s difficile',
                'mood.bad': 'Difficile',
                'mood.neutral': 'Neutre',
                'mood.good': 'Bien',
                'mood.very_good': 'Tr√®s bien',
                'mood.add_note': 'Ajouter une note (optionnel)',
                'mood.save': 'Enregistrer',
                'mood.saved': 'Humeur enregistr√©e avec succ√®s',
                'mood.tags': 'Tags d\'√©motion',
                
                // Chat
                'chat.title': 'Assistant bien-√™tre',
                'chat.placeholder': '√âcrivez votre message...',
                'chat.send': 'Envoyer',
                'chat.thinking': 'R√©flexion en cours...',
                'chat.emergency_detected': 'Situation d\'urgence d√©tect√©e',
                'chat.emergency_help': 'Des ressources d\'aide sont disponibles',
                
                // Profil et param√®tres
                'profile.title': 'Profil',
                'profile.subtitle': 'Votre espace personnel',
                'profile.settings': 'Param√®tres',
                'profile.create': 'Cr√©er un profil',
                'settings.title': 'Param√®tres',
                'settings.statistics': 'Statistiques visuelles',
                'settings.statistics_desc': 'Graphiques et analyses de votre bien-√™tre',
                'settings.reminders': 'Rappels d\'humeur',
                'settings.reminders_desc': 'Configurer vos notifications de bien-√™tre',
                'settings.language': 'Langue',
                'settings.language_desc': 'Fran√ßais, Anglais, Nederlands',
                'settings.notifications': 'Notifications',
                'settings.notifications_desc': 'G√©rer vos pr√©f√©rences de notification',
                'settings.privacy': 'Confidentialit√©',
                'settings.privacy_desc': 'Param√®tres de confidentialit√© et donn√©es',
                'settings.data': 'Mes donn√©es',
                'settings.data_desc': 'Exporter ou supprimer vos donn√©es',
                
                // Statistiques
                'stats.title': 'Vos statistiques de bien-√™tre',
                'stats.loading': 'Analyse de vos donn√©es en cours...',
                'stats.avg_mood': 'Humeur moyenne',
                'stats.streak': 'Jours cons√©cutifs',
                'stats.consistency': 'R√©gularit√© (%)',
                'stats.engagement': 'Engagement',
                'stats.mood_evolution': '√âvolution de l\'humeur (30 derniers jours)',
                'stats.emotion_distribution': 'Distribution des √©motions',
                'stats.weekly_patterns': 'Patterns d\'activit√© hebdomadaire',
                'stats.insights': 'Insights personnalis√©s',
                'stats.export': 'Exporter',
                'stats.share': 'Partager',
                'stats.close': 'Fermer',
                
                // Rappels
                'reminders.title': 'Configuration des rappels',
                'reminders.enable': 'Activer les rappels d\'humeur',
                'reminders.enable_desc': 'Recevez des notifications pour enregistrer votre humeur r√©guli√®rement',
                'reminders.frequency': 'Fr√©quence des rappels',
                'reminders.daily': 'Quotidien (1-2 fois par jour)',
                'reminders.bidaily': 'Tous les 2 jours',
                'reminders.weekly': 'Hebdomadaire',
                'reminders.times': 'Heures de rappel',
                'reminders.first_reminder': 'Premier rappel',
                'reminders.second_reminder': 'Second rappel (optionnel)',
                'reminders.enable_second': 'Activer le second rappel',
                'reminders.smart': 'Rappels intelligents',
                'reminders.smart_desc': 'Ajuster les rappels selon votre activit√© et vos patterns d\'humeur',
                'reminders.contextual': 'Messages contextuels',
                'reminders.contextual_desc': 'Adapter le message du rappel selon l\'heure et votre historique',
                'reminders.preview': 'Aper√ßu',
                'reminders.save': 'Sauvegarder',
                'reminders.test': 'Tester maintenant',
                'reminders.cancel': 'Annuler',
                
                // Messages g√©n√©raux
                'common.save': 'Sauvegarder',
                'common.cancel': 'Annuler',
                'common.close': 'Fermer',
                'common.loading': 'Chargement...',
                'common.error': 'Erreur',
                'common.success': 'Succ√®s',
                'common.retry': 'R√©essayer',
                'common.back': 'Retour',
                'common.next': 'Suivant',
                'common.previous': 'Pr√©c√©dent',
                'common.confirm': 'Confirmer',
                
                // Jours de la semaine
                'days.monday': 'Lundi',
                'days.tuesday': 'Mardi',
                'days.wednesday': 'Mercredi',
                'days.thursday': 'Jeudi',
                'days.friday': 'Vendredi',
                'days.saturday': 'Samedi',
                'days.sunday': 'Dimanche',
                'days.mon': 'Lun',
                'days.tue': 'Mar',
                'days.wed': 'Mer',
                'days.thu': 'Jeu',
                'days.fri': 'Ven',
                'days.sat': 'Sam',
                'days.sun': 'Dim'
            },
            
            en: {
                // Navigation principale
                'nav.home': 'Home',
                'nav.mood': 'Mood',
                'nav.chat': 'Chat',
                'nav.community': 'Community',
                'nav.explore': 'Explore',
                'nav.profile': 'Profile',
                
                // Titres principaux
                'app.title': 'MINDLY',
                'app.subtitle': 'Your wellness companion',
                'welcome.title': 'Welcome to MINDLY',
                'welcome.subtitle': 'Take care of your mental wellbeing',
                
                // Authentification
                'auth.login': 'Sign In',
                'auth.signup': 'Sign Up',
                'auth.email': 'Email address',
                'auth.password': 'Password',
                'auth.confirm_password': 'Confirm password',
                'auth.forgot_password': 'Forgot password?',
                'auth.create_account': 'Create account',
                'auth.google_signin': 'Sign in with Google',
                'auth.apple_signin': 'Sign in with Apple',
                'auth.anonymous_mode': 'Continue anonymously',
                'auth.terms_accept': 'I accept the terms of service',
                'auth.privacy_accept': 'I accept the privacy policy',
                
                // Suivi d'humeur
                'mood.title': 'How are you feeling?',
                'mood.subtitle': 'Take a moment to note your current state',
                'mood.very_bad': 'Very difficult',
                'mood.bad': 'Difficult',
                'mood.neutral': 'Neutral',
                'mood.good': 'Good',
                'mood.very_good': 'Very good',
                'mood.add_note': 'Add a note (optional)',
                'mood.save': 'Save',
                'mood.saved': 'Mood saved successfully',
                'mood.tags': 'Emotion tags',
                
                // Chat
                'chat.title': 'Wellness assistant',
                'chat.placeholder': 'Type your message...',
                'chat.send': 'Send',
                'chat.thinking': 'Thinking...',
                'chat.emergency_detected': 'Emergency situation detected',
                'chat.emergency_help': 'Help resources are available',
                
                // Profil et param√®tres
                'profile.title': 'Profile',
                'profile.subtitle': 'Your personal space',
                'profile.settings': 'Settings',
                'profile.create': 'Create profile',
                'settings.title': 'Settings',
                'settings.statistics': 'Visual statistics',
                'settings.statistics_desc': 'Charts and analysis of your wellbeing',
                'settings.reminders': 'Mood reminders',
                'settings.reminders_desc': 'Configure your wellness notifications',
                'settings.language': 'Language',
                'settings.language_desc': 'French, English, Nederlands',
                'settings.notifications': 'Notifications',
                'settings.notifications_desc': 'Manage your notification preferences',
                'settings.privacy': 'Privacy',
                'settings.privacy_desc': 'Privacy and data settings',
                'settings.data': 'My data',
                'settings.data_desc': 'Export or delete your data',
                
                // Statistiques
                'stats.title': 'Your wellness statistics',
                'stats.loading': 'Analyzing your data...',
                'stats.avg_mood': 'Average mood',
                'stats.streak': 'Consecutive days',
                'stats.consistency': 'Consistency (%)',
                'stats.engagement': 'Engagement',
                'stats.mood_evolution': 'Mood evolution (last 30 days)',
                'stats.emotion_distribution': 'Emotion distribution',
                'stats.weekly_patterns': 'Weekly activity patterns',
                'stats.insights': 'Personal insights',
                'stats.export': 'Export',
                'stats.share': 'Share',
                'stats.close': 'Close',
                
                // Rappels
                'reminders.title': 'Reminder settings',
                'reminders.enable': 'Enable mood reminders',
                'reminders.enable_desc': 'Receive notifications to record your mood regularly',
                'reminders.frequency': 'Reminder frequency',
                'reminders.daily': 'Daily (1-2 times per day)',
                'reminders.bidaily': 'Every 2 days',
                'reminders.weekly': 'Weekly',
                'reminders.times': 'Reminder times',
                'reminders.first_reminder': 'First reminder',
                'reminders.second_reminder': 'Second reminder (optional)',
                'reminders.enable_second': 'Enable second reminder',
                'reminders.smart': 'Smart reminders',
                'reminders.smart_desc': 'Adjust reminders based on your activity and mood patterns',
                'reminders.contextual': 'Contextual messages',
                'reminders.contextual_desc': 'Adapt reminder message based on time and your history',
                'reminders.preview': 'Preview',
                'reminders.save': 'Save',
                'reminders.test': 'Test now',
                'reminders.cancel': 'Cancel',
                
                // Messages g√©n√©raux
                'common.save': 'Save',
                'common.cancel': 'Cancel',
                'common.close': 'Close',
                'common.loading': 'Loading...',
                'common.error': 'Error',
                'common.success': 'Success',
                'common.retry': 'Retry',
                'common.back': 'Back',
                'common.next': 'Next',
                'common.previous': 'Previous',
                'common.confirm': 'Confirm',
                
                // Jours de la semaine
                'days.monday': 'Monday',
                'days.tuesday': 'Tuesday',
                'days.wednesday': 'Wednesday',
                'days.thursday': 'Thursday',
                'days.friday': 'Friday',
                'days.saturday': 'Saturday',
                'days.sunday': 'Sunday',
                'days.mon': 'Mon',
                'days.tue': 'Tue',
                'days.wed': 'Wed',
                'days.thu': 'Thu',
                'days.fri': 'Fri',
                'days.sat': 'Sat',
                'days.sun': 'Sun'
            },
            
            nl: {
                // Navigation principale
                'nav.home': 'Thuis',
                'nav.mood': 'Stemming',
                'nav.chat': 'Chat',
                'nav.community': 'Gemeenschap',
                'nav.explore': 'Verkennen',
                'nav.profile': 'Profiel',
                
                // Titres principaux
                'app.title': 'MINDLY',
                'app.subtitle': 'Uw welzijnscompagnon',
                'welcome.title': 'Welkom bij MINDLY',
                'welcome.subtitle': 'Zorg voor uw mentale welzijn',
                
                // Authentification
                'auth.login': 'Inloggen',
                'auth.signup': 'Registreren',
                'auth.email': 'E-mailadres',
                'auth.password': 'Wachtwoord',
                'auth.confirm_password': 'Bevestig wachtwoord',
                'auth.forgot_password': 'Wachtwoord vergeten?',
                'auth.create_account': 'Account aanmaken',
                'auth.google_signin': 'Inloggen met Google',
                'auth.apple_signin': 'Inloggen met Apple',
                'auth.anonymous_mode': 'Anoniem doorgaan',
                'auth.terms_accept': 'Ik accepteer de gebruiksvoorwaarden',
                'auth.privacy_accept': 'Ik accepteer het privacybeleid',
                
                // Suivi d'humeur
                'mood.title': 'Hoe voelt u zich?',
                'mood.subtitle': 'Neem even de tijd om uw huidige staat te noteren',
                'mood.very_bad': 'Erg moeilijk',
                'mood.bad': 'Moeilijk',
                'mood.neutral': 'Neutraal',
                'mood.good': 'Goed',
                'mood.very_good': 'Zeer goed',
                'mood.add_note': 'Notitie toevoegen (optioneel)',
                'mood.save': 'Opslaan',
                'mood.saved': 'Stemming succesvol opgeslagen',
                'mood.tags': 'Emotie tags',
                
                // Chat
                'chat.title': 'Welzijnsassistent',
                'chat.placeholder': 'Typ uw bericht...',
                'chat.send': 'Verzenden',
                'chat.thinking': 'Nadenken...',
                'chat.emergency_detected': 'Noodsituatie gedetecteerd',
                'chat.emergency_help': 'Hulpbronnen zijn beschikbaar',
                
                // Profil et param√®tres
                'profile.title': 'Profiel',
                'profile.subtitle': 'Uw persoonlijke ruimte',
                'profile.settings': 'Instellingen',
                'profile.create': 'Profiel aanmaken',
                'settings.title': 'Instellingen',
                'settings.statistics': 'Visuele statistieken',
                'settings.statistics_desc': 'Grafieken en analyse van uw welzijn',
                'settings.reminders': 'Stemmingsherinneringen',
                'settings.reminders_desc': 'Configureer uw welzijnsmeldingen',
                'settings.language': 'Taal',
                'settings.language_desc': 'Frans, Engels, Nederlands',
                'settings.notifications': 'Meldingen',
                'settings.notifications_desc': 'Beheer uw meldingsvoorkeuren',
                'settings.privacy': 'Privacy',
                'settings.privacy_desc': 'Privacy- en gegevensinstellingen',
                'settings.data': 'Mijn gegevens',
                'settings.data_desc': 'Exporteer of verwijder uw gegevens',
                
                // Statistiques
                'stats.title': 'Uw welzijnsstatistieken',
                'stats.loading': 'Uw gegevens analyseren...',
                'stats.avg_mood': 'Gemiddelde stemming',
                'stats.streak': 'Opeenvolgende dagen',
                'stats.consistency': 'Consistentie (%)',
                'stats.engagement': 'Betrokkenheid',
                'stats.mood_evolution': 'Stemmingsevolutie (laatste 30 dagen)',
                'stats.emotion_distribution': 'Emotieverdeling',
                'stats.weekly_patterns': 'Wekelijkse activiteitspatronen',
                'stats.insights': 'Persoonlijke inzichten',
                'stats.export': 'Exporteren',
                'stats.share': 'Delen',
                'stats.close': 'Sluiten',
                
                // Rappels
                'reminders.title': 'Herinneringsinstellingen',
                'reminders.enable': 'Stemmingsherinneringen inschakelen',
                'reminders.enable_desc': 'Ontvang meldingen om uw stemming regelmatig vast te leggen',
                'reminders.frequency': 'Herinneringsfrequentie',
                'reminders.daily': 'Dagelijks (1-2 keer per dag)',
                'reminders.bidaily': 'Om de 2 dagen',
                'reminders.weekly': 'Wekelijks',
                'reminders.times': 'Herinneringstijden',
                'reminders.first_reminder': 'Eerste herinnering',
                'reminders.second_reminder': 'Tweede herinnering (optioneel)',
                'reminders.enable_second': 'Tweede herinnering inschakelen',
                'reminders.smart': 'Slimme herinneringen',
                'reminders.smart_desc': 'Herinneringen aanpassen op basis van uw activiteit en stemmingspatronen',
                'reminders.contextual': 'Contextuele berichten',
                'reminders.contextual_desc': 'Herinneringsbericht aanpassen op basis van tijd en uw geschiedenis',
                'reminders.preview': 'Voorbeeld',
                'reminders.save': 'Opslaan',
                'reminders.test': 'Nu testen',
                'reminders.cancel': 'Annuleren',
                
                // Messages g√©n√©raux
                'common.save': 'Opslaan',
                'common.cancel': 'Annuleren',
                'common.close': 'Sluiten',
                'common.loading': 'Laden...',
                'common.error': 'Fout',
                'common.success': 'Succes',
                'common.retry': 'Opnieuw proberen',
                'common.back': 'Terug',
                'common.next': 'Volgende',
                'common.previous': 'Vorige',
                'common.confirm': 'Bevestigen',
                
                // Jours de la semaine
                'days.monday': 'Maandag',
                'days.tuesday': 'Dinsdag',
                'days.wednesday': 'Woensdag',
                'days.thursday': 'Donderdag',
                'days.friday': 'Vrijdag',
                'days.saturday': 'Zaterdag',
                'days.sunday': 'Zondag',
                'days.mon': 'Ma',
                'days.tue': 'Di',
                'days.wed': 'Wo',
                'days.thu': 'Do',
                'days.fri': 'Vr',
                'days.sat': 'Za',
                'days.sun': 'Zo'
            }
        };
        
        // Fonction de traduction
        function translate(key, lang = currentLanguage) {
            const translation = translations[lang] && translations[lang][key];
            return translation || key;
        }
        
        // Fonction pour changer de langue
        function changeLanguage(newLanguage) {
            if (!translations[newLanguage]) {
                console.warn(`Langue non support√©e: ${newLanguage}`);
                return;
            }
            
            currentLanguage = newLanguage;
            t = translations[currentLanguage];
            
            // Sauvegarder la pr√©f√©rence
            localStorage.setItem('preferredLanguage', newLanguage);
            
            // Mettre √† jour l'interface
            updateUILanguage();
            
            // Notification de changement
            showLanguageChangeNotification(newLanguage);
        }
        
        // Fonction pour d√©tecter la langue du navigateur
        function detectBrowserLanguage() {
            const browserLang = navigator.language || navigator.userLanguage;
            const langCode = browserLang.toLowerCase().split('-')[0];
            
            // Mapper les codes de langue support√©s
            if (langCode === 'fr') return 'fr';
            if (langCode === 'en') return 'en';
            if (langCode === 'nl') return 'nl';
            
            return 'fr'; // Langue par d√©faut
        }
        
        // Fonction pour initialiser la langue
        function initializeLanguage() {
            // V√©rifier la pr√©f√©rence sauvegard√©e
            const savedLang = localStorage.getItem('preferredLanguage');
            if (savedLang && translations[savedLang]) {
                currentLanguage = savedLang;
            } else {
                // D√©tecter la langue du navigateur
                currentLanguage = detectBrowserLanguage();
            }
            
            t = translations[currentLanguage];
            updateUILanguage();
        }
        
        // Fonction pour mettre √† jour l'interface utilisateur
        function updateUILanguage() {
            // Mettre √† jour tous les √©l√©ments avec data-translate
            document.querySelectorAll('[data-translate]').forEach(element => {
                const key = element.getAttribute('data-translate');
                const translation = translate(key);
                
                if (element.tagName === 'INPUT' && (element.type === 'submit' || element.type === 'button')) {
                    element.value = translation;
                } else if (element.tagName === 'INPUT' && element.type === 'text') {
                    element.placeholder = translation;
                } else {
                    element.textContent = translation;
                }
            });
            
            // Mettre √† jour les placeholders
            document.querySelectorAll('[data-translate-placeholder]').forEach(element => {
                const key = element.getAttribute('data-translate-placeholder');
                element.placeholder = translate(key);
            });
            
            // Mettre √† jour les titres (title attribute)
            document.querySelectorAll('[data-translate-title]').forEach(element => {
                const key = element.getAttribute('data-translate-title');
                element.title = translate(key);
            });
            
            // Mettre √† jour les √©l√©ments dynamiques sp√©cifiques
            updateDynamicLanguageElements();
        }
        
        // Fonction pour mettre √† jour les √©l√©ments dynamiques
        function updateDynamicLanguageElements() {
            // Mettre √† jour le titre de la page
            document.title = translate('app.title') + ' - ' + translate('app.subtitle');
            
            // Mettre √† jour les graphiques si ils sont visibles
            if (document.querySelector('.statistics-modal')) {
                // Re-g√©n√©rer les graphiques avec les nouvelles traductions
                setTimeout(() => {
                    loadAllCharts();
                }, 100);
            }
        }
        
        // Fonction pour afficher la s√©lection de langue
        function showLanguageSettings() {
            const languageHTML = `
                <div class="language-settings-modal">
                    <div class="language-content">
                        <div class="language-header">
                            <h3>${icons.globe} ${translate('settings.language')}</h3>
                            <button class="close-btn" onclick="closeLanguageSettings()">${icons.close}</button>
                        </div>
                        
                        <div class="language-body">
                            <p class="language-description">
                                ${translate('settings.language_desc')}
                            </p>
                            
                            <div class="language-options">
                                <div class="language-option ${currentLanguage === 'fr' ? 'active' : ''}" onclick="selectLanguage('fr')">
                                    <div class="language-flag">üá´üá∑</div>
                                    <div class="language-info">
                                        <h4>Fran√ßais</h4>
                                        <p>Interface en langue fran√ßaise</p>
                                    </div>
                                    <div class="language-check">${currentLanguage === 'fr' ? icons.success : ''}</div>
                                </div>
                                
                                <div class="language-option ${currentLanguage === 'en' ? 'active' : ''}" onclick="selectLanguage('en')">
                                    <div class="language-flag">üá¨üáß</div>
                                    <div class="language-info">
                                        <h4>English</h4>
                                        <p>Interface in English</p>
                                    </div>
                                    <div class="language-check">${currentLanguage === 'en' ? icons.success : ''}</div>
                                </div>
                                
                                <div class="language-option ${currentLanguage === 'nl' ? 'active' : ''}" onclick="selectLanguage('nl')">
                                    <div class="language-flag">üá≥üá±</div>
                                    <div class="language-info">
                                        <h4>Nederlands</h4>
                                        <p>Interface in het Nederlands</p>
                                    </div>
                                    <div class="language-check">${currentLanguage === 'nl' ? icons.success : ''}</div>
                                </div>
                            </div>
                            
                            <div class="language-note">
                                <p>${icons.info} ${translate('common.loading')}</p>
                            </div>
                        </div>
                        
                        <div class="language-actions">
                            <button class="btn-primary" onclick="closeLanguageSettings()">${translate('common.close')}</button>
                        </div>
                    </div>
                </div>
            `;
            
            document.body.insertAdjacentHTML('beforeend', languageHTML);
        }
        
        function selectLanguage(lang) {
            // Mettre √† jour visuellement la s√©lection
            document.querySelectorAll('.language-option').forEach(option => {
                option.classList.remove('active');
            });
            document.querySelector(`.language-option[onclick*="${lang}"]`).classList.add('active');
            
            // Mettre √† jour les checkmarks
            document.querySelectorAll('.language-check').forEach(check => {
                check.textContent = '';
            });
            document.querySelector(`.language-option[onclick*="${lang}"] .language-check`).textContent = icons.success;
            
            // Changer la langue
            changeLanguage(lang);
        }
        
        function closeLanguageSettings() {
            const modal = document.querySelector('.language-settings-modal');
            if (modal) {
                document.body.removeChild(modal);
            }
        }
        
        function showLanguageChangeNotification(newLanguage) {
            const langNames = {
                'fr': 'Fran√ßais',
                'en': 'English', 
                'nl': 'Nederlands'
            };
            
            const notification = document.createElement('div');
            notification.className = 'language-notification';
            notification.innerHTML = `
                <div class="notification-content">
                    <span class="notification-icon">${icons.success}</span>
                    <span class="notification-text">
                        ${translate('common.success')} - ${langNames[newLanguage]}
                    </span>
                </div>
            `;
            
            document.body.appendChild(notification);
            
            // Animation d'entr√©e
            setTimeout(() => {
                notification.classList.add('show');
            }, 100);
            
            // Suppression automatique
            setTimeout(() => {
                notification.classList.remove('show');
                setTimeout(() => {
                    if (document.body.contains(notification)) {
                        document.body.removeChild(notification);
                    }
                }, 300);
            }, 2000);
        }

        // === SYST√àME DE RAPPELS CONFIGURABLES (F05.1) ===
        
        function showReminderSettings() {
            const currentSettings = JSON.parse(localStorage.getItem('moodReminderSettings') || '{"enabled": true, "frequency": "daily", "times": ["09:00", "18:00"], "personalizations": true}');
            
            const modalHTML = `
                <div class="reminder-settings-modal">
                    <div class="settings-content">
                        <div class="settings-header">
                            <h3>${icons.clock} Configuration des rappels</h3>
                            <button class="close-btn" onclick="closeReminderSettings()">${icons.close}</button>
                        </div>
                        
                        <div class="settings-body">
                            <div class="setting-group">
                                <label class="setting-label">
                                    <input type="checkbox" id="remindersEnabled" ${currentSettings.enabled ? 'checked' : ''}>
                                    Activer les rappels d'humeur
                                </label>
                                <p class="setting-description">Recevez des notifications pour enregistrer votre humeur r√©guli√®rement</p>
                            </div>
                            
                            <div class="setting-group" id="reminderOptions" ${!currentSettings.enabled ? 'style="opacity: 0.5; pointer-events: none;"' : ''}>
                                <h4>Fr√©quence des rappels</h4>
                                <div class="frequency-options">
                                    <label class="radio-option">
                                        <input type="radio" name="frequency" value="daily" ${currentSettings.frequency === 'daily' ? 'checked' : ''}>
                                        <span>Quotidien (1-2 fois par jour)</span>
                                    </label>
                                    <label class="radio-option">
                                        <input type="radio" name="frequency" value="bidaily" ${currentSettings.frequency === 'bidaily' ? 'checked' : ''}>
                                        <span>Tous les 2 jours</span>
                                    </label>
                                    <label class="radio-option">
                                        <input type="radio" name="frequency" value="weekly" ${currentSettings.frequency === 'weekly' ? 'checked' : ''}>
                                        <span>Hebdomadaire</span>
                                    </label>
                                </div>
                                
                                <div class="time-selection" id="timeSelection">
                                    <h4>Heures de rappel</h4>
                                    <div class="time-slots">
                                        <div class="time-slot">
                                            <label>Premier rappel</label>
                                            <input type="time" id="firstReminder" value="${currentSettings.times[0] || '09:00'}">
                                        </div>
                                        <div class="time-slot">
                                            <label>Second rappel (optionnel)</label>
                                            <input type="time" id="secondReminder" value="${currentSettings.times[1] || '18:00'}">
                                            <label class="checkbox-option">
                                                <input type="checkbox" id="enableSecondReminder" ${currentSettings.times.length > 1 ? 'checked' : ''}>
                                                Activer le second rappel
                                            </label>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="personalization-options">
                                    <h4>Personnalisation</h4>
                                    <label class="setting-label">
                                        <input type="checkbox" id="smartReminders" ${currentSettings.personalizations ? 'checked' : ''}>
                                        Rappels intelligents
                                    </label>
                                    <p class="setting-description">Ajuster les rappels selon votre activit√© et vos patterns d'humeur</p>
                                    
                                    <label class="setting-label">
                                        <input type="checkbox" id="contextualReminders" ${currentSettings.contextual !== false ? 'checked' : ''}>
                                        Messages contextuels
                                    </label>
                                    <p class="setting-description">Adapter le message du rappel selon l'heure et votre historique</p>
                                </div>
                            </div>
                        </div>
                        
                        <div class="settings-preview">
                            <h4>üîç Aper√ßu</h4>
                            <div id="reminderPreview" class="preview-content">
                                <!-- Contenu g√©n√©r√© dynamiquement -->
                            </div>
                        </div>
                        
                        <div class="settings-actions">
                            <button class="btn-primary" onclick="saveReminderSettings()">‚úÖ Sauvegarder</button>
                            <button class="btn-secondary" onclick="testReminder()">üîî Tester maintenant</button>
                            <button class="btn-secondary" onclick="closeReminderSettings()">Annuler</button>
                        </div>
                    </div>
                </div>
            `;
            
            document.body.insertAdjacentHTML('beforeend', modalHTML);
            
            // Ajouter les event listeners
            setupReminderSettingsListeners();
            updateReminderPreview();
        }
        
        function setupReminderSettingsListeners() {
            const enabledCheckbox = document.getElementById('remindersEnabled');
            const reminderOptions = document.getElementById('reminderOptions');
            
            enabledCheckbox.addEventListener('change', function() {
                if (this.checked) {
                    reminderOptions.style.opacity = '1';
                    reminderOptions.style.pointerEvents = 'auto';
                } else {
                    reminderOptions.style.opacity = '0.5';
                    reminderOptions.style.pointerEvents = 'none';
                }
                updateReminderPreview();
            });
            
            // Listeners pour mise √† jour de l'aper√ßu
            document.querySelectorAll('input[name="frequency"], #firstReminder, #secondReminder, #enableSecondReminder, #smartReminders, #contextualReminders').forEach(input => {
                input.addEventListener('change', updateReminderPreview);
            });
        }
        
        function updateReminderPreview() {
            const enabled = document.getElementById('remindersEnabled').checked;
            const frequency = document.querySelector('input[name="frequency"]:checked')?.value || 'daily';
            const firstTime = document.getElementById('firstReminder')?.value || '09:00';
            const secondTime = document.getElementById('secondReminder')?.value || '18:00';
            const enableSecond = document.getElementById('enableSecondReminder')?.checked || false;
            const smart = document.getElementById('smartReminders')?.checked || false;
            const contextual = document.getElementById('contextualReminders')?.checked || false;
            
            const preview = document.getElementById('reminderPreview');
            if (!preview) return;
            
            if (!enabled) {
                preview.innerHTML = '<p class="preview-disabled">‚ùå Rappels d√©sactiv√©s</p>';
                return;
            }
            
            let previewHTML = '<div class="preview-enabled">';
            
            // Fr√©quence
            const frequencyTexts = {
                'daily': 'tous les jours',
                'bidaily': 'tous les 2 jours', 
                'weekly': 'chaque semaine'
            };
            
            previewHTML += `<p><strong>üìÖ Fr√©quence:</strong> ${frequencyTexts[frequency]}</p>`;
            
            // Heures
            previewHTML += `<p><strong>üïò Heures:</strong> ${firstTime}`;
            if (enableSecond) {
                previewHTML += ` et ${secondTime}`;
            }
            previewHTML += '</p>';
            
            // Fonctionnalit√©s avanc√©es
            if (smart) {
                previewHTML += '<p><strong>üß† Rappels intelligents:</strong> Les notifications s\'adapteront √† votre activit√©</p>';
            }
            
            if (contextual) {
                previewHTML += '<p><strong>üí¨ Messages contextuels:</strong> Le contenu des rappels sera personnalis√©</p>';
            }
            
            // Exemple de notification
            previewHTML += '<div class="preview-notification">';
            previewHTML += '<h5>üì± Exemple de notification:</h5>';
            
            if (contextual) {
                const hour = parseInt(firstTime.split(':')[0]);
                if (hour < 12) {
                    previewHTML += '<p class="notification-example">"üåÖ Bonjour ! Comment commencez-vous cette journ√©e ? Prenez 10 secondes pour noter votre humeur."</p>';
                } else if (hour < 18) {
                    previewHTML += '<p class="notification-example">"‚òÄÔ∏è Comment se passe votre journ√©e ? Un petit check-in humeur vous attend dans MINDLY."</p>';
                } else {
                    previewHTML += '<p class="notification-example">"üåô Bonsoir ! Avant de terminer la journ√©e, que diriez-vous de noter votre humeur ?"</p>';
                }
            } else {
                previewHTML += '<p class="notification-example">"üå∏ MINDLY vous rappelle: Comment vous sentez-vous maintenant ?"</p>';
            }
            
            previewHTML += '</div></div>';
            
            preview.innerHTML = previewHTML;
        }
        
        function saveReminderSettings() {
            const settings = {
                enabled: document.getElementById('remindersEnabled').checked,
                frequency: document.querySelector('input[name="frequency"]:checked')?.value || 'daily',
                times: [],
                personalizations: document.getElementById('smartReminders')?.checked || false,
                contextual: document.getElementById('contextualReminders')?.checked || false,
                lastUpdated: new Date().toISOString()
            };
            
            // Collecter les heures
            const firstTime = document.getElementById('firstReminder').value;
            if (firstTime) settings.times.push(firstTime);
            
            if (document.getElementById('enableSecondReminder').checked) {
                const secondTime = document.getElementById('secondReminder').value;
                if (secondTime) settings.times.push(secondTime);
            }
            
            // Sauvegarder
            localStorage.setItem('moodReminderSettings', JSON.stringify(settings));
            
            // Reprogrammer les rappels
            if (settings.enabled) {
                scheduleNextMoodReminder();
                alert('‚úÖ Rappels configur√©s avec succ√®s ! Le prochain rappel sera envoy√© selon vos pr√©f√©rences.');
            } else {
                alert('‚ùå Rappels d√©sactiv√©s.');
            }
            
            closeReminderSettings();
        }
        
        function closeReminderSettings() {
            const modal = document.querySelector('.reminder-settings-modal');
            if (modal) {
                document.body.removeChild(modal);
            }
        }
        
        function testReminder() {
            const settings = {
                enabled: document.getElementById('remindersEnabled').checked,
                contextual: document.getElementById('contextualReminders')?.checked || false
            };
            
            if (!settings.enabled) {
                alert('‚ö†Ô∏è Activez d\'abord les rappels pour tester cette fonctionnalit√©.');
                return;
            }
            
            // Simuler une notification
            let message = 'Test de notification MINDLY';
            let body = 'Ceci est un test de vos param√®tres de rappel.';
            
            if (settings.contextual) {
                const hour = new Date().getHours();
                if (hour < 12) {
                    body = 'üåÖ Test: Comment commencez-vous cette journ√©e ?';
                } else if (hour < 18) {
                    body = '‚òÄÔ∏è Test: Comment se passe votre journ√©e ?';
                } else {
                    body = 'üåô Test: Comment terminez-vous cette journ√©e ?';
                }
            }
            
            if (Notification.permission === 'granted') {
                new Notification(message, {
                    body: body,
                    icon: '/favicon.ico',
                    badge: '/favicon.ico'
                });
                alert('üîî Notification de test envoy√©e ! (V√©rifiez vos notifications syst√®me)');
            } else if (Notification.permission === 'default') {
                Notification.requestPermission().then(permission => {
                    if (permission === 'granted') {
                        new Notification(message, { body: body });
                        alert('üîî Notification de test envoy√©e !');
                    } else {
                        alert('‚ùå Permission de notification refus√©e. Les rappels appara√Ætront dans l\'application.');
                    }
                });
            } else {
                alert('‚ùå Notifications bloqu√©es. Les rappels appara√Ætront dans l\'application.');
            }
        }
        
        // Am√©lioration du syst√®me de rappel existant
        function getContextualReminderMessage() {
            const settings = JSON.parse(localStorage.getItem('moodReminderSettings') || '{}');
            const hour = new Date().getHours();
            const moodHistory = JSON.parse(localStorage.getItem('moodHistory') || '[]');
            
            // Messages de base
            let messages = {
                morning: [
                    'üåÖ Bonjour ! Comment commencez-vous cette journ√©e ?',
                    '‚òÄÔ∏è Un nouveau jour commence ! Votre humeur du moment ?',
                    'üå∏ Hello ! Prenez 10 secondes pour noter votre √©tat d\'esprit.'
                ],
                afternoon: [
                    '‚òÄÔ∏è Comment se passe votre journ√©e jusqu\'√† pr√©sent ?',
                    '‚è∞ Mi-journ√©e ! Un petit check-in humeur ?',
                    'üåû Pause bien-√™tre : comment vous sentez-vous ?'
                ],
                evening: [
                    'üåÖ Bonsoir ! Comment s\'est pass√©e votre journ√©e ?',
                    'üåô Avant de terminer, que diriez-vous d\'un bilan humeur ?',
                    '‚ú® Fin de journ√©e : comment vous sentez-vous maintenant ?'
                ]
            };
            
            // Personnalisation selon l'historique
            if (settings.personalizations && moodHistory.length > 0) {
                const recentMoods = moodHistory.slice(0, 7);
                const avgMood = recentMoods.reduce((sum, mood) => sum + mood.level, 0) / recentMoods.length;
                
                if (avgMood < 3) {
                    messages.morning.push('üíô Bonjour ! Vous avez travers√© des moments difficiles r√©cemment. Comment allez-vous aujourd\'hui ?');
                    messages.afternoon.push('ü§ó Comment se passe cette journ√©e ? Je suis l√† si vous avez besoin.');
                    messages.evening.push('üíù Bonsoir ! J\'esp√®re que cette journ√©e vous a apport√© quelques moments positifs.');
                } else if (avgMood > 4) {
                    messages.morning.push('üéâ Bonjour ! Vous rayonnez ces derniers temps ! Comment √ßa va aujourd\'hui ?');
                    messages.afternoon.push('‚≠ê Votre √©nergie positive est inspirante ! Un petit point humeur ?');
                    messages.evening.push('‚ú® Bonsoir ! J\'esp√®re que cette belle dynamique continue !');
                }
            }
            
            // S√©lectionner le message appropri√©
            let messageGroup;
            if (hour < 12) messageGroup = messages.morning;
            else if (hour < 18) messageGroup = messages.afternoon;
            else messageGroup = messages.evening;
            
            return messageGroup[Math.floor(Math.random() * messageGroup.length)];
        }
        
        // Fonction pour initialiser les rappels
        function initializeMoodReminders() {
            // Demander permission pour les notifications si n√©cessaire
            if ('Notification' in window && Notification.permission === 'default') {
                Notification.requestPermission().then(permission => {
                    console.log('Permission de notification:', permission);
                });
            }
            
            // Programmer le prochain rappel
            scheduleNextMoodReminder();
        }
        
        // Mise √† jour de la fonction de rappel existante
        function showMoodReminder() {
            const settings = JSON.parse(localStorage.getItem('moodReminderSettings') || '{"enabled": true}');
            
            if (!settings.enabled) return;
            
            // V√©rifier si l'utilisateur a d√©j√† enregistr√© son humeur r√©cemment
            const moodHistory = JSON.parse(localStorage.getItem('moodHistory') || '[]');
            const now = new Date();
            const fourHoursAgo = new Date(now.getTime() - 4 * 60 * 60 * 1000);
            
            const recentEntry = moodHistory.find(entry => new Date(entry.timestamp) > fourHoursAgo);
            
            if (recentEntry && settings.personalizations) {
                // Ne pas d√©ranger si l'humeur a √©t√© enregistr√©e r√©cemment ET que les rappels intelligents sont activ√©s
                scheduleNextMoodReminder();
                return;
            }
            
            // Obtenir le message contextuel
            const message = settings.contextual ? getContextualReminderMessage() : 'Comment vous sentez-vous maintenant ?';
            
            // Afficher le rappel
            if (Notification.permission === 'granted') {
                const notification = new Notification('MINDLY - Rappel bien-√™tre', {
                    body: message,
                    icon: '/favicon.ico',
                    badge: '/favicon.ico'
                });
                
                notification.onclick = function() {
                    window.focus();
                    showScreen('mood-screen');
                    notification.close();
                };
            } else {
                // Fallback: modal dans l'app si elle est ouverte
                if (document.visibilityState === 'visible') {
                    const reminderModal = document.createElement('div');
                    reminderModal.className = 'reminder-popup';
                    reminderModal.innerHTML = `
                        <div class="popup-content">
                            <h4>üå∏ Rappel MINDLY</h4>
                            <p>${message}</p>
                            <div class="popup-actions">
                                <button onclick="showScreen('mood-screen'); document.body.removeChild(this.closest('.reminder-popup'))">üìù Enregistrer mon humeur</button>
                                <button onclick="scheduleNextMoodReminder(); document.body.removeChild(this.closest('.reminder-popup'))">‚è∞ Plus tard (5 min)</button>
                                <button onclick="document.body.removeChild(this.closest('.reminder-popup'))">‚úï Fermer</button>
                            </div>
                        </div>
                    `;
                    
                    document.body.appendChild(reminderModal);
                    
                    // Auto-fermeture apr√®s 15 secondes
                    setTimeout(() => {
                        if (document.body.contains(reminderModal)) {
                            document.body.removeChild(reminderModal);
                        }
                    }, 15000);
                }
            }
            
            // Programmer le prochain rappel
            scheduleNextMoodReminder();
        }
        
        // Fonction am√©lior√©e pour programmer le prochain rappel
        function scheduleNextMoodReminder() {
            const settings = JSON.parse(localStorage.getItem('moodReminderSettings') || '{"enabled": true, "frequency": "daily", "times": ["09:00", "18:00"]}');
            
            if (!settings.enabled) return;
            
            // Effacer les rappels existants
            const existingTimers = JSON.parse(localStorage.getItem('moodReminderTimers') || '[]');
            existingTimers.forEach(timerId => clearTimeout(timerId));
            
            const now = new Date();
            const nextReminders = [];
            
            // Calculer les prochains rappels selon la fr√©quence
            for (let i = 0; i < 7; i++) { // Programmer pour les 7 prochains jours
                const targetDate = new Date(now);
                
                if (settings.frequency === 'daily') {
                    targetDate.setDate(now.getDate() + i);
                } else if (settings.frequency === 'bidaily') {
                    targetDate.setDate(now.getDate() + (i * 2));
                } else if (settings.frequency === 'weekly') {
                    targetDate.setDate(now.getDate() + (i * 7));
                }
                
                // Ajouter chaque heure configur√©e
                settings.times.forEach(timeStr => {
                    const [hours, minutes] = timeStr.split(':').map(Number);
                    const reminderTime = new Date(targetDate);
                    reminderTime.setHours(hours, minutes, 0, 0);
                    
                    // Ne programmer que les rappels futurs
                    if (reminderTime > now) {
                        const delay = reminderTime.getTime() - now.getTime();
                        
                        // Programmer ce rappel
                        const timerId = setTimeout(() => {
                            showMoodReminder();
                        }, delay);
                        
                        nextReminders.push(timerId);
                    }
                });
                
                // Pour les fr√©quences > daily, pas besoin de programmer tous les jours
                if (settings.frequency !== 'daily' && i > 2) break;
            }
            
            // Sauvegarder les IDs des timers pour pouvoir les annuler plus tard
            localStorage.setItem('moodReminderTimers', JSON.stringify(nextReminders));
            
            console.log(`Programm√© ${nextReminders.length} rappels selon la configuration utilisateur`);
        }

        // === SYST√àME DE STATISTIQUES VISUELLES (F05.2) ===
        
        function showStatisticsView() {
            const statisticsHTML = `
                <div class="statistics-modal">
                    <div class="stats-content">
                        <div class="stats-header">
                            <h3>${icons.heart} Vos statistiques de bien-√™tre</h3>
                            <button class="close-btn" onclick="closeStatisticsView()">${icons.close}</button>
                        </div>
                        
                        <div class="stats-body">
                            <div class="stats-loading" id="statsLoading">
                                <div class="loading-spinner"></div>
                                <p>Analyse de vos donn√©es en cours...</p>
                            </div>
                            
                            <div class="stats-content-main" id="statsContentMain" style="display: none;">
                                <!-- M√©triques principales -->
                                <div class="stats-overview">
                                    <div class="stat-card">
                                        <div class="stat-icon">${icons.mood}</div>
                                        <div class="stat-value" id="avgMoodValue">-</div>
                                        <div class="stat-label">Humeur moyenne</div>
                                        <div class="stat-trend" id="moodTrend"></div>
                                    </div>
                                    
                                    <div class="stat-card">
                                        <div class="stat-icon">${icons.calendar}</div>
                                        <div class="stat-value" id="streakValue">-</div>
                                        <div class="stat-label">Jours cons√©cutifs</div>
                                        <div class="stat-trend" id="streakTrend"></div>
                                    </div>
                                    
                                    <div class="stat-card">
                                        <div class="stat-icon">${icons.star}</div>
                                        <div class="stat-value" id="consistencyValue">-</div>
                                        <div class="stat-label">R√©gularit√© (%)</div>
                                        <div class="stat-trend" id="consistencyTrend"></div>
                                    </div>
                                    
                                    <div class="stat-card">
                                        <div class="stat-icon">${icons.chat}</div>
                                        <div class="stat-value" id="engagementValue">-</div>
                                        <div class="stat-label">Engagement</div>
                                        <div class="stat-trend" id="engagementTrend"></div>
                                    </div>
                                </div>
                                
                                <!-- Graphiques -->
                                <div class="charts-section">
                                    <div class="chart-container">
                                        <h4>√âvolution de l'humeur (30 derniers jours)</h4>
                                        <div class="chart-loading" id="moodChartLoading">
                                            <div class="loading-spinner"></div>
                                        </div>
                                        <canvas id="moodChart" style="display: none;"></canvas>
                                        <div class="chart-error" id="moodChartError" style="display: none;">
                                            <p>${icons.warning} Impossible de charger le graphique</p>
                                            <button onclick="loadMoodChart()">R√©essayer</button>
                                        </div>
                                    </div>
                                    
                                    <div class="chart-container">
                                        <h4>Distribution des √©motions</h4>
                                        <div class="chart-loading" id="emotionChartLoading">
                                            <div class="loading-spinner"></div>
                                        </div>
                                        <canvas id="emotionChart" style="display: none;"></canvas>
                                        <div class="chart-error" id="emotionChartError" style="display: none;">
                                            <p>${icons.warning} Impossible de charger le graphique</p>
                                            <button onclick="loadEmotionChart()">R√©essayer</button>
                                        </div>
                                    </div>
                                    
                                    <div class="chart-container">
                                        <h4>Patterns d'activit√© hebdomadaire</h4>
                                        <div class="chart-loading" id="weeklyChartLoading">
                                            <div class="loading-spinner"></div>
                                        </div>
                                        <canvas id="weeklyChart" style="display: none;"></canvas>
                                        <div class="chart-error" id="weeklyChartError" style="display: none;">
                                            <p>${icons.warning} Impossible de charger le graphique</p>
                                            <button onclick="loadWeeklyChart()">R√©essayer</button>
                                        </div>
                                    </div>
                                </div>
                                
                                <!-- Insights personnalis√©s -->
                                <div class="insights-section">
                                    <h4>Insights personnalis√©s</h4>
                                    <div id="personalInsights">
                                        <!-- Contenu g√©n√©r√© dynamiquement -->
                                    </div>
                                </div>
                            </div>
                            
                            <div class="stats-error" id="statsError" style="display: none;">
                                <div class="error-icon">${icons.warning}</div>
                                <h4>Impossible de charger les statistiques</h4>
                                <p>V√©rifiez votre connexion et r√©essayez.</p>
                                <button onclick="loadStatistics()">R√©essayer</button>
                            </div>
                        </div>
                        
                        <div class="stats-actions">
                            <button class="btn-secondary" onclick="exportStatistics()">${icons.download} Exporter</button>
                            <button class="btn-secondary" onclick="shareStatistics()">${icons.link} Partager</button>
                            <button class="btn-primary" onclick="closeStatisticsView()">Fermer</button>
                        </div>
                    </div>
                </div>
            `;
            
            document.body.insertAdjacentHTML('beforeend', statisticsHTML);
            
            // Charger les statistiques avec un d√©lai pour montrer le loading
            setTimeout(() => {
                loadStatistics();
            }, 500);
        }
        
        function closeStatisticsView() {
            const modal = document.querySelector('.statistics-modal');
            if (modal) {
                document.body.removeChild(modal);
            }
        }
        
        function loadStatistics() {
            try {
                // Masquer les erreurs et afficher le loading
                document.getElementById('statsError').style.display = 'none';
                document.getElementById('statsLoading').style.display = 'flex';
                document.getElementById('statsContentMain').style.display = 'none';
                
                // Simuler un chargement
                setTimeout(() => {
                    calculateAndDisplayStats();
                    loadAllCharts();
                    generatePersonalInsights();
                    
                    // Afficher le contenu
                    document.getElementById('statsLoading').style.display = 'none';
                    document.getElementById('statsContentMain').style.display = 'block';
                }, 1500);
                
            } catch (error) {
                console.error('Erreur lors du chargement des statistiques:', error);
                showStatsError();
            }
        }
        
        function calculateAndDisplayStats() {
            const moodHistory = JSON.parse(localStorage.getItem('moodHistory') || '[]');
            const chatHistory = JSON.parse(localStorage.getItem('chatHistory') || '[]');
            
            if (moodHistory.length === 0) {
                // Afficher un message pour les nouveaux utilisateurs
                document.getElementById('avgMoodValue').textContent = 'N/A';
                document.getElementById('streakValue').textContent = '0';
                document.getElementById('consistencyValue').textContent = '0';
                document.getElementById('engagementValue').textContent = 'Faible';
                return;
            }
            
            // Calcul humeur moyenne
            const avgMood = moodHistory.reduce((sum, entry) => sum + entry.level, 0) / moodHistory.length;
            document.getElementById('avgMoodValue').textContent = avgMood.toFixed(1);
            
            // Calcul s√©rie cons√©cutive
            const streak = calculateCurrentStreak(moodHistory);
            document.getElementById('streakValue').textContent = streak;
            
            // Calcul r√©gularit√© (entr√©es par rapport aux jours √©coul√©s)
            const daysSinceFirstEntry = Math.ceil((new Date() - new Date(moodHistory[moodHistory.length - 1].timestamp)) / (1000 * 60 * 60 * 24));
            const consistency = Math.min(100, Math.round((moodHistory.length / Math.max(daysSinceFirstEntry, 1)) * 100));
            document.getElementById('consistencyValue').textContent = consistency;
            
            // Calcul engagement (interactions avec le chat + entr√©es d'humeur)
            const totalInteractions = moodHistory.length + chatHistory.length;
            let engagementLevel = 'Faible';
            if (totalInteractions > 50) engagementLevel = '√âlev√©';
            else if (totalInteractions > 20) engagementLevel = 'Moyen';
            document.getElementById('engagementValue').textContent = engagementLevel;
            
            // Calcul des tendances
            calculateTrends(moodHistory);
        }
        
        function calculateCurrentStreak(moodHistory) {
            if (moodHistory.length === 0) return 0;
            
            const sortedHistory = moodHistory.sort((a, b) => new Date(b.timestamp) - new Date(a.timestamp));
            let streak = 0;
            let currentDate = new Date();
            currentDate.setHours(0, 0, 0, 0);
            
            for (let i = 0; i < sortedHistory.length; i++) {
                const entryDate = new Date(sortedHistory[i].timestamp);
                entryDate.setHours(0, 0, 0, 0);
                
                const daysDiff = Math.floor((currentDate - entryDate) / (1000 * 60 * 60 * 24));
                
                if (daysDiff === streak) {
                    streak++;
                } else if (daysDiff > streak) {
                    break;
                }
            }
            
            return streak;
        }
        
        function calculateTrends(moodHistory) {
            if (moodHistory.length < 2) return;
            
            const recent = moodHistory.slice(0, 7); // 7 derniers jours
            const previous = moodHistory.slice(7, 14); // 7 jours pr√©c√©dents
            
            if (previous.length === 0) return;
            
            const recentAvg = recent.reduce((sum, entry) => sum + entry.level, 0) / recent.length;
            const previousAvg = previous.reduce((sum, entry) => sum + entry.level, 0) / previous.length;
            
            const moodTrend = recentAvg > previousAvg ? '‚Üó +' + (recentAvg - previousAvg).toFixed(1) : 
                             recentAvg < previousAvg ? '‚Üò ' + (recentAvg - previousAvg).toFixed(1) : '‚Üí Stable';
            
            document.getElementById('moodTrend').textContent = moodTrend;
            document.getElementById('moodTrend').className = 'stat-trend ' + (recentAvg > previousAvg ? 'positive' : recentAvg < previousAvg ? 'negative' : 'neutral');
        }
        
        function loadAllCharts() {
            loadMoodChart();
            loadEmotionChart();
            loadWeeklyChart();
        }
        
        function loadMoodChart() {
            try {
                document.getElementById('moodChartLoading').style.display = 'flex';
                document.getElementById('moodChart').style.display = 'none';
                document.getElementById('moodChartError').style.display = 'none';
                
                setTimeout(() => {
                    const canvas = document.getElementById('moodChart');
                    if (!canvas) return;
                    
                    const ctx = canvas.getContext('2d');
                    const moodHistory = JSON.parse(localStorage.getItem('moodHistory') || '[]');
                    
                    // Pr√©parer les donn√©es des 30 derniers jours
                    const last30Days = getLast30DaysData(moodHistory);
                    
                    drawMoodChart(ctx, last30Days);
                    
                    document.getElementById('moodChartLoading').style.display = 'none';
                    document.getElementById('moodChart').style.display = 'block';
                }, 800);
                
            } catch (error) {
                document.getElementById('moodChartLoading').style.display = 'none';
                document.getElementById('moodChartError').style.display = 'block';
            }
        }
        
        function getLast30DaysData(moodHistory) {
            const data = [];
            const today = new Date();
            
            for (let i = 29; i >= 0; i--) {
                const date = new Date(today);
                date.setDate(today.getDate() - i);
                const dateStr = date.toISOString().split('T')[0];
                
                const dayEntries = moodHistory.filter(entry => 
                    entry.timestamp.startsWith(dateStr)
                );
                
                const avgMood = dayEntries.length > 0 
                    ? dayEntries.reduce((sum, entry) => sum + entry.level, 0) / dayEntries.length 
                    : null;
                
                data.push({
                    date: dateStr,
                    mood: avgMood,
                    entries: dayEntries.length
                });
            }
            
            return data;
        }
        
        function drawMoodChart(ctx, data) {
            const canvas = ctx.canvas;
            canvas.width = canvas.offsetWidth;
            canvas.height = 300;
            
            const width = canvas.width;
            const height = canvas.height;
            const padding = 40;
            const chartWidth = width - 2 * padding;
            const chartHeight = height - 2 * padding;
            
            // Nettoyer le canvas
            ctx.clearRect(0, 0, width, height);
            
            // Style du graphique
            ctx.strokeStyle = '#e0e0e0';
            ctx.lineWidth = 1;
            
            // Grille horizontale
            for (let i = 0; i <= 5; i++) {
                const y = padding + (chartHeight / 5) * i;
                ctx.beginPath();
                ctx.moveTo(padding, y);
                ctx.lineTo(width - padding, y);
                ctx.stroke();
                
                // Labels Y
                ctx.fillStyle = '#666';
                ctx.font = '12px sans-serif';
                ctx.textAlign = 'right';
                ctx.fillText((5 - i).toString(), padding - 10, y + 4);
            }
            
            // Tracer la courbe d'humeur
            ctx.strokeStyle = '#667eea';
            ctx.lineWidth = 3;
            ctx.beginPath();
            
            let firstPoint = true;
            data.forEach((point, index) => {
                if (point.mood !== null) {
                    const x = padding + (chartWidth / (data.length - 1)) * index;
                    const y = padding + chartHeight - (point.mood / 5) * chartHeight;
                    
                    if (firstPoint) {
                        ctx.moveTo(x, y);
                        firstPoint = false;
                    } else {
                        ctx.lineTo(x, y);
                    }
                }
            });
            
            ctx.stroke();
            
            // Points de donn√©es
            ctx.fillStyle = '#667eea';
            data.forEach((point, index) => {
                if (point.mood !== null) {
                    const x = padding + (chartWidth / (data.length - 1)) * index;
                    const y = padding + chartHeight - (point.mood / 5) * chartHeight;
                    
                    ctx.beginPath();
                    ctx.arc(x, y, 4, 0, 2 * Math.PI);
                    ctx.fill();
                }
            });
            
            // Labels des dates (tous les 5 jours)
            ctx.fillStyle = '#666';
            ctx.font = '10px sans-serif';
            ctx.textAlign = 'center';
            for (let i = 0; i < data.length; i += 5) {
                const x = padding + (chartWidth / (data.length - 1)) * i;
                const date = new Date(data[i].date);
                const label = (date.getDate()).toString();
                ctx.fillText(label, x, height - 10);
            }
        }
        
        function loadEmotionChart() {
            try {
                document.getElementById('emotionChartLoading').style.display = 'flex';
                document.getElementById('emotionChart').style.display = 'none';
                document.getElementById('emotionChartError').style.display = 'none';
                
                setTimeout(() => {
                    const canvas = document.getElementById('emotionChart');
                    if (!canvas) return;
                    
                    const ctx = canvas.getContext('2d');
                    const moodHistory = JSON.parse(localStorage.getItem('moodHistory') || '[]');
                    
                    // Analyser la distribution des √©motions
                    const emotionDistribution = analyzeEmotionDistribution(moodHistory);
                    
                    drawEmotionChart(ctx, emotionDistribution);
                    
                    document.getElementById('emotionChartLoading').style.display = 'none';
                    document.getElementById('emotionChart').style.display = 'block';
                }, 1000);
                
            } catch (error) {
                document.getElementById('emotionChartLoading').style.display = 'none';
                document.getElementById('emotionChartError').style.display = 'block';
            }
        }
        
        function analyzeEmotionDistribution(moodHistory) {
            const distribution = {
                'Tr√®s bien': 0,
                'Bien': 0,
                'Neutre': 0,
                'Difficile': 0,
                'Tr√®s difficile': 0
            };
            
            moodHistory.forEach(entry => {
                if (entry.level >= 4.5) distribution['Tr√®s bien']++;
                else if (entry.level >= 3.5) distribution['Bien']++;
                else if (entry.level >= 2.5) distribution['Neutre']++;
                else if (entry.level >= 1.5) distribution['Difficile']++;
                else distribution['Tr√®s difficile']++;
            });
            
            return distribution;
        }
        
        function drawEmotionChart(ctx, distribution) {
            const canvas = ctx.canvas;
            canvas.width = canvas.offsetWidth;
            canvas.height = 300;
            
            const width = canvas.width;
            const height = canvas.height;
            const centerX = width / 2;
            const centerY = height / 2;
            const radius = Math.min(width, height) / 2 - 40;
            
            // Nettoyer le canvas
            ctx.clearRect(0, 0, width, height);
            
            const colors = ['#4CAF50', '#8BC34A', '#FFC107', '#FF9800', '#F44336'];
            const labels = Object.keys(distribution);
            const values = Object.values(distribution);
            const total = values.reduce((sum, val) => sum + val, 0);
            
            if (total === 0) {
                ctx.fillStyle = '#999';
                ctx.font = '16px sans-serif';
                ctx.textAlign = 'center';
                ctx.fillText('Aucune donn√©e disponible', centerX, centerY);
                return;
            }
            
            let currentAngle = -Math.PI / 2;
            
            values.forEach((value, index) => {
                const sliceAngle = (value / total) * 2 * Math.PI;
                
                // Dessiner la section
                ctx.beginPath();
                ctx.moveTo(centerX, centerY);
                ctx.arc(centerX, centerY, radius, currentAngle, currentAngle + sliceAngle);
                ctx.closePath();
                ctx.fillStyle = colors[index];
                ctx.fill();
                
                // Bordure
                ctx.strokeStyle = '#fff';
                ctx.lineWidth = 2;
                ctx.stroke();
                
                currentAngle += sliceAngle;
            });
            
            // L√©gende
            let legendY = 20;
            labels.forEach((label, index) => {
                const percentage = total > 0 ? Math.round((values[index] / total) * 100) : 0;
                
                ctx.fillStyle = colors[index];
                ctx.fillRect(width - 150, legendY, 15, 15);
                
                ctx.fillStyle = '#333';
                ctx.font = '12px sans-serif';
                ctx.textAlign = 'left';
                ctx.fillText(`${label} (${percentage}%)`, width - 130, legendY + 12);
                
                legendY += 25;
            });
        }
        
        function loadWeeklyChart() {
            try {
                document.getElementById('weeklyChartLoading').style.display = 'flex';
                document.getElementById('weeklyChart').style.display = 'none';
                document.getElementById('weeklyChartError').style.display = 'none';
                
                setTimeout(() => {
                    const canvas = document.getElementById('weeklyChart');
                    if (!canvas) return;
                    
                    const ctx = canvas.getContext('2d');
                    const moodHistory = JSON.parse(localStorage.getItem('moodHistory') || '[]');
                    
                    const weeklyData = analyzeWeeklyPatterns(moodHistory);
                    
                    drawWeeklyChart(ctx, weeklyData);
                    
                    document.getElementById('weeklyChartLoading').style.display = 'none';
                    document.getElementById('weeklyChart').style.display = 'block';
                }, 1200);
                
            } catch (error) {
                document.getElementById('weeklyChartLoading').style.display = 'none';
                document.getElementById('weeklyChartError').style.display = 'block';
            }
        }
        
        function analyzeWeeklyPatterns(moodHistory) {
            const days = ['Lun', 'Mar', 'Mer', 'Jeu', 'Ven', 'Sam', 'Dim'];
            const weeklyData = days.map(() => ({ total: 0, count: 0, average: 0 }));
            
            moodHistory.forEach(entry => {
                const date = new Date(entry.timestamp);
                const dayOfWeek = (date.getDay() + 6) % 7; // Lundi = 0
                
                weeklyData[dayOfWeek].total += entry.level;
                weeklyData[dayOfWeek].count++;
            });
            
            weeklyData.forEach((day, index) => {
                day.average = day.count > 0 ? day.total / day.count : 0;
                day.label = days[index];
            });
            
            return weeklyData;
        }
        
        function drawWeeklyChart(ctx, weeklyData) {
            const canvas = ctx.canvas;
            canvas.width = canvas.offsetWidth;
            canvas.height = 300;
            
            const width = canvas.width;
            const height = canvas.height;
            const padding = 40;
            const chartWidth = width - 2 * padding;
            const chartHeight = height - 2 * padding;
            
            // Nettoyer le canvas
            ctx.clearRect(0, 0, width, height);
            
            const barWidth = chartWidth / weeklyData.length;
            const maxValue = Math.max(...weeklyData.map(d => d.average), 5);
            
            // Grille horizontale
            ctx.strokeStyle = '#e0e0e0';
            ctx.lineWidth = 1;
            for (let i = 0; i <= 5; i++) {
                const y = padding + (chartHeight / 5) * i;
                ctx.beginPath();
                ctx.moveTo(padding, y);
                ctx.lineTo(width - padding, y);
                ctx.stroke();
                
                // Labels Y
                ctx.fillStyle = '#666';
                ctx.font = '12px sans-serif';
                ctx.textAlign = 'right';
                ctx.fillText((5 - i).toString(), padding - 10, y + 4);
            }
            
            // Barres
            weeklyData.forEach((day, index) => {
                const x = padding + index * barWidth + barWidth * 0.1;
                const barHeight = (day.average / maxValue) * chartHeight;
                const y = padding + chartHeight - barHeight;
                
                // Couleur selon la valeur
                let color = '#F44336'; // Rouge pour faible
                if (day.average >= 4) color = '#4CAF50'; // Vert pour √©lev√©
                else if (day.average >= 3) color = '#FF9800'; // Orange pour moyen
                
                ctx.fillStyle = color;
                ctx.fillRect(x, y, barWidth * 0.8, barHeight);
                
                // Bordure
                ctx.strokeStyle = '#fff';
                ctx.lineWidth = 2;
                ctx.strokeRect(x, y, barWidth * 0.8, barHeight);
                
                // Label du jour
                ctx.fillStyle = '#333';
                ctx.font = '12px sans-serif';
                ctx.textAlign = 'center';
                ctx.fillText(day.label, x + barWidth * 0.4, height - 10);
                
                // Valeur sur la barre
                if (day.average > 0) {
                    ctx.fillStyle = '#fff';
                    ctx.font = 'bold 11px sans-serif';
                    ctx.fillText(day.average.toFixed(1), x + barWidth * 0.4, y + 15);
                }
            });
        }
        
        function generatePersonalInsights() {
            const moodHistory = JSON.parse(localStorage.getItem('moodHistory') || '[]');
            const insightsContainer = document.getElementById('personalInsights');
            
            if (moodHistory.length < 3) {
                insightsContainer.innerHTML = `
                    <div class="insight-card">
                        <div class="insight-icon">${icons.info}</div>
                        <div class="insight-content">
                            <h5>Commencez votre suivi</h5>
                            <p>Enregistrez votre humeur r√©guli√®rement pour obtenir des insights personnalis√©s sur votre bien-√™tre.</p>
                        </div>
                    </div>
                `;
                return;
            }
            
            const insights = [];
            
            // Analyse des tendances
            const recentMoods = moodHistory.slice(0, 7);
            const avgRecent = recentMoods.reduce((sum, entry) => sum + entry.level, 0) / recentMoods.length;
            
            if (avgRecent >= 4) {
                insights.push({
                    type: 'positive',
                    icon: icons.star,
                    title: 'Excellente p√©riode',
                    content: 'Votre humeur est particuli√®rement positive ces derniers jours. Continuez sur cette lanc√©e !'
                });
            } else if (avgRecent <= 2.5) {
                insights.push({
                    type: 'support',
                    icon: icons.heart,
                    title: 'P√©riode difficile',
                    content: 'Vous traversez une p√©riode difficile. N\'h√©sitez pas √† utiliser les ressources de bien-√™tre ou √† parler √† quelqu\'un.'
                });
            }
            
            // Analyse de r√©gularit√©
            const streak = calculateCurrentStreak(moodHistory);
            if (streak >= 7) {
                insights.push({
                    type: 'achievement',
                    icon: icons.star,
                    title: 'R√©gularit√© exemplaire',
                    content: `Bravo ! Vous suivez votre humeur depuis ${streak} jours cons√©cutifs. Cette r√©gularit√© vous aidera √† mieux comprendre vos patterns.`
                });
            }
            
            // Meilleur jour de la semaine
            const weeklyData = analyzeWeeklyPatterns(moodHistory);
            const bestDay = weeklyData.reduce((best, day) => 
                day.average > best.average ? day : best
            );
            
            if (bestDay.average > 0) {
                insights.push({
                    type: 'pattern',
                    icon: icons.calendar,
                    title: 'Votre meilleur jour',
                    content: `Le ${bestDay.label.toLowerCase()} semble √™tre votre jour le plus positif (moyenne: ${bestDay.average.toFixed(1)}). Que faites-vous de sp√©cial ce jour-l√† ?`
                });
            }
            
            // Rendu des insights
            insightsContainer.innerHTML = insights.map(insight => `
                <div class="insight-card ${insight.type}">
                    <div class="insight-icon">${insight.icon}</div>
                    <div class="insight-content">
                        <h5>${insight.title}</h5>
                        <p>${insight.content}</p>
                    </div>
                </div>
            `).join('');
        }
        
        function showStatsError() {
            document.getElementById('statsLoading').style.display = 'none';
            document.getElementById('statsContentMain').style.display = 'none';
            document.getElementById('statsError').style.display = 'flex';
        }
        
        function exportStatistics() {
            try {
                const moodHistory = JSON.parse(localStorage.getItem('moodHistory') || '[]');
                const statsData = {
                    exportDate: new Date().toISOString(),
                    moodHistory: moodHistory,
                    summary: {
                        totalEntries: moodHistory.length,
                        averageMood: moodHistory.length > 0 ? 
                            (moodHistory.reduce((sum, entry) => sum + entry.level, 0) / moodHistory.length).toFixed(2) : 0,
                        dateRange: moodHistory.length > 0 ? {
                            from: moodHistory[moodHistory.length - 1].timestamp,
                            to: moodHistory[0].timestamp
                        } : null
                    }
                };
                
                const dataStr = JSON.stringify(statsData, null, 2);
                const dataBlob = new Blob([dataStr], { type: 'application/json' });
                
                const link = document.createElement('a');
                link.href = URL.createObjectURL(dataBlob);
                link.download = `mindly-stats-${new Date().toISOString().split('T')[0]}.json`;
                link.click();
                
                alert(`${icons.success} Statistiques export√©es avec succ√®s !`);
            } catch (error) {
                alert(`${icons.error} Erreur lors de l'export des statistiques.`);
            }
        }
        
        function shareStatistics() {
            // Fonctionnalit√© de partage (√† impl√©menter selon les besoins)
            alert(`${icons.info} Fonctionnalit√© de partage en d√©veloppement.`);
        }

        // Initialize
        checkSubscriptionStatus();
        updateOnboarding();
    </script>

    <!-- Navigation principale en bas -->
    <div class="bottom-navigation" id="bottomNav">
        <button class="nav-item active" onclick="showMainScreen('dashboard-screen')" data-screen="dashboard">
            <span class="nav-icon">‚óã</span>
            <span class="nav-label" data-translate="nav.home">Accueil</span>
        </button>
        <button class="nav-item" onclick="showMainScreen('mood-screen')" data-screen="mood">
            <span class="nav-icon">${icons.mood}</span>
            <span class="nav-label" data-translate="nav.mood">Humeur</span>
        </button>
        <button class="nav-item" onclick="showMainScreen('chat-screen')" data-screen="chat">
            <span class="nav-icon">${icons.chat}</span>
            <span class="nav-label" data-translate="nav.chat">Chat</span>
        </button>
        <button class="nav-item" onclick="showMainScreen('community-screen')" data-screen="community">
            <span class="nav-icon">${icons.community}</span>
            <span class="nav-label" data-translate="nav.community">Communaut√©</span>
        </button>
        <button class="nav-item" onclick="showMainScreen('explore-screen')" data-screen="explore">
            <span class="nav-icon">${icons.explore}</span>
            <span class="nav-label" data-translate="nav.explore">Explorer</span>
        </button>
        <button class="nav-item" onclick="showMainScreen('research-center-screen')" data-screen="research">
            <span class="nav-icon">${icons.search}</span>
            <span class="nav-label" data-translate="nav.explore">Recherche</span>
        </button>
    </div>

    <!-- √âcrans d'onboarding et abonnement -->
    
    <!-- √âcran RGPD et Conditions -->
    <div class="screen-content onboarding-screen" id="terms-screen" style="display: none;">
        <div class="onboarding-container">
            <div class="onboarding-header">
                <h1>üìã Conditions d'utilisation</h1>
                <p>Veuillez accepter nos conditions pour continuer</p>
            </div>
            
            <div class="terms-content">
                <div class="terms-section">
                    <h3>üîí R√®glement G√©n√©ral sur la Protection des Donn√©es (RGPD)</h3>
                    <div class="terms-text">
                        <p><strong>Vos donn√©es personnelles sont prot√©g√©es :</strong></p>
                        <ul>
                            <li>‚úÖ Nous collectons uniquement les donn√©es n√©cessaires au fonctionnement de l'application</li>
                            <li>‚úÖ Vos donn√©es d'humeur restent priv√©es et s√©curis√©es</li>
                            <li>‚úÖ Vous pouvez demander l'effacement de vos donn√©es √† tout moment</li>
                            <li>‚úÖ Aucune vente de donn√©es √† des tiers</li>
                            <li>‚úÖ Chiffrement de bout en bout pour vos informations sensibles</li>
                        </ul>
                    </div>
                </div>
                
                <div class="terms-section">
                    <h3>üìú Conditions d'utilisation</h3>
                    <div class="terms-text">
                        <p><strong>En utilisant MINDLY, vous acceptez :</strong></p>
                        <ul>
                            <li>üì± Utiliser l'application √† des fins de bien-√™tre personnel</li>
                            <li>ü§ù Respecter les autres utilisateurs dans la communaut√©</li>
                            <li>‚öïÔ∏è Consulter un professionnel pour tout probl√®me de sant√© mentale grave</li>
                            <li>üí≥ Respecter les conditions d'abonnement choisies</li>
                            <li>üö´ Ne pas utiliser l'application √† des fins commerciales non autoris√©es</li>
                        </ul>
                    </div>
                </div>
                
                <div class="terms-section">
                    <h3>üÜò Avertissement m√©dical</h3>
                    <div class="terms-text">
                        <p><strong>Important :</strong> MINDLY est un outil de bien-√™tre et ne remplace pas un suivi m√©dical professionnel. En cas de crise ou de pens√©es suicidaires, contactez imm√©diatement les services d'urgence.</p>
                    </div>
                </div>
            </div>
            
            <div class="terms-acceptance">
                <label class="checkbox-container">
                    <input type="checkbox" id="acceptRGPD">
                    <span class="checkmark"></span>
                    J'accepte le traitement de mes donn√©es selon le RGPD
                </label>
                
                <label class="checkbox-container">
                    <input type="checkbox" id="acceptTerms">
                    <span class="checkmark"></span>
                    J'accepte les conditions d'utilisation de MINDLY
                </label>
            </div>
            
            <div class="onboarding-actions">
                <button class="continue-btn" onclick="validateTermsAndContinue()" id="termsBtn" disabled>
                    Continuer vers l'abonnement
                </button>
            </div>
        </div>
    </div>

    <!-- √âcran de s√©lection d'abonnement -->
    <div class="screen-content onboarding-screen" id="subscription-screen" style="display: none;">
        <div class="onboarding-container">
            <div class="onboarding-header">
                <h1>‚ú® Choisissez votre abonnement</h1>
                <p>Commencez par 7 jours gratuits</p>
            </div>
            
            <div class="subscription-plans">
                <div class="plan-card recommended">
                    <div class="plan-badge">‚≠ê Recommand√©</div>
                    <div class="plan-header">
                        <h3>Premium Annuel</h3>
                        <div class="plan-price">
                            <span class="price">59,99‚Ç¨</span>
                            <span class="period">/an</span>
                        </div>
                        <div class="plan-savings">√âconomisez 50%</div>
                    </div>
                    <div class="plan-features">
                        <ul>
                            <li>‚úÖ 7 jours d'essai gratuit</li>
                            <li>‚úÖ Diagnostic IA illimit√©</li>
                            <li>‚úÖ Exercices personnalis√©s</li>
                            <li>‚úÖ Communaut√© premium</li>
                            <li>‚úÖ Suivi avanc√© & rapports</li>
                            <li>‚úÖ Support prioritaire</li>
                        </ul>
                    </div>
                    <button class="select-plan-btn" onclick="selectPlan('annual', 59.99)">
                        Commencer l'essai gratuit
                    </button>
                </div>
                
                <div class="plan-card">
                    <div class="plan-header">
                        <h3>Premium Mensuel</h3>
                        <div class="plan-price">
                            <span class="price">9,99‚Ç¨</span>
                            <span class="period">/mois</span>
                        </div>
                    </div>
                    <div class="plan-features">
                        <ul>
                            <li>‚úÖ 7 jours d'essai gratuit</li>
                            <li>‚úÖ Diagnostic IA illimit√©</li>
                            <li>‚úÖ Exercices personnalis√©s</li>
                            <li>‚úÖ Communaut√© premium</li>
                            <li>‚úÖ Suivi avanc√© & rapports</li>
                        </ul>
                    </div>
                    <button class="select-plan-btn secondary" onclick="selectPlan('monthly', 9.99)">
                        Commencer l'essai gratuit
                    </button>
                </div>
                
                <div class="plan-card basic">
                    <div class="plan-header">
                        <h3>Gratuit</h3>
                        <div class="plan-price">
                            <span class="price">0‚Ç¨</span>
                            <span class="period">pour toujours</span>
                        </div>
                    </div>
                    <div class="plan-features">
                        <ul>
                            <li>‚úÖ 3 √©valuations d'humeur/mois</li>
                            <li>‚úÖ Exercices de base</li>
                            <li>‚ùå Diagnostic IA limit√©</li>
                            <li>‚ùå Communaut√© restreinte</li>
                            <li>‚ùå Suivi basique uniquement</li>
                        </ul>
                    </div>
                    <button class="select-plan-btn basic-btn" onclick="selectPlan('free', 0)">
                        Utiliser gratuitement
                    </button>
                </div>
            </div>
            
            <div class="subscription-info">
                <p><small>üí≥ Aucune facturation pendant l'essai gratuit. Annulable √† tout moment.</small></p>
            </div>
        </div>
    </div>

    <!-- √âcran de paiement -->
    <div class="screen-content onboarding-screen" id="payment-screen" style="display: none;">
        <div class="onboarding-container">
            <div class="onboarding-header">
                <h1>üí≥ Informations de paiement</h1>
                <p>S√©curis√© avec cryptage SSL</p>
                <div class="trial-reminder">
                    <span class="trial-badge">üéÅ Essai gratuit de 7 jours</span>
                    <p>Aucune facturation avant le <span id="trialEndDate"></span></p>
                </div>
            </div>
            
            <div class="payment-form">
                <div class="selected-plan-summary" id="planSummary">
                    <!-- Plan summary will be inserted here -->
                </div>
                
                <form class="payment-details" id="paymentForm">
                    <div class="form-group">
                        <label for="cardNumber">Num√©ro de carte</label>
                        <input type="text" id="cardNumber" placeholder="1234 5678 9012 3456" maxlength="19" required>
                        <div class="card-icons">
                            <span>üí≥</span>
                        </div>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="expiryDate">Date d'expiration</label>
                            <input type="text" id="expiryDate" placeholder="MM/AA" maxlength="5" required>
                        </div>
                        <div class="form-group">
                            <label for="cvv">CVV</label>
                            <input type="text" id="cvv" placeholder="123" maxlength="3" required>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="cardName">Nom sur la carte</label>
                        <input type="text" id="cardName" placeholder="Jean Dupont" required>
                    </div>
                    
                    <div class="security-info">
                        <div class="security-badge">
                            <span class="security-icon">üîí</span>
                            <div class="security-text">
                                <strong>Paiement 100% s√©curis√©</strong>
                                <p>Vos donn√©es sont prot√©g√©es par cryptage SSL</p>
                            </div>
                        </div>
                    </div>
                    
                    <button type="button" class="payment-btn" onclick="processPayment()">
                        D√©marrer l'essai gratuit de 7 jours
                    </button>
                </form>
                
                <div class="payment-terms">
                    <p><small>
                        En continuant, vous acceptez d'√™tre factur√©(e) apr√®s la p√©riode d'essai gratuit. 
                        Vous pouvez annuler √† tout moment dans les param√®tres de votre compte.
                    </small></p>
                </div>
            </div>
        </div>
    </div>

    <!-- √âcran de bienvenue apr√®s inscription -->
    <div class="screen-content onboarding-screen" id="welcome-screen" style="display: none;">
        <div class="onboarding-container">
            <div class="welcome-content">
                <div class="welcome-animation">
                    <div class="success-icon">üéâ</div>
                    <h1>Bienvenue dans MINDLY !</h1>
                    <p>Votre essai gratuit de 7 jours a commenc√©</p>
                </div>
                
                <div class="trial-status">
                    <div class="trial-info">
                        <h3>üìÖ Votre p√©riode d'essai</h3>
                        <div class="trial-countdown">
                            <span class="days-left" id="trialDaysLeft">7</span>
                            <span class="days-text">jours restants</span>
                        </div>
                        <p>Profitez de toutes les fonctionnalit√©s premium</p>
                    </div>
                </div>
                
                <div class="welcome-features">
                    <h3>üöÄ Pr√™t √† commencer ?</h3>
                    <div class="feature-list">
                        <div class="feature-item">
                            <span class="feature-icon">üß†</span>
                            <span class="feature-text">Diagnostic IA personnalis√©</span>
                        </div>
                        <div class="feature-item">
                            <span class="feature-icon">üèÉ‚Äç‚ôÄÔ∏è</span>
                            <span class="feature-text">Exercices adapt√©s √† votre profil</span>
                        </div>
                        <div class="feature-item">
                            <span class="feature-icon">üë•</span>
                            <span class="feature-text">Communaut√© bienveillante</span>
                        </div>
                        <div class="feature-item">
                            <span class="feature-icon">üìä</span>
                            <span class="feature-text">Suivi d√©taill√© de vos progr√®s</span>
                        </div>
                    </div>
                </div>
                
                <button class="start-app-btn" onclick="startUsingApp()">
                    üåü Commencer mon parcours bien-√™tre
                </button>
            </div>
        </div>
    </div>

    <!-- PWA Installation Script -->
    <script>
        // === PWA SERVICE WORKER REGISTRATION ===
        
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('/sw.js')
                    .then((registration) => {
                        console.log('üå∏ MINDLY PWA: Service Worker enregistr√© avec succ√®s:', registration.scope);
                        
                        // V√©rifier les mises √† jour
                        registration.addEventListener('updatefound', () => {
                            const newWorker = registration.installing;
                            newWorker.addEventListener('statechange', () => {
                                if (newWorker.state === 'installed' && navigator.serviceWorker.controller) {
                                    // Nouvelle version disponible
                                    if (confirm('üîÑ Une nouvelle version de MINDLY est disponible. Voulez-vous l\'installer maintenant ?')) {
                                        newWorker.postMessage({ type: 'SKIP_WAITING' });
                                        window.location.reload();
                                    }
                                }
                            });
                        });
                    })
                    .catch((error) => {
                        console.log('‚ùå MINDLY PWA: √âchec d\'enregistrement du Service Worker:', error);
                    });
            });
        }

        // D√©tection d'installation PWA
        let deferredPrompt;
        
        window.addEventListener('beforeinstallprompt', (e) => {
            console.log('üî• MINDLY PWA: Pr√™t pour installation !');
            e.preventDefault();
            deferredPrompt = e;
            
            // Afficher un bouton d'installation personnalis√©
            showInstallButton();
        });

        function showInstallButton() {
            const installBtn = document.createElement('button');
            installBtn.innerHTML = 'üì± Installer MINDLY sur votre t√©l√©phone';
            installBtn.style.cssText = `
                position: fixed;
                bottom: 100px;
                left: 50%;
                transform: translateX(-50%);
                background: linear-gradient(135deg, #4CAF50, #45a049);
                color: white;
                border: none;
                padding: 16px 24px;
                border-radius: 25px;
                font-size: 16px;
                font-weight: 600;
                cursor: pointer;
                box-shadow: 0 4px 20px rgba(76, 175, 80, 0.4);
                z-index: 10000;
                animation: bounce 2s infinite;
            `;
            
            installBtn.addEventListener('click', installPWA);
            document.body.appendChild(installBtn);
            
            // Masquer apr√®s 10 secondes
            setTimeout(() => {
                if (installBtn.parentNode) {
                    installBtn.remove();
                }
            }, 10000);
        }

        function installPWA() {
            if (deferredPrompt) {
                deferredPrompt.prompt();
                
                deferredPrompt.userChoice.then((choiceResult) => {
                    if (choiceResult.outcome === 'accepted') {
                        console.log('üéâ MINDLY PWA: Installation accept√©e !');
                        showNotification('üì± MINDLY install√© avec succ√®s !', 'success');
                    } else {
                        console.log('‚ùå MINDLY PWA: Installation refus√©e');
                    }
                    deferredPrompt = null;
                });
            }
        }

        // D√©tection si l'app est d√©j√† install√©e
        window.addEventListener('appinstalled', (evt) => {
            console.log('üéâ MINDLY PWA: Application install√©e avec succ√®s !');
            showNotification('üå∏ Bienvenue dans MINDLY ! L\'application est maintenant install√©e sur votre appareil.', 'success');
        });

        // Animation pour le bouton d'installation
        const style = document.createElement('style');
        style.textContent = `
            @keyframes bounce {
                0%, 20%, 50%, 80%, 100% {
                    transform: translateX(-50%) translateY(0);
                }
                40% {
                    transform: translateX(-50%) translateY(-10px);
                }
                60% {
                    transform: translateX(-50%) translateY(-5px);
                }
            }
        `;
        document.head.appendChild(style);
    </script>
</body>
</html>